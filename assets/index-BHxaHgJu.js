function wP(n,e){for(var t=0;t<e.length;t++){const r=e[t];if(typeof r!="string"&&!Array.isArray(r)){for(const s in r)if(s!=="default"&&!(s in n)){const o=Object.getOwnPropertyDescriptor(r,s);o&&Object.defineProperty(n,s,o.get?o:{enumerable:!0,get:()=>r[s]})}}}return Object.freeze(Object.defineProperty(n,Symbol.toStringTag,{value:"Module"}))}(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const s of document.querySelectorAll('link[rel="modulepreload"]'))r(s);new MutationObserver(s=>{for(const o of s)if(o.type==="childList")for(const l of o.addedNodes)l.tagName==="LINK"&&l.rel==="modulepreload"&&r(l)}).observe(document,{childList:!0,subtree:!0});function t(s){const o={};return s.integrity&&(o.integrity=s.integrity),s.referrerPolicy&&(o.referrerPolicy=s.referrerPolicy),s.crossOrigin==="use-credentials"?o.credentials="include":s.crossOrigin==="anonymous"?o.credentials="omit":o.credentials="same-origin",o}function r(s){if(s.ep)return;s.ep=!0;const o=t(s);fetch(s.href,o)}})();function NS(n){return n&&n.__esModule&&Object.prototype.hasOwnProperty.call(n,"default")?n.default:n}var Wg={exports:{}},au={},Hg={exports:{}},qe={};/**
 * @license React
 * react.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var px;function EP(){if(px)return qe;px=1;var n=Symbol.for("react.element"),e=Symbol.for("react.portal"),t=Symbol.for("react.fragment"),r=Symbol.for("react.strict_mode"),s=Symbol.for("react.profiler"),o=Symbol.for("react.provider"),l=Symbol.for("react.context"),u=Symbol.for("react.forward_ref"),h=Symbol.for("react.suspense"),p=Symbol.for("react.memo"),g=Symbol.for("react.lazy"),_=Symbol.iterator;function v(B){return B===null||typeof B!="object"?null:(B=_&&B[_]||B["@@iterator"],typeof B=="function"?B:null)}var T={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},A=Object.assign,I={};function b(B,Z,me){this.props=B,this.context=Z,this.refs=I,this.updater=me||T}b.prototype.isReactComponent={},b.prototype.setState=function(B,Z){if(typeof B!="object"&&typeof B!="function"&&B!=null)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,B,Z,"setState")},b.prototype.forceUpdate=function(B){this.updater.enqueueForceUpdate(this,B,"forceUpdate")};function j(){}j.prototype=b.prototype;function U(B,Z,me){this.props=B,this.context=Z,this.refs=I,this.updater=me||T}var $=U.prototype=new j;$.constructor=U,A($,b.prototype),$.isPureReactComponent=!0;var G=Array.isArray,X=Object.prototype.hasOwnProperty,ne={current:null},P={key:!0,ref:!0,__self:!0,__source:!0};function R(B,Z,me){var _e,Ne={},Pe=null,he=null;if(Z!=null)for(_e in Z.ref!==void 0&&(he=Z.ref),Z.key!==void 0&&(Pe=""+Z.key),Z)X.call(Z,_e)&&!P.hasOwnProperty(_e)&&(Ne[_e]=Z[_e]);var Fe=arguments.length-2;if(Fe===1)Ne.children=me;else if(1<Fe){for(var Ye=Array(Fe),xt=0;xt<Fe;xt++)Ye[xt]=arguments[xt+2];Ne.children=Ye}if(B&&B.defaultProps)for(_e in Fe=B.defaultProps,Fe)Ne[_e]===void 0&&(Ne[_e]=Fe[_e]);return{$$typeof:n,type:B,key:Pe,ref:he,props:Ne,_owner:ne.current}}function N(B,Z){return{$$typeof:n,type:B.type,key:Z,ref:B.ref,props:B.props,_owner:B._owner}}function L(B){return typeof B=="object"&&B!==null&&B.$$typeof===n}function O(B){var Z={"=":"=0",":":"=2"};return"$"+B.replace(/[=:]/g,function(me){return Z[me]})}var F=/\/+/g;function D(B,Z){return typeof B=="object"&&B!==null&&B.key!=null?O(""+B.key):Z.toString(36)}function Ce(B,Z,me,_e,Ne){var Pe=typeof B;(Pe==="undefined"||Pe==="boolean")&&(B=null);var he=!1;if(B===null)he=!0;else switch(Pe){case"string":case"number":he=!0;break;case"object":switch(B.$$typeof){case n:case e:he=!0}}if(he)return he=B,Ne=Ne(he),B=_e===""?"."+D(he,0):_e,G(Ne)?(me="",B!=null&&(me=B.replace(F,"$&/")+"/"),Ce(Ne,Z,me,"",function(xt){return xt})):Ne!=null&&(L(Ne)&&(Ne=N(Ne,me+(!Ne.key||he&&he.key===Ne.key?"":(""+Ne.key).replace(F,"$&/")+"/")+B)),Z.push(Ne)),1;if(he=0,_e=_e===""?".":_e+":",G(B))for(var Fe=0;Fe<B.length;Fe++){Pe=B[Fe];var Ye=_e+D(Pe,Fe);he+=Ce(Pe,Z,me,Ye,Ne)}else if(Ye=v(B),typeof Ye=="function")for(B=Ye.call(B),Fe=0;!(Pe=B.next()).done;)Pe=Pe.value,Ye=_e+D(Pe,Fe++),he+=Ce(Pe,Z,me,Ye,Ne);else if(Pe==="object")throw Z=String(B),Error("Objects are not valid as a React child (found: "+(Z==="[object Object]"?"object with keys {"+Object.keys(B).join(", ")+"}":Z)+"). If you meant to render a collection of children, use an array instead.");return he}function je(B,Z,me){if(B==null)return B;var _e=[],Ne=0;return Ce(B,_e,"","",function(Pe){return Z.call(me,Pe,Ne++)}),_e}function Se(B){if(B._status===-1){var Z=B._result;Z=Z(),Z.then(function(me){(B._status===0||B._status===-1)&&(B._status=1,B._result=me)},function(me){(B._status===0||B._status===-1)&&(B._status=2,B._result=me)}),B._status===-1&&(B._status=0,B._result=Z)}if(B._status===1)return B._result.default;throw B._result}var Ie={current:null},W={transition:null},J={ReactCurrentDispatcher:Ie,ReactCurrentBatchConfig:W,ReactCurrentOwner:ne};function oe(){throw Error("act(...) is not supported in production builds of React.")}return qe.Children={map:je,forEach:function(B,Z,me){je(B,function(){Z.apply(this,arguments)},me)},count:function(B){var Z=0;return je(B,function(){Z++}),Z},toArray:function(B){return je(B,function(Z){return Z})||[]},only:function(B){if(!L(B))throw Error("React.Children.only expected to receive a single React element child.");return B}},qe.Component=b,qe.Fragment=t,qe.Profiler=s,qe.PureComponent=U,qe.StrictMode=r,qe.Suspense=h,qe.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=J,qe.act=oe,qe.cloneElement=function(B,Z,me){if(B==null)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+B+".");var _e=A({},B.props),Ne=B.key,Pe=B.ref,he=B._owner;if(Z!=null){if(Z.ref!==void 0&&(Pe=Z.ref,he=ne.current),Z.key!==void 0&&(Ne=""+Z.key),B.type&&B.type.defaultProps)var Fe=B.type.defaultProps;for(Ye in Z)X.call(Z,Ye)&&!P.hasOwnProperty(Ye)&&(_e[Ye]=Z[Ye]===void 0&&Fe!==void 0?Fe[Ye]:Z[Ye])}var Ye=arguments.length-2;if(Ye===1)_e.children=me;else if(1<Ye){Fe=Array(Ye);for(var xt=0;xt<Ye;xt++)Fe[xt]=arguments[xt+2];_e.children=Fe}return{$$typeof:n,type:B.type,key:Ne,ref:Pe,props:_e,_owner:he}},qe.createContext=function(B){return B={$$typeof:l,_currentValue:B,_currentValue2:B,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null},B.Provider={$$typeof:o,_context:B},B.Consumer=B},qe.createElement=R,qe.createFactory=function(B){var Z=R.bind(null,B);return Z.type=B,Z},qe.createRef=function(){return{current:null}},qe.forwardRef=function(B){return{$$typeof:u,render:B}},qe.isValidElement=L,qe.lazy=function(B){return{$$typeof:g,_payload:{_status:-1,_result:B},_init:Se}},qe.memo=function(B,Z){return{$$typeof:p,type:B,compare:Z===void 0?null:Z}},qe.startTransition=function(B){var Z=W.transition;W.transition={};try{B()}finally{W.transition=Z}},qe.unstable_act=oe,qe.useCallback=function(B,Z){return Ie.current.useCallback(B,Z)},qe.useContext=function(B){return Ie.current.useContext(B)},qe.useDebugValue=function(){},qe.useDeferredValue=function(B){return Ie.current.useDeferredValue(B)},qe.useEffect=function(B,Z){return Ie.current.useEffect(B,Z)},qe.useId=function(){return Ie.current.useId()},qe.useImperativeHandle=function(B,Z,me){return Ie.current.useImperativeHandle(B,Z,me)},qe.useInsertionEffect=function(B,Z){return Ie.current.useInsertionEffect(B,Z)},qe.useLayoutEffect=function(B,Z){return Ie.current.useLayoutEffect(B,Z)},qe.useMemo=function(B,Z){return Ie.current.useMemo(B,Z)},qe.useReducer=function(B,Z,me){return Ie.current.useReducer(B,Z,me)},qe.useRef=function(B){return Ie.current.useRef(B)},qe.useState=function(B){return Ie.current.useState(B)},qe.useSyncExternalStore=function(B,Z,me){return Ie.current.useSyncExternalStore(B,Z,me)},qe.useTransition=function(){return Ie.current.useTransition()},qe.version="18.3.1",qe}var mx;function gp(){return mx||(mx=1,Hg.exports=EP()),Hg.exports}/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var gx;function xP(){if(gx)return au;gx=1;var n=gp(),e=Symbol.for("react.element"),t=Symbol.for("react.fragment"),r=Object.prototype.hasOwnProperty,s=n.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,o={key:!0,ref:!0,__self:!0,__source:!0};function l(u,h,p){var g,_={},v=null,T=null;p!==void 0&&(v=""+p),h.key!==void 0&&(v=""+h.key),h.ref!==void 0&&(T=h.ref);for(g in h)r.call(h,g)&&!o.hasOwnProperty(g)&&(_[g]=h[g]);if(u&&u.defaultProps)for(g in h=u.defaultProps,h)_[g]===void 0&&(_[g]=h[g]);return{$$typeof:e,type:u,key:v,ref:T,props:_,_owner:s.current}}return au.Fragment=t,au.jsx=l,au.jsxs=l,au}var yx;function TP(){return yx||(yx=1,Wg.exports=xP()),Wg.exports}var m=TP(),zh={},qg={exports:{}},Ln={},Gg={exports:{}},Kg={};/**
 * @license React
 * scheduler.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var _x;function CP(){return _x||(_x=1,(function(n){function e(W,J){var oe=W.length;W.push(J);e:for(;0<oe;){var B=oe-1>>>1,Z=W[B];if(0<s(Z,J))W[B]=J,W[oe]=Z,oe=B;else break e}}function t(W){return W.length===0?null:W[0]}function r(W){if(W.length===0)return null;var J=W[0],oe=W.pop();if(oe!==J){W[0]=oe;e:for(var B=0,Z=W.length,me=Z>>>1;B<me;){var _e=2*(B+1)-1,Ne=W[_e],Pe=_e+1,he=W[Pe];if(0>s(Ne,oe))Pe<Z&&0>s(he,Ne)?(W[B]=he,W[Pe]=oe,B=Pe):(W[B]=Ne,W[_e]=oe,B=_e);else if(Pe<Z&&0>s(he,oe))W[B]=he,W[Pe]=oe,B=Pe;else break e}}return J}function s(W,J){var oe=W.sortIndex-J.sortIndex;return oe!==0?oe:W.id-J.id}if(typeof performance=="object"&&typeof performance.now=="function"){var o=performance;n.unstable_now=function(){return o.now()}}else{var l=Date,u=l.now();n.unstable_now=function(){return l.now()-u}}var h=[],p=[],g=1,_=null,v=3,T=!1,A=!1,I=!1,b=typeof setTimeout=="function"?setTimeout:null,j=typeof clearTimeout=="function"?clearTimeout:null,U=typeof setImmediate<"u"?setImmediate:null;typeof navigator<"u"&&navigator.scheduling!==void 0&&navigator.scheduling.isInputPending!==void 0&&navigator.scheduling.isInputPending.bind(navigator.scheduling);function $(W){for(var J=t(p);J!==null;){if(J.callback===null)r(p);else if(J.startTime<=W)r(p),J.sortIndex=J.expirationTime,e(h,J);else break;J=t(p)}}function G(W){if(I=!1,$(W),!A)if(t(h)!==null)A=!0,Se(X);else{var J=t(p);J!==null&&Ie(G,J.startTime-W)}}function X(W,J){A=!1,I&&(I=!1,j(R),R=-1),T=!0;var oe=v;try{for($(J),_=t(h);_!==null&&(!(_.expirationTime>J)||W&&!O());){var B=_.callback;if(typeof B=="function"){_.callback=null,v=_.priorityLevel;var Z=B(_.expirationTime<=J);J=n.unstable_now(),typeof Z=="function"?_.callback=Z:_===t(h)&&r(h),$(J)}else r(h);_=t(h)}if(_!==null)var me=!0;else{var _e=t(p);_e!==null&&Ie(G,_e.startTime-J),me=!1}return me}finally{_=null,v=oe,T=!1}}var ne=!1,P=null,R=-1,N=5,L=-1;function O(){return!(n.unstable_now()-L<N)}function F(){if(P!==null){var W=n.unstable_now();L=W;var J=!0;try{J=P(!0,W)}finally{J?D():(ne=!1,P=null)}}else ne=!1}var D;if(typeof U=="function")D=function(){U(F)};else if(typeof MessageChannel<"u"){var Ce=new MessageChannel,je=Ce.port2;Ce.port1.onmessage=F,D=function(){je.postMessage(null)}}else D=function(){b(F,0)};function Se(W){P=W,ne||(ne=!0,D())}function Ie(W,J){R=b(function(){W(n.unstable_now())},J)}n.unstable_IdlePriority=5,n.unstable_ImmediatePriority=1,n.unstable_LowPriority=4,n.unstable_NormalPriority=3,n.unstable_Profiling=null,n.unstable_UserBlockingPriority=2,n.unstable_cancelCallback=function(W){W.callback=null},n.unstable_continueExecution=function(){A||T||(A=!0,Se(X))},n.unstable_forceFrameRate=function(W){0>W||125<W?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):N=0<W?Math.floor(1e3/W):5},n.unstable_getCurrentPriorityLevel=function(){return v},n.unstable_getFirstCallbackNode=function(){return t(h)},n.unstable_next=function(W){switch(v){case 1:case 2:case 3:var J=3;break;default:J=v}var oe=v;v=J;try{return W()}finally{v=oe}},n.unstable_pauseExecution=function(){},n.unstable_requestPaint=function(){},n.unstable_runWithPriority=function(W,J){switch(W){case 1:case 2:case 3:case 4:case 5:break;default:W=3}var oe=v;v=W;try{return J()}finally{v=oe}},n.unstable_scheduleCallback=function(W,J,oe){var B=n.unstable_now();switch(typeof oe=="object"&&oe!==null?(oe=oe.delay,oe=typeof oe=="number"&&0<oe?B+oe:B):oe=B,W){case 1:var Z=-1;break;case 2:Z=250;break;case 5:Z=1073741823;break;case 4:Z=1e4;break;default:Z=5e3}return Z=oe+Z,W={id:g++,callback:J,priorityLevel:W,startTime:oe,expirationTime:Z,sortIndex:-1},oe>B?(W.sortIndex=oe,e(p,W),t(h)===null&&W===t(p)&&(I?(j(R),R=-1):I=!0,Ie(G,oe-B))):(W.sortIndex=Z,e(h,W),A||T||(A=!0,Se(X))),W},n.unstable_shouldYield=O,n.unstable_wrapCallback=function(W){var J=v;return function(){var oe=v;v=J;try{return W.apply(this,arguments)}finally{v=oe}}}})(Kg)),Kg}var vx;function SP(){return vx||(vx=1,Gg.exports=CP()),Gg.exports}/**
 * @license React
 * react-dom.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var wx;function IP(){if(wx)return Ln;wx=1;var n=gp(),e=SP();function t(i){for(var a="https://reactjs.org/docs/error-decoder.html?invariant="+i,c=1;c<arguments.length;c++)a+="&args[]="+encodeURIComponent(arguments[c]);return"Minified React error #"+i+"; visit "+a+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var r=new Set,s={};function o(i,a){l(i,a),l(i+"Capture",a)}function l(i,a){for(s[i]=a,i=0;i<a.length;i++)r.add(a[i])}var u=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),h=Object.prototype.hasOwnProperty,p=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,g={},_={};function v(i){return h.call(_,i)?!0:h.call(g,i)?!1:p.test(i)?_[i]=!0:(g[i]=!0,!1)}function T(i,a,c,f){if(c!==null&&c.type===0)return!1;switch(typeof a){case"function":case"symbol":return!0;case"boolean":return f?!1:c!==null?!c.acceptsBooleans:(i=i.toLowerCase().slice(0,5),i!=="data-"&&i!=="aria-");default:return!1}}function A(i,a,c,f){if(a===null||typeof a>"u"||T(i,a,c,f))return!0;if(f)return!1;if(c!==null)switch(c.type){case 3:return!a;case 4:return a===!1;case 5:return isNaN(a);case 6:return isNaN(a)||1>a}return!1}function I(i,a,c,f,y,w,S){this.acceptsBooleans=a===2||a===3||a===4,this.attributeName=f,this.attributeNamespace=y,this.mustUseProperty=c,this.propertyName=i,this.type=a,this.sanitizeURL=w,this.removeEmptyString=S}var b={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(i){b[i]=new I(i,0,!1,i,null,!1,!1)}),[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(i){var a=i[0];b[a]=new I(a,1,!1,i[1],null,!1,!1)}),["contentEditable","draggable","spellCheck","value"].forEach(function(i){b[i]=new I(i,2,!1,i.toLowerCase(),null,!1,!1)}),["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(i){b[i]=new I(i,2,!1,i,null,!1,!1)}),"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(i){b[i]=new I(i,3,!1,i.toLowerCase(),null,!1,!1)}),["checked","multiple","muted","selected"].forEach(function(i){b[i]=new I(i,3,!0,i,null,!1,!1)}),["capture","download"].forEach(function(i){b[i]=new I(i,4,!1,i,null,!1,!1)}),["cols","rows","size","span"].forEach(function(i){b[i]=new I(i,6,!1,i,null,!1,!1)}),["rowSpan","start"].forEach(function(i){b[i]=new I(i,5,!1,i.toLowerCase(),null,!1,!1)});var j=/[\-:]([a-z])/g;function U(i){return i[1].toUpperCase()}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(i){var a=i.replace(j,U);b[a]=new I(a,1,!1,i,null,!1,!1)}),"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(i){var a=i.replace(j,U);b[a]=new I(a,1,!1,i,"http://www.w3.org/1999/xlink",!1,!1)}),["xml:base","xml:lang","xml:space"].forEach(function(i){var a=i.replace(j,U);b[a]=new I(a,1,!1,i,"http://www.w3.org/XML/1998/namespace",!1,!1)}),["tabIndex","crossOrigin"].forEach(function(i){b[i]=new I(i,1,!1,i.toLowerCase(),null,!1,!1)}),b.xlinkHref=new I("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1),["src","href","action","formAction"].forEach(function(i){b[i]=new I(i,1,!1,i.toLowerCase(),null,!0,!0)});function $(i,a,c,f){var y=b.hasOwnProperty(a)?b[a]:null;(y!==null?y.type!==0:f||!(2<a.length)||a[0]!=="o"&&a[0]!=="O"||a[1]!=="n"&&a[1]!=="N")&&(A(a,c,y,f)&&(c=null),f||y===null?v(a)&&(c===null?i.removeAttribute(a):i.setAttribute(a,""+c)):y.mustUseProperty?i[y.propertyName]=c===null?y.type===3?!1:"":c:(a=y.attributeName,f=y.attributeNamespace,c===null?i.removeAttribute(a):(y=y.type,c=y===3||y===4&&c===!0?"":""+c,f?i.setAttributeNS(f,a,c):i.setAttribute(a,c))))}var G=n.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,X=Symbol.for("react.element"),ne=Symbol.for("react.portal"),P=Symbol.for("react.fragment"),R=Symbol.for("react.strict_mode"),N=Symbol.for("react.profiler"),L=Symbol.for("react.provider"),O=Symbol.for("react.context"),F=Symbol.for("react.forward_ref"),D=Symbol.for("react.suspense"),Ce=Symbol.for("react.suspense_list"),je=Symbol.for("react.memo"),Se=Symbol.for("react.lazy"),Ie=Symbol.for("react.offscreen"),W=Symbol.iterator;function J(i){return i===null||typeof i!="object"?null:(i=W&&i[W]||i["@@iterator"],typeof i=="function"?i:null)}var oe=Object.assign,B;function Z(i){if(B===void 0)try{throw Error()}catch(c){var a=c.stack.trim().match(/\n( *(at )?)/);B=a&&a[1]||""}return`
`+B+i}var me=!1;function _e(i,a){if(!i||me)return"";me=!0;var c=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(a)if(a=function(){throw Error()},Object.defineProperty(a.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(a,[])}catch(Q){var f=Q}Reflect.construct(i,[],a)}else{try{a.call()}catch(Q){f=Q}i.call(a.prototype)}else{try{throw Error()}catch(Q){f=Q}i()}}catch(Q){if(Q&&f&&typeof Q.stack=="string"){for(var y=Q.stack.split(`
`),w=f.stack.split(`
`),S=y.length-1,M=w.length-1;1<=S&&0<=M&&y[S]!==w[M];)M--;for(;1<=S&&0<=M;S--,M--)if(y[S]!==w[M]){if(S!==1||M!==1)do if(S--,M--,0>M||y[S]!==w[M]){var V=`
`+y[S].replace(" at new "," at ");return i.displayName&&V.includes("<anonymous>")&&(V=V.replace("<anonymous>",i.displayName)),V}while(1<=S&&0<=M);break}}}finally{me=!1,Error.prepareStackTrace=c}return(i=i?i.displayName||i.name:"")?Z(i):""}function Ne(i){switch(i.tag){case 5:return Z(i.type);case 16:return Z("Lazy");case 13:return Z("Suspense");case 19:return Z("SuspenseList");case 0:case 2:case 15:return i=_e(i.type,!1),i;case 11:return i=_e(i.type.render,!1),i;case 1:return i=_e(i.type,!0),i;default:return""}}function Pe(i){if(i==null)return null;if(typeof i=="function")return i.displayName||i.name||null;if(typeof i=="string")return i;switch(i){case P:return"Fragment";case ne:return"Portal";case N:return"Profiler";case R:return"StrictMode";case D:return"Suspense";case Ce:return"SuspenseList"}if(typeof i=="object")switch(i.$$typeof){case O:return(i.displayName||"Context")+".Consumer";case L:return(i._context.displayName||"Context")+".Provider";case F:var a=i.render;return i=i.displayName,i||(i=a.displayName||a.name||"",i=i!==""?"ForwardRef("+i+")":"ForwardRef"),i;case je:return a=i.displayName||null,a!==null?a:Pe(i.type)||"Memo";case Se:a=i._payload,i=i._init;try{return Pe(i(a))}catch{}}return null}function he(i){var a=i.type;switch(i.tag){case 24:return"Cache";case 9:return(a.displayName||"Context")+".Consumer";case 10:return(a._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return i=a.render,i=i.displayName||i.name||"",a.displayName||(i!==""?"ForwardRef("+i+")":"ForwardRef");case 7:return"Fragment";case 5:return a;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return Pe(a);case 8:return a===R?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if(typeof a=="function")return a.displayName||a.name||null;if(typeof a=="string")return a}return null}function Fe(i){switch(typeof i){case"boolean":case"number":case"string":case"undefined":return i;case"object":return i;default:return""}}function Ye(i){var a=i.type;return(i=i.nodeName)&&i.toLowerCase()==="input"&&(a==="checkbox"||a==="radio")}function xt(i){var a=Ye(i)?"checked":"value",c=Object.getOwnPropertyDescriptor(i.constructor.prototype,a),f=""+i[a];if(!i.hasOwnProperty(a)&&typeof c<"u"&&typeof c.get=="function"&&typeof c.set=="function"){var y=c.get,w=c.set;return Object.defineProperty(i,a,{configurable:!0,get:function(){return y.call(this)},set:function(S){f=""+S,w.call(this,S)}}),Object.defineProperty(i,a,{enumerable:c.enumerable}),{getValue:function(){return f},setValue:function(S){f=""+S},stopTracking:function(){i._valueTracker=null,delete i[a]}}}}function An(i){i._valueTracker||(i._valueTracker=xt(i))}function kn(i){if(!i)return!1;var a=i._valueTracker;if(!a)return!0;var c=a.getValue(),f="";return i&&(f=Ye(i)?i.checked?"true":"false":i.value),i=f,i!==c?(a.setValue(i),!0):!1}function Tn(i){if(i=i||(typeof document<"u"?document:void 0),typeof i>"u")return null;try{return i.activeElement||i.body}catch{return i.body}}function ui(i,a){var c=a.checked;return oe({},a,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:c??i._wrapperState.initialChecked})}function Aa(i,a){var c=a.defaultValue==null?"":a.defaultValue,f=a.checked!=null?a.checked:a.defaultChecked;c=Fe(a.value!=null?a.value:c),i._wrapperState={initialChecked:f,initialValue:c,controlled:a.type==="checkbox"||a.type==="radio"?a.checked!=null:a.value!=null}}function di(i,a){a=a.checked,a!=null&&$(i,"checked",a,!1)}function ge(i,a){di(i,a);var c=Fe(a.value),f=a.type;if(c!=null)f==="number"?(c===0&&i.value===""||i.value!=c)&&(i.value=""+c):i.value!==""+c&&(i.value=""+c);else if(f==="submit"||f==="reset"){i.removeAttribute("value");return}a.hasOwnProperty("value")?$e(i,a.type,c):a.hasOwnProperty("defaultValue")&&$e(i,a.type,Fe(a.defaultValue)),a.checked==null&&a.defaultChecked!=null&&(i.defaultChecked=!!a.defaultChecked)}function Re(i,a,c){if(a.hasOwnProperty("value")||a.hasOwnProperty("defaultValue")){var f=a.type;if(!(f!=="submit"&&f!=="reset"||a.value!==void 0&&a.value!==null))return;a=""+i._wrapperState.initialValue,c||a===i.value||(i.value=a),i.defaultValue=a}c=i.name,c!==""&&(i.name=""),i.defaultChecked=!!i._wrapperState.initialChecked,c!==""&&(i.name=c)}function $e(i,a,c){(a!=="number"||Tn(i.ownerDocument)!==i)&&(c==null?i.defaultValue=""+i._wrapperState.initialValue:i.defaultValue!==""+c&&(i.defaultValue=""+c))}var nt=Array.isArray;function tn(i,a,c,f){if(i=i.options,a){a={};for(var y=0;y<c.length;y++)a["$"+c[y]]=!0;for(c=0;c<i.length;c++)y=a.hasOwnProperty("$"+i[c].value),i[c].selected!==y&&(i[c].selected=y),y&&f&&(i[c].defaultSelected=!0)}else{for(c=""+Fe(c),a=null,y=0;y<i.length;y++){if(i[y].value===c){i[y].selected=!0,f&&(i[y].defaultSelected=!0);return}a!==null||i[y].disabled||(a=i[y])}a!==null&&(a.selected=!0)}}function mc(i,a){if(a.dangerouslySetInnerHTML!=null)throw Error(t(91));return oe({},a,{value:void 0,defaultValue:void 0,children:""+i._wrapperState.initialValue})}function gc(i,a){var c=a.value;if(c==null){if(c=a.children,a=a.defaultValue,c!=null){if(a!=null)throw Error(t(92));if(nt(c)){if(1<c.length)throw Error(t(93));c=c[0]}a=c}a==null&&(a=""),c=a}i._wrapperState={initialValue:Fe(c)}}function bd(i,a){var c=Fe(a.value),f=Fe(a.defaultValue);c!=null&&(c=""+c,c!==i.value&&(i.value=c),a.defaultValue==null&&i.defaultValue!==c&&(i.defaultValue=c)),f!=null&&(i.defaultValue=""+f)}function hi(i){var a=i.textContent;a===i._wrapperState.initialValue&&a!==""&&a!==null&&(i.value=a)}function yc(i){switch(i){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function ka(i,a){return i==null||i==="http://www.w3.org/1999/xhtml"?yc(a):i==="http://www.w3.org/2000/svg"&&a==="foreignObject"?"http://www.w3.org/1999/xhtml":i}var fi,Rd=(function(i){return typeof MSApp<"u"&&MSApp.execUnsafeLocalFunction?function(a,c,f,y){MSApp.execUnsafeLocalFunction(function(){return i(a,c,f,y)})}:i})(function(i,a){if(i.namespaceURI!=="http://www.w3.org/2000/svg"||"innerHTML"in i)i.innerHTML=a;else{for(fi=fi||document.createElement("div"),fi.innerHTML="<svg>"+a.valueOf().toString()+"</svg>",a=fi.firstChild;i.firstChild;)i.removeChild(i.firstChild);for(;a.firstChild;)i.appendChild(a.firstChild)}});function Io(i,a){if(a){var c=i.firstChild;if(c&&c===i.lastChild&&c.nodeType===3){c.nodeValue=a;return}}i.textContent=a}var pi={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},Ad=["Webkit","ms","Moz","O"];Object.keys(pi).forEach(function(i){Ad.forEach(function(a){a=a+i.charAt(0).toUpperCase()+i.substring(1),pi[a]=pi[i]})});function mi(i,a,c){return a==null||typeof a=="boolean"||a===""?"":c||typeof a!="number"||a===0||pi.hasOwnProperty(i)&&pi[i]?(""+a).trim():a+"px"}function Na(i,a){i=i.style;for(var c in a)if(a.hasOwnProperty(c)){var f=c.indexOf("--")===0,y=mi(c,a[c],f);c==="float"&&(c="cssFloat"),f?i.setProperty(c,y):i[c]=y}}var _c=oe({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function wr(i,a){if(a){if(_c[i]&&(a.children!=null||a.dangerouslySetInnerHTML!=null))throw Error(t(137,i));if(a.dangerouslySetInnerHTML!=null){if(a.children!=null)throw Error(t(60));if(typeof a.dangerouslySetInnerHTML!="object"||!("__html"in a.dangerouslySetInnerHTML))throw Error(t(61))}if(a.style!=null&&typeof a.style!="object")throw Error(t(62))}}function Pa(i,a){if(i.indexOf("-")===-1)return typeof a.is=="string";switch(i){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var gi=null;function Da(i){return i=i.target||i.srcElement||window,i.correspondingUseElement&&(i=i.correspondingUseElement),i.nodeType===3?i.parentNode:i}var Cs=null,Ss=null,bt=null;function vc(i){if(i=qc(i)){if(typeof Cs!="function")throw Error(t(280));var a=i.stateNode;a&&(a=nh(a),Cs(i.stateNode,i.type,a))}}function yi(i){Ss?bt?bt.push(i):bt=[i]:Ss=i}function _i(){if(Ss){var i=Ss,a=bt;if(bt=Ss=null,vc(i),a)for(i=0;i<a.length;i++)vc(a[i])}}function kd(i,a){return i(a)}function Nd(){}var Ur=!1;function Pd(i,a,c){if(Ur)return i(a,c);Ur=!0;try{return kd(i,a,c)}finally{Ur=!1,(Ss!==null||bt!==null)&&(Nd(),_i())}}function bo(i,a){var c=i.stateNode;if(c===null)return null;var f=nh(c);if(f===null)return null;c=f[a];e:switch(a){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(f=!f.disabled)||(i=i.type,f=!(i==="button"||i==="input"||i==="select"||i==="textarea")),i=!f;break e;default:i=!1}if(i)return null;if(c&&typeof c!="function")throw Error(t(231,a,typeof c));return c}var vi=!1;if(u)try{var wi={};Object.defineProperty(wi,"passive",{get:function(){vi=!0}}),window.addEventListener("test",wi,wi),window.removeEventListener("test",wi,wi)}catch{vi=!1}function Dd(i,a,c,f,y,w,S,M,V){var Q=Array.prototype.slice.call(arguments,3);try{a.apply(c,Q)}catch(se){this.onError(se)}}var Is=!1,zr=null,Oa=!1,or=null,Od={onError:function(i){Is=!0,zr=i}};function Md(i,a,c,f,y,w,S,M,V){Is=!1,zr=null,Dd.apply(Od,arguments)}function wc(i,a,c,f,y,w,S,M,V){if(Md.apply(this,arguments),Is){if(Is){var Q=zr;Is=!1,zr=null}else throw Error(t(198));Oa||(Oa=!0,or=Q)}}function Er(i){var a=i,c=i;if(i.alternate)for(;a.return;)a=a.return;else{i=a;do a=i,(a.flags&4098)!==0&&(c=a.return),i=a.return;while(i)}return a.tag===3?c:null}function Ec(i){if(i.tag===13){var a=i.memoizedState;if(a===null&&(i=i.alternate,i!==null&&(a=i.memoizedState)),a!==null)return a.dehydrated}return null}function Ld(i){if(Er(i)!==i)throw Error(t(188))}function jd(i){var a=i.alternate;if(!a){if(a=Er(i),a===null)throw Error(t(188));return a!==i?null:i}for(var c=i,f=a;;){var y=c.return;if(y===null)break;var w=y.alternate;if(w===null){if(f=y.return,f!==null){c=f;continue}break}if(y.child===w.child){for(w=y.child;w;){if(w===c)return Ld(y),i;if(w===f)return Ld(y),a;w=w.sibling}throw Error(t(188))}if(c.return!==f.return)c=y,f=w;else{for(var S=!1,M=y.child;M;){if(M===c){S=!0,c=y,f=w;break}if(M===f){S=!0,f=y,c=w;break}M=M.sibling}if(!S){for(M=w.child;M;){if(M===c){S=!0,c=w,f=y;break}if(M===f){S=!0,f=w,c=y;break}M=M.sibling}if(!S)throw Error(t(189))}}if(c.alternate!==f)throw Error(t(190))}if(c.tag!==3)throw Error(t(188));return c.stateNode.current===c?i:a}function Vd(i){return i=jd(i),i!==null?Ro(i):null}function Ro(i){if(i.tag===5||i.tag===6)return i;for(i=i.child;i!==null;){var a=Ro(i);if(a!==null)return a;i=i.sibling}return null}var xc=e.unstable_scheduleCallback,Ma=e.unstable_cancelCallback,Ao=e.unstable_shouldYield,bs=e.unstable_requestPaint,gt=e.unstable_now,Em=e.unstable_getCurrentPriorityLevel,La=e.unstable_ImmediatePriority,Tc=e.unstable_UserBlockingPriority,ko=e.unstable_NormalPriority,Cc=e.unstable_LowPriority,ja=e.unstable_IdlePriority,No=null,Bn=null;function Fd(i){if(Bn&&typeof Bn.onCommitFiberRoot=="function")try{Bn.onCommitFiberRoot(No,i,void 0,(i.current.flags&128)===128)}catch{}}var $n=Math.clz32?Math.clz32:Po,Br=Math.log,ar=Math.LN2;function Po(i){return i>>>=0,i===0?32:31-(Br(i)/ar|0)|0}var $r=64,Ei=4194304;function ot(i){switch(i&-i){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return i&4194240;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return i&130023424;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return i}}function Rs(i,a){var c=i.pendingLanes;if(c===0)return 0;var f=0,y=i.suspendedLanes,w=i.pingedLanes,S=c&268435455;if(S!==0){var M=S&~y;M!==0?f=ot(M):(w&=S,w!==0&&(f=ot(w)))}else S=c&~y,S!==0?f=ot(S):w!==0&&(f=ot(w));if(f===0)return 0;if(a!==0&&a!==f&&(a&y)===0&&(y=f&-f,w=a&-a,y>=w||y===16&&(w&4194240)!==0))return a;if((f&4)!==0&&(f|=c&16),a=i.entangledLanes,a!==0)for(i=i.entanglements,a&=f;0<a;)c=31-$n(a),y=1<<c,f|=i[c],a&=~y;return f}function Do(i,a){switch(i){case 1:case 2:case 4:return a+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return a+5e3;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return-1;case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function Oo(i,a){for(var c=i.suspendedLanes,f=i.pingedLanes,y=i.expirationTimes,w=i.pendingLanes;0<w;){var S=31-$n(w),M=1<<S,V=y[S];V===-1?((M&c)===0||(M&f)!==0)&&(y[S]=Do(M,a)):V<=a&&(i.expiredLanes|=M),w&=~M}}function Sc(i){return i=i.pendingLanes&-1073741825,i!==0?i:i&1073741824?1073741824:0}function Ic(){var i=$r;return $r<<=1,($r&4194240)===0&&($r=64),i}function bc(i){for(var a=[],c=0;31>c;c++)a.push(i);return a}function Mo(i,a,c){i.pendingLanes|=a,a!==536870912&&(i.suspendedLanes=0,i.pingedLanes=0),i=i.eventTimes,a=31-$n(a),i[a]=c}function xm(i,a){var c=i.pendingLanes&~a;i.pendingLanes=a,i.suspendedLanes=0,i.pingedLanes=0,i.expiredLanes&=a,i.mutableReadLanes&=a,i.entangledLanes&=a,a=i.entanglements;var f=i.eventTimes;for(i=i.expirationTimes;0<c;){var y=31-$n(c),w=1<<y;a[y]=0,f[y]=-1,i[y]=-1,c&=~w}}function Rc(i,a){var c=i.entangledLanes|=a;for(i=i.entanglements;c;){var f=31-$n(c),y=1<<f;y&a|i[f]&a&&(i[f]|=a),c&=~y}}var Ze=0;function Wr(i){return i&=-i,1<i?4<i?(i&268435455)!==0?16:536870912:4:1}var Ac,Va,kc,Nc,Pc,Hr=!1,Fa=[],qr=null,Gr=null,nn=null,Lo=new Map,As=new Map,Wn=[],Ud="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function xi(i,a){switch(i){case"focusin":case"focusout":qr=null;break;case"dragenter":case"dragleave":Gr=null;break;case"mouseover":case"mouseout":nn=null;break;case"pointerover":case"pointerout":Lo.delete(a.pointerId);break;case"gotpointercapture":case"lostpointercapture":As.delete(a.pointerId)}}function xr(i,a,c,f,y,w){return i===null||i.nativeEvent!==w?(i={blockedOn:a,domEventName:c,eventSystemFlags:f,nativeEvent:w,targetContainers:[y]},a!==null&&(a=qc(a),a!==null&&Va(a)),i):(i.eventSystemFlags|=f,a=i.targetContainers,y!==null&&a.indexOf(y)===-1&&a.push(y),i)}function zd(i,a,c,f,y){switch(a){case"focusin":return qr=xr(qr,i,a,c,f,y),!0;case"dragenter":return Gr=xr(Gr,i,a,c,f,y),!0;case"mouseover":return nn=xr(nn,i,a,c,f,y),!0;case"pointerover":var w=y.pointerId;return Lo.set(w,xr(Lo.get(w)||null,i,a,c,f,y)),!0;case"gotpointercapture":return w=y.pointerId,As.set(w,xr(As.get(w)||null,i,a,c,f,y)),!0}return!1}function Ua(i){var a=Uo(i.target);if(a!==null){var c=Er(a);if(c!==null){if(a=c.tag,a===13){if(a=Ec(c),a!==null){i.blockedOn=a,Pc(i.priority,function(){kc(c)});return}}else if(a===3&&c.stateNode.current.memoizedState.isDehydrated){i.blockedOn=c.tag===3?c.stateNode.containerInfo:null;return}}}i.blockedOn=null}function ht(i){if(i.blockedOn!==null)return!1;for(var a=i.targetContainers;0<a.length;){var c=za(i.domEventName,i.eventSystemFlags,a[0],i.nativeEvent);if(c===null){c=i.nativeEvent;var f=new c.constructor(c.type,c);gi=f,c.target.dispatchEvent(f),gi=null}else return a=qc(c),a!==null&&Va(a),i.blockedOn=c,!1;a.shift()}return!0}function Bd(i,a,c){ht(i)&&c.delete(a)}function Tm(){Hr=!1,qr!==null&&ht(qr)&&(qr=null),Gr!==null&&ht(Gr)&&(Gr=null),nn!==null&&ht(nn)&&(nn=null),Lo.forEach(Bd),As.forEach(Bd)}function Ti(i,a){i.blockedOn===a&&(i.blockedOn=null,Hr||(Hr=!0,e.unstable_scheduleCallback(e.unstable_NormalPriority,Tm)))}function Ci(i){function a(y){return Ti(y,i)}if(0<Fa.length){Ti(Fa[0],i);for(var c=1;c<Fa.length;c++){var f=Fa[c];f.blockedOn===i&&(f.blockedOn=null)}}for(qr!==null&&Ti(qr,i),Gr!==null&&Ti(Gr,i),nn!==null&&Ti(nn,i),Lo.forEach(a),As.forEach(a),c=0;c<Wn.length;c++)f=Wn[c],f.blockedOn===i&&(f.blockedOn=null);for(;0<Wn.length&&(c=Wn[0],c.blockedOn===null);)Ua(c),c.blockedOn===null&&Wn.shift()}var ks=G.ReactCurrentBatchConfig,Ns=!0;function Kr(i,a,c,f){var y=Ze,w=ks.transition;ks.transition=null;try{Ze=1,Dc(i,a,c,f)}finally{Ze=y,ks.transition=w}}function $d(i,a,c,f){var y=Ze,w=ks.transition;ks.transition=null;try{Ze=4,Dc(i,a,c,f)}finally{Ze=y,ks.transition=w}}function Dc(i,a,c,f){if(Ns){var y=za(i,a,c,f);if(y===null)Om(i,a,f,Qr,c),xi(i,f);else if(zd(y,i,a,c,f))f.stopPropagation();else if(xi(i,f),a&4&&-1<Ud.indexOf(i)){for(;y!==null;){var w=qc(y);if(w!==null&&Ac(w),w=za(i,a,c,f),w===null&&Om(i,a,f,Qr,c),w===y)break;y=w}y!==null&&f.stopPropagation()}else Om(i,a,f,null,c)}}var Qr=null;function za(i,a,c,f){if(Qr=null,i=Da(f),i=Uo(i),i!==null)if(a=Er(i),a===null)i=null;else if(c=a.tag,c===13){if(i=Ec(a),i!==null)return i;i=null}else if(c===3){if(a.stateNode.current.memoizedState.isDehydrated)return a.tag===3?a.stateNode.containerInfo:null;i=null}else a!==i&&(i=null);return Qr=i,null}function Ba(i){switch(i){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(Em()){case La:return 1;case Tc:return 4;case ko:case Cc:return 16;case ja:return 536870912;default:return 16}default:return 16}}var Hn=null,$a=null,Ps=null;function Wd(){if(Ps)return Ps;var i,a=$a,c=a.length,f,y="value"in Hn?Hn.value:Hn.textContent,w=y.length;for(i=0;i<c&&a[i]===y[i];i++);var S=c-i;for(f=1;f<=S&&a[c-f]===y[w-f];f++);return Ps=y.slice(i,1<f?1-f:void 0)}function jo(i){var a=i.keyCode;return"charCode"in i?(i=i.charCode,i===0&&a===13&&(i=13)):i=a,i===10&&(i=13),32<=i||i===13?i:0}function Yr(){return!0}function Oc(){return!1}function fn(i){function a(c,f,y,w,S){this._reactName=c,this._targetInst=y,this.type=f,this.nativeEvent=w,this.target=S,this.currentTarget=null;for(var M in i)i.hasOwnProperty(M)&&(c=i[M],this[M]=c?c(w):w[M]);return this.isDefaultPrevented=(w.defaultPrevented!=null?w.defaultPrevented:w.returnValue===!1)?Yr:Oc,this.isPropagationStopped=Oc,this}return oe(a.prototype,{preventDefault:function(){this.defaultPrevented=!0;var c=this.nativeEvent;c&&(c.preventDefault?c.preventDefault():typeof c.returnValue!="unknown"&&(c.returnValue=!1),this.isDefaultPrevented=Yr)},stopPropagation:function(){var c=this.nativeEvent;c&&(c.stopPropagation?c.stopPropagation():typeof c.cancelBubble!="unknown"&&(c.cancelBubble=!0),this.isPropagationStopped=Yr)},persist:function(){},isPersistent:Yr}),a}var Xr={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(i){return i.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},Vo=fn(Xr),Si=oe({},Xr,{view:0,detail:0}),Wa=fn(Si),Ha,qa,qn,Fo=oe({},Si,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:ze,button:0,buttons:0,relatedTarget:function(i){return i.relatedTarget===void 0?i.fromElement===i.srcElement?i.toElement:i.fromElement:i.relatedTarget},movementX:function(i){return"movementX"in i?i.movementX:(i!==qn&&(qn&&i.type==="mousemove"?(Ha=i.screenX-qn.screenX,qa=i.screenY-qn.screenY):qa=Ha=0,qn=i),Ha)},movementY:function(i){return"movementY"in i?i.movementY:qa}}),Mc=fn(Fo),Hd=oe({},Fo,{dataTransfer:0}),qd=fn(Hd),Ga=oe({},Si,{relatedTarget:0}),rn=fn(Ga),Gd=oe({},Xr,{animationName:0,elapsedTime:0,pseudoElement:0}),Kd=fn(Gd),Ii=oe({},Xr,{clipboardData:function(i){return"clipboardData"in i?i.clipboardData:window.clipboardData}}),d=fn(Ii),E=oe({},Xr,{data:0}),x=fn(E),k={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},q={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},Y={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function ce(i){var a=this.nativeEvent;return a.getModifierState?a.getModifierState(i):(i=Y[i])?!!a[i]:!1}function ze(){return ce}var Pt=oe({},Si,{key:function(i){if(i.key){var a=k[i.key]||i.key;if(a!=="Unidentified")return a}return i.type==="keypress"?(i=jo(i),i===13?"Enter":String.fromCharCode(i)):i.type==="keydown"||i.type==="keyup"?q[i.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:ze,charCode:function(i){return i.type==="keypress"?jo(i):0},keyCode:function(i){return i.type==="keydown"||i.type==="keyup"?i.keyCode:0},which:function(i){return i.type==="keypress"?jo(i):i.type==="keydown"||i.type==="keyup"?i.keyCode:0}}),ct=fn(Pt),jt=oe({},Fo,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),Gn=fn(jt),Ds=oe({},Si,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:ze}),Jr=fn(Ds),Zr=oe({},Xr,{propertyName:0,elapsedTime:0,pseudoElement:0}),Ka=fn(Zr),Lc=oe({},Fo,{deltaX:function(i){return"deltaX"in i?i.deltaX:"wheelDeltaX"in i?-i.wheelDeltaX:0},deltaY:function(i){return"deltaY"in i?i.deltaY:"wheelDeltaY"in i?-i.wheelDeltaY:"wheelDelta"in i?-i.wheelDelta:0},deltaZ:0,deltaMode:0}),p1=fn(Lc),m1=[9,13,27,32],Cm=u&&"CompositionEvent"in window,jc=null;u&&"documentMode"in document&&(jc=document.documentMode);var g1=u&&"TextEvent"in window&&!jc,o0=u&&(!Cm||jc&&8<jc&&11>=jc),a0=" ",l0=!1;function c0(i,a){switch(i){case"keyup":return m1.indexOf(a.keyCode)!==-1;case"keydown":return a.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function u0(i){return i=i.detail,typeof i=="object"&&"data"in i?i.data:null}var Qa=!1;function y1(i,a){switch(i){case"compositionend":return u0(a);case"keypress":return a.which!==32?null:(l0=!0,a0);case"textInput":return i=a.data,i===a0&&l0?null:i;default:return null}}function _1(i,a){if(Qa)return i==="compositionend"||!Cm&&c0(i,a)?(i=Wd(),Ps=$a=Hn=null,Qa=!1,i):null;switch(i){case"paste":return null;case"keypress":if(!(a.ctrlKey||a.altKey||a.metaKey)||a.ctrlKey&&a.altKey){if(a.char&&1<a.char.length)return a.char;if(a.which)return String.fromCharCode(a.which)}return null;case"compositionend":return o0&&a.locale!=="ko"?null:a.data;default:return null}}var v1={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function d0(i){var a=i&&i.nodeName&&i.nodeName.toLowerCase();return a==="input"?!!v1[i.type]:a==="textarea"}function h0(i,a,c,f){yi(f),a=Zd(a,"onChange"),0<a.length&&(c=new Vo("onChange","change",null,c,f),i.push({event:c,listeners:a}))}var Vc=null,Fc=null;function w1(i){k0(i,0)}function Qd(i){var a=el(i);if(kn(a))return i}function E1(i,a){if(i==="change")return a}var f0=!1;if(u){var Sm;if(u){var Im="oninput"in document;if(!Im){var p0=document.createElement("div");p0.setAttribute("oninput","return;"),Im=typeof p0.oninput=="function"}Sm=Im}else Sm=!1;f0=Sm&&(!document.documentMode||9<document.documentMode)}function m0(){Vc&&(Vc.detachEvent("onpropertychange",g0),Fc=Vc=null)}function g0(i){if(i.propertyName==="value"&&Qd(Fc)){var a=[];h0(a,Fc,i,Da(i)),Pd(w1,a)}}function x1(i,a,c){i==="focusin"?(m0(),Vc=a,Fc=c,Vc.attachEvent("onpropertychange",g0)):i==="focusout"&&m0()}function T1(i){if(i==="selectionchange"||i==="keyup"||i==="keydown")return Qd(Fc)}function C1(i,a){if(i==="click")return Qd(a)}function S1(i,a){if(i==="input"||i==="change")return Qd(a)}function I1(i,a){return i===a&&(i!==0||1/i===1/a)||i!==i&&a!==a}var Tr=typeof Object.is=="function"?Object.is:I1;function Uc(i,a){if(Tr(i,a))return!0;if(typeof i!="object"||i===null||typeof a!="object"||a===null)return!1;var c=Object.keys(i),f=Object.keys(a);if(c.length!==f.length)return!1;for(f=0;f<c.length;f++){var y=c[f];if(!h.call(a,y)||!Tr(i[y],a[y]))return!1}return!0}function y0(i){for(;i&&i.firstChild;)i=i.firstChild;return i}function _0(i,a){var c=y0(i);i=0;for(var f;c;){if(c.nodeType===3){if(f=i+c.textContent.length,i<=a&&f>=a)return{node:c,offset:a-i};i=f}e:{for(;c;){if(c.nextSibling){c=c.nextSibling;break e}c=c.parentNode}c=void 0}c=y0(c)}}function v0(i,a){return i&&a?i===a?!0:i&&i.nodeType===3?!1:a&&a.nodeType===3?v0(i,a.parentNode):"contains"in i?i.contains(a):i.compareDocumentPosition?!!(i.compareDocumentPosition(a)&16):!1:!1}function w0(){for(var i=window,a=Tn();a instanceof i.HTMLIFrameElement;){try{var c=typeof a.contentWindow.location.href=="string"}catch{c=!1}if(c)i=a.contentWindow;else break;a=Tn(i.document)}return a}function bm(i){var a=i&&i.nodeName&&i.nodeName.toLowerCase();return a&&(a==="input"&&(i.type==="text"||i.type==="search"||i.type==="tel"||i.type==="url"||i.type==="password")||a==="textarea"||i.contentEditable==="true")}function b1(i){var a=w0(),c=i.focusedElem,f=i.selectionRange;if(a!==c&&c&&c.ownerDocument&&v0(c.ownerDocument.documentElement,c)){if(f!==null&&bm(c)){if(a=f.start,i=f.end,i===void 0&&(i=a),"selectionStart"in c)c.selectionStart=a,c.selectionEnd=Math.min(i,c.value.length);else if(i=(a=c.ownerDocument||document)&&a.defaultView||window,i.getSelection){i=i.getSelection();var y=c.textContent.length,w=Math.min(f.start,y);f=f.end===void 0?w:Math.min(f.end,y),!i.extend&&w>f&&(y=f,f=w,w=y),y=_0(c,w);var S=_0(c,f);y&&S&&(i.rangeCount!==1||i.anchorNode!==y.node||i.anchorOffset!==y.offset||i.focusNode!==S.node||i.focusOffset!==S.offset)&&(a=a.createRange(),a.setStart(y.node,y.offset),i.removeAllRanges(),w>f?(i.addRange(a),i.extend(S.node,S.offset)):(a.setEnd(S.node,S.offset),i.addRange(a)))}}for(a=[],i=c;i=i.parentNode;)i.nodeType===1&&a.push({element:i,left:i.scrollLeft,top:i.scrollTop});for(typeof c.focus=="function"&&c.focus(),c=0;c<a.length;c++)i=a[c],i.element.scrollLeft=i.left,i.element.scrollTop=i.top}}var R1=u&&"documentMode"in document&&11>=document.documentMode,Ya=null,Rm=null,zc=null,Am=!1;function E0(i,a,c){var f=c.window===c?c.document:c.nodeType===9?c:c.ownerDocument;Am||Ya==null||Ya!==Tn(f)||(f=Ya,"selectionStart"in f&&bm(f)?f={start:f.selectionStart,end:f.selectionEnd}:(f=(f.ownerDocument&&f.ownerDocument.defaultView||window).getSelection(),f={anchorNode:f.anchorNode,anchorOffset:f.anchorOffset,focusNode:f.focusNode,focusOffset:f.focusOffset}),zc&&Uc(zc,f)||(zc=f,f=Zd(Rm,"onSelect"),0<f.length&&(a=new Vo("onSelect","select",null,a,c),i.push({event:a,listeners:f}),a.target=Ya)))}function Yd(i,a){var c={};return c[i.toLowerCase()]=a.toLowerCase(),c["Webkit"+i]="webkit"+a,c["Moz"+i]="moz"+a,c}var Xa={animationend:Yd("Animation","AnimationEnd"),animationiteration:Yd("Animation","AnimationIteration"),animationstart:Yd("Animation","AnimationStart"),transitionend:Yd("Transition","TransitionEnd")},km={},x0={};u&&(x0=document.createElement("div").style,"AnimationEvent"in window||(delete Xa.animationend.animation,delete Xa.animationiteration.animation,delete Xa.animationstart.animation),"TransitionEvent"in window||delete Xa.transitionend.transition);function Xd(i){if(km[i])return km[i];if(!Xa[i])return i;var a=Xa[i],c;for(c in a)if(a.hasOwnProperty(c)&&c in x0)return km[i]=a[c];return i}var T0=Xd("animationend"),C0=Xd("animationiteration"),S0=Xd("animationstart"),I0=Xd("transitionend"),b0=new Map,R0="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function bi(i,a){b0.set(i,a),o(a,[i])}for(var Nm=0;Nm<R0.length;Nm++){var Pm=R0[Nm],A1=Pm.toLowerCase(),k1=Pm[0].toUpperCase()+Pm.slice(1);bi(A1,"on"+k1)}bi(T0,"onAnimationEnd"),bi(C0,"onAnimationIteration"),bi(S0,"onAnimationStart"),bi("dblclick","onDoubleClick"),bi("focusin","onFocus"),bi("focusout","onBlur"),bi(I0,"onTransitionEnd"),l("onMouseEnter",["mouseout","mouseover"]),l("onMouseLeave",["mouseout","mouseover"]),l("onPointerEnter",["pointerout","pointerover"]),l("onPointerLeave",["pointerout","pointerover"]),o("onChange","change click focusin focusout input keydown keyup selectionchange".split(" ")),o("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" ")),o("onBeforeInput",["compositionend","keypress","textInput","paste"]),o("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" ")),o("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" ")),o("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var Bc="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),N1=new Set("cancel close invalid load scroll toggle".split(" ").concat(Bc));function A0(i,a,c){var f=i.type||"unknown-event";i.currentTarget=c,wc(f,a,void 0,i),i.currentTarget=null}function k0(i,a){a=(a&4)!==0;for(var c=0;c<i.length;c++){var f=i[c],y=f.event;f=f.listeners;e:{var w=void 0;if(a)for(var S=f.length-1;0<=S;S--){var M=f[S],V=M.instance,Q=M.currentTarget;if(M=M.listener,V!==w&&y.isPropagationStopped())break e;A0(y,M,Q),w=V}else for(S=0;S<f.length;S++){if(M=f[S],V=M.instance,Q=M.currentTarget,M=M.listener,V!==w&&y.isPropagationStopped())break e;A0(y,M,Q),w=V}}}if(Oa)throw i=or,Oa=!1,or=null,i}function yt(i,a){var c=a[Um];c===void 0&&(c=a[Um]=new Set);var f=i+"__bubble";c.has(f)||(N0(a,i,2,!1),c.add(f))}function Dm(i,a,c){var f=0;a&&(f|=4),N0(c,i,f,a)}var Jd="_reactListening"+Math.random().toString(36).slice(2);function $c(i){if(!i[Jd]){i[Jd]=!0,r.forEach(function(c){c!=="selectionchange"&&(N1.has(c)||Dm(c,!1,i),Dm(c,!0,i))});var a=i.nodeType===9?i:i.ownerDocument;a===null||a[Jd]||(a[Jd]=!0,Dm("selectionchange",!1,a))}}function N0(i,a,c,f){switch(Ba(a)){case 1:var y=Kr;break;case 4:y=$d;break;default:y=Dc}c=y.bind(null,a,c,i),y=void 0,!vi||a!=="touchstart"&&a!=="touchmove"&&a!=="wheel"||(y=!0),f?y!==void 0?i.addEventListener(a,c,{capture:!0,passive:y}):i.addEventListener(a,c,!0):y!==void 0?i.addEventListener(a,c,{passive:y}):i.addEventListener(a,c,!1)}function Om(i,a,c,f,y){var w=f;if((a&1)===0&&(a&2)===0&&f!==null)e:for(;;){if(f===null)return;var S=f.tag;if(S===3||S===4){var M=f.stateNode.containerInfo;if(M===y||M.nodeType===8&&M.parentNode===y)break;if(S===4)for(S=f.return;S!==null;){var V=S.tag;if((V===3||V===4)&&(V=S.stateNode.containerInfo,V===y||V.nodeType===8&&V.parentNode===y))return;S=S.return}for(;M!==null;){if(S=Uo(M),S===null)return;if(V=S.tag,V===5||V===6){f=w=S;continue e}M=M.parentNode}}f=f.return}Pd(function(){var Q=w,se=Da(c),ie=[];e:{var re=b0.get(i);if(re!==void 0){var fe=Vo,ve=i;switch(i){case"keypress":if(jo(c)===0)break e;case"keydown":case"keyup":fe=ct;break;case"focusin":ve="focus",fe=rn;break;case"focusout":ve="blur",fe=rn;break;case"beforeblur":case"afterblur":fe=rn;break;case"click":if(c.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":fe=Mc;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":fe=qd;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":fe=Jr;break;case T0:case C0:case S0:fe=Kd;break;case I0:fe=Ka;break;case"scroll":fe=Wa;break;case"wheel":fe=p1;break;case"copy":case"cut":case"paste":fe=d;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":fe=Gn}var xe=(a&4)!==0,Dt=!xe&&i==="scroll",H=xe?re!==null?re+"Capture":null:re;xe=[];for(var z=Q,K;z!==null;){K=z;var ae=K.stateNode;if(K.tag===5&&ae!==null&&(K=ae,H!==null&&(ae=bo(z,H),ae!=null&&xe.push(Wc(z,ae,K)))),Dt)break;z=z.return}0<xe.length&&(re=new fe(re,ve,null,c,se),ie.push({event:re,listeners:xe}))}}if((a&7)===0){e:{if(re=i==="mouseover"||i==="pointerover",fe=i==="mouseout"||i==="pointerout",re&&c!==gi&&(ve=c.relatedTarget||c.fromElement)&&(Uo(ve)||ve[Os]))break e;if((fe||re)&&(re=se.window===se?se:(re=se.ownerDocument)?re.defaultView||re.parentWindow:window,fe?(ve=c.relatedTarget||c.toElement,fe=Q,ve=ve?Uo(ve):null,ve!==null&&(Dt=Er(ve),ve!==Dt||ve.tag!==5&&ve.tag!==6)&&(ve=null)):(fe=null,ve=Q),fe!==ve)){if(xe=Mc,ae="onMouseLeave",H="onMouseEnter",z="mouse",(i==="pointerout"||i==="pointerover")&&(xe=Gn,ae="onPointerLeave",H="onPointerEnter",z="pointer"),Dt=fe==null?re:el(fe),K=ve==null?re:el(ve),re=new xe(ae,z+"leave",fe,c,se),re.target=Dt,re.relatedTarget=K,ae=null,Uo(se)===Q&&(xe=new xe(H,z+"enter",ve,c,se),xe.target=K,xe.relatedTarget=Dt,ae=xe),Dt=ae,fe&&ve)t:{for(xe=fe,H=ve,z=0,K=xe;K;K=Ja(K))z++;for(K=0,ae=H;ae;ae=Ja(ae))K++;for(;0<z-K;)xe=Ja(xe),z--;for(;0<K-z;)H=Ja(H),K--;for(;z--;){if(xe===H||H!==null&&xe===H.alternate)break t;xe=Ja(xe),H=Ja(H)}xe=null}else xe=null;fe!==null&&P0(ie,re,fe,xe,!1),ve!==null&&Dt!==null&&P0(ie,Dt,ve,xe,!0)}}e:{if(re=Q?el(Q):window,fe=re.nodeName&&re.nodeName.toLowerCase(),fe==="select"||fe==="input"&&re.type==="file")var Te=E1;else if(d0(re))if(f0)Te=S1;else{Te=T1;var Ae=x1}else(fe=re.nodeName)&&fe.toLowerCase()==="input"&&(re.type==="checkbox"||re.type==="radio")&&(Te=C1);if(Te&&(Te=Te(i,Q))){h0(ie,Te,c,se);break e}Ae&&Ae(i,re,Q),i==="focusout"&&(Ae=re._wrapperState)&&Ae.controlled&&re.type==="number"&&$e(re,"number",re.value)}switch(Ae=Q?el(Q):window,i){case"focusin":(d0(Ae)||Ae.contentEditable==="true")&&(Ya=Ae,Rm=Q,zc=null);break;case"focusout":zc=Rm=Ya=null;break;case"mousedown":Am=!0;break;case"contextmenu":case"mouseup":case"dragend":Am=!1,E0(ie,c,se);break;case"selectionchange":if(R1)break;case"keydown":case"keyup":E0(ie,c,se)}var ke;if(Cm)e:{switch(i){case"compositionstart":var Ve="onCompositionStart";break e;case"compositionend":Ve="onCompositionEnd";break e;case"compositionupdate":Ve="onCompositionUpdate";break e}Ve=void 0}else Qa?c0(i,c)&&(Ve="onCompositionEnd"):i==="keydown"&&c.keyCode===229&&(Ve="onCompositionStart");Ve&&(o0&&c.locale!=="ko"&&(Qa||Ve!=="onCompositionStart"?Ve==="onCompositionEnd"&&Qa&&(ke=Wd()):(Hn=se,$a="value"in Hn?Hn.value:Hn.textContent,Qa=!0)),Ae=Zd(Q,Ve),0<Ae.length&&(Ve=new x(Ve,i,null,c,se),ie.push({event:Ve,listeners:Ae}),ke?Ve.data=ke:(ke=u0(c),ke!==null&&(Ve.data=ke)))),(ke=g1?y1(i,c):_1(i,c))&&(Q=Zd(Q,"onBeforeInput"),0<Q.length&&(se=new x("onBeforeInput","beforeinput",null,c,se),ie.push({event:se,listeners:Q}),se.data=ke))}k0(ie,a)})}function Wc(i,a,c){return{instance:i,listener:a,currentTarget:c}}function Zd(i,a){for(var c=a+"Capture",f=[];i!==null;){var y=i,w=y.stateNode;y.tag===5&&w!==null&&(y=w,w=bo(i,c),w!=null&&f.unshift(Wc(i,w,y)),w=bo(i,a),w!=null&&f.push(Wc(i,w,y))),i=i.return}return f}function Ja(i){if(i===null)return null;do i=i.return;while(i&&i.tag!==5);return i||null}function P0(i,a,c,f,y){for(var w=a._reactName,S=[];c!==null&&c!==f;){var M=c,V=M.alternate,Q=M.stateNode;if(V!==null&&V===f)break;M.tag===5&&Q!==null&&(M=Q,y?(V=bo(c,w),V!=null&&S.unshift(Wc(c,V,M))):y||(V=bo(c,w),V!=null&&S.push(Wc(c,V,M)))),c=c.return}S.length!==0&&i.push({event:a,listeners:S})}var P1=/\r\n?/g,D1=/\u0000|\uFFFD/g;function D0(i){return(typeof i=="string"?i:""+i).replace(P1,`
`).replace(D1,"")}function eh(i,a,c){if(a=D0(a),D0(i)!==a&&c)throw Error(t(425))}function th(){}var Mm=null,Lm=null;function jm(i,a){return i==="textarea"||i==="noscript"||typeof a.children=="string"||typeof a.children=="number"||typeof a.dangerouslySetInnerHTML=="object"&&a.dangerouslySetInnerHTML!==null&&a.dangerouslySetInnerHTML.__html!=null}var Vm=typeof setTimeout=="function"?setTimeout:void 0,O1=typeof clearTimeout=="function"?clearTimeout:void 0,O0=typeof Promise=="function"?Promise:void 0,M1=typeof queueMicrotask=="function"?queueMicrotask:typeof O0<"u"?function(i){return O0.resolve(null).then(i).catch(L1)}:Vm;function L1(i){setTimeout(function(){throw i})}function Fm(i,a){var c=a,f=0;do{var y=c.nextSibling;if(i.removeChild(c),y&&y.nodeType===8)if(c=y.data,c==="/$"){if(f===0){i.removeChild(y),Ci(a);return}f--}else c!=="$"&&c!=="$?"&&c!=="$!"||f++;c=y}while(c);Ci(a)}function Ri(i){for(;i!=null;i=i.nextSibling){var a=i.nodeType;if(a===1||a===3)break;if(a===8){if(a=i.data,a==="$"||a==="$!"||a==="$?")break;if(a==="/$")return null}}return i}function M0(i){i=i.previousSibling;for(var a=0;i;){if(i.nodeType===8){var c=i.data;if(c==="$"||c==="$!"||c==="$?"){if(a===0)return i;a--}else c==="/$"&&a++}i=i.previousSibling}return null}var Za=Math.random().toString(36).slice(2),es="__reactFiber$"+Za,Hc="__reactProps$"+Za,Os="__reactContainer$"+Za,Um="__reactEvents$"+Za,j1="__reactListeners$"+Za,V1="__reactHandles$"+Za;function Uo(i){var a=i[es];if(a)return a;for(var c=i.parentNode;c;){if(a=c[Os]||c[es]){if(c=a.alternate,a.child!==null||c!==null&&c.child!==null)for(i=M0(i);i!==null;){if(c=i[es])return c;i=M0(i)}return a}i=c,c=i.parentNode}return null}function qc(i){return i=i[es]||i[Os],!i||i.tag!==5&&i.tag!==6&&i.tag!==13&&i.tag!==3?null:i}function el(i){if(i.tag===5||i.tag===6)return i.stateNode;throw Error(t(33))}function nh(i){return i[Hc]||null}var zm=[],tl=-1;function Ai(i){return{current:i}}function _t(i){0>tl||(i.current=zm[tl],zm[tl]=null,tl--)}function pt(i,a){tl++,zm[tl]=i.current,i.current=a}var ki={},pn=Ai(ki),Nn=Ai(!1),zo=ki;function nl(i,a){var c=i.type.contextTypes;if(!c)return ki;var f=i.stateNode;if(f&&f.__reactInternalMemoizedUnmaskedChildContext===a)return f.__reactInternalMemoizedMaskedChildContext;var y={},w;for(w in c)y[w]=a[w];return f&&(i=i.stateNode,i.__reactInternalMemoizedUnmaskedChildContext=a,i.__reactInternalMemoizedMaskedChildContext=y),y}function Pn(i){return i=i.childContextTypes,i!=null}function rh(){_t(Nn),_t(pn)}function L0(i,a,c){if(pn.current!==ki)throw Error(t(168));pt(pn,a),pt(Nn,c)}function j0(i,a,c){var f=i.stateNode;if(a=a.childContextTypes,typeof f.getChildContext!="function")return c;f=f.getChildContext();for(var y in f)if(!(y in a))throw Error(t(108,he(i)||"Unknown",y));return oe({},c,f)}function sh(i){return i=(i=i.stateNode)&&i.__reactInternalMemoizedMergedChildContext||ki,zo=pn.current,pt(pn,i),pt(Nn,Nn.current),!0}function V0(i,a,c){var f=i.stateNode;if(!f)throw Error(t(169));c?(i=j0(i,a,zo),f.__reactInternalMemoizedMergedChildContext=i,_t(Nn),_t(pn),pt(pn,i)):_t(Nn),pt(Nn,c)}var Ms=null,ih=!1,Bm=!1;function F0(i){Ms===null?Ms=[i]:Ms.push(i)}function F1(i){ih=!0,F0(i)}function Ni(){if(!Bm&&Ms!==null){Bm=!0;var i=0,a=Ze;try{var c=Ms;for(Ze=1;i<c.length;i++){var f=c[i];do f=f(!0);while(f!==null)}Ms=null,ih=!1}catch(y){throw Ms!==null&&(Ms=Ms.slice(i+1)),xc(La,Ni),y}finally{Ze=a,Bm=!1}}return null}var rl=[],sl=0,oh=null,ah=0,lr=[],cr=0,Bo=null,Ls=1,js="";function $o(i,a){rl[sl++]=ah,rl[sl++]=oh,oh=i,ah=a}function U0(i,a,c){lr[cr++]=Ls,lr[cr++]=js,lr[cr++]=Bo,Bo=i;var f=Ls;i=js;var y=32-$n(f)-1;f&=~(1<<y),c+=1;var w=32-$n(a)+y;if(30<w){var S=y-y%5;w=(f&(1<<S)-1).toString(32),f>>=S,y-=S,Ls=1<<32-$n(a)+y|c<<y|f,js=w+i}else Ls=1<<w|c<<y|f,js=i}function $m(i){i.return!==null&&($o(i,1),U0(i,1,0))}function Wm(i){for(;i===oh;)oh=rl[--sl],rl[sl]=null,ah=rl[--sl],rl[sl]=null;for(;i===Bo;)Bo=lr[--cr],lr[cr]=null,js=lr[--cr],lr[cr]=null,Ls=lr[--cr],lr[cr]=null}var Kn=null,Qn=null,Tt=!1,Cr=null;function z0(i,a){var c=fr(5,null,null,0);c.elementType="DELETED",c.stateNode=a,c.return=i,a=i.deletions,a===null?(i.deletions=[c],i.flags|=16):a.push(c)}function B0(i,a){switch(i.tag){case 5:var c=i.type;return a=a.nodeType!==1||c.toLowerCase()!==a.nodeName.toLowerCase()?null:a,a!==null?(i.stateNode=a,Kn=i,Qn=Ri(a.firstChild),!0):!1;case 6:return a=i.pendingProps===""||a.nodeType!==3?null:a,a!==null?(i.stateNode=a,Kn=i,Qn=null,!0):!1;case 13:return a=a.nodeType!==8?null:a,a!==null?(c=Bo!==null?{id:Ls,overflow:js}:null,i.memoizedState={dehydrated:a,treeContext:c,retryLane:1073741824},c=fr(18,null,null,0),c.stateNode=a,c.return=i,i.child=c,Kn=i,Qn=null,!0):!1;default:return!1}}function Hm(i){return(i.mode&1)!==0&&(i.flags&128)===0}function qm(i){if(Tt){var a=Qn;if(a){var c=a;if(!B0(i,a)){if(Hm(i))throw Error(t(418));a=Ri(c.nextSibling);var f=Kn;a&&B0(i,a)?z0(f,c):(i.flags=i.flags&-4097|2,Tt=!1,Kn=i)}}else{if(Hm(i))throw Error(t(418));i.flags=i.flags&-4097|2,Tt=!1,Kn=i}}}function $0(i){for(i=i.return;i!==null&&i.tag!==5&&i.tag!==3&&i.tag!==13;)i=i.return;Kn=i}function lh(i){if(i!==Kn)return!1;if(!Tt)return $0(i),Tt=!0,!1;var a;if((a=i.tag!==3)&&!(a=i.tag!==5)&&(a=i.type,a=a!=="head"&&a!=="body"&&!jm(i.type,i.memoizedProps)),a&&(a=Qn)){if(Hm(i))throw W0(),Error(t(418));for(;a;)z0(i,a),a=Ri(a.nextSibling)}if($0(i),i.tag===13){if(i=i.memoizedState,i=i!==null?i.dehydrated:null,!i)throw Error(t(317));e:{for(i=i.nextSibling,a=0;i;){if(i.nodeType===8){var c=i.data;if(c==="/$"){if(a===0){Qn=Ri(i.nextSibling);break e}a--}else c!=="$"&&c!=="$!"&&c!=="$?"||a++}i=i.nextSibling}Qn=null}}else Qn=Kn?Ri(i.stateNode.nextSibling):null;return!0}function W0(){for(var i=Qn;i;)i=Ri(i.nextSibling)}function il(){Qn=Kn=null,Tt=!1}function Gm(i){Cr===null?Cr=[i]:Cr.push(i)}var U1=G.ReactCurrentBatchConfig;function Gc(i,a,c){if(i=c.ref,i!==null&&typeof i!="function"&&typeof i!="object"){if(c._owner){if(c=c._owner,c){if(c.tag!==1)throw Error(t(309));var f=c.stateNode}if(!f)throw Error(t(147,i));var y=f,w=""+i;return a!==null&&a.ref!==null&&typeof a.ref=="function"&&a.ref._stringRef===w?a.ref:(a=function(S){var M=y.refs;S===null?delete M[w]:M[w]=S},a._stringRef=w,a)}if(typeof i!="string")throw Error(t(284));if(!c._owner)throw Error(t(290,i))}return i}function ch(i,a){throw i=Object.prototype.toString.call(a),Error(t(31,i==="[object Object]"?"object with keys {"+Object.keys(a).join(", ")+"}":i))}function H0(i){var a=i._init;return a(i._payload)}function q0(i){function a(H,z){if(i){var K=H.deletions;K===null?(H.deletions=[z],H.flags|=16):K.push(z)}}function c(H,z){if(!i)return null;for(;z!==null;)a(H,z),z=z.sibling;return null}function f(H,z){for(H=new Map;z!==null;)z.key!==null?H.set(z.key,z):H.set(z.index,z),z=z.sibling;return H}function y(H,z){return H=Fi(H,z),H.index=0,H.sibling=null,H}function w(H,z,K){return H.index=K,i?(K=H.alternate,K!==null?(K=K.index,K<z?(H.flags|=2,z):K):(H.flags|=2,z)):(H.flags|=1048576,z)}function S(H){return i&&H.alternate===null&&(H.flags|=2),H}function M(H,z,K,ae){return z===null||z.tag!==6?(z=Vg(K,H.mode,ae),z.return=H,z):(z=y(z,K),z.return=H,z)}function V(H,z,K,ae){var Te=K.type;return Te===P?se(H,z,K.props.children,ae,K.key):z!==null&&(z.elementType===Te||typeof Te=="object"&&Te!==null&&Te.$$typeof===Se&&H0(Te)===z.type)?(ae=y(z,K.props),ae.ref=Gc(H,z,K),ae.return=H,ae):(ae=Dh(K.type,K.key,K.props,null,H.mode,ae),ae.ref=Gc(H,z,K),ae.return=H,ae)}function Q(H,z,K,ae){return z===null||z.tag!==4||z.stateNode.containerInfo!==K.containerInfo||z.stateNode.implementation!==K.implementation?(z=Fg(K,H.mode,ae),z.return=H,z):(z=y(z,K.children||[]),z.return=H,z)}function se(H,z,K,ae,Te){return z===null||z.tag!==7?(z=Xo(K,H.mode,ae,Te),z.return=H,z):(z=y(z,K),z.return=H,z)}function ie(H,z,K){if(typeof z=="string"&&z!==""||typeof z=="number")return z=Vg(""+z,H.mode,K),z.return=H,z;if(typeof z=="object"&&z!==null){switch(z.$$typeof){case X:return K=Dh(z.type,z.key,z.props,null,H.mode,K),K.ref=Gc(H,null,z),K.return=H,K;case ne:return z=Fg(z,H.mode,K),z.return=H,z;case Se:var ae=z._init;return ie(H,ae(z._payload),K)}if(nt(z)||J(z))return z=Xo(z,H.mode,K,null),z.return=H,z;ch(H,z)}return null}function re(H,z,K,ae){var Te=z!==null?z.key:null;if(typeof K=="string"&&K!==""||typeof K=="number")return Te!==null?null:M(H,z,""+K,ae);if(typeof K=="object"&&K!==null){switch(K.$$typeof){case X:return K.key===Te?V(H,z,K,ae):null;case ne:return K.key===Te?Q(H,z,K,ae):null;case Se:return Te=K._init,re(H,z,Te(K._payload),ae)}if(nt(K)||J(K))return Te!==null?null:se(H,z,K,ae,null);ch(H,K)}return null}function fe(H,z,K,ae,Te){if(typeof ae=="string"&&ae!==""||typeof ae=="number")return H=H.get(K)||null,M(z,H,""+ae,Te);if(typeof ae=="object"&&ae!==null){switch(ae.$$typeof){case X:return H=H.get(ae.key===null?K:ae.key)||null,V(z,H,ae,Te);case ne:return H=H.get(ae.key===null?K:ae.key)||null,Q(z,H,ae,Te);case Se:var Ae=ae._init;return fe(H,z,K,Ae(ae._payload),Te)}if(nt(ae)||J(ae))return H=H.get(K)||null,se(z,H,ae,Te,null);ch(z,ae)}return null}function ve(H,z,K,ae){for(var Te=null,Ae=null,ke=z,Ve=z=0,Yt=null;ke!==null&&Ve<K.length;Ve++){ke.index>Ve?(Yt=ke,ke=null):Yt=ke.sibling;var it=re(H,ke,K[Ve],ae);if(it===null){ke===null&&(ke=Yt);break}i&&ke&&it.alternate===null&&a(H,ke),z=w(it,z,Ve),Ae===null?Te=it:Ae.sibling=it,Ae=it,ke=Yt}if(Ve===K.length)return c(H,ke),Tt&&$o(H,Ve),Te;if(ke===null){for(;Ve<K.length;Ve++)ke=ie(H,K[Ve],ae),ke!==null&&(z=w(ke,z,Ve),Ae===null?Te=ke:Ae.sibling=ke,Ae=ke);return Tt&&$o(H,Ve),Te}for(ke=f(H,ke);Ve<K.length;Ve++)Yt=fe(ke,H,Ve,K[Ve],ae),Yt!==null&&(i&&Yt.alternate!==null&&ke.delete(Yt.key===null?Ve:Yt.key),z=w(Yt,z,Ve),Ae===null?Te=Yt:Ae.sibling=Yt,Ae=Yt);return i&&ke.forEach(function(Ui){return a(H,Ui)}),Tt&&$o(H,Ve),Te}function xe(H,z,K,ae){var Te=J(K);if(typeof Te!="function")throw Error(t(150));if(K=Te.call(K),K==null)throw Error(t(151));for(var Ae=Te=null,ke=z,Ve=z=0,Yt=null,it=K.next();ke!==null&&!it.done;Ve++,it=K.next()){ke.index>Ve?(Yt=ke,ke=null):Yt=ke.sibling;var Ui=re(H,ke,it.value,ae);if(Ui===null){ke===null&&(ke=Yt);break}i&&ke&&Ui.alternate===null&&a(H,ke),z=w(Ui,z,Ve),Ae===null?Te=Ui:Ae.sibling=Ui,Ae=Ui,ke=Yt}if(it.done)return c(H,ke),Tt&&$o(H,Ve),Te;if(ke===null){for(;!it.done;Ve++,it=K.next())it=ie(H,it.value,ae),it!==null&&(z=w(it,z,Ve),Ae===null?Te=it:Ae.sibling=it,Ae=it);return Tt&&$o(H,Ve),Te}for(ke=f(H,ke);!it.done;Ve++,it=K.next())it=fe(ke,H,Ve,it.value,ae),it!==null&&(i&&it.alternate!==null&&ke.delete(it.key===null?Ve:it.key),z=w(it,z,Ve),Ae===null?Te=it:Ae.sibling=it,Ae=it);return i&&ke.forEach(function(vP){return a(H,vP)}),Tt&&$o(H,Ve),Te}function Dt(H,z,K,ae){if(typeof K=="object"&&K!==null&&K.type===P&&K.key===null&&(K=K.props.children),typeof K=="object"&&K!==null){switch(K.$$typeof){case X:e:{for(var Te=K.key,Ae=z;Ae!==null;){if(Ae.key===Te){if(Te=K.type,Te===P){if(Ae.tag===7){c(H,Ae.sibling),z=y(Ae,K.props.children),z.return=H,H=z;break e}}else if(Ae.elementType===Te||typeof Te=="object"&&Te!==null&&Te.$$typeof===Se&&H0(Te)===Ae.type){c(H,Ae.sibling),z=y(Ae,K.props),z.ref=Gc(H,Ae,K),z.return=H,H=z;break e}c(H,Ae);break}else a(H,Ae);Ae=Ae.sibling}K.type===P?(z=Xo(K.props.children,H.mode,ae,K.key),z.return=H,H=z):(ae=Dh(K.type,K.key,K.props,null,H.mode,ae),ae.ref=Gc(H,z,K),ae.return=H,H=ae)}return S(H);case ne:e:{for(Ae=K.key;z!==null;){if(z.key===Ae)if(z.tag===4&&z.stateNode.containerInfo===K.containerInfo&&z.stateNode.implementation===K.implementation){c(H,z.sibling),z=y(z,K.children||[]),z.return=H,H=z;break e}else{c(H,z);break}else a(H,z);z=z.sibling}z=Fg(K,H.mode,ae),z.return=H,H=z}return S(H);case Se:return Ae=K._init,Dt(H,z,Ae(K._payload),ae)}if(nt(K))return ve(H,z,K,ae);if(J(K))return xe(H,z,K,ae);ch(H,K)}return typeof K=="string"&&K!==""||typeof K=="number"?(K=""+K,z!==null&&z.tag===6?(c(H,z.sibling),z=y(z,K),z.return=H,H=z):(c(H,z),z=Vg(K,H.mode,ae),z.return=H,H=z),S(H)):c(H,z)}return Dt}var ol=q0(!0),G0=q0(!1),uh=Ai(null),dh=null,al=null,Km=null;function Qm(){Km=al=dh=null}function Ym(i){var a=uh.current;_t(uh),i._currentValue=a}function Xm(i,a,c){for(;i!==null;){var f=i.alternate;if((i.childLanes&a)!==a?(i.childLanes|=a,f!==null&&(f.childLanes|=a)):f!==null&&(f.childLanes&a)!==a&&(f.childLanes|=a),i===c)break;i=i.return}}function ll(i,a){dh=i,Km=al=null,i=i.dependencies,i!==null&&i.firstContext!==null&&((i.lanes&a)!==0&&(Dn=!0),i.firstContext=null)}function ur(i){var a=i._currentValue;if(Km!==i)if(i={context:i,memoizedValue:a,next:null},al===null){if(dh===null)throw Error(t(308));al=i,dh.dependencies={lanes:0,firstContext:i}}else al=al.next=i;return a}var Wo=null;function Jm(i){Wo===null?Wo=[i]:Wo.push(i)}function K0(i,a,c,f){var y=a.interleaved;return y===null?(c.next=c,Jm(a)):(c.next=y.next,y.next=c),a.interleaved=c,Vs(i,f)}function Vs(i,a){i.lanes|=a;var c=i.alternate;for(c!==null&&(c.lanes|=a),c=i,i=i.return;i!==null;)i.childLanes|=a,c=i.alternate,c!==null&&(c.childLanes|=a),c=i,i=i.return;return c.tag===3?c.stateNode:null}var Pi=!1;function Zm(i){i.updateQueue={baseState:i.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function Q0(i,a){i=i.updateQueue,a.updateQueue===i&&(a.updateQueue={baseState:i.baseState,firstBaseUpdate:i.firstBaseUpdate,lastBaseUpdate:i.lastBaseUpdate,shared:i.shared,effects:i.effects})}function Fs(i,a){return{eventTime:i,lane:a,tag:0,payload:null,callback:null,next:null}}function Di(i,a,c){var f=i.updateQueue;if(f===null)return null;if(f=f.shared,(rt&2)!==0){var y=f.pending;return y===null?a.next=a:(a.next=y.next,y.next=a),f.pending=a,Vs(i,c)}return y=f.interleaved,y===null?(a.next=a,Jm(f)):(a.next=y.next,y.next=a),f.interleaved=a,Vs(i,c)}function hh(i,a,c){if(a=a.updateQueue,a!==null&&(a=a.shared,(c&4194240)!==0)){var f=a.lanes;f&=i.pendingLanes,c|=f,a.lanes=c,Rc(i,c)}}function Y0(i,a){var c=i.updateQueue,f=i.alternate;if(f!==null&&(f=f.updateQueue,c===f)){var y=null,w=null;if(c=c.firstBaseUpdate,c!==null){do{var S={eventTime:c.eventTime,lane:c.lane,tag:c.tag,payload:c.payload,callback:c.callback,next:null};w===null?y=w=S:w=w.next=S,c=c.next}while(c!==null);w===null?y=w=a:w=w.next=a}else y=w=a;c={baseState:f.baseState,firstBaseUpdate:y,lastBaseUpdate:w,shared:f.shared,effects:f.effects},i.updateQueue=c;return}i=c.lastBaseUpdate,i===null?c.firstBaseUpdate=a:i.next=a,c.lastBaseUpdate=a}function fh(i,a,c,f){var y=i.updateQueue;Pi=!1;var w=y.firstBaseUpdate,S=y.lastBaseUpdate,M=y.shared.pending;if(M!==null){y.shared.pending=null;var V=M,Q=V.next;V.next=null,S===null?w=Q:S.next=Q,S=V;var se=i.alternate;se!==null&&(se=se.updateQueue,M=se.lastBaseUpdate,M!==S&&(M===null?se.firstBaseUpdate=Q:M.next=Q,se.lastBaseUpdate=V))}if(w!==null){var ie=y.baseState;S=0,se=Q=V=null,M=w;do{var re=M.lane,fe=M.eventTime;if((f&re)===re){se!==null&&(se=se.next={eventTime:fe,lane:0,tag:M.tag,payload:M.payload,callback:M.callback,next:null});e:{var ve=i,xe=M;switch(re=a,fe=c,xe.tag){case 1:if(ve=xe.payload,typeof ve=="function"){ie=ve.call(fe,ie,re);break e}ie=ve;break e;case 3:ve.flags=ve.flags&-65537|128;case 0:if(ve=xe.payload,re=typeof ve=="function"?ve.call(fe,ie,re):ve,re==null)break e;ie=oe({},ie,re);break e;case 2:Pi=!0}}M.callback!==null&&M.lane!==0&&(i.flags|=64,re=y.effects,re===null?y.effects=[M]:re.push(M))}else fe={eventTime:fe,lane:re,tag:M.tag,payload:M.payload,callback:M.callback,next:null},se===null?(Q=se=fe,V=ie):se=se.next=fe,S|=re;if(M=M.next,M===null){if(M=y.shared.pending,M===null)break;re=M,M=re.next,re.next=null,y.lastBaseUpdate=re,y.shared.pending=null}}while(!0);if(se===null&&(V=ie),y.baseState=V,y.firstBaseUpdate=Q,y.lastBaseUpdate=se,a=y.shared.interleaved,a!==null){y=a;do S|=y.lane,y=y.next;while(y!==a)}else w===null&&(y.shared.lanes=0);Go|=S,i.lanes=S,i.memoizedState=ie}}function X0(i,a,c){if(i=a.effects,a.effects=null,i!==null)for(a=0;a<i.length;a++){var f=i[a],y=f.callback;if(y!==null){if(f.callback=null,f=c,typeof y!="function")throw Error(t(191,y));y.call(f)}}}var Kc={},ts=Ai(Kc),Qc=Ai(Kc),Yc=Ai(Kc);function Ho(i){if(i===Kc)throw Error(t(174));return i}function eg(i,a){switch(pt(Yc,a),pt(Qc,i),pt(ts,Kc),i=a.nodeType,i){case 9:case 11:a=(a=a.documentElement)?a.namespaceURI:ka(null,"");break;default:i=i===8?a.parentNode:a,a=i.namespaceURI||null,i=i.tagName,a=ka(a,i)}_t(ts),pt(ts,a)}function cl(){_t(ts),_t(Qc),_t(Yc)}function J0(i){Ho(Yc.current);var a=Ho(ts.current),c=ka(a,i.type);a!==c&&(pt(Qc,i),pt(ts,c))}function tg(i){Qc.current===i&&(_t(ts),_t(Qc))}var Ct=Ai(0);function ph(i){for(var a=i;a!==null;){if(a.tag===13){var c=a.memoizedState;if(c!==null&&(c=c.dehydrated,c===null||c.data==="$?"||c.data==="$!"))return a}else if(a.tag===19&&a.memoizedProps.revealOrder!==void 0){if((a.flags&128)!==0)return a}else if(a.child!==null){a.child.return=a,a=a.child;continue}if(a===i)break;for(;a.sibling===null;){if(a.return===null||a.return===i)return null;a=a.return}a.sibling.return=a.return,a=a.sibling}return null}var ng=[];function rg(){for(var i=0;i<ng.length;i++)ng[i]._workInProgressVersionPrimary=null;ng.length=0}var mh=G.ReactCurrentDispatcher,sg=G.ReactCurrentBatchConfig,qo=0,St=null,Wt=null,Kt=null,gh=!1,Xc=!1,Jc=0,z1=0;function mn(){throw Error(t(321))}function ig(i,a){if(a===null)return!1;for(var c=0;c<a.length&&c<i.length;c++)if(!Tr(i[c],a[c]))return!1;return!0}function og(i,a,c,f,y,w){if(qo=w,St=a,a.memoizedState=null,a.updateQueue=null,a.lanes=0,mh.current=i===null||i.memoizedState===null?H1:q1,i=c(f,y),Xc){w=0;do{if(Xc=!1,Jc=0,25<=w)throw Error(t(301));w+=1,Kt=Wt=null,a.updateQueue=null,mh.current=G1,i=c(f,y)}while(Xc)}if(mh.current=vh,a=Wt!==null&&Wt.next!==null,qo=0,Kt=Wt=St=null,gh=!1,a)throw Error(t(300));return i}function ag(){var i=Jc!==0;return Jc=0,i}function ns(){var i={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return Kt===null?St.memoizedState=Kt=i:Kt=Kt.next=i,Kt}function dr(){if(Wt===null){var i=St.alternate;i=i!==null?i.memoizedState:null}else i=Wt.next;var a=Kt===null?St.memoizedState:Kt.next;if(a!==null)Kt=a,Wt=i;else{if(i===null)throw Error(t(310));Wt=i,i={memoizedState:Wt.memoizedState,baseState:Wt.baseState,baseQueue:Wt.baseQueue,queue:Wt.queue,next:null},Kt===null?St.memoizedState=Kt=i:Kt=Kt.next=i}return Kt}function Zc(i,a){return typeof a=="function"?a(i):a}function lg(i){var a=dr(),c=a.queue;if(c===null)throw Error(t(311));c.lastRenderedReducer=i;var f=Wt,y=f.baseQueue,w=c.pending;if(w!==null){if(y!==null){var S=y.next;y.next=w.next,w.next=S}f.baseQueue=y=w,c.pending=null}if(y!==null){w=y.next,f=f.baseState;var M=S=null,V=null,Q=w;do{var se=Q.lane;if((qo&se)===se)V!==null&&(V=V.next={lane:0,action:Q.action,hasEagerState:Q.hasEagerState,eagerState:Q.eagerState,next:null}),f=Q.hasEagerState?Q.eagerState:i(f,Q.action);else{var ie={lane:se,action:Q.action,hasEagerState:Q.hasEagerState,eagerState:Q.eagerState,next:null};V===null?(M=V=ie,S=f):V=V.next=ie,St.lanes|=se,Go|=se}Q=Q.next}while(Q!==null&&Q!==w);V===null?S=f:V.next=M,Tr(f,a.memoizedState)||(Dn=!0),a.memoizedState=f,a.baseState=S,a.baseQueue=V,c.lastRenderedState=f}if(i=c.interleaved,i!==null){y=i;do w=y.lane,St.lanes|=w,Go|=w,y=y.next;while(y!==i)}else y===null&&(c.lanes=0);return[a.memoizedState,c.dispatch]}function cg(i){var a=dr(),c=a.queue;if(c===null)throw Error(t(311));c.lastRenderedReducer=i;var f=c.dispatch,y=c.pending,w=a.memoizedState;if(y!==null){c.pending=null;var S=y=y.next;do w=i(w,S.action),S=S.next;while(S!==y);Tr(w,a.memoizedState)||(Dn=!0),a.memoizedState=w,a.baseQueue===null&&(a.baseState=w),c.lastRenderedState=w}return[w,f]}function Z0(){}function eE(i,a){var c=St,f=dr(),y=a(),w=!Tr(f.memoizedState,y);if(w&&(f.memoizedState=y,Dn=!0),f=f.queue,ug(rE.bind(null,c,f,i),[i]),f.getSnapshot!==a||w||Kt!==null&&Kt.memoizedState.tag&1){if(c.flags|=2048,eu(9,nE.bind(null,c,f,y,a),void 0,null),Qt===null)throw Error(t(349));(qo&30)!==0||tE(c,a,y)}return y}function tE(i,a,c){i.flags|=16384,i={getSnapshot:a,value:c},a=St.updateQueue,a===null?(a={lastEffect:null,stores:null},St.updateQueue=a,a.stores=[i]):(c=a.stores,c===null?a.stores=[i]:c.push(i))}function nE(i,a,c,f){a.value=c,a.getSnapshot=f,sE(a)&&iE(i)}function rE(i,a,c){return c(function(){sE(a)&&iE(i)})}function sE(i){var a=i.getSnapshot;i=i.value;try{var c=a();return!Tr(i,c)}catch{return!0}}function iE(i){var a=Vs(i,1);a!==null&&Rr(a,i,1,-1)}function oE(i){var a=ns();return typeof i=="function"&&(i=i()),a.memoizedState=a.baseState=i,i={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:Zc,lastRenderedState:i},a.queue=i,i=i.dispatch=W1.bind(null,St,i),[a.memoizedState,i]}function eu(i,a,c,f){return i={tag:i,create:a,destroy:c,deps:f,next:null},a=St.updateQueue,a===null?(a={lastEffect:null,stores:null},St.updateQueue=a,a.lastEffect=i.next=i):(c=a.lastEffect,c===null?a.lastEffect=i.next=i:(f=c.next,c.next=i,i.next=f,a.lastEffect=i)),i}function aE(){return dr().memoizedState}function yh(i,a,c,f){var y=ns();St.flags|=i,y.memoizedState=eu(1|a,c,void 0,f===void 0?null:f)}function _h(i,a,c,f){var y=dr();f=f===void 0?null:f;var w=void 0;if(Wt!==null){var S=Wt.memoizedState;if(w=S.destroy,f!==null&&ig(f,S.deps)){y.memoizedState=eu(a,c,w,f);return}}St.flags|=i,y.memoizedState=eu(1|a,c,w,f)}function lE(i,a){return yh(8390656,8,i,a)}function ug(i,a){return _h(2048,8,i,a)}function cE(i,a){return _h(4,2,i,a)}function uE(i,a){return _h(4,4,i,a)}function dE(i,a){if(typeof a=="function")return i=i(),a(i),function(){a(null)};if(a!=null)return i=i(),a.current=i,function(){a.current=null}}function hE(i,a,c){return c=c!=null?c.concat([i]):null,_h(4,4,dE.bind(null,a,i),c)}function dg(){}function fE(i,a){var c=dr();a=a===void 0?null:a;var f=c.memoizedState;return f!==null&&a!==null&&ig(a,f[1])?f[0]:(c.memoizedState=[i,a],i)}function pE(i,a){var c=dr();a=a===void 0?null:a;var f=c.memoizedState;return f!==null&&a!==null&&ig(a,f[1])?f[0]:(i=i(),c.memoizedState=[i,a],i)}function mE(i,a,c){return(qo&21)===0?(i.baseState&&(i.baseState=!1,Dn=!0),i.memoizedState=c):(Tr(c,a)||(c=Ic(),St.lanes|=c,Go|=c,i.baseState=!0),a)}function B1(i,a){var c=Ze;Ze=c!==0&&4>c?c:4,i(!0);var f=sg.transition;sg.transition={};try{i(!1),a()}finally{Ze=c,sg.transition=f}}function gE(){return dr().memoizedState}function $1(i,a,c){var f=ji(i);if(c={lane:f,action:c,hasEagerState:!1,eagerState:null,next:null},yE(i))_E(a,c);else if(c=K0(i,a,c,f),c!==null){var y=Sn();Rr(c,i,f,y),vE(c,a,f)}}function W1(i,a,c){var f=ji(i),y={lane:f,action:c,hasEagerState:!1,eagerState:null,next:null};if(yE(i))_E(a,y);else{var w=i.alternate;if(i.lanes===0&&(w===null||w.lanes===0)&&(w=a.lastRenderedReducer,w!==null))try{var S=a.lastRenderedState,M=w(S,c);if(y.hasEagerState=!0,y.eagerState=M,Tr(M,S)){var V=a.interleaved;V===null?(y.next=y,Jm(a)):(y.next=V.next,V.next=y),a.interleaved=y;return}}catch{}finally{}c=K0(i,a,y,f),c!==null&&(y=Sn(),Rr(c,i,f,y),vE(c,a,f))}}function yE(i){var a=i.alternate;return i===St||a!==null&&a===St}function _E(i,a){Xc=gh=!0;var c=i.pending;c===null?a.next=a:(a.next=c.next,c.next=a),i.pending=a}function vE(i,a,c){if((c&4194240)!==0){var f=a.lanes;f&=i.pendingLanes,c|=f,a.lanes=c,Rc(i,c)}}var vh={readContext:ur,useCallback:mn,useContext:mn,useEffect:mn,useImperativeHandle:mn,useInsertionEffect:mn,useLayoutEffect:mn,useMemo:mn,useReducer:mn,useRef:mn,useState:mn,useDebugValue:mn,useDeferredValue:mn,useTransition:mn,useMutableSource:mn,useSyncExternalStore:mn,useId:mn,unstable_isNewReconciler:!1},H1={readContext:ur,useCallback:function(i,a){return ns().memoizedState=[i,a===void 0?null:a],i},useContext:ur,useEffect:lE,useImperativeHandle:function(i,a,c){return c=c!=null?c.concat([i]):null,yh(4194308,4,dE.bind(null,a,i),c)},useLayoutEffect:function(i,a){return yh(4194308,4,i,a)},useInsertionEffect:function(i,a){return yh(4,2,i,a)},useMemo:function(i,a){var c=ns();return a=a===void 0?null:a,i=i(),c.memoizedState=[i,a],i},useReducer:function(i,a,c){var f=ns();return a=c!==void 0?c(a):a,f.memoizedState=f.baseState=a,i={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:i,lastRenderedState:a},f.queue=i,i=i.dispatch=$1.bind(null,St,i),[f.memoizedState,i]},useRef:function(i){var a=ns();return i={current:i},a.memoizedState=i},useState:oE,useDebugValue:dg,useDeferredValue:function(i){return ns().memoizedState=i},useTransition:function(){var i=oE(!1),a=i[0];return i=B1.bind(null,i[1]),ns().memoizedState=i,[a,i]},useMutableSource:function(){},useSyncExternalStore:function(i,a,c){var f=St,y=ns();if(Tt){if(c===void 0)throw Error(t(407));c=c()}else{if(c=a(),Qt===null)throw Error(t(349));(qo&30)!==0||tE(f,a,c)}y.memoizedState=c;var w={value:c,getSnapshot:a};return y.queue=w,lE(rE.bind(null,f,w,i),[i]),f.flags|=2048,eu(9,nE.bind(null,f,w,c,a),void 0,null),c},useId:function(){var i=ns(),a=Qt.identifierPrefix;if(Tt){var c=js,f=Ls;c=(f&~(1<<32-$n(f)-1)).toString(32)+c,a=":"+a+"R"+c,c=Jc++,0<c&&(a+="H"+c.toString(32)),a+=":"}else c=z1++,a=":"+a+"r"+c.toString(32)+":";return i.memoizedState=a},unstable_isNewReconciler:!1},q1={readContext:ur,useCallback:fE,useContext:ur,useEffect:ug,useImperativeHandle:hE,useInsertionEffect:cE,useLayoutEffect:uE,useMemo:pE,useReducer:lg,useRef:aE,useState:function(){return lg(Zc)},useDebugValue:dg,useDeferredValue:function(i){var a=dr();return mE(a,Wt.memoizedState,i)},useTransition:function(){var i=lg(Zc)[0],a=dr().memoizedState;return[i,a]},useMutableSource:Z0,useSyncExternalStore:eE,useId:gE,unstable_isNewReconciler:!1},G1={readContext:ur,useCallback:fE,useContext:ur,useEffect:ug,useImperativeHandle:hE,useInsertionEffect:cE,useLayoutEffect:uE,useMemo:pE,useReducer:cg,useRef:aE,useState:function(){return cg(Zc)},useDebugValue:dg,useDeferredValue:function(i){var a=dr();return Wt===null?a.memoizedState=i:mE(a,Wt.memoizedState,i)},useTransition:function(){var i=cg(Zc)[0],a=dr().memoizedState;return[i,a]},useMutableSource:Z0,useSyncExternalStore:eE,useId:gE,unstable_isNewReconciler:!1};function Sr(i,a){if(i&&i.defaultProps){a=oe({},a),i=i.defaultProps;for(var c in i)a[c]===void 0&&(a[c]=i[c]);return a}return a}function hg(i,a,c,f){a=i.memoizedState,c=c(f,a),c=c==null?a:oe({},a,c),i.memoizedState=c,i.lanes===0&&(i.updateQueue.baseState=c)}var wh={isMounted:function(i){return(i=i._reactInternals)?Er(i)===i:!1},enqueueSetState:function(i,a,c){i=i._reactInternals;var f=Sn(),y=ji(i),w=Fs(f,y);w.payload=a,c!=null&&(w.callback=c),a=Di(i,w,y),a!==null&&(Rr(a,i,y,f),hh(a,i,y))},enqueueReplaceState:function(i,a,c){i=i._reactInternals;var f=Sn(),y=ji(i),w=Fs(f,y);w.tag=1,w.payload=a,c!=null&&(w.callback=c),a=Di(i,w,y),a!==null&&(Rr(a,i,y,f),hh(a,i,y))},enqueueForceUpdate:function(i,a){i=i._reactInternals;var c=Sn(),f=ji(i),y=Fs(c,f);y.tag=2,a!=null&&(y.callback=a),a=Di(i,y,f),a!==null&&(Rr(a,i,f,c),hh(a,i,f))}};function wE(i,a,c,f,y,w,S){return i=i.stateNode,typeof i.shouldComponentUpdate=="function"?i.shouldComponentUpdate(f,w,S):a.prototype&&a.prototype.isPureReactComponent?!Uc(c,f)||!Uc(y,w):!0}function EE(i,a,c){var f=!1,y=ki,w=a.contextType;return typeof w=="object"&&w!==null?w=ur(w):(y=Pn(a)?zo:pn.current,f=a.contextTypes,w=(f=f!=null)?nl(i,y):ki),a=new a(c,w),i.memoizedState=a.state!==null&&a.state!==void 0?a.state:null,a.updater=wh,i.stateNode=a,a._reactInternals=i,f&&(i=i.stateNode,i.__reactInternalMemoizedUnmaskedChildContext=y,i.__reactInternalMemoizedMaskedChildContext=w),a}function xE(i,a,c,f){i=a.state,typeof a.componentWillReceiveProps=="function"&&a.componentWillReceiveProps(c,f),typeof a.UNSAFE_componentWillReceiveProps=="function"&&a.UNSAFE_componentWillReceiveProps(c,f),a.state!==i&&wh.enqueueReplaceState(a,a.state,null)}function fg(i,a,c,f){var y=i.stateNode;y.props=c,y.state=i.memoizedState,y.refs={},Zm(i);var w=a.contextType;typeof w=="object"&&w!==null?y.context=ur(w):(w=Pn(a)?zo:pn.current,y.context=nl(i,w)),y.state=i.memoizedState,w=a.getDerivedStateFromProps,typeof w=="function"&&(hg(i,a,w,c),y.state=i.memoizedState),typeof a.getDerivedStateFromProps=="function"||typeof y.getSnapshotBeforeUpdate=="function"||typeof y.UNSAFE_componentWillMount!="function"&&typeof y.componentWillMount!="function"||(a=y.state,typeof y.componentWillMount=="function"&&y.componentWillMount(),typeof y.UNSAFE_componentWillMount=="function"&&y.UNSAFE_componentWillMount(),a!==y.state&&wh.enqueueReplaceState(y,y.state,null),fh(i,c,y,f),y.state=i.memoizedState),typeof y.componentDidMount=="function"&&(i.flags|=4194308)}function ul(i,a){try{var c="",f=a;do c+=Ne(f),f=f.return;while(f);var y=c}catch(w){y=`
Error generating stack: `+w.message+`
`+w.stack}return{value:i,source:a,stack:y,digest:null}}function pg(i,a,c){return{value:i,source:null,stack:c??null,digest:a??null}}function mg(i,a){try{console.error(a.value)}catch(c){setTimeout(function(){throw c})}}var K1=typeof WeakMap=="function"?WeakMap:Map;function TE(i,a,c){c=Fs(-1,c),c.tag=3,c.payload={element:null};var f=a.value;return c.callback=function(){bh||(bh=!0,kg=f),mg(i,a)},c}function CE(i,a,c){c=Fs(-1,c),c.tag=3;var f=i.type.getDerivedStateFromError;if(typeof f=="function"){var y=a.value;c.payload=function(){return f(y)},c.callback=function(){mg(i,a)}}var w=i.stateNode;return w!==null&&typeof w.componentDidCatch=="function"&&(c.callback=function(){mg(i,a),typeof f!="function"&&(Mi===null?Mi=new Set([this]):Mi.add(this));var S=a.stack;this.componentDidCatch(a.value,{componentStack:S!==null?S:""})}),c}function SE(i,a,c){var f=i.pingCache;if(f===null){f=i.pingCache=new K1;var y=new Set;f.set(a,y)}else y=f.get(a),y===void 0&&(y=new Set,f.set(a,y));y.has(c)||(y.add(c),i=lP.bind(null,i,a,c),a.then(i,i))}function IE(i){do{var a;if((a=i.tag===13)&&(a=i.memoizedState,a=a!==null?a.dehydrated!==null:!0),a)return i;i=i.return}while(i!==null);return null}function bE(i,a,c,f,y){return(i.mode&1)===0?(i===a?i.flags|=65536:(i.flags|=128,c.flags|=131072,c.flags&=-52805,c.tag===1&&(c.alternate===null?c.tag=17:(a=Fs(-1,1),a.tag=2,Di(c,a,1))),c.lanes|=1),i):(i.flags|=65536,i.lanes=y,i)}var Q1=G.ReactCurrentOwner,Dn=!1;function Cn(i,a,c,f){a.child=i===null?G0(a,null,c,f):ol(a,i.child,c,f)}function RE(i,a,c,f,y){c=c.render;var w=a.ref;return ll(a,y),f=og(i,a,c,f,w,y),c=ag(),i!==null&&!Dn?(a.updateQueue=i.updateQueue,a.flags&=-2053,i.lanes&=~y,Us(i,a,y)):(Tt&&c&&$m(a),a.flags|=1,Cn(i,a,f,y),a.child)}function AE(i,a,c,f,y){if(i===null){var w=c.type;return typeof w=="function"&&!jg(w)&&w.defaultProps===void 0&&c.compare===null&&c.defaultProps===void 0?(a.tag=15,a.type=w,kE(i,a,w,f,y)):(i=Dh(c.type,null,f,a,a.mode,y),i.ref=a.ref,i.return=a,a.child=i)}if(w=i.child,(i.lanes&y)===0){var S=w.memoizedProps;if(c=c.compare,c=c!==null?c:Uc,c(S,f)&&i.ref===a.ref)return Us(i,a,y)}return a.flags|=1,i=Fi(w,f),i.ref=a.ref,i.return=a,a.child=i}function kE(i,a,c,f,y){if(i!==null){var w=i.memoizedProps;if(Uc(w,f)&&i.ref===a.ref)if(Dn=!1,a.pendingProps=f=w,(i.lanes&y)!==0)(i.flags&131072)!==0&&(Dn=!0);else return a.lanes=i.lanes,Us(i,a,y)}return gg(i,a,c,f,y)}function NE(i,a,c){var f=a.pendingProps,y=f.children,w=i!==null?i.memoizedState:null;if(f.mode==="hidden")if((a.mode&1)===0)a.memoizedState={baseLanes:0,cachePool:null,transitions:null},pt(hl,Yn),Yn|=c;else{if((c&1073741824)===0)return i=w!==null?w.baseLanes|c:c,a.lanes=a.childLanes=1073741824,a.memoizedState={baseLanes:i,cachePool:null,transitions:null},a.updateQueue=null,pt(hl,Yn),Yn|=i,null;a.memoizedState={baseLanes:0,cachePool:null,transitions:null},f=w!==null?w.baseLanes:c,pt(hl,Yn),Yn|=f}else w!==null?(f=w.baseLanes|c,a.memoizedState=null):f=c,pt(hl,Yn),Yn|=f;return Cn(i,a,y,c),a.child}function PE(i,a){var c=a.ref;(i===null&&c!==null||i!==null&&i.ref!==c)&&(a.flags|=512,a.flags|=2097152)}function gg(i,a,c,f,y){var w=Pn(c)?zo:pn.current;return w=nl(a,w),ll(a,y),c=og(i,a,c,f,w,y),f=ag(),i!==null&&!Dn?(a.updateQueue=i.updateQueue,a.flags&=-2053,i.lanes&=~y,Us(i,a,y)):(Tt&&f&&$m(a),a.flags|=1,Cn(i,a,c,y),a.child)}function DE(i,a,c,f,y){if(Pn(c)){var w=!0;sh(a)}else w=!1;if(ll(a,y),a.stateNode===null)xh(i,a),EE(a,c,f),fg(a,c,f,y),f=!0;else if(i===null){var S=a.stateNode,M=a.memoizedProps;S.props=M;var V=S.context,Q=c.contextType;typeof Q=="object"&&Q!==null?Q=ur(Q):(Q=Pn(c)?zo:pn.current,Q=nl(a,Q));var se=c.getDerivedStateFromProps,ie=typeof se=="function"||typeof S.getSnapshotBeforeUpdate=="function";ie||typeof S.UNSAFE_componentWillReceiveProps!="function"&&typeof S.componentWillReceiveProps!="function"||(M!==f||V!==Q)&&xE(a,S,f,Q),Pi=!1;var re=a.memoizedState;S.state=re,fh(a,f,S,y),V=a.memoizedState,M!==f||re!==V||Nn.current||Pi?(typeof se=="function"&&(hg(a,c,se,f),V=a.memoizedState),(M=Pi||wE(a,c,M,f,re,V,Q))?(ie||typeof S.UNSAFE_componentWillMount!="function"&&typeof S.componentWillMount!="function"||(typeof S.componentWillMount=="function"&&S.componentWillMount(),typeof S.UNSAFE_componentWillMount=="function"&&S.UNSAFE_componentWillMount()),typeof S.componentDidMount=="function"&&(a.flags|=4194308)):(typeof S.componentDidMount=="function"&&(a.flags|=4194308),a.memoizedProps=f,a.memoizedState=V),S.props=f,S.state=V,S.context=Q,f=M):(typeof S.componentDidMount=="function"&&(a.flags|=4194308),f=!1)}else{S=a.stateNode,Q0(i,a),M=a.memoizedProps,Q=a.type===a.elementType?M:Sr(a.type,M),S.props=Q,ie=a.pendingProps,re=S.context,V=c.contextType,typeof V=="object"&&V!==null?V=ur(V):(V=Pn(c)?zo:pn.current,V=nl(a,V));var fe=c.getDerivedStateFromProps;(se=typeof fe=="function"||typeof S.getSnapshotBeforeUpdate=="function")||typeof S.UNSAFE_componentWillReceiveProps!="function"&&typeof S.componentWillReceiveProps!="function"||(M!==ie||re!==V)&&xE(a,S,f,V),Pi=!1,re=a.memoizedState,S.state=re,fh(a,f,S,y);var ve=a.memoizedState;M!==ie||re!==ve||Nn.current||Pi?(typeof fe=="function"&&(hg(a,c,fe,f),ve=a.memoizedState),(Q=Pi||wE(a,c,Q,f,re,ve,V)||!1)?(se||typeof S.UNSAFE_componentWillUpdate!="function"&&typeof S.componentWillUpdate!="function"||(typeof S.componentWillUpdate=="function"&&S.componentWillUpdate(f,ve,V),typeof S.UNSAFE_componentWillUpdate=="function"&&S.UNSAFE_componentWillUpdate(f,ve,V)),typeof S.componentDidUpdate=="function"&&(a.flags|=4),typeof S.getSnapshotBeforeUpdate=="function"&&(a.flags|=1024)):(typeof S.componentDidUpdate!="function"||M===i.memoizedProps&&re===i.memoizedState||(a.flags|=4),typeof S.getSnapshotBeforeUpdate!="function"||M===i.memoizedProps&&re===i.memoizedState||(a.flags|=1024),a.memoizedProps=f,a.memoizedState=ve),S.props=f,S.state=ve,S.context=V,f=Q):(typeof S.componentDidUpdate!="function"||M===i.memoizedProps&&re===i.memoizedState||(a.flags|=4),typeof S.getSnapshotBeforeUpdate!="function"||M===i.memoizedProps&&re===i.memoizedState||(a.flags|=1024),f=!1)}return yg(i,a,c,f,w,y)}function yg(i,a,c,f,y,w){PE(i,a);var S=(a.flags&128)!==0;if(!f&&!S)return y&&V0(a,c,!1),Us(i,a,w);f=a.stateNode,Q1.current=a;var M=S&&typeof c.getDerivedStateFromError!="function"?null:f.render();return a.flags|=1,i!==null&&S?(a.child=ol(a,i.child,null,w),a.child=ol(a,null,M,w)):Cn(i,a,M,w),a.memoizedState=f.state,y&&V0(a,c,!0),a.child}function OE(i){var a=i.stateNode;a.pendingContext?L0(i,a.pendingContext,a.pendingContext!==a.context):a.context&&L0(i,a.context,!1),eg(i,a.containerInfo)}function ME(i,a,c,f,y){return il(),Gm(y),a.flags|=256,Cn(i,a,c,f),a.child}var _g={dehydrated:null,treeContext:null,retryLane:0};function vg(i){return{baseLanes:i,cachePool:null,transitions:null}}function LE(i,a,c){var f=a.pendingProps,y=Ct.current,w=!1,S=(a.flags&128)!==0,M;if((M=S)||(M=i!==null&&i.memoizedState===null?!1:(y&2)!==0),M?(w=!0,a.flags&=-129):(i===null||i.memoizedState!==null)&&(y|=1),pt(Ct,y&1),i===null)return qm(a),i=a.memoizedState,i!==null&&(i=i.dehydrated,i!==null)?((a.mode&1)===0?a.lanes=1:i.data==="$!"?a.lanes=8:a.lanes=1073741824,null):(S=f.children,i=f.fallback,w?(f=a.mode,w=a.child,S={mode:"hidden",children:S},(f&1)===0&&w!==null?(w.childLanes=0,w.pendingProps=S):w=Oh(S,f,0,null),i=Xo(i,f,c,null),w.return=a,i.return=a,w.sibling=i,a.child=w,a.child.memoizedState=vg(c),a.memoizedState=_g,i):wg(a,S));if(y=i.memoizedState,y!==null&&(M=y.dehydrated,M!==null))return Y1(i,a,S,f,M,y,c);if(w){w=f.fallback,S=a.mode,y=i.child,M=y.sibling;var V={mode:"hidden",children:f.children};return(S&1)===0&&a.child!==y?(f=a.child,f.childLanes=0,f.pendingProps=V,a.deletions=null):(f=Fi(y,V),f.subtreeFlags=y.subtreeFlags&14680064),M!==null?w=Fi(M,w):(w=Xo(w,S,c,null),w.flags|=2),w.return=a,f.return=a,f.sibling=w,a.child=f,f=w,w=a.child,S=i.child.memoizedState,S=S===null?vg(c):{baseLanes:S.baseLanes|c,cachePool:null,transitions:S.transitions},w.memoizedState=S,w.childLanes=i.childLanes&~c,a.memoizedState=_g,f}return w=i.child,i=w.sibling,f=Fi(w,{mode:"visible",children:f.children}),(a.mode&1)===0&&(f.lanes=c),f.return=a,f.sibling=null,i!==null&&(c=a.deletions,c===null?(a.deletions=[i],a.flags|=16):c.push(i)),a.child=f,a.memoizedState=null,f}function wg(i,a){return a=Oh({mode:"visible",children:a},i.mode,0,null),a.return=i,i.child=a}function Eh(i,a,c,f){return f!==null&&Gm(f),ol(a,i.child,null,c),i=wg(a,a.pendingProps.children),i.flags|=2,a.memoizedState=null,i}function Y1(i,a,c,f,y,w,S){if(c)return a.flags&256?(a.flags&=-257,f=pg(Error(t(422))),Eh(i,a,S,f)):a.memoizedState!==null?(a.child=i.child,a.flags|=128,null):(w=f.fallback,y=a.mode,f=Oh({mode:"visible",children:f.children},y,0,null),w=Xo(w,y,S,null),w.flags|=2,f.return=a,w.return=a,f.sibling=w,a.child=f,(a.mode&1)!==0&&ol(a,i.child,null,S),a.child.memoizedState=vg(S),a.memoizedState=_g,w);if((a.mode&1)===0)return Eh(i,a,S,null);if(y.data==="$!"){if(f=y.nextSibling&&y.nextSibling.dataset,f)var M=f.dgst;return f=M,w=Error(t(419)),f=pg(w,f,void 0),Eh(i,a,S,f)}if(M=(S&i.childLanes)!==0,Dn||M){if(f=Qt,f!==null){switch(S&-S){case 4:y=2;break;case 16:y=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:y=32;break;case 536870912:y=268435456;break;default:y=0}y=(y&(f.suspendedLanes|S))!==0?0:y,y!==0&&y!==w.retryLane&&(w.retryLane=y,Vs(i,y),Rr(f,i,y,-1))}return Lg(),f=pg(Error(t(421))),Eh(i,a,S,f)}return y.data==="$?"?(a.flags|=128,a.child=i.child,a=cP.bind(null,i),y._reactRetry=a,null):(i=w.treeContext,Qn=Ri(y.nextSibling),Kn=a,Tt=!0,Cr=null,i!==null&&(lr[cr++]=Ls,lr[cr++]=js,lr[cr++]=Bo,Ls=i.id,js=i.overflow,Bo=a),a=wg(a,f.children),a.flags|=4096,a)}function jE(i,a,c){i.lanes|=a;var f=i.alternate;f!==null&&(f.lanes|=a),Xm(i.return,a,c)}function Eg(i,a,c,f,y){var w=i.memoizedState;w===null?i.memoizedState={isBackwards:a,rendering:null,renderingStartTime:0,last:f,tail:c,tailMode:y}:(w.isBackwards=a,w.rendering=null,w.renderingStartTime=0,w.last=f,w.tail=c,w.tailMode=y)}function VE(i,a,c){var f=a.pendingProps,y=f.revealOrder,w=f.tail;if(Cn(i,a,f.children,c),f=Ct.current,(f&2)!==0)f=f&1|2,a.flags|=128;else{if(i!==null&&(i.flags&128)!==0)e:for(i=a.child;i!==null;){if(i.tag===13)i.memoizedState!==null&&jE(i,c,a);else if(i.tag===19)jE(i,c,a);else if(i.child!==null){i.child.return=i,i=i.child;continue}if(i===a)break e;for(;i.sibling===null;){if(i.return===null||i.return===a)break e;i=i.return}i.sibling.return=i.return,i=i.sibling}f&=1}if(pt(Ct,f),(a.mode&1)===0)a.memoizedState=null;else switch(y){case"forwards":for(c=a.child,y=null;c!==null;)i=c.alternate,i!==null&&ph(i)===null&&(y=c),c=c.sibling;c=y,c===null?(y=a.child,a.child=null):(y=c.sibling,c.sibling=null),Eg(a,!1,y,c,w);break;case"backwards":for(c=null,y=a.child,a.child=null;y!==null;){if(i=y.alternate,i!==null&&ph(i)===null){a.child=y;break}i=y.sibling,y.sibling=c,c=y,y=i}Eg(a,!0,c,null,w);break;case"together":Eg(a,!1,null,null,void 0);break;default:a.memoizedState=null}return a.child}function xh(i,a){(a.mode&1)===0&&i!==null&&(i.alternate=null,a.alternate=null,a.flags|=2)}function Us(i,a,c){if(i!==null&&(a.dependencies=i.dependencies),Go|=a.lanes,(c&a.childLanes)===0)return null;if(i!==null&&a.child!==i.child)throw Error(t(153));if(a.child!==null){for(i=a.child,c=Fi(i,i.pendingProps),a.child=c,c.return=a;i.sibling!==null;)i=i.sibling,c=c.sibling=Fi(i,i.pendingProps),c.return=a;c.sibling=null}return a.child}function X1(i,a,c){switch(a.tag){case 3:OE(a),il();break;case 5:J0(a);break;case 1:Pn(a.type)&&sh(a);break;case 4:eg(a,a.stateNode.containerInfo);break;case 10:var f=a.type._context,y=a.memoizedProps.value;pt(uh,f._currentValue),f._currentValue=y;break;case 13:if(f=a.memoizedState,f!==null)return f.dehydrated!==null?(pt(Ct,Ct.current&1),a.flags|=128,null):(c&a.child.childLanes)!==0?LE(i,a,c):(pt(Ct,Ct.current&1),i=Us(i,a,c),i!==null?i.sibling:null);pt(Ct,Ct.current&1);break;case 19:if(f=(c&a.childLanes)!==0,(i.flags&128)!==0){if(f)return VE(i,a,c);a.flags|=128}if(y=a.memoizedState,y!==null&&(y.rendering=null,y.tail=null,y.lastEffect=null),pt(Ct,Ct.current),f)break;return null;case 22:case 23:return a.lanes=0,NE(i,a,c)}return Us(i,a,c)}var FE,xg,UE,zE;FE=function(i,a){for(var c=a.child;c!==null;){if(c.tag===5||c.tag===6)i.appendChild(c.stateNode);else if(c.tag!==4&&c.child!==null){c.child.return=c,c=c.child;continue}if(c===a)break;for(;c.sibling===null;){if(c.return===null||c.return===a)return;c=c.return}c.sibling.return=c.return,c=c.sibling}},xg=function(){},UE=function(i,a,c,f){var y=i.memoizedProps;if(y!==f){i=a.stateNode,Ho(ts.current);var w=null;switch(c){case"input":y=ui(i,y),f=ui(i,f),w=[];break;case"select":y=oe({},y,{value:void 0}),f=oe({},f,{value:void 0}),w=[];break;case"textarea":y=mc(i,y),f=mc(i,f),w=[];break;default:typeof y.onClick!="function"&&typeof f.onClick=="function"&&(i.onclick=th)}wr(c,f);var S;c=null;for(Q in y)if(!f.hasOwnProperty(Q)&&y.hasOwnProperty(Q)&&y[Q]!=null)if(Q==="style"){var M=y[Q];for(S in M)M.hasOwnProperty(S)&&(c||(c={}),c[S]="")}else Q!=="dangerouslySetInnerHTML"&&Q!=="children"&&Q!=="suppressContentEditableWarning"&&Q!=="suppressHydrationWarning"&&Q!=="autoFocus"&&(s.hasOwnProperty(Q)?w||(w=[]):(w=w||[]).push(Q,null));for(Q in f){var V=f[Q];if(M=y?.[Q],f.hasOwnProperty(Q)&&V!==M&&(V!=null||M!=null))if(Q==="style")if(M){for(S in M)!M.hasOwnProperty(S)||V&&V.hasOwnProperty(S)||(c||(c={}),c[S]="");for(S in V)V.hasOwnProperty(S)&&M[S]!==V[S]&&(c||(c={}),c[S]=V[S])}else c||(w||(w=[]),w.push(Q,c)),c=V;else Q==="dangerouslySetInnerHTML"?(V=V?V.__html:void 0,M=M?M.__html:void 0,V!=null&&M!==V&&(w=w||[]).push(Q,V)):Q==="children"?typeof V!="string"&&typeof V!="number"||(w=w||[]).push(Q,""+V):Q!=="suppressContentEditableWarning"&&Q!=="suppressHydrationWarning"&&(s.hasOwnProperty(Q)?(V!=null&&Q==="onScroll"&&yt("scroll",i),w||M===V||(w=[])):(w=w||[]).push(Q,V))}c&&(w=w||[]).push("style",c);var Q=w;(a.updateQueue=Q)&&(a.flags|=4)}},zE=function(i,a,c,f){c!==f&&(a.flags|=4)};function tu(i,a){if(!Tt)switch(i.tailMode){case"hidden":a=i.tail;for(var c=null;a!==null;)a.alternate!==null&&(c=a),a=a.sibling;c===null?i.tail=null:c.sibling=null;break;case"collapsed":c=i.tail;for(var f=null;c!==null;)c.alternate!==null&&(f=c),c=c.sibling;f===null?a||i.tail===null?i.tail=null:i.tail.sibling=null:f.sibling=null}}function gn(i){var a=i.alternate!==null&&i.alternate.child===i.child,c=0,f=0;if(a)for(var y=i.child;y!==null;)c|=y.lanes|y.childLanes,f|=y.subtreeFlags&14680064,f|=y.flags&14680064,y.return=i,y=y.sibling;else for(y=i.child;y!==null;)c|=y.lanes|y.childLanes,f|=y.subtreeFlags,f|=y.flags,y.return=i,y=y.sibling;return i.subtreeFlags|=f,i.childLanes=c,a}function J1(i,a,c){var f=a.pendingProps;switch(Wm(a),a.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return gn(a),null;case 1:return Pn(a.type)&&rh(),gn(a),null;case 3:return f=a.stateNode,cl(),_t(Nn),_t(pn),rg(),f.pendingContext&&(f.context=f.pendingContext,f.pendingContext=null),(i===null||i.child===null)&&(lh(a)?a.flags|=4:i===null||i.memoizedState.isDehydrated&&(a.flags&256)===0||(a.flags|=1024,Cr!==null&&(Dg(Cr),Cr=null))),xg(i,a),gn(a),null;case 5:tg(a);var y=Ho(Yc.current);if(c=a.type,i!==null&&a.stateNode!=null)UE(i,a,c,f,y),i.ref!==a.ref&&(a.flags|=512,a.flags|=2097152);else{if(!f){if(a.stateNode===null)throw Error(t(166));return gn(a),null}if(i=Ho(ts.current),lh(a)){f=a.stateNode,c=a.type;var w=a.memoizedProps;switch(f[es]=a,f[Hc]=w,i=(a.mode&1)!==0,c){case"dialog":yt("cancel",f),yt("close",f);break;case"iframe":case"object":case"embed":yt("load",f);break;case"video":case"audio":for(y=0;y<Bc.length;y++)yt(Bc[y],f);break;case"source":yt("error",f);break;case"img":case"image":case"link":yt("error",f),yt("load",f);break;case"details":yt("toggle",f);break;case"input":Aa(f,w),yt("invalid",f);break;case"select":f._wrapperState={wasMultiple:!!w.multiple},yt("invalid",f);break;case"textarea":gc(f,w),yt("invalid",f)}wr(c,w),y=null;for(var S in w)if(w.hasOwnProperty(S)){var M=w[S];S==="children"?typeof M=="string"?f.textContent!==M&&(w.suppressHydrationWarning!==!0&&eh(f.textContent,M,i),y=["children",M]):typeof M=="number"&&f.textContent!==""+M&&(w.suppressHydrationWarning!==!0&&eh(f.textContent,M,i),y=["children",""+M]):s.hasOwnProperty(S)&&M!=null&&S==="onScroll"&&yt("scroll",f)}switch(c){case"input":An(f),Re(f,w,!0);break;case"textarea":An(f),hi(f);break;case"select":case"option":break;default:typeof w.onClick=="function"&&(f.onclick=th)}f=y,a.updateQueue=f,f!==null&&(a.flags|=4)}else{S=y.nodeType===9?y:y.ownerDocument,i==="http://www.w3.org/1999/xhtml"&&(i=yc(c)),i==="http://www.w3.org/1999/xhtml"?c==="script"?(i=S.createElement("div"),i.innerHTML="<script><\/script>",i=i.removeChild(i.firstChild)):typeof f.is=="string"?i=S.createElement(c,{is:f.is}):(i=S.createElement(c),c==="select"&&(S=i,f.multiple?S.multiple=!0:f.size&&(S.size=f.size))):i=S.createElementNS(i,c),i[es]=a,i[Hc]=f,FE(i,a,!1,!1),a.stateNode=i;e:{switch(S=Pa(c,f),c){case"dialog":yt("cancel",i),yt("close",i),y=f;break;case"iframe":case"object":case"embed":yt("load",i),y=f;break;case"video":case"audio":for(y=0;y<Bc.length;y++)yt(Bc[y],i);y=f;break;case"source":yt("error",i),y=f;break;case"img":case"image":case"link":yt("error",i),yt("load",i),y=f;break;case"details":yt("toggle",i),y=f;break;case"input":Aa(i,f),y=ui(i,f),yt("invalid",i);break;case"option":y=f;break;case"select":i._wrapperState={wasMultiple:!!f.multiple},y=oe({},f,{value:void 0}),yt("invalid",i);break;case"textarea":gc(i,f),y=mc(i,f),yt("invalid",i);break;default:y=f}wr(c,y),M=y;for(w in M)if(M.hasOwnProperty(w)){var V=M[w];w==="style"?Na(i,V):w==="dangerouslySetInnerHTML"?(V=V?V.__html:void 0,V!=null&&Rd(i,V)):w==="children"?typeof V=="string"?(c!=="textarea"||V!=="")&&Io(i,V):typeof V=="number"&&Io(i,""+V):w!=="suppressContentEditableWarning"&&w!=="suppressHydrationWarning"&&w!=="autoFocus"&&(s.hasOwnProperty(w)?V!=null&&w==="onScroll"&&yt("scroll",i):V!=null&&$(i,w,V,S))}switch(c){case"input":An(i),Re(i,f,!1);break;case"textarea":An(i),hi(i);break;case"option":f.value!=null&&i.setAttribute("value",""+Fe(f.value));break;case"select":i.multiple=!!f.multiple,w=f.value,w!=null?tn(i,!!f.multiple,w,!1):f.defaultValue!=null&&tn(i,!!f.multiple,f.defaultValue,!0);break;default:typeof y.onClick=="function"&&(i.onclick=th)}switch(c){case"button":case"input":case"select":case"textarea":f=!!f.autoFocus;break e;case"img":f=!0;break e;default:f=!1}}f&&(a.flags|=4)}a.ref!==null&&(a.flags|=512,a.flags|=2097152)}return gn(a),null;case 6:if(i&&a.stateNode!=null)zE(i,a,i.memoizedProps,f);else{if(typeof f!="string"&&a.stateNode===null)throw Error(t(166));if(c=Ho(Yc.current),Ho(ts.current),lh(a)){if(f=a.stateNode,c=a.memoizedProps,f[es]=a,(w=f.nodeValue!==c)&&(i=Kn,i!==null))switch(i.tag){case 3:eh(f.nodeValue,c,(i.mode&1)!==0);break;case 5:i.memoizedProps.suppressHydrationWarning!==!0&&eh(f.nodeValue,c,(i.mode&1)!==0)}w&&(a.flags|=4)}else f=(c.nodeType===9?c:c.ownerDocument).createTextNode(f),f[es]=a,a.stateNode=f}return gn(a),null;case 13:if(_t(Ct),f=a.memoizedState,i===null||i.memoizedState!==null&&i.memoizedState.dehydrated!==null){if(Tt&&Qn!==null&&(a.mode&1)!==0&&(a.flags&128)===0)W0(),il(),a.flags|=98560,w=!1;else if(w=lh(a),f!==null&&f.dehydrated!==null){if(i===null){if(!w)throw Error(t(318));if(w=a.memoizedState,w=w!==null?w.dehydrated:null,!w)throw Error(t(317));w[es]=a}else il(),(a.flags&128)===0&&(a.memoizedState=null),a.flags|=4;gn(a),w=!1}else Cr!==null&&(Dg(Cr),Cr=null),w=!0;if(!w)return a.flags&65536?a:null}return(a.flags&128)!==0?(a.lanes=c,a):(f=f!==null,f!==(i!==null&&i.memoizedState!==null)&&f&&(a.child.flags|=8192,(a.mode&1)!==0&&(i===null||(Ct.current&1)!==0?Ht===0&&(Ht=3):Lg())),a.updateQueue!==null&&(a.flags|=4),gn(a),null);case 4:return cl(),xg(i,a),i===null&&$c(a.stateNode.containerInfo),gn(a),null;case 10:return Ym(a.type._context),gn(a),null;case 17:return Pn(a.type)&&rh(),gn(a),null;case 19:if(_t(Ct),w=a.memoizedState,w===null)return gn(a),null;if(f=(a.flags&128)!==0,S=w.rendering,S===null)if(f)tu(w,!1);else{if(Ht!==0||i!==null&&(i.flags&128)!==0)for(i=a.child;i!==null;){if(S=ph(i),S!==null){for(a.flags|=128,tu(w,!1),f=S.updateQueue,f!==null&&(a.updateQueue=f,a.flags|=4),a.subtreeFlags=0,f=c,c=a.child;c!==null;)w=c,i=f,w.flags&=14680066,S=w.alternate,S===null?(w.childLanes=0,w.lanes=i,w.child=null,w.subtreeFlags=0,w.memoizedProps=null,w.memoizedState=null,w.updateQueue=null,w.dependencies=null,w.stateNode=null):(w.childLanes=S.childLanes,w.lanes=S.lanes,w.child=S.child,w.subtreeFlags=0,w.deletions=null,w.memoizedProps=S.memoizedProps,w.memoizedState=S.memoizedState,w.updateQueue=S.updateQueue,w.type=S.type,i=S.dependencies,w.dependencies=i===null?null:{lanes:i.lanes,firstContext:i.firstContext}),c=c.sibling;return pt(Ct,Ct.current&1|2),a.child}i=i.sibling}w.tail!==null&&gt()>fl&&(a.flags|=128,f=!0,tu(w,!1),a.lanes=4194304)}else{if(!f)if(i=ph(S),i!==null){if(a.flags|=128,f=!0,c=i.updateQueue,c!==null&&(a.updateQueue=c,a.flags|=4),tu(w,!0),w.tail===null&&w.tailMode==="hidden"&&!S.alternate&&!Tt)return gn(a),null}else 2*gt()-w.renderingStartTime>fl&&c!==1073741824&&(a.flags|=128,f=!0,tu(w,!1),a.lanes=4194304);w.isBackwards?(S.sibling=a.child,a.child=S):(c=w.last,c!==null?c.sibling=S:a.child=S,w.last=S)}return w.tail!==null?(a=w.tail,w.rendering=a,w.tail=a.sibling,w.renderingStartTime=gt(),a.sibling=null,c=Ct.current,pt(Ct,f?c&1|2:c&1),a):(gn(a),null);case 22:case 23:return Mg(),f=a.memoizedState!==null,i!==null&&i.memoizedState!==null!==f&&(a.flags|=8192),f&&(a.mode&1)!==0?(Yn&1073741824)!==0&&(gn(a),a.subtreeFlags&6&&(a.flags|=8192)):gn(a),null;case 24:return null;case 25:return null}throw Error(t(156,a.tag))}function Z1(i,a){switch(Wm(a),a.tag){case 1:return Pn(a.type)&&rh(),i=a.flags,i&65536?(a.flags=i&-65537|128,a):null;case 3:return cl(),_t(Nn),_t(pn),rg(),i=a.flags,(i&65536)!==0&&(i&128)===0?(a.flags=i&-65537|128,a):null;case 5:return tg(a),null;case 13:if(_t(Ct),i=a.memoizedState,i!==null&&i.dehydrated!==null){if(a.alternate===null)throw Error(t(340));il()}return i=a.flags,i&65536?(a.flags=i&-65537|128,a):null;case 19:return _t(Ct),null;case 4:return cl(),null;case 10:return Ym(a.type._context),null;case 22:case 23:return Mg(),null;case 24:return null;default:return null}}var Th=!1,yn=!1,eP=typeof WeakSet=="function"?WeakSet:Set,ye=null;function dl(i,a){var c=i.ref;if(c!==null)if(typeof c=="function")try{c(null)}catch(f){Rt(i,a,f)}else c.current=null}function Tg(i,a,c){try{c()}catch(f){Rt(i,a,f)}}var BE=!1;function tP(i,a){if(Mm=Ns,i=w0(),bm(i)){if("selectionStart"in i)var c={start:i.selectionStart,end:i.selectionEnd};else e:{c=(c=i.ownerDocument)&&c.defaultView||window;var f=c.getSelection&&c.getSelection();if(f&&f.rangeCount!==0){c=f.anchorNode;var y=f.anchorOffset,w=f.focusNode;f=f.focusOffset;try{c.nodeType,w.nodeType}catch{c=null;break e}var S=0,M=-1,V=-1,Q=0,se=0,ie=i,re=null;t:for(;;){for(var fe;ie!==c||y!==0&&ie.nodeType!==3||(M=S+y),ie!==w||f!==0&&ie.nodeType!==3||(V=S+f),ie.nodeType===3&&(S+=ie.nodeValue.length),(fe=ie.firstChild)!==null;)re=ie,ie=fe;for(;;){if(ie===i)break t;if(re===c&&++Q===y&&(M=S),re===w&&++se===f&&(V=S),(fe=ie.nextSibling)!==null)break;ie=re,re=ie.parentNode}ie=fe}c=M===-1||V===-1?null:{start:M,end:V}}else c=null}c=c||{start:0,end:0}}else c=null;for(Lm={focusedElem:i,selectionRange:c},Ns=!1,ye=a;ye!==null;)if(a=ye,i=a.child,(a.subtreeFlags&1028)!==0&&i!==null)i.return=a,ye=i;else for(;ye!==null;){a=ye;try{var ve=a.alternate;if((a.flags&1024)!==0)switch(a.tag){case 0:case 11:case 15:break;case 1:if(ve!==null){var xe=ve.memoizedProps,Dt=ve.memoizedState,H=a.stateNode,z=H.getSnapshotBeforeUpdate(a.elementType===a.type?xe:Sr(a.type,xe),Dt);H.__reactInternalSnapshotBeforeUpdate=z}break;case 3:var K=a.stateNode.containerInfo;K.nodeType===1?K.textContent="":K.nodeType===9&&K.documentElement&&K.removeChild(K.documentElement);break;case 5:case 6:case 4:case 17:break;default:throw Error(t(163))}}catch(ae){Rt(a,a.return,ae)}if(i=a.sibling,i!==null){i.return=a.return,ye=i;break}ye=a.return}return ve=BE,BE=!1,ve}function nu(i,a,c){var f=a.updateQueue;if(f=f!==null?f.lastEffect:null,f!==null){var y=f=f.next;do{if((y.tag&i)===i){var w=y.destroy;y.destroy=void 0,w!==void 0&&Tg(a,c,w)}y=y.next}while(y!==f)}}function Ch(i,a){if(a=a.updateQueue,a=a!==null?a.lastEffect:null,a!==null){var c=a=a.next;do{if((c.tag&i)===i){var f=c.create;c.destroy=f()}c=c.next}while(c!==a)}}function Cg(i){var a=i.ref;if(a!==null){var c=i.stateNode;switch(i.tag){case 5:i=c;break;default:i=c}typeof a=="function"?a(i):a.current=i}}function $E(i){var a=i.alternate;a!==null&&(i.alternate=null,$E(a)),i.child=null,i.deletions=null,i.sibling=null,i.tag===5&&(a=i.stateNode,a!==null&&(delete a[es],delete a[Hc],delete a[Um],delete a[j1],delete a[V1])),i.stateNode=null,i.return=null,i.dependencies=null,i.memoizedProps=null,i.memoizedState=null,i.pendingProps=null,i.stateNode=null,i.updateQueue=null}function WE(i){return i.tag===5||i.tag===3||i.tag===4}function HE(i){e:for(;;){for(;i.sibling===null;){if(i.return===null||WE(i.return))return null;i=i.return}for(i.sibling.return=i.return,i=i.sibling;i.tag!==5&&i.tag!==6&&i.tag!==18;){if(i.flags&2||i.child===null||i.tag===4)continue e;i.child.return=i,i=i.child}if(!(i.flags&2))return i.stateNode}}function Sg(i,a,c){var f=i.tag;if(f===5||f===6)i=i.stateNode,a?c.nodeType===8?c.parentNode.insertBefore(i,a):c.insertBefore(i,a):(c.nodeType===8?(a=c.parentNode,a.insertBefore(i,c)):(a=c,a.appendChild(i)),c=c._reactRootContainer,c!=null||a.onclick!==null||(a.onclick=th));else if(f!==4&&(i=i.child,i!==null))for(Sg(i,a,c),i=i.sibling;i!==null;)Sg(i,a,c),i=i.sibling}function Ig(i,a,c){var f=i.tag;if(f===5||f===6)i=i.stateNode,a?c.insertBefore(i,a):c.appendChild(i);else if(f!==4&&(i=i.child,i!==null))for(Ig(i,a,c),i=i.sibling;i!==null;)Ig(i,a,c),i=i.sibling}var sn=null,Ir=!1;function Oi(i,a,c){for(c=c.child;c!==null;)qE(i,a,c),c=c.sibling}function qE(i,a,c){if(Bn&&typeof Bn.onCommitFiberUnmount=="function")try{Bn.onCommitFiberUnmount(No,c)}catch{}switch(c.tag){case 5:yn||dl(c,a);case 6:var f=sn,y=Ir;sn=null,Oi(i,a,c),sn=f,Ir=y,sn!==null&&(Ir?(i=sn,c=c.stateNode,i.nodeType===8?i.parentNode.removeChild(c):i.removeChild(c)):sn.removeChild(c.stateNode));break;case 18:sn!==null&&(Ir?(i=sn,c=c.stateNode,i.nodeType===8?Fm(i.parentNode,c):i.nodeType===1&&Fm(i,c),Ci(i)):Fm(sn,c.stateNode));break;case 4:f=sn,y=Ir,sn=c.stateNode.containerInfo,Ir=!0,Oi(i,a,c),sn=f,Ir=y;break;case 0:case 11:case 14:case 15:if(!yn&&(f=c.updateQueue,f!==null&&(f=f.lastEffect,f!==null))){y=f=f.next;do{var w=y,S=w.destroy;w=w.tag,S!==void 0&&((w&2)!==0||(w&4)!==0)&&Tg(c,a,S),y=y.next}while(y!==f)}Oi(i,a,c);break;case 1:if(!yn&&(dl(c,a),f=c.stateNode,typeof f.componentWillUnmount=="function"))try{f.props=c.memoizedProps,f.state=c.memoizedState,f.componentWillUnmount()}catch(M){Rt(c,a,M)}Oi(i,a,c);break;case 21:Oi(i,a,c);break;case 22:c.mode&1?(yn=(f=yn)||c.memoizedState!==null,Oi(i,a,c),yn=f):Oi(i,a,c);break;default:Oi(i,a,c)}}function GE(i){var a=i.updateQueue;if(a!==null){i.updateQueue=null;var c=i.stateNode;c===null&&(c=i.stateNode=new eP),a.forEach(function(f){var y=uP.bind(null,i,f);c.has(f)||(c.add(f),f.then(y,y))})}}function br(i,a){var c=a.deletions;if(c!==null)for(var f=0;f<c.length;f++){var y=c[f];try{var w=i,S=a,M=S;e:for(;M!==null;){switch(M.tag){case 5:sn=M.stateNode,Ir=!1;break e;case 3:sn=M.stateNode.containerInfo,Ir=!0;break e;case 4:sn=M.stateNode.containerInfo,Ir=!0;break e}M=M.return}if(sn===null)throw Error(t(160));qE(w,S,y),sn=null,Ir=!1;var V=y.alternate;V!==null&&(V.return=null),y.return=null}catch(Q){Rt(y,a,Q)}}if(a.subtreeFlags&12854)for(a=a.child;a!==null;)KE(a,i),a=a.sibling}function KE(i,a){var c=i.alternate,f=i.flags;switch(i.tag){case 0:case 11:case 14:case 15:if(br(a,i),rs(i),f&4){try{nu(3,i,i.return),Ch(3,i)}catch(xe){Rt(i,i.return,xe)}try{nu(5,i,i.return)}catch(xe){Rt(i,i.return,xe)}}break;case 1:br(a,i),rs(i),f&512&&c!==null&&dl(c,c.return);break;case 5:if(br(a,i),rs(i),f&512&&c!==null&&dl(c,c.return),i.flags&32){var y=i.stateNode;try{Io(y,"")}catch(xe){Rt(i,i.return,xe)}}if(f&4&&(y=i.stateNode,y!=null)){var w=i.memoizedProps,S=c!==null?c.memoizedProps:w,M=i.type,V=i.updateQueue;if(i.updateQueue=null,V!==null)try{M==="input"&&w.type==="radio"&&w.name!=null&&di(y,w),Pa(M,S);var Q=Pa(M,w);for(S=0;S<V.length;S+=2){var se=V[S],ie=V[S+1];se==="style"?Na(y,ie):se==="dangerouslySetInnerHTML"?Rd(y,ie):se==="children"?Io(y,ie):$(y,se,ie,Q)}switch(M){case"input":ge(y,w);break;case"textarea":bd(y,w);break;case"select":var re=y._wrapperState.wasMultiple;y._wrapperState.wasMultiple=!!w.multiple;var fe=w.value;fe!=null?tn(y,!!w.multiple,fe,!1):re!==!!w.multiple&&(w.defaultValue!=null?tn(y,!!w.multiple,w.defaultValue,!0):tn(y,!!w.multiple,w.multiple?[]:"",!1))}y[Hc]=w}catch(xe){Rt(i,i.return,xe)}}break;case 6:if(br(a,i),rs(i),f&4){if(i.stateNode===null)throw Error(t(162));y=i.stateNode,w=i.memoizedProps;try{y.nodeValue=w}catch(xe){Rt(i,i.return,xe)}}break;case 3:if(br(a,i),rs(i),f&4&&c!==null&&c.memoizedState.isDehydrated)try{Ci(a.containerInfo)}catch(xe){Rt(i,i.return,xe)}break;case 4:br(a,i),rs(i);break;case 13:br(a,i),rs(i),y=i.child,y.flags&8192&&(w=y.memoizedState!==null,y.stateNode.isHidden=w,!w||y.alternate!==null&&y.alternate.memoizedState!==null||(Ag=gt())),f&4&&GE(i);break;case 22:if(se=c!==null&&c.memoizedState!==null,i.mode&1?(yn=(Q=yn)||se,br(a,i),yn=Q):br(a,i),rs(i),f&8192){if(Q=i.memoizedState!==null,(i.stateNode.isHidden=Q)&&!se&&(i.mode&1)!==0)for(ye=i,se=i.child;se!==null;){for(ie=ye=se;ye!==null;){switch(re=ye,fe=re.child,re.tag){case 0:case 11:case 14:case 15:nu(4,re,re.return);break;case 1:dl(re,re.return);var ve=re.stateNode;if(typeof ve.componentWillUnmount=="function"){f=re,c=re.return;try{a=f,ve.props=a.memoizedProps,ve.state=a.memoizedState,ve.componentWillUnmount()}catch(xe){Rt(f,c,xe)}}break;case 5:dl(re,re.return);break;case 22:if(re.memoizedState!==null){XE(ie);continue}}fe!==null?(fe.return=re,ye=fe):XE(ie)}se=se.sibling}e:for(se=null,ie=i;;){if(ie.tag===5){if(se===null){se=ie;try{y=ie.stateNode,Q?(w=y.style,typeof w.setProperty=="function"?w.setProperty("display","none","important"):w.display="none"):(M=ie.stateNode,V=ie.memoizedProps.style,S=V!=null&&V.hasOwnProperty("display")?V.display:null,M.style.display=mi("display",S))}catch(xe){Rt(i,i.return,xe)}}}else if(ie.tag===6){if(se===null)try{ie.stateNode.nodeValue=Q?"":ie.memoizedProps}catch(xe){Rt(i,i.return,xe)}}else if((ie.tag!==22&&ie.tag!==23||ie.memoizedState===null||ie===i)&&ie.child!==null){ie.child.return=ie,ie=ie.child;continue}if(ie===i)break e;for(;ie.sibling===null;){if(ie.return===null||ie.return===i)break e;se===ie&&(se=null),ie=ie.return}se===ie&&(se=null),ie.sibling.return=ie.return,ie=ie.sibling}}break;case 19:br(a,i),rs(i),f&4&&GE(i);break;case 21:break;default:br(a,i),rs(i)}}function rs(i){var a=i.flags;if(a&2){try{e:{for(var c=i.return;c!==null;){if(WE(c)){var f=c;break e}c=c.return}throw Error(t(160))}switch(f.tag){case 5:var y=f.stateNode;f.flags&32&&(Io(y,""),f.flags&=-33);var w=HE(i);Ig(i,w,y);break;case 3:case 4:var S=f.stateNode.containerInfo,M=HE(i);Sg(i,M,S);break;default:throw Error(t(161))}}catch(V){Rt(i,i.return,V)}i.flags&=-3}a&4096&&(i.flags&=-4097)}function nP(i,a,c){ye=i,QE(i)}function QE(i,a,c){for(var f=(i.mode&1)!==0;ye!==null;){var y=ye,w=y.child;if(y.tag===22&&f){var S=y.memoizedState!==null||Th;if(!S){var M=y.alternate,V=M!==null&&M.memoizedState!==null||yn;M=Th;var Q=yn;if(Th=S,(yn=V)&&!Q)for(ye=y;ye!==null;)S=ye,V=S.child,S.tag===22&&S.memoizedState!==null?JE(y):V!==null?(V.return=S,ye=V):JE(y);for(;w!==null;)ye=w,QE(w),w=w.sibling;ye=y,Th=M,yn=Q}YE(i)}else(y.subtreeFlags&8772)!==0&&w!==null?(w.return=y,ye=w):YE(i)}}function YE(i){for(;ye!==null;){var a=ye;if((a.flags&8772)!==0){var c=a.alternate;try{if((a.flags&8772)!==0)switch(a.tag){case 0:case 11:case 15:yn||Ch(5,a);break;case 1:var f=a.stateNode;if(a.flags&4&&!yn)if(c===null)f.componentDidMount();else{var y=a.elementType===a.type?c.memoizedProps:Sr(a.type,c.memoizedProps);f.componentDidUpdate(y,c.memoizedState,f.__reactInternalSnapshotBeforeUpdate)}var w=a.updateQueue;w!==null&&X0(a,w,f);break;case 3:var S=a.updateQueue;if(S!==null){if(c=null,a.child!==null)switch(a.child.tag){case 5:c=a.child.stateNode;break;case 1:c=a.child.stateNode}X0(a,S,c)}break;case 5:var M=a.stateNode;if(c===null&&a.flags&4){c=M;var V=a.memoizedProps;switch(a.type){case"button":case"input":case"select":case"textarea":V.autoFocus&&c.focus();break;case"img":V.src&&(c.src=V.src)}}break;case 6:break;case 4:break;case 12:break;case 13:if(a.memoizedState===null){var Q=a.alternate;if(Q!==null){var se=Q.memoizedState;if(se!==null){var ie=se.dehydrated;ie!==null&&Ci(ie)}}}break;case 19:case 17:case 21:case 22:case 23:case 25:break;default:throw Error(t(163))}yn||a.flags&512&&Cg(a)}catch(re){Rt(a,a.return,re)}}if(a===i){ye=null;break}if(c=a.sibling,c!==null){c.return=a.return,ye=c;break}ye=a.return}}function XE(i){for(;ye!==null;){var a=ye;if(a===i){ye=null;break}var c=a.sibling;if(c!==null){c.return=a.return,ye=c;break}ye=a.return}}function JE(i){for(;ye!==null;){var a=ye;try{switch(a.tag){case 0:case 11:case 15:var c=a.return;try{Ch(4,a)}catch(V){Rt(a,c,V)}break;case 1:var f=a.stateNode;if(typeof f.componentDidMount=="function"){var y=a.return;try{f.componentDidMount()}catch(V){Rt(a,y,V)}}var w=a.return;try{Cg(a)}catch(V){Rt(a,w,V)}break;case 5:var S=a.return;try{Cg(a)}catch(V){Rt(a,S,V)}}}catch(V){Rt(a,a.return,V)}if(a===i){ye=null;break}var M=a.sibling;if(M!==null){M.return=a.return,ye=M;break}ye=a.return}}var rP=Math.ceil,Sh=G.ReactCurrentDispatcher,bg=G.ReactCurrentOwner,hr=G.ReactCurrentBatchConfig,rt=0,Qt=null,Vt=null,on=0,Yn=0,hl=Ai(0),Ht=0,ru=null,Go=0,Ih=0,Rg=0,su=null,On=null,Ag=0,fl=1/0,zs=null,bh=!1,kg=null,Mi=null,Rh=!1,Li=null,Ah=0,iu=0,Ng=null,kh=-1,Nh=0;function Sn(){return(rt&6)!==0?gt():kh!==-1?kh:kh=gt()}function ji(i){return(i.mode&1)===0?1:(rt&2)!==0&&on!==0?on&-on:U1.transition!==null?(Nh===0&&(Nh=Ic()),Nh):(i=Ze,i!==0||(i=window.event,i=i===void 0?16:Ba(i.type)),i)}function Rr(i,a,c,f){if(50<iu)throw iu=0,Ng=null,Error(t(185));Mo(i,c,f),((rt&2)===0||i!==Qt)&&(i===Qt&&((rt&2)===0&&(Ih|=c),Ht===4&&Vi(i,on)),Mn(i,f),c===1&&rt===0&&(a.mode&1)===0&&(fl=gt()+500,ih&&Ni()))}function Mn(i,a){var c=i.callbackNode;Oo(i,a);var f=Rs(i,i===Qt?on:0);if(f===0)c!==null&&Ma(c),i.callbackNode=null,i.callbackPriority=0;else if(a=f&-f,i.callbackPriority!==a){if(c!=null&&Ma(c),a===1)i.tag===0?F1(ex.bind(null,i)):F0(ex.bind(null,i)),M1(function(){(rt&6)===0&&Ni()}),c=null;else{switch(Wr(f)){case 1:c=La;break;case 4:c=Tc;break;case 16:c=ko;break;case 536870912:c=ja;break;default:c=ko}c=lx(c,ZE.bind(null,i))}i.callbackPriority=a,i.callbackNode=c}}function ZE(i,a){if(kh=-1,Nh=0,(rt&6)!==0)throw Error(t(327));var c=i.callbackNode;if(pl()&&i.callbackNode!==c)return null;var f=Rs(i,i===Qt?on:0);if(f===0)return null;if((f&30)!==0||(f&i.expiredLanes)!==0||a)a=Ph(i,f);else{a=f;var y=rt;rt|=2;var w=nx();(Qt!==i||on!==a)&&(zs=null,fl=gt()+500,Qo(i,a));do try{oP();break}catch(M){tx(i,M)}while(!0);Qm(),Sh.current=w,rt=y,Vt!==null?a=0:(Qt=null,on=0,a=Ht)}if(a!==0){if(a===2&&(y=Sc(i),y!==0&&(f=y,a=Pg(i,y))),a===1)throw c=ru,Qo(i,0),Vi(i,f),Mn(i,gt()),c;if(a===6)Vi(i,f);else{if(y=i.current.alternate,(f&30)===0&&!sP(y)&&(a=Ph(i,f),a===2&&(w=Sc(i),w!==0&&(f=w,a=Pg(i,w))),a===1))throw c=ru,Qo(i,0),Vi(i,f),Mn(i,gt()),c;switch(i.finishedWork=y,i.finishedLanes=f,a){case 0:case 1:throw Error(t(345));case 2:Yo(i,On,zs);break;case 3:if(Vi(i,f),(f&130023424)===f&&(a=Ag+500-gt(),10<a)){if(Rs(i,0)!==0)break;if(y=i.suspendedLanes,(y&f)!==f){Sn(),i.pingedLanes|=i.suspendedLanes&y;break}i.timeoutHandle=Vm(Yo.bind(null,i,On,zs),a);break}Yo(i,On,zs);break;case 4:if(Vi(i,f),(f&4194240)===f)break;for(a=i.eventTimes,y=-1;0<f;){var S=31-$n(f);w=1<<S,S=a[S],S>y&&(y=S),f&=~w}if(f=y,f=gt()-f,f=(120>f?120:480>f?480:1080>f?1080:1920>f?1920:3e3>f?3e3:4320>f?4320:1960*rP(f/1960))-f,10<f){i.timeoutHandle=Vm(Yo.bind(null,i,On,zs),f);break}Yo(i,On,zs);break;case 5:Yo(i,On,zs);break;default:throw Error(t(329))}}}return Mn(i,gt()),i.callbackNode===c?ZE.bind(null,i):null}function Pg(i,a){var c=su;return i.current.memoizedState.isDehydrated&&(Qo(i,a).flags|=256),i=Ph(i,a),i!==2&&(a=On,On=c,a!==null&&Dg(a)),i}function Dg(i){On===null?On=i:On.push.apply(On,i)}function sP(i){for(var a=i;;){if(a.flags&16384){var c=a.updateQueue;if(c!==null&&(c=c.stores,c!==null))for(var f=0;f<c.length;f++){var y=c[f],w=y.getSnapshot;y=y.value;try{if(!Tr(w(),y))return!1}catch{return!1}}}if(c=a.child,a.subtreeFlags&16384&&c!==null)c.return=a,a=c;else{if(a===i)break;for(;a.sibling===null;){if(a.return===null||a.return===i)return!0;a=a.return}a.sibling.return=a.return,a=a.sibling}}return!0}function Vi(i,a){for(a&=~Rg,a&=~Ih,i.suspendedLanes|=a,i.pingedLanes&=~a,i=i.expirationTimes;0<a;){var c=31-$n(a),f=1<<c;i[c]=-1,a&=~f}}function ex(i){if((rt&6)!==0)throw Error(t(327));pl();var a=Rs(i,0);if((a&1)===0)return Mn(i,gt()),null;var c=Ph(i,a);if(i.tag!==0&&c===2){var f=Sc(i);f!==0&&(a=f,c=Pg(i,f))}if(c===1)throw c=ru,Qo(i,0),Vi(i,a),Mn(i,gt()),c;if(c===6)throw Error(t(345));return i.finishedWork=i.current.alternate,i.finishedLanes=a,Yo(i,On,zs),Mn(i,gt()),null}function Og(i,a){var c=rt;rt|=1;try{return i(a)}finally{rt=c,rt===0&&(fl=gt()+500,ih&&Ni())}}function Ko(i){Li!==null&&Li.tag===0&&(rt&6)===0&&pl();var a=rt;rt|=1;var c=hr.transition,f=Ze;try{if(hr.transition=null,Ze=1,i)return i()}finally{Ze=f,hr.transition=c,rt=a,(rt&6)===0&&Ni()}}function Mg(){Yn=hl.current,_t(hl)}function Qo(i,a){i.finishedWork=null,i.finishedLanes=0;var c=i.timeoutHandle;if(c!==-1&&(i.timeoutHandle=-1,O1(c)),Vt!==null)for(c=Vt.return;c!==null;){var f=c;switch(Wm(f),f.tag){case 1:f=f.type.childContextTypes,f!=null&&rh();break;case 3:cl(),_t(Nn),_t(pn),rg();break;case 5:tg(f);break;case 4:cl();break;case 13:_t(Ct);break;case 19:_t(Ct);break;case 10:Ym(f.type._context);break;case 22:case 23:Mg()}c=c.return}if(Qt=i,Vt=i=Fi(i.current,null),on=Yn=a,Ht=0,ru=null,Rg=Ih=Go=0,On=su=null,Wo!==null){for(a=0;a<Wo.length;a++)if(c=Wo[a],f=c.interleaved,f!==null){c.interleaved=null;var y=f.next,w=c.pending;if(w!==null){var S=w.next;w.next=y,f.next=S}c.pending=f}Wo=null}return i}function tx(i,a){do{var c=Vt;try{if(Qm(),mh.current=vh,gh){for(var f=St.memoizedState;f!==null;){var y=f.queue;y!==null&&(y.pending=null),f=f.next}gh=!1}if(qo=0,Kt=Wt=St=null,Xc=!1,Jc=0,bg.current=null,c===null||c.return===null){Ht=1,ru=a,Vt=null;break}e:{var w=i,S=c.return,M=c,V=a;if(a=on,M.flags|=32768,V!==null&&typeof V=="object"&&typeof V.then=="function"){var Q=V,se=M,ie=se.tag;if((se.mode&1)===0&&(ie===0||ie===11||ie===15)){var re=se.alternate;re?(se.updateQueue=re.updateQueue,se.memoizedState=re.memoizedState,se.lanes=re.lanes):(se.updateQueue=null,se.memoizedState=null)}var fe=IE(S);if(fe!==null){fe.flags&=-257,bE(fe,S,M,w,a),fe.mode&1&&SE(w,Q,a),a=fe,V=Q;var ve=a.updateQueue;if(ve===null){var xe=new Set;xe.add(V),a.updateQueue=xe}else ve.add(V);break e}else{if((a&1)===0){SE(w,Q,a),Lg();break e}V=Error(t(426))}}else if(Tt&&M.mode&1){var Dt=IE(S);if(Dt!==null){(Dt.flags&65536)===0&&(Dt.flags|=256),bE(Dt,S,M,w,a),Gm(ul(V,M));break e}}w=V=ul(V,M),Ht!==4&&(Ht=2),su===null?su=[w]:su.push(w),w=S;do{switch(w.tag){case 3:w.flags|=65536,a&=-a,w.lanes|=a;var H=TE(w,V,a);Y0(w,H);break e;case 1:M=V;var z=w.type,K=w.stateNode;if((w.flags&128)===0&&(typeof z.getDerivedStateFromError=="function"||K!==null&&typeof K.componentDidCatch=="function"&&(Mi===null||!Mi.has(K)))){w.flags|=65536,a&=-a,w.lanes|=a;var ae=CE(w,M,a);Y0(w,ae);break e}}w=w.return}while(w!==null)}sx(c)}catch(Te){a=Te,Vt===c&&c!==null&&(Vt=c=c.return);continue}break}while(!0)}function nx(){var i=Sh.current;return Sh.current=vh,i===null?vh:i}function Lg(){(Ht===0||Ht===3||Ht===2)&&(Ht=4),Qt===null||(Go&268435455)===0&&(Ih&268435455)===0||Vi(Qt,on)}function Ph(i,a){var c=rt;rt|=2;var f=nx();(Qt!==i||on!==a)&&(zs=null,Qo(i,a));do try{iP();break}catch(y){tx(i,y)}while(!0);if(Qm(),rt=c,Sh.current=f,Vt!==null)throw Error(t(261));return Qt=null,on=0,Ht}function iP(){for(;Vt!==null;)rx(Vt)}function oP(){for(;Vt!==null&&!Ao();)rx(Vt)}function rx(i){var a=ax(i.alternate,i,Yn);i.memoizedProps=i.pendingProps,a===null?sx(i):Vt=a,bg.current=null}function sx(i){var a=i;do{var c=a.alternate;if(i=a.return,(a.flags&32768)===0){if(c=J1(c,a,Yn),c!==null){Vt=c;return}}else{if(c=Z1(c,a),c!==null){c.flags&=32767,Vt=c;return}if(i!==null)i.flags|=32768,i.subtreeFlags=0,i.deletions=null;else{Ht=6,Vt=null;return}}if(a=a.sibling,a!==null){Vt=a;return}Vt=a=i}while(a!==null);Ht===0&&(Ht=5)}function Yo(i,a,c){var f=Ze,y=hr.transition;try{hr.transition=null,Ze=1,aP(i,a,c,f)}finally{hr.transition=y,Ze=f}return null}function aP(i,a,c,f){do pl();while(Li!==null);if((rt&6)!==0)throw Error(t(327));c=i.finishedWork;var y=i.finishedLanes;if(c===null)return null;if(i.finishedWork=null,i.finishedLanes=0,c===i.current)throw Error(t(177));i.callbackNode=null,i.callbackPriority=0;var w=c.lanes|c.childLanes;if(xm(i,w),i===Qt&&(Vt=Qt=null,on=0),(c.subtreeFlags&2064)===0&&(c.flags&2064)===0||Rh||(Rh=!0,lx(ko,function(){return pl(),null})),w=(c.flags&15990)!==0,(c.subtreeFlags&15990)!==0||w){w=hr.transition,hr.transition=null;var S=Ze;Ze=1;var M=rt;rt|=4,bg.current=null,tP(i,c),KE(c,i),b1(Lm),Ns=!!Mm,Lm=Mm=null,i.current=c,nP(c),bs(),rt=M,Ze=S,hr.transition=w}else i.current=c;if(Rh&&(Rh=!1,Li=i,Ah=y),w=i.pendingLanes,w===0&&(Mi=null),Fd(c.stateNode),Mn(i,gt()),a!==null)for(f=i.onRecoverableError,c=0;c<a.length;c++)y=a[c],f(y.value,{componentStack:y.stack,digest:y.digest});if(bh)throw bh=!1,i=kg,kg=null,i;return(Ah&1)!==0&&i.tag!==0&&pl(),w=i.pendingLanes,(w&1)!==0?i===Ng?iu++:(iu=0,Ng=i):iu=0,Ni(),null}function pl(){if(Li!==null){var i=Wr(Ah),a=hr.transition,c=Ze;try{if(hr.transition=null,Ze=16>i?16:i,Li===null)var f=!1;else{if(i=Li,Li=null,Ah=0,(rt&6)!==0)throw Error(t(331));var y=rt;for(rt|=4,ye=i.current;ye!==null;){var w=ye,S=w.child;if((ye.flags&16)!==0){var M=w.deletions;if(M!==null){for(var V=0;V<M.length;V++){var Q=M[V];for(ye=Q;ye!==null;){var se=ye;switch(se.tag){case 0:case 11:case 15:nu(8,se,w)}var ie=se.child;if(ie!==null)ie.return=se,ye=ie;else for(;ye!==null;){se=ye;var re=se.sibling,fe=se.return;if($E(se),se===Q){ye=null;break}if(re!==null){re.return=fe,ye=re;break}ye=fe}}}var ve=w.alternate;if(ve!==null){var xe=ve.child;if(xe!==null){ve.child=null;do{var Dt=xe.sibling;xe.sibling=null,xe=Dt}while(xe!==null)}}ye=w}}if((w.subtreeFlags&2064)!==0&&S!==null)S.return=w,ye=S;else e:for(;ye!==null;){if(w=ye,(w.flags&2048)!==0)switch(w.tag){case 0:case 11:case 15:nu(9,w,w.return)}var H=w.sibling;if(H!==null){H.return=w.return,ye=H;break e}ye=w.return}}var z=i.current;for(ye=z;ye!==null;){S=ye;var K=S.child;if((S.subtreeFlags&2064)!==0&&K!==null)K.return=S,ye=K;else e:for(S=z;ye!==null;){if(M=ye,(M.flags&2048)!==0)try{switch(M.tag){case 0:case 11:case 15:Ch(9,M)}}catch(Te){Rt(M,M.return,Te)}if(M===S){ye=null;break e}var ae=M.sibling;if(ae!==null){ae.return=M.return,ye=ae;break e}ye=M.return}}if(rt=y,Ni(),Bn&&typeof Bn.onPostCommitFiberRoot=="function")try{Bn.onPostCommitFiberRoot(No,i)}catch{}f=!0}return f}finally{Ze=c,hr.transition=a}}return!1}function ix(i,a,c){a=ul(c,a),a=TE(i,a,1),i=Di(i,a,1),a=Sn(),i!==null&&(Mo(i,1,a),Mn(i,a))}function Rt(i,a,c){if(i.tag===3)ix(i,i,c);else for(;a!==null;){if(a.tag===3){ix(a,i,c);break}else if(a.tag===1){var f=a.stateNode;if(typeof a.type.getDerivedStateFromError=="function"||typeof f.componentDidCatch=="function"&&(Mi===null||!Mi.has(f))){i=ul(c,i),i=CE(a,i,1),a=Di(a,i,1),i=Sn(),a!==null&&(Mo(a,1,i),Mn(a,i));break}}a=a.return}}function lP(i,a,c){var f=i.pingCache;f!==null&&f.delete(a),a=Sn(),i.pingedLanes|=i.suspendedLanes&c,Qt===i&&(on&c)===c&&(Ht===4||Ht===3&&(on&130023424)===on&&500>gt()-Ag?Qo(i,0):Rg|=c),Mn(i,a)}function ox(i,a){a===0&&((i.mode&1)===0?a=1:(a=Ei,Ei<<=1,(Ei&130023424)===0&&(Ei=4194304)));var c=Sn();i=Vs(i,a),i!==null&&(Mo(i,a,c),Mn(i,c))}function cP(i){var a=i.memoizedState,c=0;a!==null&&(c=a.retryLane),ox(i,c)}function uP(i,a){var c=0;switch(i.tag){case 13:var f=i.stateNode,y=i.memoizedState;y!==null&&(c=y.retryLane);break;case 19:f=i.stateNode;break;default:throw Error(t(314))}f!==null&&f.delete(a),ox(i,c)}var ax;ax=function(i,a,c){if(i!==null)if(i.memoizedProps!==a.pendingProps||Nn.current)Dn=!0;else{if((i.lanes&c)===0&&(a.flags&128)===0)return Dn=!1,X1(i,a,c);Dn=(i.flags&131072)!==0}else Dn=!1,Tt&&(a.flags&1048576)!==0&&U0(a,ah,a.index);switch(a.lanes=0,a.tag){case 2:var f=a.type;xh(i,a),i=a.pendingProps;var y=nl(a,pn.current);ll(a,c),y=og(null,a,f,i,y,c);var w=ag();return a.flags|=1,typeof y=="object"&&y!==null&&typeof y.render=="function"&&y.$$typeof===void 0?(a.tag=1,a.memoizedState=null,a.updateQueue=null,Pn(f)?(w=!0,sh(a)):w=!1,a.memoizedState=y.state!==null&&y.state!==void 0?y.state:null,Zm(a),y.updater=wh,a.stateNode=y,y._reactInternals=a,fg(a,f,i,c),a=yg(null,a,f,!0,w,c)):(a.tag=0,Tt&&w&&$m(a),Cn(null,a,y,c),a=a.child),a;case 16:f=a.elementType;e:{switch(xh(i,a),i=a.pendingProps,y=f._init,f=y(f._payload),a.type=f,y=a.tag=hP(f),i=Sr(f,i),y){case 0:a=gg(null,a,f,i,c);break e;case 1:a=DE(null,a,f,i,c);break e;case 11:a=RE(null,a,f,i,c);break e;case 14:a=AE(null,a,f,Sr(f.type,i),c);break e}throw Error(t(306,f,""))}return a;case 0:return f=a.type,y=a.pendingProps,y=a.elementType===f?y:Sr(f,y),gg(i,a,f,y,c);case 1:return f=a.type,y=a.pendingProps,y=a.elementType===f?y:Sr(f,y),DE(i,a,f,y,c);case 3:e:{if(OE(a),i===null)throw Error(t(387));f=a.pendingProps,w=a.memoizedState,y=w.element,Q0(i,a),fh(a,f,null,c);var S=a.memoizedState;if(f=S.element,w.isDehydrated)if(w={element:f,isDehydrated:!1,cache:S.cache,pendingSuspenseBoundaries:S.pendingSuspenseBoundaries,transitions:S.transitions},a.updateQueue.baseState=w,a.memoizedState=w,a.flags&256){y=ul(Error(t(423)),a),a=ME(i,a,f,c,y);break e}else if(f!==y){y=ul(Error(t(424)),a),a=ME(i,a,f,c,y);break e}else for(Qn=Ri(a.stateNode.containerInfo.firstChild),Kn=a,Tt=!0,Cr=null,c=G0(a,null,f,c),a.child=c;c;)c.flags=c.flags&-3|4096,c=c.sibling;else{if(il(),f===y){a=Us(i,a,c);break e}Cn(i,a,f,c)}a=a.child}return a;case 5:return J0(a),i===null&&qm(a),f=a.type,y=a.pendingProps,w=i!==null?i.memoizedProps:null,S=y.children,jm(f,y)?S=null:w!==null&&jm(f,w)&&(a.flags|=32),PE(i,a),Cn(i,a,S,c),a.child;case 6:return i===null&&qm(a),null;case 13:return LE(i,a,c);case 4:return eg(a,a.stateNode.containerInfo),f=a.pendingProps,i===null?a.child=ol(a,null,f,c):Cn(i,a,f,c),a.child;case 11:return f=a.type,y=a.pendingProps,y=a.elementType===f?y:Sr(f,y),RE(i,a,f,y,c);case 7:return Cn(i,a,a.pendingProps,c),a.child;case 8:return Cn(i,a,a.pendingProps.children,c),a.child;case 12:return Cn(i,a,a.pendingProps.children,c),a.child;case 10:e:{if(f=a.type._context,y=a.pendingProps,w=a.memoizedProps,S=y.value,pt(uh,f._currentValue),f._currentValue=S,w!==null)if(Tr(w.value,S)){if(w.children===y.children&&!Nn.current){a=Us(i,a,c);break e}}else for(w=a.child,w!==null&&(w.return=a);w!==null;){var M=w.dependencies;if(M!==null){S=w.child;for(var V=M.firstContext;V!==null;){if(V.context===f){if(w.tag===1){V=Fs(-1,c&-c),V.tag=2;var Q=w.updateQueue;if(Q!==null){Q=Q.shared;var se=Q.pending;se===null?V.next=V:(V.next=se.next,se.next=V),Q.pending=V}}w.lanes|=c,V=w.alternate,V!==null&&(V.lanes|=c),Xm(w.return,c,a),M.lanes|=c;break}V=V.next}}else if(w.tag===10)S=w.type===a.type?null:w.child;else if(w.tag===18){if(S=w.return,S===null)throw Error(t(341));S.lanes|=c,M=S.alternate,M!==null&&(M.lanes|=c),Xm(S,c,a),S=w.sibling}else S=w.child;if(S!==null)S.return=w;else for(S=w;S!==null;){if(S===a){S=null;break}if(w=S.sibling,w!==null){w.return=S.return,S=w;break}S=S.return}w=S}Cn(i,a,y.children,c),a=a.child}return a;case 9:return y=a.type,f=a.pendingProps.children,ll(a,c),y=ur(y),f=f(y),a.flags|=1,Cn(i,a,f,c),a.child;case 14:return f=a.type,y=Sr(f,a.pendingProps),y=Sr(f.type,y),AE(i,a,f,y,c);case 15:return kE(i,a,a.type,a.pendingProps,c);case 17:return f=a.type,y=a.pendingProps,y=a.elementType===f?y:Sr(f,y),xh(i,a),a.tag=1,Pn(f)?(i=!0,sh(a)):i=!1,ll(a,c),EE(a,f,y),fg(a,f,y,c),yg(null,a,f,!0,i,c);case 19:return VE(i,a,c);case 22:return NE(i,a,c)}throw Error(t(156,a.tag))};function lx(i,a){return xc(i,a)}function dP(i,a,c,f){this.tag=i,this.key=c,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=a,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=f,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function fr(i,a,c,f){return new dP(i,a,c,f)}function jg(i){return i=i.prototype,!(!i||!i.isReactComponent)}function hP(i){if(typeof i=="function")return jg(i)?1:0;if(i!=null){if(i=i.$$typeof,i===F)return 11;if(i===je)return 14}return 2}function Fi(i,a){var c=i.alternate;return c===null?(c=fr(i.tag,a,i.key,i.mode),c.elementType=i.elementType,c.type=i.type,c.stateNode=i.stateNode,c.alternate=i,i.alternate=c):(c.pendingProps=a,c.type=i.type,c.flags=0,c.subtreeFlags=0,c.deletions=null),c.flags=i.flags&14680064,c.childLanes=i.childLanes,c.lanes=i.lanes,c.child=i.child,c.memoizedProps=i.memoizedProps,c.memoizedState=i.memoizedState,c.updateQueue=i.updateQueue,a=i.dependencies,c.dependencies=a===null?null:{lanes:a.lanes,firstContext:a.firstContext},c.sibling=i.sibling,c.index=i.index,c.ref=i.ref,c}function Dh(i,a,c,f,y,w){var S=2;if(f=i,typeof i=="function")jg(i)&&(S=1);else if(typeof i=="string")S=5;else e:switch(i){case P:return Xo(c.children,y,w,a);case R:S=8,y|=8;break;case N:return i=fr(12,c,a,y|2),i.elementType=N,i.lanes=w,i;case D:return i=fr(13,c,a,y),i.elementType=D,i.lanes=w,i;case Ce:return i=fr(19,c,a,y),i.elementType=Ce,i.lanes=w,i;case Ie:return Oh(c,y,w,a);default:if(typeof i=="object"&&i!==null)switch(i.$$typeof){case L:S=10;break e;case O:S=9;break e;case F:S=11;break e;case je:S=14;break e;case Se:S=16,f=null;break e}throw Error(t(130,i==null?i:typeof i,""))}return a=fr(S,c,a,y),a.elementType=i,a.type=f,a.lanes=w,a}function Xo(i,a,c,f){return i=fr(7,i,f,a),i.lanes=c,i}function Oh(i,a,c,f){return i=fr(22,i,f,a),i.elementType=Ie,i.lanes=c,i.stateNode={isHidden:!1},i}function Vg(i,a,c){return i=fr(6,i,null,a),i.lanes=c,i}function Fg(i,a,c){return a=fr(4,i.children!==null?i.children:[],i.key,a),a.lanes=c,a.stateNode={containerInfo:i.containerInfo,pendingChildren:null,implementation:i.implementation},a}function fP(i,a,c,f,y){this.tag=a,this.containerInfo=i,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=bc(0),this.expirationTimes=bc(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=bc(0),this.identifierPrefix=f,this.onRecoverableError=y,this.mutableSourceEagerHydrationData=null}function Ug(i,a,c,f,y,w,S,M,V){return i=new fP(i,a,c,M,V),a===1?(a=1,w===!0&&(a|=8)):a=0,w=fr(3,null,null,a),i.current=w,w.stateNode=i,w.memoizedState={element:f,isDehydrated:c,cache:null,transitions:null,pendingSuspenseBoundaries:null},Zm(w),i}function pP(i,a,c){var f=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:ne,key:f==null?null:""+f,children:i,containerInfo:a,implementation:c}}function cx(i){if(!i)return ki;i=i._reactInternals;e:{if(Er(i)!==i||i.tag!==1)throw Error(t(170));var a=i;do{switch(a.tag){case 3:a=a.stateNode.context;break e;case 1:if(Pn(a.type)){a=a.stateNode.__reactInternalMemoizedMergedChildContext;break e}}a=a.return}while(a!==null);throw Error(t(171))}if(i.tag===1){var c=i.type;if(Pn(c))return j0(i,c,a)}return a}function ux(i,a,c,f,y,w,S,M,V){return i=Ug(c,f,!0,i,y,w,S,M,V),i.context=cx(null),c=i.current,f=Sn(),y=ji(c),w=Fs(f,y),w.callback=a??null,Di(c,w,y),i.current.lanes=y,Mo(i,y,f),Mn(i,f),i}function Mh(i,a,c,f){var y=a.current,w=Sn(),S=ji(y);return c=cx(c),a.context===null?a.context=c:a.pendingContext=c,a=Fs(w,S),a.payload={element:i},f=f===void 0?null:f,f!==null&&(a.callback=f),i=Di(y,a,S),i!==null&&(Rr(i,y,S,w),hh(i,y,S)),S}function Lh(i){if(i=i.current,!i.child)return null;switch(i.child.tag){case 5:return i.child.stateNode;default:return i.child.stateNode}}function dx(i,a){if(i=i.memoizedState,i!==null&&i.dehydrated!==null){var c=i.retryLane;i.retryLane=c!==0&&c<a?c:a}}function zg(i,a){dx(i,a),(i=i.alternate)&&dx(i,a)}function mP(){return null}var hx=typeof reportError=="function"?reportError:function(i){console.error(i)};function Bg(i){this._internalRoot=i}jh.prototype.render=Bg.prototype.render=function(i){var a=this._internalRoot;if(a===null)throw Error(t(409));Mh(i,a,null,null)},jh.prototype.unmount=Bg.prototype.unmount=function(){var i=this._internalRoot;if(i!==null){this._internalRoot=null;var a=i.containerInfo;Ko(function(){Mh(null,i,null,null)}),a[Os]=null}};function jh(i){this._internalRoot=i}jh.prototype.unstable_scheduleHydration=function(i){if(i){var a=Nc();i={blockedOn:null,target:i,priority:a};for(var c=0;c<Wn.length&&a!==0&&a<Wn[c].priority;c++);Wn.splice(c,0,i),c===0&&Ua(i)}};function $g(i){return!(!i||i.nodeType!==1&&i.nodeType!==9&&i.nodeType!==11)}function Vh(i){return!(!i||i.nodeType!==1&&i.nodeType!==9&&i.nodeType!==11&&(i.nodeType!==8||i.nodeValue!==" react-mount-point-unstable "))}function fx(){}function gP(i,a,c,f,y){if(y){if(typeof f=="function"){var w=f;f=function(){var Q=Lh(S);w.call(Q)}}var S=ux(a,f,i,0,null,!1,!1,"",fx);return i._reactRootContainer=S,i[Os]=S.current,$c(i.nodeType===8?i.parentNode:i),Ko(),S}for(;y=i.lastChild;)i.removeChild(y);if(typeof f=="function"){var M=f;f=function(){var Q=Lh(V);M.call(Q)}}var V=Ug(i,0,!1,null,null,!1,!1,"",fx);return i._reactRootContainer=V,i[Os]=V.current,$c(i.nodeType===8?i.parentNode:i),Ko(function(){Mh(a,V,c,f)}),V}function Fh(i,a,c,f,y){var w=c._reactRootContainer;if(w){var S=w;if(typeof y=="function"){var M=y;y=function(){var V=Lh(S);M.call(V)}}Mh(a,S,i,y)}else S=gP(c,a,i,y,f);return Lh(S)}Ac=function(i){switch(i.tag){case 3:var a=i.stateNode;if(a.current.memoizedState.isDehydrated){var c=ot(a.pendingLanes);c!==0&&(Rc(a,c|1),Mn(a,gt()),(rt&6)===0&&(fl=gt()+500,Ni()))}break;case 13:Ko(function(){var f=Vs(i,1);if(f!==null){var y=Sn();Rr(f,i,1,y)}}),zg(i,1)}},Va=function(i){if(i.tag===13){var a=Vs(i,134217728);if(a!==null){var c=Sn();Rr(a,i,134217728,c)}zg(i,134217728)}},kc=function(i){if(i.tag===13){var a=ji(i),c=Vs(i,a);if(c!==null){var f=Sn();Rr(c,i,a,f)}zg(i,a)}},Nc=function(){return Ze},Pc=function(i,a){var c=Ze;try{return Ze=i,a()}finally{Ze=c}},Cs=function(i,a,c){switch(a){case"input":if(ge(i,c),a=c.name,c.type==="radio"&&a!=null){for(c=i;c.parentNode;)c=c.parentNode;for(c=c.querySelectorAll("input[name="+JSON.stringify(""+a)+'][type="radio"]'),a=0;a<c.length;a++){var f=c[a];if(f!==i&&f.form===i.form){var y=nh(f);if(!y)throw Error(t(90));kn(f),ge(f,y)}}}break;case"textarea":bd(i,c);break;case"select":a=c.value,a!=null&&tn(i,!!c.multiple,a,!1)}},kd=Og,Nd=Ko;var yP={usingClientEntryPoint:!1,Events:[qc,el,nh,yi,_i,Og]},ou={findFiberByHostInstance:Uo,bundleType:0,version:"18.3.1",rendererPackageName:"react-dom"},_P={bundleType:ou.bundleType,version:ou.version,rendererPackageName:ou.rendererPackageName,rendererConfig:ou.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:G.ReactCurrentDispatcher,findHostInstanceByFiber:function(i){return i=Vd(i),i===null?null:i.stateNode},findFiberByHostInstance:ou.findFiberByHostInstance||mP,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.3.1-next-f1338f8080-20240426"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var Uh=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!Uh.isDisabled&&Uh.supportsFiber)try{No=Uh.inject(_P),Bn=Uh}catch{}}return Ln.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=yP,Ln.createPortal=function(i,a){var c=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!$g(a))throw Error(t(200));return pP(i,a,null,c)},Ln.createRoot=function(i,a){if(!$g(i))throw Error(t(299));var c=!1,f="",y=hx;return a!=null&&(a.unstable_strictMode===!0&&(c=!0),a.identifierPrefix!==void 0&&(f=a.identifierPrefix),a.onRecoverableError!==void 0&&(y=a.onRecoverableError)),a=Ug(i,1,!1,null,null,c,!1,f,y),i[Os]=a.current,$c(i.nodeType===8?i.parentNode:i),new Bg(a)},Ln.findDOMNode=function(i){if(i==null)return null;if(i.nodeType===1)return i;var a=i._reactInternals;if(a===void 0)throw typeof i.render=="function"?Error(t(188)):(i=Object.keys(i).join(","),Error(t(268,i)));return i=Vd(a),i=i===null?null:i.stateNode,i},Ln.flushSync=function(i){return Ko(i)},Ln.hydrate=function(i,a,c){if(!Vh(a))throw Error(t(200));return Fh(null,i,a,!0,c)},Ln.hydrateRoot=function(i,a,c){if(!$g(i))throw Error(t(405));var f=c!=null&&c.hydratedSources||null,y=!1,w="",S=hx;if(c!=null&&(c.unstable_strictMode===!0&&(y=!0),c.identifierPrefix!==void 0&&(w=c.identifierPrefix),c.onRecoverableError!==void 0&&(S=c.onRecoverableError)),a=ux(a,null,i,1,c??null,y,!1,w,S),i[Os]=a.current,$c(i),f)for(i=0;i<f.length;i++)c=f[i],y=c._getVersion,y=y(c._source),a.mutableSourceEagerHydrationData==null?a.mutableSourceEagerHydrationData=[c,y]:a.mutableSourceEagerHydrationData.push(c,y);return new jh(a)},Ln.render=function(i,a,c){if(!Vh(a))throw Error(t(200));return Fh(null,i,a,!1,c)},Ln.unmountComponentAtNode=function(i){if(!Vh(i))throw Error(t(40));return i._reactRootContainer?(Ko(function(){Fh(null,null,i,!1,function(){i._reactRootContainer=null,i[Os]=null})}),!0):!1},Ln.unstable_batchedUpdates=Og,Ln.unstable_renderSubtreeIntoContainer=function(i,a,c,f){if(!Vh(c))throw Error(t(200));if(i==null||i._reactInternals===void 0)throw Error(t(38));return Fh(i,a,c,!1,f)},Ln.version="18.3.1-next-f1338f8080-20240426",Ln}var Ex;function PS(){if(Ex)return qg.exports;Ex=1;function n(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(n)}catch(e){console.error(e)}}return n(),qg.exports=IP(),qg.exports}var xx;function bP(){if(xx)return zh;xx=1;var n=PS();return zh.createRoot=n.createRoot,zh.hydrateRoot=n.hydrateRoot,zh}var RP=bP(),C=gp();const $i=NS(C),DS=wP({__proto__:null,default:$i},[C]),AP=()=>{};var Tx={};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const OS={NODE_ADMIN:!1,SDK_VERSION:"${JSCORE_VERSION}"};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const le=function(n,e){if(!n)throw Zl(e)},Zl=function(n){return new Error("Firebase Database ("+OS.SDK_VERSION+") INTERNAL ASSERT FAILED: "+n)};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const MS=function(n){const e=[];let t=0;for(let r=0;r<n.length;r++){let s=n.charCodeAt(r);s<128?e[t++]=s:s<2048?(e[t++]=s>>6|192,e[t++]=s&63|128):(s&64512)===55296&&r+1<n.length&&(n.charCodeAt(r+1)&64512)===56320?(s=65536+((s&1023)<<10)+(n.charCodeAt(++r)&1023),e[t++]=s>>18|240,e[t++]=s>>12&63|128,e[t++]=s>>6&63|128,e[t++]=s&63|128):(e[t++]=s>>12|224,e[t++]=s>>6&63|128,e[t++]=s&63|128)}return e},kP=function(n){const e=[];let t=0,r=0;for(;t<n.length;){const s=n[t++];if(s<128)e[r++]=String.fromCharCode(s);else if(s>191&&s<224){const o=n[t++];e[r++]=String.fromCharCode((s&31)<<6|o&63)}else if(s>239&&s<365){const o=n[t++],l=n[t++],u=n[t++],h=((s&7)<<18|(o&63)<<12|(l&63)<<6|u&63)-65536;e[r++]=String.fromCharCode(55296+(h>>10)),e[r++]=String.fromCharCode(56320+(h&1023))}else{const o=n[t++],l=n[t++];e[r++]=String.fromCharCode((s&15)<<12|(o&63)<<6|l&63)}}return e.join("")},D_={byteToCharMap_:null,charToByteMap_:null,byteToCharMapWebSafe_:null,charToByteMapWebSafe_:null,ENCODED_VALS_BASE:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",get ENCODED_VALS(){return this.ENCODED_VALS_BASE+"+/="},get ENCODED_VALS_WEBSAFE(){return this.ENCODED_VALS_BASE+"-_."},HAS_NATIVE_SUPPORT:typeof atob=="function",encodeByteArray(n,e){if(!Array.isArray(n))throw Error("encodeByteArray takes an array as a parameter");this.init_();const t=e?this.byteToCharMapWebSafe_:this.byteToCharMap_,r=[];for(let s=0;s<n.length;s+=3){const o=n[s],l=s+1<n.length,u=l?n[s+1]:0,h=s+2<n.length,p=h?n[s+2]:0,g=o>>2,_=(o&3)<<4|u>>4;let v=(u&15)<<2|p>>6,T=p&63;h||(T=64,l||(v=64)),r.push(t[g],t[_],t[v],t[T])}return r.join("")},encodeString(n,e){return this.HAS_NATIVE_SUPPORT&&!e?btoa(n):this.encodeByteArray(MS(n),e)},decodeString(n,e){return this.HAS_NATIVE_SUPPORT&&!e?atob(n):kP(this.decodeStringToByteArray(n,e))},decodeStringToByteArray(n,e){this.init_();const t=e?this.charToByteMapWebSafe_:this.charToByteMap_,r=[];for(let s=0;s<n.length;){const o=t[n.charAt(s++)],u=s<n.length?t[n.charAt(s)]:0;++s;const p=s<n.length?t[n.charAt(s)]:64;++s;const _=s<n.length?t[n.charAt(s)]:64;if(++s,o==null||u==null||p==null||_==null)throw new NP;const v=o<<2|u>>4;if(r.push(v),p!==64){const T=u<<4&240|p>>2;if(r.push(T),_!==64){const A=p<<6&192|_;r.push(A)}}}return r},init_(){if(!this.byteToCharMap_){this.byteToCharMap_={},this.charToByteMap_={},this.byteToCharMapWebSafe_={},this.charToByteMapWebSafe_={};for(let n=0;n<this.ENCODED_VALS.length;n++)this.byteToCharMap_[n]=this.ENCODED_VALS.charAt(n),this.charToByteMap_[this.byteToCharMap_[n]]=n,this.byteToCharMapWebSafe_[n]=this.ENCODED_VALS_WEBSAFE.charAt(n),this.charToByteMapWebSafe_[this.byteToCharMapWebSafe_[n]]=n,n>=this.ENCODED_VALS_BASE.length&&(this.charToByteMap_[this.ENCODED_VALS_WEBSAFE.charAt(n)]=n,this.charToByteMapWebSafe_[this.ENCODED_VALS.charAt(n)]=n)}}};class NP extends Error{constructor(){super(...arguments),this.name="DecodeBase64StringError"}}const LS=function(n){const e=MS(n);return D_.encodeByteArray(e,!0)},xf=function(n){return LS(n).replace(/\./g,"")},Tf=function(n){try{return D_.decodeString(n,!0)}catch(e){console.error("base64Decode failed: ",e)}return null};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function PP(n){return jS(void 0,n)}function jS(n,e){if(!(e instanceof Object))return e;switch(e.constructor){case Date:const t=e;return new Date(t.getTime());case Object:n===void 0&&(n={});break;case Array:n=[];break;default:return e}for(const t in e)!e.hasOwnProperty(t)||!DP(t)||(n[t]=jS(n[t],e[t]));return n}function DP(n){return n!=="__proto__"}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function OP(){if(typeof self<"u")return self;if(typeof window<"u")return window;if(typeof global<"u")return global;throw new Error("Unable to locate global object.")}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const MP=()=>OP().__FIREBASE_DEFAULTS__,LP=()=>{if(typeof process>"u"||typeof Tx>"u")return;const n=Tx.__FIREBASE_DEFAULTS__;if(n)return JSON.parse(n)},jP=()=>{if(typeof document>"u")return;let n;try{n=document.cookie.match(/__FIREBASE_DEFAULTS__=([^;]+)/)}catch{return}const e=n&&Tf(n[1]);return e&&JSON.parse(e)},yp=()=>{try{return AP()||MP()||LP()||jP()}catch(n){console.info(`Unable to get __FIREBASE_DEFAULTS__ due to: ${n}`);return}},VS=n=>yp()?.emulatorHosts?.[n],O_=n=>{const e=VS(n);if(!e)return;const t=e.lastIndexOf(":");if(t<=0||t+1===e.length)throw new Error(`Invalid host ${e} with no separate hostname and port!`);const r=parseInt(e.substring(t+1),10);return e[0]==="["?[e.substring(1,t-1),r]:[e.substring(0,t),r]},FS=()=>yp()?.config,US=n=>yp()?.[`_${n}`];/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Hs{constructor(){this.reject=()=>{},this.resolve=()=>{},this.promise=new Promise((e,t)=>{this.resolve=e,this.reject=t})}wrapCallback(e){return(t,r)=>{t?this.reject(t):this.resolve(r),typeof e=="function"&&(this.promise.catch(()=>{}),e.length===1?e(t):e(t,r))}}}/**
 * @license
 * Copyright 2025 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function vs(n){try{return(n.startsWith("http://")||n.startsWith("https://")?new URL(n).hostname:n).endsWith(".cloudworkstations.dev")}catch{return!1}}async function _p(n){return(await fetch(n,{credentials:"include"})).ok}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function M_(n,e){if(n.uid)throw new Error('The "uid" field is no longer supported by mockUserToken. Please use "sub" instead for Firebase Auth User ID.');const t={alg:"none",type:"JWT"},r=e||"demo-project",s=n.iat||0,o=n.sub||n.user_id;if(!o)throw new Error("mockUserToken must contain 'sub' or 'user_id' field!");const l={iss:`https://securetoken.google.com/${r}`,aud:r,iat:s,exp:s+3600,auth_time:s,sub:o,user_id:o,firebase:{sign_in_provider:"custom",identities:{}},...n};return[xf(JSON.stringify(t)),xf(JSON.stringify(l)),""].join(".")}const xu={};function VP(){const n={prod:[],emulator:[]};for(const e of Object.keys(xu))xu[e]?n.emulator.push(e):n.prod.push(e);return n}function FP(n){let e=document.getElementById(n),t=!1;return e||(e=document.createElement("div"),e.setAttribute("id",n),t=!0),{created:t,element:e}}let Cx=!1;function vp(n,e){if(typeof window>"u"||typeof document>"u"||!vs(window.location.host)||xu[n]===e||xu[n]||Cx)return;xu[n]=e;function t(v){return`__firebase__banner__${v}`}const r="__firebase__banner",o=VP().prod.length>0;function l(){const v=document.getElementById(r);v&&v.remove()}function u(v){v.style.display="flex",v.style.background="#7faaf0",v.style.position="fixed",v.style.bottom="5px",v.style.left="5px",v.style.padding=".5em",v.style.borderRadius="5px",v.style.alignItems="center"}function h(v,T){v.setAttribute("width","24"),v.setAttribute("id",T),v.setAttribute("height","24"),v.setAttribute("viewBox","0 0 24 24"),v.setAttribute("fill","none"),v.style.marginLeft="-6px"}function p(){const v=document.createElement("span");return v.style.cursor="pointer",v.style.marginLeft="16px",v.style.fontSize="24px",v.innerHTML=" &times;",v.onclick=()=>{Cx=!0,l()},v}function g(v,T){v.setAttribute("id",T),v.innerText="Learn more",v.href="https://firebase.google.com/docs/studio/preview-apps#preview-backend",v.setAttribute("target","__blank"),v.style.paddingLeft="5px",v.style.textDecoration="underline"}function _(){const v=FP(r),T=t("text"),A=document.getElementById(T)||document.createElement("span"),I=t("learnmore"),b=document.getElementById(I)||document.createElement("a"),j=t("preprendIcon"),U=document.getElementById(j)||document.createElementNS("http://www.w3.org/2000/svg","svg");if(v.created){const $=v.element;u($),g(b,I);const G=p();h(U,j),$.append(U,A,b,G),document.body.appendChild($)}o?(A.innerText="Preview backend disconnected.",U.innerHTML=`<g clip-path="url(#clip0_6013_33858)">
<path d="M4.8 17.6L12 5.6L19.2 17.6H4.8ZM6.91667 16.4H17.0833L12 7.93333L6.91667 16.4ZM12 15.6C12.1667 15.6 12.3056 15.5444 12.4167 15.4333C12.5389 15.3111 12.6 15.1667 12.6 15C12.6 14.8333 12.5389 14.6944 12.4167 14.5833C12.3056 14.4611 12.1667 14.4 12 14.4C11.8333 14.4 11.6889 14.4611 11.5667 14.5833C11.4556 14.6944 11.4 14.8333 11.4 15C11.4 15.1667 11.4556 15.3111 11.5667 15.4333C11.6889 15.5444 11.8333 15.6 12 15.6ZM11.4 13.6H12.6V10.4H11.4V13.6Z" fill="#212121"/>
</g>
<defs>
<clipPath id="clip0_6013_33858">
<rect width="24" height="24" fill="white"/>
</clipPath>
</defs>`):(U.innerHTML=`<g clip-path="url(#clip0_6083_34804)">
<path d="M11.4 15.2H12.6V11.2H11.4V15.2ZM12 10C12.1667 10 12.3056 9.94444 12.4167 9.83333C12.5389 9.71111 12.6 9.56667 12.6 9.4C12.6 9.23333 12.5389 9.09444 12.4167 8.98333C12.3056 8.86111 12.1667 8.8 12 8.8C11.8333 8.8 11.6889 8.86111 11.5667 8.98333C11.4556 9.09444 11.4 9.23333 11.4 9.4C11.4 9.56667 11.4556 9.71111 11.5667 9.83333C11.6889 9.94444 11.8333 10 12 10ZM12 18.4C11.1222 18.4 10.2944 18.2333 9.51667 17.9C8.73889 17.5667 8.05556 17.1111 7.46667 16.5333C6.88889 15.9444 6.43333 15.2611 6.1 14.4833C5.76667 13.7056 5.6 12.8778 5.6 12C5.6 11.1111 5.76667 10.2833 6.1 9.51667C6.43333 8.73889 6.88889 8.06111 7.46667 7.48333C8.05556 6.89444 8.73889 6.43333 9.51667 6.1C10.2944 5.76667 11.1222 5.6 12 5.6C12.8889 5.6 13.7167 5.76667 14.4833 6.1C15.2611 6.43333 15.9389 6.89444 16.5167 7.48333C17.1056 8.06111 17.5667 8.73889 17.9 9.51667C18.2333 10.2833 18.4 11.1111 18.4 12C18.4 12.8778 18.2333 13.7056 17.9 14.4833C17.5667 15.2611 17.1056 15.9444 16.5167 16.5333C15.9389 17.1111 15.2611 17.5667 14.4833 17.9C13.7167 18.2333 12.8889 18.4 12 18.4ZM12 17.2C13.4444 17.2 14.6722 16.6944 15.6833 15.6833C16.6944 14.6722 17.2 13.4444 17.2 12C17.2 10.5556 16.6944 9.32778 15.6833 8.31667C14.6722 7.30555 13.4444 6.8 12 6.8C10.5556 6.8 9.32778 7.30555 8.31667 8.31667C7.30556 9.32778 6.8 10.5556 6.8 12C6.8 13.4444 7.30556 14.6722 8.31667 15.6833C9.32778 16.6944 10.5556 17.2 12 17.2Z" fill="#212121"/>
</g>
<defs>
<clipPath id="clip0_6083_34804">
<rect width="24" height="24" fill="white"/>
</clipPath>
</defs>`,A.innerText="Preview backend running in this workspace."),A.setAttribute("id",T)}document.readyState==="loading"?window.addEventListener("DOMContentLoaded",_):_()}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function En(){return typeof navigator<"u"&&typeof navigator.userAgent=="string"?navigator.userAgent:""}function L_(){return typeof window<"u"&&!!(window.cordova||window.phonegap||window.PhoneGap)&&/ios|iphone|ipod|ipad|android|blackberry|iemobile/i.test(En())}function UP(){const n=yp()?.forceEnvironment;if(n==="node")return!0;if(n==="browser")return!1;try{return Object.prototype.toString.call(global.process)==="[object process]"}catch{return!1}}function zP(){return typeof navigator<"u"&&navigator.userAgent==="Cloudflare-Workers"}function BP(){const n=typeof chrome=="object"?chrome.runtime:typeof browser=="object"?browser.runtime:void 0;return typeof n=="object"&&n.id!==void 0}function zS(){return typeof navigator=="object"&&navigator.product==="ReactNative"}function $P(){const n=En();return n.indexOf("MSIE ")>=0||n.indexOf("Trident/")>=0}function WP(){return OS.NODE_ADMIN===!0}function HP(){return!UP()&&!!navigator.userAgent&&navigator.userAgent.includes("Safari")&&!navigator.userAgent.includes("Chrome")}function qP(){try{return typeof indexedDB=="object"}catch{return!1}}function GP(){return new Promise((n,e)=>{try{let t=!0;const r="validate-browser-context-for-indexeddb-analytics-module",s=self.indexedDB.open(r);s.onsuccess=()=>{s.result.close(),t||self.indexedDB.deleteDatabase(r),n(!0)},s.onupgradeneeded=()=>{t=!1},s.onerror=()=>{e(s.error?.message||"")}}catch(t){e(t)}})}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const KP="FirebaseError";class ws extends Error{constructor(e,t,r){super(t),this.code=e,this.customData=r,this.name=KP,Object.setPrototypeOf(this,ws.prototype),Error.captureStackTrace&&Error.captureStackTrace(this,id.prototype.create)}}class id{constructor(e,t,r){this.service=e,this.serviceName=t,this.errors=r}create(e,...t){const r=t[0]||{},s=`${this.service}/${e}`,o=this.errors[e],l=o?QP(o,r):"Error",u=`${this.serviceName}: ${l} (${s}).`;return new ws(s,u,r)}}function QP(n,e){return n.replace(YP,(t,r)=>{const s=e[r];return s!=null?String(s):`<${r}?>`})}const YP=/\{\$([^}]+)}/g;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Mu(n){return JSON.parse(n)}function en(n){return JSON.stringify(n)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const BS=function(n){let e={},t={},r={},s="";try{const o=n.split(".");e=Mu(Tf(o[0])||""),t=Mu(Tf(o[1])||""),s=o[2],r=t.d||{},delete t.d}catch{}return{header:e,claims:t,data:r,signature:s}},XP=function(n){const e=BS(n),t=e.claims;return!!t&&typeof t=="object"&&t.hasOwnProperty("iat")},JP=function(n){const e=BS(n).claims;return typeof e=="object"&&e.admin===!0};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Es(n,e){return Object.prototype.hasOwnProperty.call(n,e)}function Ll(n,e){if(Object.prototype.hasOwnProperty.call(n,e))return n[e]}function Cf(n){for(const e in n)if(Object.prototype.hasOwnProperty.call(n,e))return!1;return!0}function Sf(n,e,t){const r={};for(const s in n)Object.prototype.hasOwnProperty.call(n,s)&&(r[s]=e.call(t,n[s],s,n));return r}function io(n,e){if(n===e)return!0;const t=Object.keys(n),r=Object.keys(e);for(const s of t){if(!r.includes(s))return!1;const o=n[s],l=e[s];if(Sx(o)&&Sx(l)){if(!io(o,l))return!1}else if(o!==l)return!1}for(const s of r)if(!t.includes(s))return!1;return!0}function Sx(n){return n!==null&&typeof n=="object"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function ec(n){const e=[];for(const[t,r]of Object.entries(n))Array.isArray(r)?r.forEach(s=>{e.push(encodeURIComponent(t)+"="+encodeURIComponent(s))}):e.push(encodeURIComponent(t)+"="+encodeURIComponent(r));return e.length?"&"+e.join("&"):""}function pu(n){const e={};return n.replace(/^\?/,"").split("&").forEach(r=>{if(r){const[s,o]=r.split("=");e[decodeURIComponent(s)]=decodeURIComponent(o)}}),e}function mu(n){const e=n.indexOf("?");if(!e)return"";const t=n.indexOf("#",e);return n.substring(e,t>0?t:void 0)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ZP{constructor(){this.chain_=[],this.buf_=[],this.W_=[],this.pad_=[],this.inbuf_=0,this.total_=0,this.blockSize=512/8,this.pad_[0]=128;for(let e=1;e<this.blockSize;++e)this.pad_[e]=0;this.reset()}reset(){this.chain_[0]=1732584193,this.chain_[1]=4023233417,this.chain_[2]=2562383102,this.chain_[3]=271733878,this.chain_[4]=3285377520,this.inbuf_=0,this.total_=0}compress_(e,t){t||(t=0);const r=this.W_;if(typeof e=="string")for(let _=0;_<16;_++)r[_]=e.charCodeAt(t)<<24|e.charCodeAt(t+1)<<16|e.charCodeAt(t+2)<<8|e.charCodeAt(t+3),t+=4;else for(let _=0;_<16;_++)r[_]=e[t]<<24|e[t+1]<<16|e[t+2]<<8|e[t+3],t+=4;for(let _=16;_<80;_++){const v=r[_-3]^r[_-8]^r[_-14]^r[_-16];r[_]=(v<<1|v>>>31)&4294967295}let s=this.chain_[0],o=this.chain_[1],l=this.chain_[2],u=this.chain_[3],h=this.chain_[4],p,g;for(let _=0;_<80;_++){_<40?_<20?(p=u^o&(l^u),g=1518500249):(p=o^l^u,g=1859775393):_<60?(p=o&l|u&(o|l),g=2400959708):(p=o^l^u,g=3395469782);const v=(s<<5|s>>>27)+p+h+g+r[_]&4294967295;h=u,u=l,l=(o<<30|o>>>2)&4294967295,o=s,s=v}this.chain_[0]=this.chain_[0]+s&4294967295,this.chain_[1]=this.chain_[1]+o&4294967295,this.chain_[2]=this.chain_[2]+l&4294967295,this.chain_[3]=this.chain_[3]+u&4294967295,this.chain_[4]=this.chain_[4]+h&4294967295}update(e,t){if(e==null)return;t===void 0&&(t=e.length);const r=t-this.blockSize;let s=0;const o=this.buf_;let l=this.inbuf_;for(;s<t;){if(l===0)for(;s<=r;)this.compress_(e,s),s+=this.blockSize;if(typeof e=="string"){for(;s<t;)if(o[l]=e.charCodeAt(s),++l,++s,l===this.blockSize){this.compress_(o),l=0;break}}else for(;s<t;)if(o[l]=e[s],++l,++s,l===this.blockSize){this.compress_(o),l=0;break}}this.inbuf_=l,this.total_+=t}digest(){const e=[];let t=this.total_*8;this.inbuf_<56?this.update(this.pad_,56-this.inbuf_):this.update(this.pad_,this.blockSize-(this.inbuf_-56));for(let s=this.blockSize-1;s>=56;s--)this.buf_[s]=t&255,t/=256;this.compress_(this.buf_);let r=0;for(let s=0;s<5;s++)for(let o=24;o>=0;o-=8)e[r]=this.chain_[s]>>o&255,++r;return e}}function eD(n,e){const t=new tD(n,e);return t.subscribe.bind(t)}class tD{constructor(e,t){this.observers=[],this.unsubscribes=[],this.observerCount=0,this.task=Promise.resolve(),this.finalized=!1,this.onNoObservers=t,this.task.then(()=>{e(this)}).catch(r=>{this.error(r)})}next(e){this.forEachObserver(t=>{t.next(e)})}error(e){this.forEachObserver(t=>{t.error(e)}),this.close(e)}complete(){this.forEachObserver(e=>{e.complete()}),this.close()}subscribe(e,t,r){let s;if(e===void 0&&t===void 0&&r===void 0)throw new Error("Missing Observer.");nD(e,["next","error","complete"])?s=e:s={next:e,error:t,complete:r},s.next===void 0&&(s.next=Qg),s.error===void 0&&(s.error=Qg),s.complete===void 0&&(s.complete=Qg);const o=this.unsubscribeOne.bind(this,this.observers.length);return this.finalized&&this.task.then(()=>{try{this.finalError?s.error(this.finalError):s.complete()}catch{}}),this.observers.push(s),o}unsubscribeOne(e){this.observers===void 0||this.observers[e]===void 0||(delete this.observers[e],this.observerCount-=1,this.observerCount===0&&this.onNoObservers!==void 0&&this.onNoObservers(this))}forEachObserver(e){if(!this.finalized)for(let t=0;t<this.observers.length;t++)this.sendOne(t,e)}sendOne(e,t){this.task.then(()=>{if(this.observers!==void 0&&this.observers[e]!==void 0)try{t(this.observers[e])}catch(r){typeof console<"u"&&console.error&&console.error(r)}})}close(e){this.finalized||(this.finalized=!0,e!==void 0&&(this.finalError=e),this.task.then(()=>{this.observers=void 0,this.onNoObservers=void 0}))}}function nD(n,e){if(typeof n!="object"||n===null)return!1;for(const t of e)if(t in n&&typeof n[t]=="function")return!0;return!1}function Qg(){}function jl(n,e){return`${n} failed: ${e} argument `}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const rD=function(n){const e=[];let t=0;for(let r=0;r<n.length;r++){let s=n.charCodeAt(r);if(s>=55296&&s<=56319){const o=s-55296;r++,le(r<n.length,"Surrogate pair missing trail surrogate.");const l=n.charCodeAt(r)-56320;s=65536+(o<<10)+l}s<128?e[t++]=s:s<2048?(e[t++]=s>>6|192,e[t++]=s&63|128):s<65536?(e[t++]=s>>12|224,e[t++]=s>>6&63|128,e[t++]=s&63|128):(e[t++]=s>>18|240,e[t++]=s>>12&63|128,e[t++]=s>>6&63|128,e[t++]=s&63|128)}return e},wp=function(n){let e=0;for(let t=0;t<n.length;t++){const r=n.charCodeAt(t);r<128?e++:r<2048?e+=2:r>=55296&&r<=56319?(e+=4,t++):e+=3}return e};/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function ut(n){return n&&n._delegate?n._delegate:n}class Xs{constructor(e,t,r){this.name=e,this.instanceFactory=t,this.type=r,this.multipleInstances=!1,this.serviceProps={},this.instantiationMode="LAZY",this.onInstanceCreated=null}setInstantiationMode(e){return this.instantiationMode=e,this}setMultipleInstances(e){return this.multipleInstances=e,this}setServiceProps(e){return this.serviceProps=e,this}setInstanceCreatedCallback(e){return this.onInstanceCreated=e,this}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Zo="[DEFAULT]";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class sD{constructor(e,t){this.name=e,this.container=t,this.component=null,this.instances=new Map,this.instancesDeferred=new Map,this.instancesOptions=new Map,this.onInitCallbacks=new Map}get(e){const t=this.normalizeInstanceIdentifier(e);if(!this.instancesDeferred.has(t)){const r=new Hs;if(this.instancesDeferred.set(t,r),this.isInitialized(t)||this.shouldAutoInitialize())try{const s=this.getOrInitializeService({instanceIdentifier:t});s&&r.resolve(s)}catch{}}return this.instancesDeferred.get(t).promise}getImmediate(e){const t=this.normalizeInstanceIdentifier(e?.identifier),r=e?.optional??!1;if(this.isInitialized(t)||this.shouldAutoInitialize())try{return this.getOrInitializeService({instanceIdentifier:t})}catch(s){if(r)return null;throw s}else{if(r)return null;throw Error(`Service ${this.name} is not available`)}}getComponent(){return this.component}setComponent(e){if(e.name!==this.name)throw Error(`Mismatching Component ${e.name} for Provider ${this.name}.`);if(this.component)throw Error(`Component for ${this.name} has already been provided`);if(this.component=e,!!this.shouldAutoInitialize()){if(oD(e))try{this.getOrInitializeService({instanceIdentifier:Zo})}catch{}for(const[t,r]of this.instancesDeferred.entries()){const s=this.normalizeInstanceIdentifier(t);try{const o=this.getOrInitializeService({instanceIdentifier:s});r.resolve(o)}catch{}}}}clearInstance(e=Zo){this.instancesDeferred.delete(e),this.instancesOptions.delete(e),this.instances.delete(e)}async delete(){const e=Array.from(this.instances.values());await Promise.all([...e.filter(t=>"INTERNAL"in t).map(t=>t.INTERNAL.delete()),...e.filter(t=>"_delete"in t).map(t=>t._delete())])}isComponentSet(){return this.component!=null}isInitialized(e=Zo){return this.instances.has(e)}getOptions(e=Zo){return this.instancesOptions.get(e)||{}}initialize(e={}){const{options:t={}}=e,r=this.normalizeInstanceIdentifier(e.instanceIdentifier);if(this.isInitialized(r))throw Error(`${this.name}(${r}) has already been initialized`);if(!this.isComponentSet())throw Error(`Component ${this.name} has not been registered yet`);const s=this.getOrInitializeService({instanceIdentifier:r,options:t});for(const[o,l]of this.instancesDeferred.entries()){const u=this.normalizeInstanceIdentifier(o);r===u&&l.resolve(s)}return s}onInit(e,t){const r=this.normalizeInstanceIdentifier(t),s=this.onInitCallbacks.get(r)??new Set;s.add(e),this.onInitCallbacks.set(r,s);const o=this.instances.get(r);return o&&e(o,r),()=>{s.delete(e)}}invokeOnInitCallbacks(e,t){const r=this.onInitCallbacks.get(t);if(r)for(const s of r)try{s(e,t)}catch{}}getOrInitializeService({instanceIdentifier:e,options:t={}}){let r=this.instances.get(e);if(!r&&this.component&&(r=this.component.instanceFactory(this.container,{instanceIdentifier:iD(e),options:t}),this.instances.set(e,r),this.instancesOptions.set(e,t),this.invokeOnInitCallbacks(r,e),this.component.onInstanceCreated))try{this.component.onInstanceCreated(this.container,e,r)}catch{}return r||null}normalizeInstanceIdentifier(e=Zo){return this.component?this.component.multipleInstances?e:Zo:e}shouldAutoInitialize(){return!!this.component&&this.component.instantiationMode!=="EXPLICIT"}}function iD(n){return n===Zo?void 0:n}function oD(n){return n.instantiationMode==="EAGER"}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class aD{constructor(e){this.name=e,this.providers=new Map}addComponent(e){const t=this.getProvider(e.name);if(t.isComponentSet())throw new Error(`Component ${e.name} has already been registered with ${this.name}`);t.setComponent(e)}addOrOverwriteComponent(e){this.getProvider(e.name).isComponentSet()&&this.providers.delete(e.name),this.addComponent(e)}getProvider(e){if(this.providers.has(e))return this.providers.get(e);const t=new sD(e,this);return this.providers.set(e,t),t}getProviders(){return Array.from(this.providers.values())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var Qe;(function(n){n[n.DEBUG=0]="DEBUG",n[n.VERBOSE=1]="VERBOSE",n[n.INFO=2]="INFO",n[n.WARN=3]="WARN",n[n.ERROR=4]="ERROR",n[n.SILENT=5]="SILENT"})(Qe||(Qe={}));const lD={debug:Qe.DEBUG,verbose:Qe.VERBOSE,info:Qe.INFO,warn:Qe.WARN,error:Qe.ERROR,silent:Qe.SILENT},cD=Qe.INFO,uD={[Qe.DEBUG]:"log",[Qe.VERBOSE]:"log",[Qe.INFO]:"info",[Qe.WARN]:"warn",[Qe.ERROR]:"error"},dD=(n,e,...t)=>{if(e<n.logLevel)return;const r=new Date().toISOString(),s=uD[e];if(s)console[s](`[${r}]  ${n.name}:`,...t);else throw new Error(`Attempted to log a message with an invalid logType (value: ${e})`)};class Ep{constructor(e){this.name=e,this._logLevel=cD,this._logHandler=dD,this._userLogHandler=null}get logLevel(){return this._logLevel}set logLevel(e){if(!(e in Qe))throw new TypeError(`Invalid value "${e}" assigned to \`logLevel\``);this._logLevel=e}setLogLevel(e){this._logLevel=typeof e=="string"?lD[e]:e}get logHandler(){return this._logHandler}set logHandler(e){if(typeof e!="function")throw new TypeError("Value assigned to `logHandler` must be a function");this._logHandler=e}get userLogHandler(){return this._userLogHandler}set userLogHandler(e){this._userLogHandler=e}debug(...e){this._userLogHandler&&this._userLogHandler(this,Qe.DEBUG,...e),this._logHandler(this,Qe.DEBUG,...e)}log(...e){this._userLogHandler&&this._userLogHandler(this,Qe.VERBOSE,...e),this._logHandler(this,Qe.VERBOSE,...e)}info(...e){this._userLogHandler&&this._userLogHandler(this,Qe.INFO,...e),this._logHandler(this,Qe.INFO,...e)}warn(...e){this._userLogHandler&&this._userLogHandler(this,Qe.WARN,...e),this._logHandler(this,Qe.WARN,...e)}error(...e){this._userLogHandler&&this._userLogHandler(this,Qe.ERROR,...e),this._logHandler(this,Qe.ERROR,...e)}}const hD=(n,e)=>e.some(t=>n instanceof t);let Ix,bx;function fD(){return Ix||(Ix=[IDBDatabase,IDBObjectStore,IDBIndex,IDBCursor,IDBTransaction])}function pD(){return bx||(bx=[IDBCursor.prototype.advance,IDBCursor.prototype.continue,IDBCursor.prototype.continuePrimaryKey])}const $S=new WeakMap,ky=new WeakMap,WS=new WeakMap,Yg=new WeakMap,j_=new WeakMap;function mD(n){const e=new Promise((t,r)=>{const s=()=>{n.removeEventListener("success",o),n.removeEventListener("error",l)},o=()=>{t(Xi(n.result)),s()},l=()=>{r(n.error),s()};n.addEventListener("success",o),n.addEventListener("error",l)});return e.then(t=>{t instanceof IDBCursor&&$S.set(t,n)}).catch(()=>{}),j_.set(e,n),e}function gD(n){if(ky.has(n))return;const e=new Promise((t,r)=>{const s=()=>{n.removeEventListener("complete",o),n.removeEventListener("error",l),n.removeEventListener("abort",l)},o=()=>{t(),s()},l=()=>{r(n.error||new DOMException("AbortError","AbortError")),s()};n.addEventListener("complete",o),n.addEventListener("error",l),n.addEventListener("abort",l)});ky.set(n,e)}let Ny={get(n,e,t){if(n instanceof IDBTransaction){if(e==="done")return ky.get(n);if(e==="objectStoreNames")return n.objectStoreNames||WS.get(n);if(e==="store")return t.objectStoreNames[1]?void 0:t.objectStore(t.objectStoreNames[0])}return Xi(n[e])},set(n,e,t){return n[e]=t,!0},has(n,e){return n instanceof IDBTransaction&&(e==="done"||e==="store")?!0:e in n}};function yD(n){Ny=n(Ny)}function _D(n){return n===IDBDatabase.prototype.transaction&&!("objectStoreNames"in IDBTransaction.prototype)?function(e,...t){const r=n.call(Xg(this),e,...t);return WS.set(r,e.sort?e.sort():[e]),Xi(r)}:pD().includes(n)?function(...e){return n.apply(Xg(this),e),Xi($S.get(this))}:function(...e){return Xi(n.apply(Xg(this),e))}}function vD(n){return typeof n=="function"?_D(n):(n instanceof IDBTransaction&&gD(n),hD(n,fD())?new Proxy(n,Ny):n)}function Xi(n){if(n instanceof IDBRequest)return mD(n);if(Yg.has(n))return Yg.get(n);const e=vD(n);return e!==n&&(Yg.set(n,e),j_.set(e,n)),e}const Xg=n=>j_.get(n);function wD(n,e,{blocked:t,upgrade:r,blocking:s,terminated:o}={}){const l=indexedDB.open(n,e),u=Xi(l);return r&&l.addEventListener("upgradeneeded",h=>{r(Xi(l.result),h.oldVersion,h.newVersion,Xi(l.transaction),h)}),t&&l.addEventListener("blocked",h=>t(h.oldVersion,h.newVersion,h)),u.then(h=>{o&&h.addEventListener("close",()=>o()),s&&h.addEventListener("versionchange",p=>s(p.oldVersion,p.newVersion,p))}).catch(()=>{}),u}const ED=["get","getKey","getAll","getAllKeys","count"],xD=["put","add","delete","clear"],Jg=new Map;function Rx(n,e){if(!(n instanceof IDBDatabase&&!(e in n)&&typeof e=="string"))return;if(Jg.get(e))return Jg.get(e);const t=e.replace(/FromIndex$/,""),r=e!==t,s=xD.includes(t);if(!(t in(r?IDBIndex:IDBObjectStore).prototype)||!(s||ED.includes(t)))return;const o=async function(l,...u){const h=this.transaction(l,s?"readwrite":"readonly");let p=h.store;return r&&(p=p.index(u.shift())),(await Promise.all([p[t](...u),s&&h.done]))[0]};return Jg.set(e,o),o}yD(n=>({...n,get:(e,t,r)=>Rx(e,t)||n.get(e,t,r),has:(e,t)=>!!Rx(e,t)||n.has(e,t)}));/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class TD{constructor(e){this.container=e}getPlatformInfoString(){return this.container.getProviders().map(t=>{if(CD(t)){const r=t.getImmediate();return`${r.library}/${r.version}`}else return null}).filter(t=>t).join(" ")}}function CD(n){return n.getComponent()?.type==="VERSION"}const Py="@firebase/app",Ax="0.14.3";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Js=new Ep("@firebase/app"),SD="@firebase/app-compat",ID="@firebase/analytics-compat",bD="@firebase/analytics",RD="@firebase/app-check-compat",AD="@firebase/app-check",kD="@firebase/auth",ND="@firebase/auth-compat",PD="@firebase/database",DD="@firebase/data-connect",OD="@firebase/database-compat",MD="@firebase/functions",LD="@firebase/functions-compat",jD="@firebase/installations",VD="@firebase/installations-compat",FD="@firebase/messaging",UD="@firebase/messaging-compat",zD="@firebase/performance",BD="@firebase/performance-compat",$D="@firebase/remote-config",WD="@firebase/remote-config-compat",HD="@firebase/storage",qD="@firebase/storage-compat",GD="@firebase/firestore",KD="@firebase/ai",QD="@firebase/firestore-compat",YD="firebase",XD="12.3.0";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Dy="[DEFAULT]",JD={[Py]:"fire-core",[SD]:"fire-core-compat",[bD]:"fire-analytics",[ID]:"fire-analytics-compat",[AD]:"fire-app-check",[RD]:"fire-app-check-compat",[kD]:"fire-auth",[ND]:"fire-auth-compat",[PD]:"fire-rtdb",[DD]:"fire-data-connect",[OD]:"fire-rtdb-compat",[MD]:"fire-fn",[LD]:"fire-fn-compat",[jD]:"fire-iid",[VD]:"fire-iid-compat",[FD]:"fire-fcm",[UD]:"fire-fcm-compat",[zD]:"fire-perf",[BD]:"fire-perf-compat",[$D]:"fire-rc",[WD]:"fire-rc-compat",[HD]:"fire-gcs",[qD]:"fire-gcs-compat",[GD]:"fire-fst",[QD]:"fire-fst-compat",[KD]:"fire-vertex","fire-js":"fire-js",[YD]:"fire-js-all"};/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const If=new Map,ZD=new Map,Oy=new Map;function kx(n,e){try{n.container.addComponent(e)}catch(t){Js.debug(`Component ${e.name} failed to register with FirebaseApp ${n.name}`,t)}}function oo(n){const e=n.name;if(Oy.has(e))return Js.debug(`There were multiple attempts to register component ${e}.`),!1;Oy.set(e,n);for(const t of If.values())kx(t,n);for(const t of ZD.values())kx(t,n);return!0}function od(n,e){const t=n.container.getProvider("heartbeat").getImmediate({optional:!0});return t&&t.triggerHeartbeat(),n.container.getProvider(e)}function bn(n){return n==null?!1:n.settings!==void 0}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const e2={"no-app":"No Firebase App '{$appName}' has been created - call initializeApp() first","bad-app-name":"Illegal App name: '{$appName}'","duplicate-app":"Firebase App named '{$appName}' already exists with different options or config","app-deleted":"Firebase App named '{$appName}' already deleted","server-app-deleted":"Firebase Server App has been deleted","no-options":"Need to provide options, when not being deployed to hosting via source.","invalid-app-argument":"firebase.{$appName}() takes either no argument or a Firebase App instance.","invalid-log-argument":"First argument to `onLog` must be null or a function.","idb-open":"Error thrown when opening IndexedDB. Original error: {$originalErrorMessage}.","idb-get":"Error thrown when reading from IndexedDB. Original error: {$originalErrorMessage}.","idb-set":"Error thrown when writing to IndexedDB. Original error: {$originalErrorMessage}.","idb-delete":"Error thrown when deleting from IndexedDB. Original error: {$originalErrorMessage}.","finalization-registry-not-supported":"FirebaseServerApp deleteOnDeref field defined but the JS runtime does not support FinalizationRegistry.","invalid-server-app-environment":"FirebaseServerApp is not for use in browser environments."},Ji=new id("app","Firebase",e2);/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class t2{constructor(e,t,r){this._isDeleted=!1,this._options={...e},this._config={...t},this._name=t.name,this._automaticDataCollectionEnabled=t.automaticDataCollectionEnabled,this._container=r,this.container.addComponent(new Xs("app",()=>this,"PUBLIC"))}get automaticDataCollectionEnabled(){return this.checkDestroyed(),this._automaticDataCollectionEnabled}set automaticDataCollectionEnabled(e){this.checkDestroyed(),this._automaticDataCollectionEnabled=e}get name(){return this.checkDestroyed(),this._name}get options(){return this.checkDestroyed(),this._options}get config(){return this.checkDestroyed(),this._config}get container(){return this._container}get isDeleted(){return this._isDeleted}set isDeleted(e){this._isDeleted=e}checkDestroyed(){if(this.isDeleted)throw Ji.create("app-deleted",{appName:this._name})}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const vo=XD;function HS(n,e={}){let t=n;typeof e!="object"&&(e={name:e});const r={name:Dy,automaticDataCollectionEnabled:!0,...e},s=r.name;if(typeof s!="string"||!s)throw Ji.create("bad-app-name",{appName:String(s)});if(t||(t=FS()),!t)throw Ji.create("no-options");const o=If.get(s);if(o){if(io(t,o.options)&&io(r,o.config))return o;throw Ji.create("duplicate-app",{appName:s})}const l=new aD(s);for(const h of Oy.values())l.addComponent(h);const u=new t2(t,r,l);return If.set(s,u),u}function xp(n=Dy){const e=If.get(n);if(!e&&n===Dy&&FS())return HS();if(!e)throw Ji.create("no-app",{appName:n});return e}function gr(n,e,t){let r=JD[n]??n;t&&(r+=`-${t}`);const s=r.match(/\s|\//),o=e.match(/\s|\//);if(s||o){const l=[`Unable to register library "${r}" with version "${e}":`];s&&l.push(`library name "${r}" contains illegal characters (whitespace or "/")`),s&&o&&l.push("and"),o&&l.push(`version name "${e}" contains illegal characters (whitespace or "/")`),Js.warn(l.join(" "));return}oo(new Xs(`${r}-version`,()=>({library:r,version:e}),"VERSION"))}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const n2="firebase-heartbeat-database",r2=1,Lu="firebase-heartbeat-store";let Zg=null;function qS(){return Zg||(Zg=wD(n2,r2,{upgrade:(n,e)=>{switch(e){case 0:try{n.createObjectStore(Lu)}catch(t){console.warn(t)}}}}).catch(n=>{throw Ji.create("idb-open",{originalErrorMessage:n.message})})),Zg}async function s2(n){try{const t=(await qS()).transaction(Lu),r=await t.objectStore(Lu).get(GS(n));return await t.done,r}catch(e){if(e instanceof ws)Js.warn(e.message);else{const t=Ji.create("idb-get",{originalErrorMessage:e?.message});Js.warn(t.message)}}}async function Nx(n,e){try{const r=(await qS()).transaction(Lu,"readwrite");await r.objectStore(Lu).put(e,GS(n)),await r.done}catch(t){if(t instanceof ws)Js.warn(t.message);else{const r=Ji.create("idb-set",{originalErrorMessage:t?.message});Js.warn(r.message)}}}function GS(n){return`${n.name}!${n.options.appId}`}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const i2=1024,o2=30;class a2{constructor(e){this.container=e,this._heartbeatsCache=null;const t=this.container.getProvider("app").getImmediate();this._storage=new c2(t),this._heartbeatsCachePromise=this._storage.read().then(r=>(this._heartbeatsCache=r,r))}async triggerHeartbeat(){try{const t=this.container.getProvider("platform-logger").getImmediate().getPlatformInfoString(),r=Px();if(this._heartbeatsCache?.heartbeats==null&&(this._heartbeatsCache=await this._heartbeatsCachePromise,this._heartbeatsCache?.heartbeats==null)||this._heartbeatsCache.lastSentHeartbeatDate===r||this._heartbeatsCache.heartbeats.some(s=>s.date===r))return;if(this._heartbeatsCache.heartbeats.push({date:r,agent:t}),this._heartbeatsCache.heartbeats.length>o2){const s=u2(this._heartbeatsCache.heartbeats);this._heartbeatsCache.heartbeats.splice(s,1)}return this._storage.overwrite(this._heartbeatsCache)}catch(e){Js.warn(e)}}async getHeartbeatsHeader(){try{if(this._heartbeatsCache===null&&await this._heartbeatsCachePromise,this._heartbeatsCache?.heartbeats==null||this._heartbeatsCache.heartbeats.length===0)return"";const e=Px(),{heartbeatsToSend:t,unsentEntries:r}=l2(this._heartbeatsCache.heartbeats),s=xf(JSON.stringify({version:2,heartbeats:t}));return this._heartbeatsCache.lastSentHeartbeatDate=e,r.length>0?(this._heartbeatsCache.heartbeats=r,await this._storage.overwrite(this._heartbeatsCache)):(this._heartbeatsCache.heartbeats=[],this._storage.overwrite(this._heartbeatsCache)),s}catch(e){return Js.warn(e),""}}}function Px(){return new Date().toISOString().substring(0,10)}function l2(n,e=i2){const t=[];let r=n.slice();for(const s of n){const o=t.find(l=>l.agent===s.agent);if(o){if(o.dates.push(s.date),Dx(t)>e){o.dates.pop();break}}else if(t.push({agent:s.agent,dates:[s.date]}),Dx(t)>e){t.pop();break}r=r.slice(1)}return{heartbeatsToSend:t,unsentEntries:r}}class c2{constructor(e){this.app=e,this._canUseIndexedDBPromise=this.runIndexedDBEnvironmentCheck()}async runIndexedDBEnvironmentCheck(){return qP()?GP().then(()=>!0).catch(()=>!1):!1}async read(){if(await this._canUseIndexedDBPromise){const t=await s2(this.app);return t?.heartbeats?t:{heartbeats:[]}}else return{heartbeats:[]}}async overwrite(e){if(await this._canUseIndexedDBPromise){const r=await this.read();return Nx(this.app,{lastSentHeartbeatDate:e.lastSentHeartbeatDate??r.lastSentHeartbeatDate,heartbeats:e.heartbeats})}else return}async add(e){if(await this._canUseIndexedDBPromise){const r=await this.read();return Nx(this.app,{lastSentHeartbeatDate:e.lastSentHeartbeatDate??r.lastSentHeartbeatDate,heartbeats:[...r.heartbeats,...e.heartbeats]})}else return}}function Dx(n){return xf(JSON.stringify({version:2,heartbeats:n})).length}function u2(n){if(n.length===0)return-1;let e=0,t=n[0].date;for(let r=1;r<n.length;r++)n[r].date<t&&(t=n[r].date,e=r);return e}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function d2(n){oo(new Xs("platform-logger",e=>new TD(e),"PRIVATE")),oo(new Xs("heartbeat",e=>new a2(e),"PRIVATE")),gr(Py,Ax,n),gr(Py,Ax,"esm2020"),gr("fire-js","")}d2("");var h2="firebase",f2="12.3.0";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */gr(h2,f2,"app");function KS(){return{"dependent-sdk-initialized-before-auth":"Another Firebase SDK was initialized and is trying to use Auth before Auth is initialized. Please be sure to call `initializeAuth` or `getAuth` before starting any other Firebase SDK."}}const p2=KS,QS=new id("auth","Firebase",KS());/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const bf=new Ep("@firebase/auth");function m2(n,...e){bf.logLevel<=Qe.WARN&&bf.warn(`Auth (${vo}): ${n}`,...e)}function af(n,...e){bf.logLevel<=Qe.ERROR&&bf.error(`Auth (${vo}): ${n}`,...e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Mr(n,...e){throw V_(n,...e)}function ls(n,...e){return V_(n,...e)}function YS(n,e,t){const r={...p2(),[e]:t};return new id("auth","Firebase",r).create(e,{appName:n.name})}function cs(n){return YS(n,"operation-not-supported-in-this-environment","Operations that alter the current user are not supported in conjunction with FirebaseServerApp")}function V_(n,...e){if(typeof n!="string"){const t=e[0],r=[...e.slice(1)];return r[0]&&(r[0].appName=n.name),n._errorFactory.create(t,...r)}return QS.create(n,...e)}function De(n,e,...t){if(!n)throw V_(e,...t)}function qs(n){const e="INTERNAL ASSERTION FAILED: "+n;throw af(e),new Error(e)}function Zs(n,e){n||qs(e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function My(){return typeof self<"u"&&self.location?.href||""}function g2(){return Ox()==="http:"||Ox()==="https:"}function Ox(){return typeof self<"u"&&self.location?.protocol||null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function y2(){return typeof navigator<"u"&&navigator&&"onLine"in navigator&&typeof navigator.onLine=="boolean"&&(g2()||BP()||"connection"in navigator)?navigator.onLine:!0}function _2(){if(typeof navigator>"u")return null;const n=navigator;return n.languages&&n.languages[0]||n.language||null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ad{constructor(e,t){this.shortDelay=e,this.longDelay=t,Zs(t>e,"Short delay should be less than long delay!"),this.isMobile=L_()||zS()}get(){return y2()?this.isMobile?this.longDelay:this.shortDelay:Math.min(5e3,this.shortDelay)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function F_(n,e){Zs(n.emulator,"Emulator should always be set here");const{url:t}=n.emulator;return e?`${t}${e.startsWith("/")?e.slice(1):e}`:t}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class XS{static initialize(e,t,r){this.fetchImpl=e,t&&(this.headersImpl=t),r&&(this.responseImpl=r)}static fetch(){if(this.fetchImpl)return this.fetchImpl;if(typeof self<"u"&&"fetch"in self)return self.fetch;if(typeof globalThis<"u"&&globalThis.fetch)return globalThis.fetch;if(typeof fetch<"u")return fetch;qs("Could not find fetch implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static headers(){if(this.headersImpl)return this.headersImpl;if(typeof self<"u"&&"Headers"in self)return self.Headers;if(typeof globalThis<"u"&&globalThis.Headers)return globalThis.Headers;if(typeof Headers<"u")return Headers;qs("Could not find Headers implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static response(){if(this.responseImpl)return this.responseImpl;if(typeof self<"u"&&"Response"in self)return self.Response;if(typeof globalThis<"u"&&globalThis.Response)return globalThis.Response;if(typeof Response<"u")return Response;qs("Could not find Response implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const v2={CREDENTIAL_MISMATCH:"custom-token-mismatch",MISSING_CUSTOM_TOKEN:"internal-error",INVALID_IDENTIFIER:"invalid-email",MISSING_CONTINUE_URI:"internal-error",INVALID_PASSWORD:"wrong-password",MISSING_PASSWORD:"missing-password",INVALID_LOGIN_CREDENTIALS:"invalid-credential",EMAIL_EXISTS:"email-already-in-use",PASSWORD_LOGIN_DISABLED:"operation-not-allowed",INVALID_IDP_RESPONSE:"invalid-credential",INVALID_PENDING_TOKEN:"invalid-credential",FEDERATED_USER_ID_ALREADY_LINKED:"credential-already-in-use",MISSING_REQ_TYPE:"internal-error",EMAIL_NOT_FOUND:"user-not-found",RESET_PASSWORD_EXCEED_LIMIT:"too-many-requests",EXPIRED_OOB_CODE:"expired-action-code",INVALID_OOB_CODE:"invalid-action-code",MISSING_OOB_CODE:"internal-error",CREDENTIAL_TOO_OLD_LOGIN_AGAIN:"requires-recent-login",INVALID_ID_TOKEN:"invalid-user-token",TOKEN_EXPIRED:"user-token-expired",USER_NOT_FOUND:"user-token-expired",TOO_MANY_ATTEMPTS_TRY_LATER:"too-many-requests",PASSWORD_DOES_NOT_MEET_REQUIREMENTS:"password-does-not-meet-requirements",INVALID_CODE:"invalid-verification-code",INVALID_SESSION_INFO:"invalid-verification-id",INVALID_TEMPORARY_PROOF:"invalid-credential",MISSING_SESSION_INFO:"missing-verification-id",SESSION_EXPIRED:"code-expired",MISSING_ANDROID_PACKAGE_NAME:"missing-android-pkg-name",UNAUTHORIZED_DOMAIN:"unauthorized-continue-uri",INVALID_OAUTH_CLIENT_ID:"invalid-oauth-client-id",ADMIN_ONLY_OPERATION:"admin-restricted-operation",INVALID_MFA_PENDING_CREDENTIAL:"invalid-multi-factor-session",MFA_ENROLLMENT_NOT_FOUND:"multi-factor-info-not-found",MISSING_MFA_ENROLLMENT_ID:"missing-multi-factor-info",MISSING_MFA_PENDING_CREDENTIAL:"missing-multi-factor-session",SECOND_FACTOR_EXISTS:"second-factor-already-in-use",SECOND_FACTOR_LIMIT_EXCEEDED:"maximum-second-factor-count-exceeded",BLOCKING_FUNCTION_ERROR_RESPONSE:"internal-error",RECAPTCHA_NOT_ENABLED:"recaptcha-not-enabled",MISSING_RECAPTCHA_TOKEN:"missing-recaptcha-token",INVALID_RECAPTCHA_TOKEN:"invalid-recaptcha-token",INVALID_RECAPTCHA_ACTION:"invalid-recaptcha-action",MISSING_CLIENT_TYPE:"missing-client-type",MISSING_RECAPTCHA_VERSION:"missing-recaptcha-version",INVALID_RECAPTCHA_VERSION:"invalid-recaptcha-version",INVALID_REQ_TYPE:"invalid-req-type"};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const w2=["/v1/accounts:signInWithCustomToken","/v1/accounts:signInWithEmailLink","/v1/accounts:signInWithIdp","/v1/accounts:signInWithPassword","/v1/accounts:signInWithPhoneNumber","/v1/token"],E2=new ad(3e4,6e4);function wo(n,e){return n.tenantId&&!e.tenantId?{...e,tenantId:n.tenantId}:e}async function Eo(n,e,t,r,s={}){return JS(n,s,async()=>{let o={},l={};r&&(e==="GET"?l=r:o={body:JSON.stringify(r)});const u=ec({key:n.config.apiKey,...l}).slice(1),h=await n._getAdditionalHeaders();h["Content-Type"]="application/json",n.languageCode&&(h["X-Firebase-Locale"]=n.languageCode);const p={method:e,headers:h,...o};return zP()||(p.referrerPolicy="no-referrer"),n.emulatorConfig&&vs(n.emulatorConfig.host)&&(p.credentials="include"),XS.fetch()(await ZS(n,n.config.apiHost,t,u),p)})}async function JS(n,e,t){n._canInitEmulator=!1;const r={...v2,...e};try{const s=new T2(n),o=await Promise.race([t(),s.promise]);s.clearNetworkTimeout();const l=await o.json();if("needConfirmation"in l)throw Bh(n,"account-exists-with-different-credential",l);if(o.ok&&!("errorMessage"in l))return l;{const u=o.ok?l.errorMessage:l.error.message,[h,p]=u.split(" : ");if(h==="FEDERATED_USER_ID_ALREADY_LINKED")throw Bh(n,"credential-already-in-use",l);if(h==="EMAIL_EXISTS")throw Bh(n,"email-already-in-use",l);if(h==="USER_DISABLED")throw Bh(n,"user-disabled",l);const g=r[h]||h.toLowerCase().replace(/[_\s]+/g,"-");if(p)throw YS(n,g,p);Mr(n,g)}}catch(s){if(s instanceof ws)throw s;Mr(n,"network-request-failed",{message:String(s)})}}async function ld(n,e,t,r,s={}){const o=await Eo(n,e,t,r,s);return"mfaPendingCredential"in o&&Mr(n,"multi-factor-auth-required",{_serverResponse:o}),o}async function ZS(n,e,t,r){const s=`${e}${t}?${r}`,o=n,l=o.config.emulator?F_(n.config,s):`${n.config.apiScheme}://${s}`;return w2.includes(t)&&(await o._persistenceManagerAvailable,o._getPersistenceType()==="COOKIE")?o._getPersistence()._getFinalTarget(l).toString():l}function x2(n){switch(n){case"ENFORCE":return"ENFORCE";case"AUDIT":return"AUDIT";case"OFF":return"OFF";default:return"ENFORCEMENT_STATE_UNSPECIFIED"}}class T2{clearNetworkTimeout(){clearTimeout(this.timer)}constructor(e){this.auth=e,this.timer=null,this.promise=new Promise((t,r)=>{this.timer=setTimeout(()=>r(ls(this.auth,"network-request-failed")),E2.get())})}}function Bh(n,e,t){const r={appName:n.name};t.email&&(r.email=t.email),t.phoneNumber&&(r.phoneNumber=t.phoneNumber);const s=ls(n,e,r);return s.customData._tokenResponse=t,s}function Mx(n){return n!==void 0&&n.enterprise!==void 0}class C2{constructor(e){if(this.siteKey="",this.recaptchaEnforcementState=[],e.recaptchaKey===void 0)throw new Error("recaptchaKey undefined");this.siteKey=e.recaptchaKey.split("/")[3],this.recaptchaEnforcementState=e.recaptchaEnforcementState}getProviderEnforcementState(e){if(!this.recaptchaEnforcementState||this.recaptchaEnforcementState.length===0)return null;for(const t of this.recaptchaEnforcementState)if(t.provider&&t.provider===e)return x2(t.enforcementState);return null}isProviderEnabled(e){return this.getProviderEnforcementState(e)==="ENFORCE"||this.getProviderEnforcementState(e)==="AUDIT"}isAnyProviderEnabled(){return this.isProviderEnabled("EMAIL_PASSWORD_PROVIDER")||this.isProviderEnabled("PHONE_PROVIDER")}}async function S2(n,e){return Eo(n,"GET","/v2/recaptchaConfig",wo(n,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function I2(n,e){return Eo(n,"POST","/v1/accounts:delete",e)}async function Rf(n,e){return Eo(n,"POST","/v1/accounts:lookup",e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Tu(n){if(n)try{const e=new Date(Number(n));if(!isNaN(e.getTime()))return e.toUTCString()}catch{}}async function b2(n,e=!1){const t=ut(n),r=await t.getIdToken(e),s=U_(r);De(s&&s.exp&&s.auth_time&&s.iat,t.auth,"internal-error");const o=typeof s.firebase=="object"?s.firebase:void 0,l=o?.sign_in_provider;return{claims:s,token:r,authTime:Tu(ey(s.auth_time)),issuedAtTime:Tu(ey(s.iat)),expirationTime:Tu(ey(s.exp)),signInProvider:l||null,signInSecondFactor:o?.sign_in_second_factor||null}}function ey(n){return Number(n)*1e3}function U_(n){const[e,t,r]=n.split(".");if(e===void 0||t===void 0||r===void 0)return af("JWT malformed, contained fewer than 3 sections"),null;try{const s=Tf(t);return s?JSON.parse(s):(af("Failed to decode base64 JWT payload"),null)}catch(s){return af("Caught error parsing JWT payload as JSON",s?.toString()),null}}function Lx(n){const e=U_(n);return De(e,"internal-error"),De(typeof e.exp<"u","internal-error"),De(typeof e.iat<"u","internal-error"),Number(e.exp)-Number(e.iat)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function ju(n,e,t=!1){if(t)return e;try{return await e}catch(r){throw r instanceof ws&&R2(r)&&n.auth.currentUser===n&&await n.auth.signOut(),r}}function R2({code:n}){return n==="auth/user-disabled"||n==="auth/user-token-expired"}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class A2{constructor(e){this.user=e,this.isRunning=!1,this.timerId=null,this.errorBackoff=3e4}_start(){this.isRunning||(this.isRunning=!0,this.schedule())}_stop(){this.isRunning&&(this.isRunning=!1,this.timerId!==null&&clearTimeout(this.timerId))}getInterval(e){if(e){const t=this.errorBackoff;return this.errorBackoff=Math.min(this.errorBackoff*2,96e4),t}else{this.errorBackoff=3e4;const r=(this.user.stsTokenManager.expirationTime??0)-Date.now()-3e5;return Math.max(0,r)}}schedule(e=!1){if(!this.isRunning)return;const t=this.getInterval(e);this.timerId=setTimeout(async()=>{await this.iteration()},t)}async iteration(){try{await this.user.getIdToken(!0)}catch(e){e?.code==="auth/network-request-failed"&&this.schedule(!0);return}this.schedule()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ly{constructor(e,t){this.createdAt=e,this.lastLoginAt=t,this._initializeTime()}_initializeTime(){this.lastSignInTime=Tu(this.lastLoginAt),this.creationTime=Tu(this.createdAt)}_copy(e){this.createdAt=e.createdAt,this.lastLoginAt=e.lastLoginAt,this._initializeTime()}toJSON(){return{createdAt:this.createdAt,lastLoginAt:this.lastLoginAt}}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Af(n){const e=n.auth,t=await n.getIdToken(),r=await ju(n,Rf(e,{idToken:t}));De(r?.users.length,e,"internal-error");const s=r.users[0];n._notifyReloadListener(s);const o=s.providerUserInfo?.length?eI(s.providerUserInfo):[],l=N2(n.providerData,o),u=n.isAnonymous,h=!(n.email&&s.passwordHash)&&!l?.length,p=u?h:!1,g={uid:s.localId,displayName:s.displayName||null,photoURL:s.photoUrl||null,email:s.email||null,emailVerified:s.emailVerified||!1,phoneNumber:s.phoneNumber||null,tenantId:s.tenantId||null,providerData:l,metadata:new Ly(s.createdAt,s.lastLoginAt),isAnonymous:p};Object.assign(n,g)}async function k2(n){const e=ut(n);await Af(e),await e.auth._persistUserIfCurrent(e),e.auth._notifyListenersIfCurrent(e)}function N2(n,e){return[...n.filter(r=>!e.some(s=>s.providerId===r.providerId)),...e]}function eI(n){return n.map(({providerId:e,...t})=>({providerId:e,uid:t.rawId||"",displayName:t.displayName||null,email:t.email||null,phoneNumber:t.phoneNumber||null,photoURL:t.photoUrl||null}))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function P2(n,e){const t=await JS(n,{},async()=>{const r=ec({grant_type:"refresh_token",refresh_token:e}).slice(1),{tokenApiHost:s,apiKey:o}=n.config,l=await ZS(n,s,"/v1/token",`key=${o}`),u=await n._getAdditionalHeaders();u["Content-Type"]="application/x-www-form-urlencoded";const h={method:"POST",headers:u,body:r};return n.emulatorConfig&&vs(n.emulatorConfig.host)&&(h.credentials="include"),XS.fetch()(l,h)});return{accessToken:t.access_token,expiresIn:t.expires_in,refreshToken:t.refresh_token}}async function D2(n,e){return Eo(n,"POST","/v2/accounts:revokeToken",wo(n,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Il{constructor(){this.refreshToken=null,this.accessToken=null,this.expirationTime=null}get isExpired(){return!this.expirationTime||Date.now()>this.expirationTime-3e4}updateFromServerResponse(e){De(e.idToken,"internal-error"),De(typeof e.idToken<"u","internal-error"),De(typeof e.refreshToken<"u","internal-error");const t="expiresIn"in e&&typeof e.expiresIn<"u"?Number(e.expiresIn):Lx(e.idToken);this.updateTokensAndExpiration(e.idToken,e.refreshToken,t)}updateFromIdToken(e){De(e.length!==0,"internal-error");const t=Lx(e);this.updateTokensAndExpiration(e,null,t)}async getToken(e,t=!1){return!t&&this.accessToken&&!this.isExpired?this.accessToken:(De(this.refreshToken,e,"user-token-expired"),this.refreshToken?(await this.refresh(e,this.refreshToken),this.accessToken):null)}clearRefreshToken(){this.refreshToken=null}async refresh(e,t){const{accessToken:r,refreshToken:s,expiresIn:o}=await P2(e,t);this.updateTokensAndExpiration(r,s,Number(o))}updateTokensAndExpiration(e,t,r){this.refreshToken=t||null,this.accessToken=e||null,this.expirationTime=Date.now()+r*1e3}static fromJSON(e,t){const{refreshToken:r,accessToken:s,expirationTime:o}=t,l=new Il;return r&&(De(typeof r=="string","internal-error",{appName:e}),l.refreshToken=r),s&&(De(typeof s=="string","internal-error",{appName:e}),l.accessToken=s),o&&(De(typeof o=="number","internal-error",{appName:e}),l.expirationTime=o),l}toJSON(){return{refreshToken:this.refreshToken,accessToken:this.accessToken,expirationTime:this.expirationTime}}_assign(e){this.accessToken=e.accessToken,this.refreshToken=e.refreshToken,this.expirationTime=e.expirationTime}_clone(){return Object.assign(new Il,this.toJSON())}_performRefresh(){return qs("not implemented")}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function zi(n,e){De(typeof n=="string"||typeof n>"u","internal-error",{appName:e})}class kr{constructor({uid:e,auth:t,stsTokenManager:r,...s}){this.providerId="firebase",this.proactiveRefresh=new A2(this),this.reloadUserInfo=null,this.reloadListener=null,this.uid=e,this.auth=t,this.stsTokenManager=r,this.accessToken=r.accessToken,this.displayName=s.displayName||null,this.email=s.email||null,this.emailVerified=s.emailVerified||!1,this.phoneNumber=s.phoneNumber||null,this.photoURL=s.photoURL||null,this.isAnonymous=s.isAnonymous||!1,this.tenantId=s.tenantId||null,this.providerData=s.providerData?[...s.providerData]:[],this.metadata=new Ly(s.createdAt||void 0,s.lastLoginAt||void 0)}async getIdToken(e){const t=await ju(this,this.stsTokenManager.getToken(this.auth,e));return De(t,this.auth,"internal-error"),this.accessToken!==t&&(this.accessToken=t,await this.auth._persistUserIfCurrent(this),this.auth._notifyListenersIfCurrent(this)),t}getIdTokenResult(e){return b2(this,e)}reload(){return k2(this)}_assign(e){this!==e&&(De(this.uid===e.uid,this.auth,"internal-error"),this.displayName=e.displayName,this.photoURL=e.photoURL,this.email=e.email,this.emailVerified=e.emailVerified,this.phoneNumber=e.phoneNumber,this.isAnonymous=e.isAnonymous,this.tenantId=e.tenantId,this.providerData=e.providerData.map(t=>({...t})),this.metadata._copy(e.metadata),this.stsTokenManager._assign(e.stsTokenManager))}_clone(e){const t=new kr({...this,auth:e,stsTokenManager:this.stsTokenManager._clone()});return t.metadata._copy(this.metadata),t}_onReload(e){De(!this.reloadListener,this.auth,"internal-error"),this.reloadListener=e,this.reloadUserInfo&&(this._notifyReloadListener(this.reloadUserInfo),this.reloadUserInfo=null)}_notifyReloadListener(e){this.reloadListener?this.reloadListener(e):this.reloadUserInfo=e}_startProactiveRefresh(){this.proactiveRefresh._start()}_stopProactiveRefresh(){this.proactiveRefresh._stop()}async _updateTokensIfNecessary(e,t=!1){let r=!1;e.idToken&&e.idToken!==this.stsTokenManager.accessToken&&(this.stsTokenManager.updateFromServerResponse(e),r=!0),t&&await Af(this),await this.auth._persistUserIfCurrent(this),r&&this.auth._notifyListenersIfCurrent(this)}async delete(){if(bn(this.auth.app))return Promise.reject(cs(this.auth));const e=await this.getIdToken();return await ju(this,I2(this.auth,{idToken:e})),this.stsTokenManager.clearRefreshToken(),this.auth.signOut()}toJSON(){return{uid:this.uid,email:this.email||void 0,emailVerified:this.emailVerified,displayName:this.displayName||void 0,isAnonymous:this.isAnonymous,photoURL:this.photoURL||void 0,phoneNumber:this.phoneNumber||void 0,tenantId:this.tenantId||void 0,providerData:this.providerData.map(e=>({...e})),stsTokenManager:this.stsTokenManager.toJSON(),_redirectEventId:this._redirectEventId,...this.metadata.toJSON(),apiKey:this.auth.config.apiKey,appName:this.auth.name}}get refreshToken(){return this.stsTokenManager.refreshToken||""}static _fromJSON(e,t){const r=t.displayName??void 0,s=t.email??void 0,o=t.phoneNumber??void 0,l=t.photoURL??void 0,u=t.tenantId??void 0,h=t._redirectEventId??void 0,p=t.createdAt??void 0,g=t.lastLoginAt??void 0,{uid:_,emailVerified:v,isAnonymous:T,providerData:A,stsTokenManager:I}=t;De(_&&I,e,"internal-error");const b=Il.fromJSON(this.name,I);De(typeof _=="string",e,"internal-error"),zi(r,e.name),zi(s,e.name),De(typeof v=="boolean",e,"internal-error"),De(typeof T=="boolean",e,"internal-error"),zi(o,e.name),zi(l,e.name),zi(u,e.name),zi(h,e.name),zi(p,e.name),zi(g,e.name);const j=new kr({uid:_,auth:e,email:s,emailVerified:v,displayName:r,isAnonymous:T,photoURL:l,phoneNumber:o,tenantId:u,stsTokenManager:b,createdAt:p,lastLoginAt:g});return A&&Array.isArray(A)&&(j.providerData=A.map(U=>({...U}))),h&&(j._redirectEventId=h),j}static async _fromIdTokenResponse(e,t,r=!1){const s=new Il;s.updateFromServerResponse(t);const o=new kr({uid:t.localId,auth:e,stsTokenManager:s,isAnonymous:r});return await Af(o),o}static async _fromGetAccountInfoResponse(e,t,r){const s=t.users[0];De(s.localId!==void 0,"internal-error");const o=s.providerUserInfo!==void 0?eI(s.providerUserInfo):[],l=!(s.email&&s.passwordHash)&&!o?.length,u=new Il;u.updateFromIdToken(r);const h=new kr({uid:s.localId,auth:e,stsTokenManager:u,isAnonymous:l}),p={uid:s.localId,displayName:s.displayName||null,photoURL:s.photoUrl||null,email:s.email||null,emailVerified:s.emailVerified||!1,phoneNumber:s.phoneNumber||null,tenantId:s.tenantId||null,providerData:o,metadata:new Ly(s.createdAt,s.lastLoginAt),isAnonymous:!(s.email&&s.passwordHash)&&!o?.length};return Object.assign(h,p),h}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const jx=new Map;function Gs(n){Zs(n instanceof Function,"Expected a class definition");let e=jx.get(n);return e?(Zs(e instanceof n,"Instance stored in cache mismatched with class"),e):(e=new n,jx.set(n,e),e)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class tI{constructor(){this.type="NONE",this.storage={}}async _isAvailable(){return!0}async _set(e,t){this.storage[e]=t}async _get(e){const t=this.storage[e];return t===void 0?null:t}async _remove(e){delete this.storage[e]}_addListener(e,t){}_removeListener(e,t){}}tI.type="NONE";const Vx=tI;/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function lf(n,e,t){return`firebase:${n}:${e}:${t}`}class bl{constructor(e,t,r){this.persistence=e,this.auth=t,this.userKey=r;const{config:s,name:o}=this.auth;this.fullUserKey=lf(this.userKey,s.apiKey,o),this.fullPersistenceKey=lf("persistence",s.apiKey,o),this.boundEventHandler=t._onStorageEvent.bind(t),this.persistence._addListener(this.fullUserKey,this.boundEventHandler)}setCurrentUser(e){return this.persistence._set(this.fullUserKey,e.toJSON())}async getCurrentUser(){const e=await this.persistence._get(this.fullUserKey);if(!e)return null;if(typeof e=="string"){const t=await Rf(this.auth,{idToken:e}).catch(()=>{});return t?kr._fromGetAccountInfoResponse(this.auth,t,e):null}return kr._fromJSON(this.auth,e)}removeCurrentUser(){return this.persistence._remove(this.fullUserKey)}savePersistenceForRedirect(){return this.persistence._set(this.fullPersistenceKey,this.persistence.type)}async setPersistence(e){if(this.persistence===e)return;const t=await this.getCurrentUser();if(await this.removeCurrentUser(),this.persistence=e,t)return this.setCurrentUser(t)}delete(){this.persistence._removeListener(this.fullUserKey,this.boundEventHandler)}static async create(e,t,r="authUser"){if(!t.length)return new bl(Gs(Vx),e,r);const s=(await Promise.all(t.map(async p=>{if(await p._isAvailable())return p}))).filter(p=>p);let o=s[0]||Gs(Vx);const l=lf(r,e.config.apiKey,e.name);let u=null;for(const p of t)try{const g=await p._get(l);if(g){let _;if(typeof g=="string"){const v=await Rf(e,{idToken:g}).catch(()=>{});if(!v)break;_=await kr._fromGetAccountInfoResponse(e,v,g)}else _=kr._fromJSON(e,g);p!==o&&(u=_),o=p;break}}catch{}const h=s.filter(p=>p._shouldAllowMigration);return!o._shouldAllowMigration||!h.length?new bl(o,e,r):(o=h[0],u&&await o._set(l,u.toJSON()),await Promise.all(t.map(async p=>{if(p!==o)try{await p._remove(l)}catch{}})),new bl(o,e,r))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Fx(n){const e=n.toLowerCase();if(e.includes("opera/")||e.includes("opr/")||e.includes("opios/"))return"Opera";if(iI(e))return"IEMobile";if(e.includes("msie")||e.includes("trident/"))return"IE";if(e.includes("edge/"))return"Edge";if(nI(e))return"Firefox";if(e.includes("silk/"))return"Silk";if(aI(e))return"Blackberry";if(lI(e))return"Webos";if(rI(e))return"Safari";if((e.includes("chrome/")||sI(e))&&!e.includes("edge/"))return"Chrome";if(oI(e))return"Android";{const t=/([a-zA-Z\d\.]+)\/[a-zA-Z\d\.]*$/,r=n.match(t);if(r?.length===2)return r[1]}return"Other"}function nI(n=En()){return/firefox\//i.test(n)}function rI(n=En()){const e=n.toLowerCase();return e.includes("safari/")&&!e.includes("chrome/")&&!e.includes("crios/")&&!e.includes("android")}function sI(n=En()){return/crios\//i.test(n)}function iI(n=En()){return/iemobile/i.test(n)}function oI(n=En()){return/android/i.test(n)}function aI(n=En()){return/blackberry/i.test(n)}function lI(n=En()){return/webos/i.test(n)}function z_(n=En()){return/iphone|ipad|ipod/i.test(n)||/macintosh/i.test(n)&&/mobile/i.test(n)}function O2(n=En()){return z_(n)&&!!window.navigator?.standalone}function M2(){return $P()&&document.documentMode===10}function cI(n=En()){return z_(n)||oI(n)||lI(n)||aI(n)||/windows phone/i.test(n)||iI(n)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function uI(n,e=[]){let t;switch(n){case"Browser":t=Fx(En());break;case"Worker":t=`${Fx(En())}-${n}`;break;default:t=n}const r=e.length?e.join(","):"FirebaseCore-web";return`${t}/JsCore/${vo}/${r}`}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class L2{constructor(e){this.auth=e,this.queue=[]}pushCallback(e,t){const r=o=>new Promise((l,u)=>{try{const h=e(o);l(h)}catch(h){u(h)}});r.onAbort=t,this.queue.push(r);const s=this.queue.length-1;return()=>{this.queue[s]=()=>Promise.resolve()}}async runMiddleware(e){if(this.auth.currentUser===e)return;const t=[];try{for(const r of this.queue)await r(e),r.onAbort&&t.push(r.onAbort)}catch(r){t.reverse();for(const s of t)try{s()}catch{}throw this.auth._errorFactory.create("login-blocked",{originalMessage:r?.message})}}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function j2(n,e={}){return Eo(n,"GET","/v2/passwordPolicy",wo(n,e))}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const V2=6;class F2{constructor(e){const t=e.customStrengthOptions;this.customStrengthOptions={},this.customStrengthOptions.minPasswordLength=t.minPasswordLength??V2,t.maxPasswordLength&&(this.customStrengthOptions.maxPasswordLength=t.maxPasswordLength),t.containsLowercaseCharacter!==void 0&&(this.customStrengthOptions.containsLowercaseLetter=t.containsLowercaseCharacter),t.containsUppercaseCharacter!==void 0&&(this.customStrengthOptions.containsUppercaseLetter=t.containsUppercaseCharacter),t.containsNumericCharacter!==void 0&&(this.customStrengthOptions.containsNumericCharacter=t.containsNumericCharacter),t.containsNonAlphanumericCharacter!==void 0&&(this.customStrengthOptions.containsNonAlphanumericCharacter=t.containsNonAlphanumericCharacter),this.enforcementState=e.enforcementState,this.enforcementState==="ENFORCEMENT_STATE_UNSPECIFIED"&&(this.enforcementState="OFF"),this.allowedNonAlphanumericCharacters=e.allowedNonAlphanumericCharacters?.join("")??"",this.forceUpgradeOnSignin=e.forceUpgradeOnSignin??!1,this.schemaVersion=e.schemaVersion}validatePassword(e){const t={isValid:!0,passwordPolicy:this};return this.validatePasswordLengthOptions(e,t),this.validatePasswordCharacterOptions(e,t),t.isValid&&(t.isValid=t.meetsMinPasswordLength??!0),t.isValid&&(t.isValid=t.meetsMaxPasswordLength??!0),t.isValid&&(t.isValid=t.containsLowercaseLetter??!0),t.isValid&&(t.isValid=t.containsUppercaseLetter??!0),t.isValid&&(t.isValid=t.containsNumericCharacter??!0),t.isValid&&(t.isValid=t.containsNonAlphanumericCharacter??!0),t}validatePasswordLengthOptions(e,t){const r=this.customStrengthOptions.minPasswordLength,s=this.customStrengthOptions.maxPasswordLength;r&&(t.meetsMinPasswordLength=e.length>=r),s&&(t.meetsMaxPasswordLength=e.length<=s)}validatePasswordCharacterOptions(e,t){this.updatePasswordCharacterOptionsStatuses(t,!1,!1,!1,!1);let r;for(let s=0;s<e.length;s++)r=e.charAt(s),this.updatePasswordCharacterOptionsStatuses(t,r>="a"&&r<="z",r>="A"&&r<="Z",r>="0"&&r<="9",this.allowedNonAlphanumericCharacters.includes(r))}updatePasswordCharacterOptionsStatuses(e,t,r,s,o){this.customStrengthOptions.containsLowercaseLetter&&(e.containsLowercaseLetter||(e.containsLowercaseLetter=t)),this.customStrengthOptions.containsUppercaseLetter&&(e.containsUppercaseLetter||(e.containsUppercaseLetter=r)),this.customStrengthOptions.containsNumericCharacter&&(e.containsNumericCharacter||(e.containsNumericCharacter=s)),this.customStrengthOptions.containsNonAlphanumericCharacter&&(e.containsNonAlphanumericCharacter||(e.containsNonAlphanumericCharacter=o))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class U2{constructor(e,t,r,s){this.app=e,this.heartbeatServiceProvider=t,this.appCheckServiceProvider=r,this.config=s,this.currentUser=null,this.emulatorConfig=null,this.operations=Promise.resolve(),this.authStateSubscription=new Ux(this),this.idTokenSubscription=new Ux(this),this.beforeStateQueue=new L2(this),this.redirectUser=null,this.isProactiveRefreshEnabled=!1,this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION=1,this._canInitEmulator=!0,this._isInitialized=!1,this._deleted=!1,this._initializationPromise=null,this._popupRedirectResolver=null,this._errorFactory=QS,this._agentRecaptchaConfig=null,this._tenantRecaptchaConfigs={},this._projectPasswordPolicy=null,this._tenantPasswordPolicies={},this._resolvePersistenceManagerAvailable=void 0,this.lastNotifiedUid=void 0,this.languageCode=null,this.tenantId=null,this.settings={appVerificationDisabledForTesting:!1},this.frameworks=[],this.name=e.name,this.clientVersion=s.sdkClientVersion,this._persistenceManagerAvailable=new Promise(o=>this._resolvePersistenceManagerAvailable=o)}_initializeWithPersistence(e,t){return t&&(this._popupRedirectResolver=Gs(t)),this._initializationPromise=this.queue(async()=>{if(!this._deleted&&(this.persistenceManager=await bl.create(this,e),this._resolvePersistenceManagerAvailable?.(),!this._deleted)){if(this._popupRedirectResolver?._shouldInitProactively)try{await this._popupRedirectResolver._initialize(this)}catch{}await this.initializeCurrentUser(t),this.lastNotifiedUid=this.currentUser?.uid||null,!this._deleted&&(this._isInitialized=!0)}}),this._initializationPromise}async _onStorageEvent(){if(this._deleted)return;const e=await this.assertedPersistence.getCurrentUser();if(!(!this.currentUser&&!e)){if(this.currentUser&&e&&this.currentUser.uid===e.uid){this._currentUser._assign(e),await this.currentUser.getIdToken();return}await this._updateCurrentUser(e,!0)}}async initializeCurrentUserFromIdToken(e){try{const t=await Rf(this,{idToken:e}),r=await kr._fromGetAccountInfoResponse(this,t,e);await this.directlySetCurrentUser(r)}catch(t){console.warn("FirebaseServerApp could not login user with provided authIdToken: ",t),await this.directlySetCurrentUser(null)}}async initializeCurrentUser(e){if(bn(this.app)){const o=this.app.settings.authIdToken;return o?new Promise(l=>{setTimeout(()=>this.initializeCurrentUserFromIdToken(o).then(l,l))}):this.directlySetCurrentUser(null)}const t=await this.assertedPersistence.getCurrentUser();let r=t,s=!1;if(e&&this.config.authDomain){await this.getOrInitRedirectPersistenceManager();const o=this.redirectUser?._redirectEventId,l=r?._redirectEventId,u=await this.tryRedirectSignIn(e);(!o||o===l)&&u?.user&&(r=u.user,s=!0)}if(!r)return this.directlySetCurrentUser(null);if(!r._redirectEventId){if(s)try{await this.beforeStateQueue.runMiddleware(r)}catch(o){r=t,this._popupRedirectResolver._overrideRedirectResult(this,()=>Promise.reject(o))}return r?this.reloadAndSetCurrentUserOrClear(r):this.directlySetCurrentUser(null)}return De(this._popupRedirectResolver,this,"argument-error"),await this.getOrInitRedirectPersistenceManager(),this.redirectUser&&this.redirectUser._redirectEventId===r._redirectEventId?this.directlySetCurrentUser(r):this.reloadAndSetCurrentUserOrClear(r)}async tryRedirectSignIn(e){let t=null;try{t=await this._popupRedirectResolver._completeRedirectFn(this,e,!0)}catch{await this._setRedirectUser(null)}return t}async reloadAndSetCurrentUserOrClear(e){try{await Af(e)}catch(t){if(t?.code!=="auth/network-request-failed")return this.directlySetCurrentUser(null)}return this.directlySetCurrentUser(e)}useDeviceLanguage(){this.languageCode=_2()}async _delete(){this._deleted=!0}async updateCurrentUser(e){if(bn(this.app))return Promise.reject(cs(this));const t=e?ut(e):null;return t&&De(t.auth.config.apiKey===this.config.apiKey,this,"invalid-user-token"),this._updateCurrentUser(t&&t._clone(this))}async _updateCurrentUser(e,t=!1){if(!this._deleted)return e&&De(this.tenantId===e.tenantId,this,"tenant-id-mismatch"),t||await this.beforeStateQueue.runMiddleware(e),this.queue(async()=>{await this.directlySetCurrentUser(e),this.notifyAuthListeners()})}async signOut(){return bn(this.app)?Promise.reject(cs(this)):(await this.beforeStateQueue.runMiddleware(null),(this.redirectPersistenceManager||this._popupRedirectResolver)&&await this._setRedirectUser(null),this._updateCurrentUser(null,!0))}setPersistence(e){return bn(this.app)?Promise.reject(cs(this)):this.queue(async()=>{await this.assertedPersistence.setPersistence(Gs(e))})}_getRecaptchaConfig(){return this.tenantId==null?this._agentRecaptchaConfig:this._tenantRecaptchaConfigs[this.tenantId]}async validatePassword(e){this._getPasswordPolicyInternal()||await this._updatePasswordPolicy();const t=this._getPasswordPolicyInternal();return t.schemaVersion!==this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION?Promise.reject(this._errorFactory.create("unsupported-password-policy-schema-version",{})):t.validatePassword(e)}_getPasswordPolicyInternal(){return this.tenantId===null?this._projectPasswordPolicy:this._tenantPasswordPolicies[this.tenantId]}async _updatePasswordPolicy(){const e=await j2(this),t=new F2(e);this.tenantId===null?this._projectPasswordPolicy=t:this._tenantPasswordPolicies[this.tenantId]=t}_getPersistenceType(){return this.assertedPersistence.persistence.type}_getPersistence(){return this.assertedPersistence.persistence}_updateErrorMap(e){this._errorFactory=new id("auth","Firebase",e())}onAuthStateChanged(e,t,r){return this.registerStateListener(this.authStateSubscription,e,t,r)}beforeAuthStateChanged(e,t){return this.beforeStateQueue.pushCallback(e,t)}onIdTokenChanged(e,t,r){return this.registerStateListener(this.idTokenSubscription,e,t,r)}authStateReady(){return new Promise((e,t)=>{if(this.currentUser)e();else{const r=this.onAuthStateChanged(()=>{r(),e()},t)}})}async revokeAccessToken(e){if(this.currentUser){const t=await this.currentUser.getIdToken(),r={providerId:"apple.com",tokenType:"ACCESS_TOKEN",token:e,idToken:t};this.tenantId!=null&&(r.tenantId=this.tenantId),await D2(this,r)}}toJSON(){return{apiKey:this.config.apiKey,authDomain:this.config.authDomain,appName:this.name,currentUser:this._currentUser?.toJSON()}}async _setRedirectUser(e,t){const r=await this.getOrInitRedirectPersistenceManager(t);return e===null?r.removeCurrentUser():r.setCurrentUser(e)}async getOrInitRedirectPersistenceManager(e){if(!this.redirectPersistenceManager){const t=e&&Gs(e)||this._popupRedirectResolver;De(t,this,"argument-error"),this.redirectPersistenceManager=await bl.create(this,[Gs(t._redirectPersistence)],"redirectUser"),this.redirectUser=await this.redirectPersistenceManager.getCurrentUser()}return this.redirectPersistenceManager}async _redirectUserForId(e){return this._isInitialized&&await this.queue(async()=>{}),this._currentUser?._redirectEventId===e?this._currentUser:this.redirectUser?._redirectEventId===e?this.redirectUser:null}async _persistUserIfCurrent(e){if(e===this.currentUser)return this.queue(async()=>this.directlySetCurrentUser(e))}_notifyListenersIfCurrent(e){e===this.currentUser&&this.notifyAuthListeners()}_key(){return`${this.config.authDomain}:${this.config.apiKey}:${this.name}`}_startProactiveRefresh(){this.isProactiveRefreshEnabled=!0,this.currentUser&&this._currentUser._startProactiveRefresh()}_stopProactiveRefresh(){this.isProactiveRefreshEnabled=!1,this.currentUser&&this._currentUser._stopProactiveRefresh()}get _currentUser(){return this.currentUser}notifyAuthListeners(){if(!this._isInitialized)return;this.idTokenSubscription.next(this.currentUser);const e=this.currentUser?.uid??null;this.lastNotifiedUid!==e&&(this.lastNotifiedUid=e,this.authStateSubscription.next(this.currentUser))}registerStateListener(e,t,r,s){if(this._deleted)return()=>{};const o=typeof t=="function"?t:t.next.bind(t);let l=!1;const u=this._isInitialized?Promise.resolve():this._initializationPromise;if(De(u,this,"internal-error"),u.then(()=>{l||o(this.currentUser)}),typeof t=="function"){const h=e.addObserver(t,r,s);return()=>{l=!0,h()}}else{const h=e.addObserver(t);return()=>{l=!0,h()}}}async directlySetCurrentUser(e){this.currentUser&&this.currentUser!==e&&this._currentUser._stopProactiveRefresh(),e&&this.isProactiveRefreshEnabled&&e._startProactiveRefresh(),this.currentUser=e,e?await this.assertedPersistence.setCurrentUser(e):await this.assertedPersistence.removeCurrentUser()}queue(e){return this.operations=this.operations.then(e,e),this.operations}get assertedPersistence(){return De(this.persistenceManager,this,"internal-error"),this.persistenceManager}_logFramework(e){!e||this.frameworks.includes(e)||(this.frameworks.push(e),this.frameworks.sort(),this.clientVersion=uI(this.config.clientPlatform,this._getFrameworks()))}_getFrameworks(){return this.frameworks}async _getAdditionalHeaders(){const e={"X-Client-Version":this.clientVersion};this.app.options.appId&&(e["X-Firebase-gmpid"]=this.app.options.appId);const t=await this.heartbeatServiceProvider.getImmediate({optional:!0})?.getHeartbeatsHeader();t&&(e["X-Firebase-Client"]=t);const r=await this._getAppCheckToken();return r&&(e["X-Firebase-AppCheck"]=r),e}async _getAppCheckToken(){if(bn(this.app)&&this.app.settings.appCheckToken)return this.app.settings.appCheckToken;const e=await this.appCheckServiceProvider.getImmediate({optional:!0})?.getToken();return e?.error&&m2(`Error while retrieving App Check token: ${e.error}`),e?.token}}function xo(n){return ut(n)}class Ux{constructor(e){this.auth=e,this.observer=null,this.addObserver=eD(t=>this.observer=t)}get next(){return De(this.observer,this.auth,"internal-error"),this.observer.next.bind(this.observer)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let Tp={async loadJS(){throw new Error("Unable to load external scripts")},recaptchaV2Script:"",recaptchaEnterpriseScript:"",gapiScript:""};function z2(n){Tp=n}function dI(n){return Tp.loadJS(n)}function B2(){return Tp.recaptchaEnterpriseScript}function $2(){return Tp.gapiScript}function W2(n){return`__${n}${Math.floor(Math.random()*1e6)}`}class H2{constructor(){this.enterprise=new q2}ready(e){e()}execute(e,t){return Promise.resolve("token")}render(e,t){return""}}class q2{ready(e){e()}execute(e,t){return Promise.resolve("token")}render(e,t){return""}}const G2="recaptcha-enterprise",hI="NO_RECAPTCHA";class K2{constructor(e){this.type=G2,this.auth=xo(e)}async verify(e="verify",t=!1){async function r(o){if(!t){if(o.tenantId==null&&o._agentRecaptchaConfig!=null)return o._agentRecaptchaConfig.siteKey;if(o.tenantId!=null&&o._tenantRecaptchaConfigs[o.tenantId]!==void 0)return o._tenantRecaptchaConfigs[o.tenantId].siteKey}return new Promise(async(l,u)=>{S2(o,{clientType:"CLIENT_TYPE_WEB",version:"RECAPTCHA_ENTERPRISE"}).then(h=>{if(h.recaptchaKey===void 0)u(new Error("recaptcha Enterprise site key undefined"));else{const p=new C2(h);return o.tenantId==null?o._agentRecaptchaConfig=p:o._tenantRecaptchaConfigs[o.tenantId]=p,l(p.siteKey)}}).catch(h=>{u(h)})})}function s(o,l,u){const h=window.grecaptcha;Mx(h)?h.enterprise.ready(()=>{h.enterprise.execute(o,{action:e}).then(p=>{l(p)}).catch(()=>{l(hI)})}):u(Error("No reCAPTCHA enterprise script loaded."))}return this.auth.settings.appVerificationDisabledForTesting?new H2().execute("siteKey",{action:"verify"}):new Promise((o,l)=>{r(this.auth).then(u=>{if(!t&&Mx(window.grecaptcha))s(u,o,l);else{if(typeof window>"u"){l(new Error("RecaptchaVerifier is only supported in browser"));return}let h=B2();h.length!==0&&(h+=u),dI(h).then(()=>{s(u,o,l)}).catch(p=>{l(p)})}}).catch(u=>{l(u)})})}}async function zx(n,e,t,r=!1,s=!1){const o=new K2(n);let l;if(s)l=hI;else try{l=await o.verify(t)}catch{l=await o.verify(t,!0)}const u={...e};if(t==="mfaSmsEnrollment"||t==="mfaSmsSignIn"){if("phoneEnrollmentInfo"in u){const h=u.phoneEnrollmentInfo.phoneNumber,p=u.phoneEnrollmentInfo.recaptchaToken;Object.assign(u,{phoneEnrollmentInfo:{phoneNumber:h,recaptchaToken:p,captchaResponse:l,clientType:"CLIENT_TYPE_WEB",recaptchaVersion:"RECAPTCHA_ENTERPRISE"}})}else if("phoneSignInInfo"in u){const h=u.phoneSignInInfo.recaptchaToken;Object.assign(u,{phoneSignInInfo:{recaptchaToken:h,captchaResponse:l,clientType:"CLIENT_TYPE_WEB",recaptchaVersion:"RECAPTCHA_ENTERPRISE"}})}return u}return r?Object.assign(u,{captchaResp:l}):Object.assign(u,{captchaResponse:l}),Object.assign(u,{clientType:"CLIENT_TYPE_WEB"}),Object.assign(u,{recaptchaVersion:"RECAPTCHA_ENTERPRISE"}),u}async function jy(n,e,t,r,s){if(n._getRecaptchaConfig()?.isProviderEnabled("EMAIL_PASSWORD_PROVIDER")){const o=await zx(n,e,t,t==="getOobCode");return r(n,o)}else return r(n,e).catch(async o=>{if(o.code==="auth/missing-recaptcha-token"){console.log(`${t} is protected by reCAPTCHA Enterprise for this project. Automatically triggering the reCAPTCHA flow and restarting the flow.`);const l=await zx(n,e,t,t==="getOobCode");return r(n,l)}else return Promise.reject(o)})}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Q2(n,e){const t=od(n,"auth");if(t.isInitialized()){const s=t.getImmediate(),o=t.getOptions();if(io(o,e??{}))return s;Mr(s,"already-initialized")}return t.initialize({options:e})}function Y2(n,e){const t=e?.persistence||[],r=(Array.isArray(t)?t:[t]).map(Gs);e?.errorMap&&n._updateErrorMap(e.errorMap),n._initializeWithPersistence(r,e?.popupRedirectResolver)}function X2(n,e,t){const r=xo(n);De(/^https?:\/\//.test(e),r,"invalid-emulator-scheme");const s=!1,o=fI(e),{host:l,port:u}=J2(e),h=u===null?"":`:${u}`,p={url:`${o}//${l}${h}/`},g=Object.freeze({host:l,port:u,protocol:o.replace(":",""),options:Object.freeze({disableWarnings:s})});if(!r._canInitEmulator){De(r.config.emulator&&r.emulatorConfig,r,"emulator-config-failed"),De(io(p,r.config.emulator)&&io(g,r.emulatorConfig),r,"emulator-config-failed");return}r.config.emulator=p,r.emulatorConfig=g,r.settings.appVerificationDisabledForTesting=!0,vs(l)?(_p(`${o}//${l}${h}`),vp("Auth",!0)):Z2()}function fI(n){const e=n.indexOf(":");return e<0?"":n.substr(0,e+1)}function J2(n){const e=fI(n),t=/(\/\/)?([^?#/]+)/.exec(n.substr(e.length));if(!t)return{host:"",port:null};const r=t[2].split("@").pop()||"",s=/^(\[[^\]]+\])(:|$)/.exec(r);if(s){const o=s[1];return{host:o,port:Bx(r.substr(o.length+1))}}else{const[o,l]=r.split(":");return{host:o,port:Bx(l)}}}function Bx(n){if(!n)return null;const e=Number(n);return isNaN(e)?null:e}function Z2(){function n(){const e=document.createElement("p"),t=e.style;e.innerText="Running in emulator mode. Do not use with production credentials.",t.position="fixed",t.width="100%",t.backgroundColor="#ffffff",t.border=".1em solid #000000",t.color="#b50000",t.bottom="0px",t.left="0px",t.margin="0px",t.zIndex="10000",t.textAlign="center",e.classList.add("firebase-emulator-warning"),document.body.appendChild(e)}typeof console<"u"&&typeof console.info=="function"&&console.info("WARNING: You are using the Auth Emulator, which is intended for local testing only.  Do not use with production credentials."),typeof window<"u"&&typeof document<"u"&&(document.readyState==="loading"?window.addEventListener("DOMContentLoaded",n):n())}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class B_{constructor(e,t){this.providerId=e,this.signInMethod=t}toJSON(){return qs("not implemented")}_getIdTokenResponse(e){return qs("not implemented")}_linkToIdToken(e,t){return qs("not implemented")}_getReauthenticationResolver(e){return qs("not implemented")}}async function eO(n,e){return Eo(n,"POST","/v1/accounts:signUp",e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function tO(n,e){return ld(n,"POST","/v1/accounts:signInWithPassword",wo(n,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function nO(n,e){return ld(n,"POST","/v1/accounts:signInWithEmailLink",wo(n,e))}async function rO(n,e){return ld(n,"POST","/v1/accounts:signInWithEmailLink",wo(n,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Vu extends B_{constructor(e,t,r,s=null){super("password",r),this._email=e,this._password=t,this._tenantId=s}static _fromEmailAndPassword(e,t){return new Vu(e,t,"password")}static _fromEmailAndCode(e,t,r=null){return new Vu(e,t,"emailLink",r)}toJSON(){return{email:this._email,password:this._password,signInMethod:this.signInMethod,tenantId:this._tenantId}}static fromJSON(e){const t=typeof e=="string"?JSON.parse(e):e;if(t?.email&&t?.password){if(t.signInMethod==="password")return this._fromEmailAndPassword(t.email,t.password);if(t.signInMethod==="emailLink")return this._fromEmailAndCode(t.email,t.password,t.tenantId)}return null}async _getIdTokenResponse(e){switch(this.signInMethod){case"password":const t={returnSecureToken:!0,email:this._email,password:this._password,clientType:"CLIENT_TYPE_WEB"};return jy(e,t,"signInWithPassword",tO);case"emailLink":return nO(e,{email:this._email,oobCode:this._password});default:Mr(e,"internal-error")}}async _linkToIdToken(e,t){switch(this.signInMethod){case"password":const r={idToken:t,returnSecureToken:!0,email:this._email,password:this._password,clientType:"CLIENT_TYPE_WEB"};return jy(e,r,"signUpPassword",eO);case"emailLink":return rO(e,{idToken:t,email:this._email,oobCode:this._password});default:Mr(e,"internal-error")}}_getReauthenticationResolver(e){return this._getIdTokenResponse(e)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Rl(n,e){return ld(n,"POST","/v1/accounts:signInWithIdp",wo(n,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const sO="http://localhost";class aa extends B_{constructor(){super(...arguments),this.pendingToken=null}static _fromParams(e){const t=new aa(e.providerId,e.signInMethod);return e.idToken||e.accessToken?(e.idToken&&(t.idToken=e.idToken),e.accessToken&&(t.accessToken=e.accessToken),e.nonce&&!e.pendingToken&&(t.nonce=e.nonce),e.pendingToken&&(t.pendingToken=e.pendingToken)):e.oauthToken&&e.oauthTokenSecret?(t.accessToken=e.oauthToken,t.secret=e.oauthTokenSecret):Mr("argument-error"),t}toJSON(){return{idToken:this.idToken,accessToken:this.accessToken,secret:this.secret,nonce:this.nonce,pendingToken:this.pendingToken,providerId:this.providerId,signInMethod:this.signInMethod}}static fromJSON(e){const t=typeof e=="string"?JSON.parse(e):e,{providerId:r,signInMethod:s,...o}=t;if(!r||!s)return null;const l=new aa(r,s);return l.idToken=o.idToken||void 0,l.accessToken=o.accessToken||void 0,l.secret=o.secret,l.nonce=o.nonce,l.pendingToken=o.pendingToken||null,l}_getIdTokenResponse(e){const t=this.buildRequest();return Rl(e,t)}_linkToIdToken(e,t){const r=this.buildRequest();return r.idToken=t,Rl(e,r)}_getReauthenticationResolver(e){const t=this.buildRequest();return t.autoCreate=!1,Rl(e,t)}buildRequest(){const e={requestUri:sO,returnSecureToken:!0};if(this.pendingToken)e.pendingToken=this.pendingToken;else{const t={};this.idToken&&(t.id_token=this.idToken),this.accessToken&&(t.access_token=this.accessToken),this.secret&&(t.oauth_token_secret=this.secret),t.providerId=this.providerId,this.nonce&&!this.pendingToken&&(t.nonce=this.nonce),e.postBody=ec(t)}return e}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function iO(n){switch(n){case"recoverEmail":return"RECOVER_EMAIL";case"resetPassword":return"PASSWORD_RESET";case"signIn":return"EMAIL_SIGNIN";case"verifyEmail":return"VERIFY_EMAIL";case"verifyAndChangeEmail":return"VERIFY_AND_CHANGE_EMAIL";case"revertSecondFactorAddition":return"REVERT_SECOND_FACTOR_ADDITION";default:return null}}function oO(n){const e=pu(mu(n)).link,t=e?pu(mu(e)).deep_link_id:null,r=pu(mu(n)).deep_link_id;return(r?pu(mu(r)).link:null)||r||t||e||n}class $_{constructor(e){const t=pu(mu(e)),r=t.apiKey??null,s=t.oobCode??null,o=iO(t.mode??null);De(r&&s&&o,"argument-error"),this.apiKey=r,this.operation=o,this.code=s,this.continueUrl=t.continueUrl??null,this.languageCode=t.lang??null,this.tenantId=t.tenantId??null}static parseLink(e){const t=oO(e);try{return new $_(t)}catch{return null}}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class tc{constructor(){this.providerId=tc.PROVIDER_ID}static credential(e,t){return Vu._fromEmailAndPassword(e,t)}static credentialWithLink(e,t){const r=$_.parseLink(t);return De(r,"argument-error"),Vu._fromEmailAndCode(e,r.code,r.tenantId)}}tc.PROVIDER_ID="password";tc.EMAIL_PASSWORD_SIGN_IN_METHOD="password";tc.EMAIL_LINK_SIGN_IN_METHOD="emailLink";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class pI{constructor(e){this.providerId=e,this.defaultLanguageCode=null,this.customParameters={}}setDefaultLanguage(e){this.defaultLanguageCode=e}setCustomParameters(e){return this.customParameters=e,this}getCustomParameters(){return this.customParameters}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class cd extends pI{constructor(){super(...arguments),this.scopes=[]}addScope(e){return this.scopes.includes(e)||this.scopes.push(e),this}getScopes(){return[...this.scopes]}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Hi extends cd{constructor(){super("facebook.com")}static credential(e){return aa._fromParams({providerId:Hi.PROVIDER_ID,signInMethod:Hi.FACEBOOK_SIGN_IN_METHOD,accessToken:e})}static credentialFromResult(e){return Hi.credentialFromTaggedObject(e)}static credentialFromError(e){return Hi.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e||!("oauthAccessToken"in e)||!e.oauthAccessToken)return null;try{return Hi.credential(e.oauthAccessToken)}catch{return null}}}Hi.FACEBOOK_SIGN_IN_METHOD="facebook.com";Hi.PROVIDER_ID="facebook.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class qi extends cd{constructor(){super("google.com"),this.addScope("profile")}static credential(e,t){return aa._fromParams({providerId:qi.PROVIDER_ID,signInMethod:qi.GOOGLE_SIGN_IN_METHOD,idToken:e,accessToken:t})}static credentialFromResult(e){return qi.credentialFromTaggedObject(e)}static credentialFromError(e){return qi.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{oauthIdToken:t,oauthAccessToken:r}=e;if(!t&&!r)return null;try{return qi.credential(t,r)}catch{return null}}}qi.GOOGLE_SIGN_IN_METHOD="google.com";qi.PROVIDER_ID="google.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Gi extends cd{constructor(){super("github.com")}static credential(e){return aa._fromParams({providerId:Gi.PROVIDER_ID,signInMethod:Gi.GITHUB_SIGN_IN_METHOD,accessToken:e})}static credentialFromResult(e){return Gi.credentialFromTaggedObject(e)}static credentialFromError(e){return Gi.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e||!("oauthAccessToken"in e)||!e.oauthAccessToken)return null;try{return Gi.credential(e.oauthAccessToken)}catch{return null}}}Gi.GITHUB_SIGN_IN_METHOD="github.com";Gi.PROVIDER_ID="github.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ki extends cd{constructor(){super("twitter.com")}static credential(e,t){return aa._fromParams({providerId:Ki.PROVIDER_ID,signInMethod:Ki.TWITTER_SIGN_IN_METHOD,oauthToken:e,oauthTokenSecret:t})}static credentialFromResult(e){return Ki.credentialFromTaggedObject(e)}static credentialFromError(e){return Ki.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{oauthAccessToken:t,oauthTokenSecret:r}=e;if(!t||!r)return null;try{return Ki.credential(t,r)}catch{return null}}}Ki.TWITTER_SIGN_IN_METHOD="twitter.com";Ki.PROVIDER_ID="twitter.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function mI(n,e){return ld(n,"POST","/v1/accounts:signUp",wo(n,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ei{constructor(e){this.user=e.user,this.providerId=e.providerId,this._tokenResponse=e._tokenResponse,this.operationType=e.operationType}static async _fromIdTokenResponse(e,t,r,s=!1){const o=await kr._fromIdTokenResponse(e,r,s),l=$x(r);return new ei({user:o,providerId:l,_tokenResponse:r,operationType:t})}static async _forOperation(e,t,r){await e._updateTokensIfNecessary(r,!0);const s=$x(r);return new ei({user:e,providerId:s,_tokenResponse:r,operationType:t})}}function $x(n){return n.providerId?n.providerId:"phoneNumber"in n?"phone":null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function aO(n){if(bn(n.app))return Promise.reject(cs(n));const e=xo(n);if(await e._initializationPromise,e.currentUser?.isAnonymous)return new ei({user:e.currentUser,providerId:null,operationType:"signIn"});const t=await mI(e,{returnSecureToken:!0}),r=await ei._fromIdTokenResponse(e,"signIn",t,!0);return await e._updateCurrentUser(r.user),r}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class kf extends ws{constructor(e,t,r,s){super(t.code,t.message),this.operationType=r,this.user=s,Object.setPrototypeOf(this,kf.prototype),this.customData={appName:e.name,tenantId:e.tenantId??void 0,_serverResponse:t.customData._serverResponse,operationType:r}}static _fromErrorAndOperation(e,t,r,s){return new kf(e,t,r,s)}}function gI(n,e,t,r){return(e==="reauthenticate"?t._getReauthenticationResolver(n):t._getIdTokenResponse(n)).catch(o=>{throw o.code==="auth/multi-factor-auth-required"?kf._fromErrorAndOperation(n,o,e,r):o})}async function lO(n,e,t=!1){const r=await ju(n,e._linkToIdToken(n.auth,await n.getIdToken()),t);return ei._forOperation(n,"link",r)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function cO(n,e,t=!1){const{auth:r}=n;if(bn(r.app))return Promise.reject(cs(r));const s="reauthenticate";try{const o=await ju(n,gI(r,s,e,n),t);De(o.idToken,r,"internal-error");const l=U_(o.idToken);De(l,r,"internal-error");const{sub:u}=l;return De(n.uid===u,r,"user-mismatch"),ei._forOperation(n,s,o)}catch(o){throw o?.code==="auth/user-not-found"&&Mr(r,"user-mismatch"),o}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function yI(n,e,t=!1){if(bn(n.app))return Promise.reject(cs(n));const r="signIn",s=await gI(n,r,e),o=await ei._fromIdTokenResponse(n,r,s);return t||await n._updateCurrentUser(o.user),o}async function uO(n,e){return yI(xo(n),e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function _I(n){const e=xo(n);e._getPasswordPolicyInternal()&&await e._updatePasswordPolicy()}async function dO(n,e,t){if(bn(n.app))return Promise.reject(cs(n));const r=xo(n),l=await jy(r,{returnSecureToken:!0,email:e,password:t,clientType:"CLIENT_TYPE_WEB"},"signUpPassword",mI).catch(h=>{throw h.code==="auth/password-does-not-meet-requirements"&&_I(n),h}),u=await ei._fromIdTokenResponse(r,"signIn",l);return await r._updateCurrentUser(u.user),u}function hO(n,e,t){return bn(n.app)?Promise.reject(cs(n)):uO(ut(n),tc.credential(e,t)).catch(async r=>{throw r.code==="auth/password-does-not-meet-requirements"&&_I(n),r})}function fO(n,e,t,r){return ut(n).onIdTokenChanged(e,t,r)}function pO(n,e,t){return ut(n).beforeAuthStateChanged(e,t)}function mO(n,e,t,r){return ut(n).onAuthStateChanged(e,t,r)}function gO(n){return ut(n).signOut()}const Nf="__sak";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class vI{constructor(e,t){this.storageRetriever=e,this.type=t}_isAvailable(){try{return this.storage?(this.storage.setItem(Nf,"1"),this.storage.removeItem(Nf),Promise.resolve(!0)):Promise.resolve(!1)}catch{return Promise.resolve(!1)}}_set(e,t){return this.storage.setItem(e,JSON.stringify(t)),Promise.resolve()}_get(e){const t=this.storage.getItem(e);return Promise.resolve(t?JSON.parse(t):null)}_remove(e){return this.storage.removeItem(e),Promise.resolve()}get storage(){return this.storageRetriever()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const yO=1e3,_O=10;class wI extends vI{constructor(){super(()=>window.localStorage,"LOCAL"),this.boundEventHandler=(e,t)=>this.onStorageEvent(e,t),this.listeners={},this.localCache={},this.pollTimer=null,this.fallbackToPolling=cI(),this._shouldAllowMigration=!0}forAllChangedKeys(e){for(const t of Object.keys(this.listeners)){const r=this.storage.getItem(t),s=this.localCache[t];r!==s&&e(t,s,r)}}onStorageEvent(e,t=!1){if(!e.key){this.forAllChangedKeys((l,u,h)=>{this.notifyListeners(l,h)});return}const r=e.key;t?this.detachListener():this.stopPolling();const s=()=>{const l=this.storage.getItem(r);!t&&this.localCache[r]===l||this.notifyListeners(r,l)},o=this.storage.getItem(r);M2()&&o!==e.newValue&&e.newValue!==e.oldValue?setTimeout(s,_O):s()}notifyListeners(e,t){this.localCache[e]=t;const r=this.listeners[e];if(r)for(const s of Array.from(r))s(t&&JSON.parse(t))}startPolling(){this.stopPolling(),this.pollTimer=setInterval(()=>{this.forAllChangedKeys((e,t,r)=>{this.onStorageEvent(new StorageEvent("storage",{key:e,oldValue:t,newValue:r}),!0)})},yO)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}attachListener(){window.addEventListener("storage",this.boundEventHandler)}detachListener(){window.removeEventListener("storage",this.boundEventHandler)}_addListener(e,t){Object.keys(this.listeners).length===0&&(this.fallbackToPolling?this.startPolling():this.attachListener()),this.listeners[e]||(this.listeners[e]=new Set,this.localCache[e]=this.storage.getItem(e)),this.listeners[e].add(t)}_removeListener(e,t){this.listeners[e]&&(this.listeners[e].delete(t),this.listeners[e].size===0&&delete this.listeners[e]),Object.keys(this.listeners).length===0&&(this.detachListener(),this.stopPolling())}async _set(e,t){await super._set(e,t),this.localCache[e]=JSON.stringify(t)}async _get(e){const t=await super._get(e);return this.localCache[e]=JSON.stringify(t),t}async _remove(e){await super._remove(e),delete this.localCache[e]}}wI.type="LOCAL";const vO=wI;/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class EI extends vI{constructor(){super(()=>window.sessionStorage,"SESSION")}_addListener(e,t){}_removeListener(e,t){}}EI.type="SESSION";const xI=EI;/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function wO(n){return Promise.all(n.map(async e=>{try{return{fulfilled:!0,value:await e}}catch(t){return{fulfilled:!1,reason:t}}}))}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Cp{constructor(e){this.eventTarget=e,this.handlersMap={},this.boundEventHandler=this.handleEvent.bind(this)}static _getInstance(e){const t=this.receivers.find(s=>s.isListeningto(e));if(t)return t;const r=new Cp(e);return this.receivers.push(r),r}isListeningto(e){return this.eventTarget===e}async handleEvent(e){const t=e,{eventId:r,eventType:s,data:o}=t.data,l=this.handlersMap[s];if(!l?.size)return;t.ports[0].postMessage({status:"ack",eventId:r,eventType:s});const u=Array.from(l).map(async p=>p(t.origin,o)),h=await wO(u);t.ports[0].postMessage({status:"done",eventId:r,eventType:s,response:h})}_subscribe(e,t){Object.keys(this.handlersMap).length===0&&this.eventTarget.addEventListener("message",this.boundEventHandler),this.handlersMap[e]||(this.handlersMap[e]=new Set),this.handlersMap[e].add(t)}_unsubscribe(e,t){this.handlersMap[e]&&t&&this.handlersMap[e].delete(t),(!t||this.handlersMap[e].size===0)&&delete this.handlersMap[e],Object.keys(this.handlersMap).length===0&&this.eventTarget.removeEventListener("message",this.boundEventHandler)}}Cp.receivers=[];/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function W_(n="",e=10){let t="";for(let r=0;r<e;r++)t+=Math.floor(Math.random()*10);return n+t}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class EO{constructor(e){this.target=e,this.handlers=new Set}removeMessageHandler(e){e.messageChannel&&(e.messageChannel.port1.removeEventListener("message",e.onMessage),e.messageChannel.port1.close()),this.handlers.delete(e)}async _send(e,t,r=50){const s=typeof MessageChannel<"u"?new MessageChannel:null;if(!s)throw new Error("connection_unavailable");let o,l;return new Promise((u,h)=>{const p=W_("",20);s.port1.start();const g=setTimeout(()=>{h(new Error("unsupported_event"))},r);l={messageChannel:s,onMessage(_){const v=_;if(v.data.eventId===p)switch(v.data.status){case"ack":clearTimeout(g),o=setTimeout(()=>{h(new Error("timeout"))},3e3);break;case"done":clearTimeout(o),u(v.data.response);break;default:clearTimeout(g),clearTimeout(o),h(new Error("invalid_response"));break}}},this.handlers.add(l),s.port1.addEventListener("message",l.onMessage),this.target.postMessage({eventType:e,eventId:p,data:t},[s.port2])}).finally(()=>{l&&this.removeMessageHandler(l)})}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function us(){return window}function xO(n){us().location.href=n}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function TI(){return typeof us().WorkerGlobalScope<"u"&&typeof us().importScripts=="function"}async function TO(){if(!navigator?.serviceWorker)return null;try{return(await navigator.serviceWorker.ready).active}catch{return null}}function CO(){return navigator?.serviceWorker?.controller||null}function SO(){return TI()?self:null}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const CI="firebaseLocalStorageDb",IO=1,Pf="firebaseLocalStorage",SI="fbase_key";class ud{constructor(e){this.request=e}toPromise(){return new Promise((e,t)=>{this.request.addEventListener("success",()=>{e(this.request.result)}),this.request.addEventListener("error",()=>{t(this.request.error)})})}}function Sp(n,e){return n.transaction([Pf],e?"readwrite":"readonly").objectStore(Pf)}function bO(){const n=indexedDB.deleteDatabase(CI);return new ud(n).toPromise()}function Vy(){const n=indexedDB.open(CI,IO);return new Promise((e,t)=>{n.addEventListener("error",()=>{t(n.error)}),n.addEventListener("upgradeneeded",()=>{const r=n.result;try{r.createObjectStore(Pf,{keyPath:SI})}catch(s){t(s)}}),n.addEventListener("success",async()=>{const r=n.result;r.objectStoreNames.contains(Pf)?e(r):(r.close(),await bO(),e(await Vy()))})})}async function Wx(n,e,t){const r=Sp(n,!0).put({[SI]:e,value:t});return new ud(r).toPromise()}async function RO(n,e){const t=Sp(n,!1).get(e),r=await new ud(t).toPromise();return r===void 0?null:r.value}function Hx(n,e){const t=Sp(n,!0).delete(e);return new ud(t).toPromise()}const AO=800,kO=3;class II{constructor(){this.type="LOCAL",this._shouldAllowMigration=!0,this.listeners={},this.localCache={},this.pollTimer=null,this.pendingWrites=0,this.receiver=null,this.sender=null,this.serviceWorkerReceiverAvailable=!1,this.activeServiceWorker=null,this._workerInitializationPromise=this.initializeServiceWorkerMessaging().then(()=>{},()=>{})}async _openDb(){return this.db?this.db:(this.db=await Vy(),this.db)}async _withRetries(e){let t=0;for(;;)try{const r=await this._openDb();return await e(r)}catch(r){if(t++>kO)throw r;this.db&&(this.db.close(),this.db=void 0)}}async initializeServiceWorkerMessaging(){return TI()?this.initializeReceiver():this.initializeSender()}async initializeReceiver(){this.receiver=Cp._getInstance(SO()),this.receiver._subscribe("keyChanged",async(e,t)=>({keyProcessed:(await this._poll()).includes(t.key)})),this.receiver._subscribe("ping",async(e,t)=>["keyChanged"])}async initializeSender(){if(this.activeServiceWorker=await TO(),!this.activeServiceWorker)return;this.sender=new EO(this.activeServiceWorker);const e=await this.sender._send("ping",{},800);e&&e[0]?.fulfilled&&e[0]?.value.includes("keyChanged")&&(this.serviceWorkerReceiverAvailable=!0)}async notifyServiceWorker(e){if(!(!this.sender||!this.activeServiceWorker||CO()!==this.activeServiceWorker))try{await this.sender._send("keyChanged",{key:e},this.serviceWorkerReceiverAvailable?800:50)}catch{}}async _isAvailable(){try{if(!indexedDB)return!1;const e=await Vy();return await Wx(e,Nf,"1"),await Hx(e,Nf),!0}catch{}return!1}async _withPendingWrite(e){this.pendingWrites++;try{await e()}finally{this.pendingWrites--}}async _set(e,t){return this._withPendingWrite(async()=>(await this._withRetries(r=>Wx(r,e,t)),this.localCache[e]=t,this.notifyServiceWorker(e)))}async _get(e){const t=await this._withRetries(r=>RO(r,e));return this.localCache[e]=t,t}async _remove(e){return this._withPendingWrite(async()=>(await this._withRetries(t=>Hx(t,e)),delete this.localCache[e],this.notifyServiceWorker(e)))}async _poll(){const e=await this._withRetries(s=>{const o=Sp(s,!1).getAll();return new ud(o).toPromise()});if(!e)return[];if(this.pendingWrites!==0)return[];const t=[],r=new Set;if(e.length!==0)for(const{fbase_key:s,value:o}of e)r.add(s),JSON.stringify(this.localCache[s])!==JSON.stringify(o)&&(this.notifyListeners(s,o),t.push(s));for(const s of Object.keys(this.localCache))this.localCache[s]&&!r.has(s)&&(this.notifyListeners(s,null),t.push(s));return t}notifyListeners(e,t){this.localCache[e]=t;const r=this.listeners[e];if(r)for(const s of Array.from(r))s(t)}startPolling(){this.stopPolling(),this.pollTimer=setInterval(async()=>this._poll(),AO)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}_addListener(e,t){Object.keys(this.listeners).length===0&&this.startPolling(),this.listeners[e]||(this.listeners[e]=new Set,this._get(e)),this.listeners[e].add(t)}_removeListener(e,t){this.listeners[e]&&(this.listeners[e].delete(t),this.listeners[e].size===0&&delete this.listeners[e]),Object.keys(this.listeners).length===0&&this.stopPolling()}}II.type="LOCAL";const NO=II;new ad(3e4,6e4);/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function PO(n,e){return e?Gs(e):(De(n._popupRedirectResolver,n,"argument-error"),n._popupRedirectResolver)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class H_ extends B_{constructor(e){super("custom","custom"),this.params=e}_getIdTokenResponse(e){return Rl(e,this._buildIdpRequest())}_linkToIdToken(e,t){return Rl(e,this._buildIdpRequest(t))}_getReauthenticationResolver(e){return Rl(e,this._buildIdpRequest())}_buildIdpRequest(e){const t={requestUri:this.params.requestUri,sessionId:this.params.sessionId,postBody:this.params.postBody,tenantId:this.params.tenantId,pendingToken:this.params.pendingToken,returnSecureToken:!0,returnIdpCredential:!0};return e&&(t.idToken=e),t}}function DO(n){return yI(n.auth,new H_(n),n.bypassAuthState)}function OO(n){const{auth:e,user:t}=n;return De(t,e,"internal-error"),cO(t,new H_(n),n.bypassAuthState)}async function MO(n){const{auth:e,user:t}=n;return De(t,e,"internal-error"),lO(t,new H_(n),n.bypassAuthState)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class bI{constructor(e,t,r,s,o=!1){this.auth=e,this.resolver=r,this.user=s,this.bypassAuthState=o,this.pendingPromise=null,this.eventManager=null,this.filter=Array.isArray(t)?t:[t]}execute(){return new Promise(async(e,t)=>{this.pendingPromise={resolve:e,reject:t};try{this.eventManager=await this.resolver._initialize(this.auth),await this.onExecution(),this.eventManager.registerConsumer(this)}catch(r){this.reject(r)}})}async onAuthEvent(e){const{urlResponse:t,sessionId:r,postBody:s,tenantId:o,error:l,type:u}=e;if(l){this.reject(l);return}const h={auth:this.auth,requestUri:t,sessionId:r,tenantId:o||void 0,postBody:s||void 0,user:this.user,bypassAuthState:this.bypassAuthState};try{this.resolve(await this.getIdpTask(u)(h))}catch(p){this.reject(p)}}onError(e){this.reject(e)}getIdpTask(e){switch(e){case"signInViaPopup":case"signInViaRedirect":return DO;case"linkViaPopup":case"linkViaRedirect":return MO;case"reauthViaPopup":case"reauthViaRedirect":return OO;default:Mr(this.auth,"internal-error")}}resolve(e){Zs(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.resolve(e),this.unregisterAndCleanUp()}reject(e){Zs(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.reject(e),this.unregisterAndCleanUp()}unregisterAndCleanUp(){this.eventManager&&this.eventManager.unregisterConsumer(this),this.pendingPromise=null,this.cleanUp()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const LO=new ad(2e3,1e4);class Cl extends bI{constructor(e,t,r,s,o){super(e,t,s,o),this.provider=r,this.authWindow=null,this.pollId=null,Cl.currentPopupAction&&Cl.currentPopupAction.cancel(),Cl.currentPopupAction=this}async executeNotNull(){const e=await this.execute();return De(e,this.auth,"internal-error"),e}async onExecution(){Zs(this.filter.length===1,"Popup operations only handle one event");const e=W_();this.authWindow=await this.resolver._openPopup(this.auth,this.provider,this.filter[0],e),this.authWindow.associatedEvent=e,this.resolver._originValidation(this.auth).catch(t=>{this.reject(t)}),this.resolver._isIframeWebStorageSupported(this.auth,t=>{t||this.reject(ls(this.auth,"web-storage-unsupported"))}),this.pollUserCancellation()}get eventId(){return this.authWindow?.associatedEvent||null}cancel(){this.reject(ls(this.auth,"cancelled-popup-request"))}cleanUp(){this.authWindow&&this.authWindow.close(),this.pollId&&window.clearTimeout(this.pollId),this.authWindow=null,this.pollId=null,Cl.currentPopupAction=null}pollUserCancellation(){const e=()=>{if(this.authWindow?.window?.closed){this.pollId=window.setTimeout(()=>{this.pollId=null,this.reject(ls(this.auth,"popup-closed-by-user"))},8e3);return}this.pollId=window.setTimeout(e,LO.get())};e()}}Cl.currentPopupAction=null;/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const jO="pendingRedirect",cf=new Map;class VO extends bI{constructor(e,t,r=!1){super(e,["signInViaRedirect","linkViaRedirect","reauthViaRedirect","unknown"],t,void 0,r),this.eventId=null}async execute(){let e=cf.get(this.auth._key());if(!e){try{const r=await FO(this.resolver,this.auth)?await super.execute():null;e=()=>Promise.resolve(r)}catch(t){e=()=>Promise.reject(t)}cf.set(this.auth._key(),e)}return this.bypassAuthState||cf.set(this.auth._key(),()=>Promise.resolve(null)),e()}async onAuthEvent(e){if(e.type==="signInViaRedirect")return super.onAuthEvent(e);if(e.type==="unknown"){this.resolve(null);return}if(e.eventId){const t=await this.auth._redirectUserForId(e.eventId);if(t)return this.user=t,super.onAuthEvent(e);this.resolve(null)}}async onExecution(){}cleanUp(){}}async function FO(n,e){const t=BO(e),r=zO(n);if(!await r._isAvailable())return!1;const s=await r._get(t)==="true";return await r._remove(t),s}function UO(n,e){cf.set(n._key(),e)}function zO(n){return Gs(n._redirectPersistence)}function BO(n){return lf(jO,n.config.apiKey,n.name)}async function $O(n,e,t=!1){if(bn(n.app))return Promise.reject(cs(n));const r=xo(n),s=PO(r,e),l=await new VO(r,s,t).execute();return l&&!t&&(delete l.user._redirectEventId,await r._persistUserIfCurrent(l.user),await r._setRedirectUser(null,e)),l}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const WO=600*1e3;class HO{constructor(e){this.auth=e,this.cachedEventUids=new Set,this.consumers=new Set,this.queuedRedirectEvent=null,this.hasHandledPotentialRedirect=!1,this.lastProcessedEventTime=Date.now()}registerConsumer(e){this.consumers.add(e),this.queuedRedirectEvent&&this.isEventForConsumer(this.queuedRedirectEvent,e)&&(this.sendToConsumer(this.queuedRedirectEvent,e),this.saveEventToCache(this.queuedRedirectEvent),this.queuedRedirectEvent=null)}unregisterConsumer(e){this.consumers.delete(e)}onEvent(e){if(this.hasEventBeenHandled(e))return!1;let t=!1;return this.consumers.forEach(r=>{this.isEventForConsumer(e,r)&&(t=!0,this.sendToConsumer(e,r),this.saveEventToCache(e))}),this.hasHandledPotentialRedirect||!qO(e)||(this.hasHandledPotentialRedirect=!0,t||(this.queuedRedirectEvent=e,t=!0)),t}sendToConsumer(e,t){if(e.error&&!RI(e)){const r=e.error.code?.split("auth/")[1]||"internal-error";t.onError(ls(this.auth,r))}else t.onAuthEvent(e)}isEventForConsumer(e,t){const r=t.eventId===null||!!e.eventId&&e.eventId===t.eventId;return t.filter.includes(e.type)&&r}hasEventBeenHandled(e){return Date.now()-this.lastProcessedEventTime>=WO&&this.cachedEventUids.clear(),this.cachedEventUids.has(qx(e))}saveEventToCache(e){this.cachedEventUids.add(qx(e)),this.lastProcessedEventTime=Date.now()}}function qx(n){return[n.type,n.eventId,n.sessionId,n.tenantId].filter(e=>e).join("-")}function RI({type:n,error:e}){return n==="unknown"&&e?.code==="auth/no-auth-event"}function qO(n){switch(n.type){case"signInViaRedirect":case"linkViaRedirect":case"reauthViaRedirect":return!0;case"unknown":return RI(n);default:return!1}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function GO(n,e={}){return Eo(n,"GET","/v1/projects",e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const KO=/^\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3}$/,QO=/^https?/;async function YO(n){if(n.config.emulator)return;const{authorizedDomains:e}=await GO(n);for(const t of e)try{if(XO(t))return}catch{}Mr(n,"unauthorized-domain")}function XO(n){const e=My(),{protocol:t,hostname:r}=new URL(e);if(n.startsWith("chrome-extension://")){const l=new URL(n);return l.hostname===""&&r===""?t==="chrome-extension:"&&n.replace("chrome-extension://","")===e.replace("chrome-extension://",""):t==="chrome-extension:"&&l.hostname===r}if(!QO.test(t))return!1;if(KO.test(n))return r===n;const s=n.replace(/\./g,"\\.");return new RegExp("^(.+\\."+s+"|"+s+")$","i").test(r)}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const JO=new ad(3e4,6e4);function Gx(){const n=us().___jsl;if(n?.H){for(const e of Object.keys(n.H))if(n.H[e].r=n.H[e].r||[],n.H[e].L=n.H[e].L||[],n.H[e].r=[...n.H[e].L],n.CP)for(let t=0;t<n.CP.length;t++)n.CP[t]=null}}function ZO(n){return new Promise((e,t)=>{function r(){Gx(),gapi.load("gapi.iframes",{callback:()=>{e(gapi.iframes.getContext())},ontimeout:()=>{Gx(),t(ls(n,"network-request-failed"))},timeout:JO.get()})}if(us().gapi?.iframes?.Iframe)e(gapi.iframes.getContext());else if(us().gapi?.load)r();else{const s=W2("iframefcb");return us()[s]=()=>{gapi.load?r():t(ls(n,"network-request-failed"))},dI(`${$2()}?onload=${s}`).catch(o=>t(o))}}).catch(e=>{throw uf=null,e})}let uf=null;function eM(n){return uf=uf||ZO(n),uf}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const tM=new ad(5e3,15e3),nM="__/auth/iframe",rM="emulator/auth/iframe",sM={style:{position:"absolute",top:"-100px",width:"1px",height:"1px"},"aria-hidden":"true",tabindex:"-1"},iM=new Map([["identitytoolkit.googleapis.com","p"],["staging-identitytoolkit.sandbox.googleapis.com","s"],["test-identitytoolkit.sandbox.googleapis.com","t"]]);function oM(n){const e=n.config;De(e.authDomain,n,"auth-domain-config-required");const t=e.emulator?F_(e,rM):`https://${n.config.authDomain}/${nM}`,r={apiKey:e.apiKey,appName:n.name,v:vo},s=iM.get(n.config.apiHost);s&&(r.eid=s);const o=n._getFrameworks();return o.length&&(r.fw=o.join(",")),`${t}?${ec(r).slice(1)}`}async function aM(n){const e=await eM(n),t=us().gapi;return De(t,n,"internal-error"),e.open({where:document.body,url:oM(n),messageHandlersFilter:t.iframes.CROSS_ORIGIN_IFRAMES_FILTER,attributes:sM,dontclear:!0},r=>new Promise(async(s,o)=>{await r.restyle({setHideOnLeave:!1});const l=ls(n,"network-request-failed"),u=us().setTimeout(()=>{o(l)},tM.get());function h(){us().clearTimeout(u),s(r)}r.ping(h).then(h,()=>{o(l)})}))}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const lM={location:"yes",resizable:"yes",statusbar:"yes",toolbar:"no"},cM=500,uM=600,dM="_blank",hM="http://localhost";class Kx{constructor(e){this.window=e,this.associatedEvent=null}close(){if(this.window)try{this.window.close()}catch{}}}function fM(n,e,t,r=cM,s=uM){const o=Math.max((window.screen.availHeight-s)/2,0).toString(),l=Math.max((window.screen.availWidth-r)/2,0).toString();let u="";const h={...lM,width:r.toString(),height:s.toString(),top:o,left:l},p=En().toLowerCase();t&&(u=sI(p)?dM:t),nI(p)&&(e=e||hM,h.scrollbars="yes");const g=Object.entries(h).reduce((v,[T,A])=>`${v}${T}=${A},`,"");if(O2(p)&&u!=="_self")return pM(e||"",u),new Kx(null);const _=window.open(e||"",u,g);De(_,n,"popup-blocked");try{_.focus()}catch{}return new Kx(_)}function pM(n,e){const t=document.createElement("a");t.href=n,t.target=e;const r=document.createEvent("MouseEvent");r.initMouseEvent("click",!0,!0,window,1,0,0,0,0,!1,!1,!1,!1,1,null),t.dispatchEvent(r)}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const mM="__/auth/handler",gM="emulator/auth/handler",yM=encodeURIComponent("fac");async function Qx(n,e,t,r,s,o){De(n.config.authDomain,n,"auth-domain-config-required"),De(n.config.apiKey,n,"invalid-api-key");const l={apiKey:n.config.apiKey,appName:n.name,authType:t,redirectUrl:r,v:vo,eventId:s};if(e instanceof pI){e.setDefaultLanguage(n.languageCode),l.providerId=e.providerId||"",Cf(e.getCustomParameters())||(l.customParameters=JSON.stringify(e.getCustomParameters()));for(const[g,_]of Object.entries({}))l[g]=_}if(e instanceof cd){const g=e.getScopes().filter(_=>_!=="");g.length>0&&(l.scopes=g.join(","))}n.tenantId&&(l.tid=n.tenantId);const u=l;for(const g of Object.keys(u))u[g]===void 0&&delete u[g];const h=await n._getAppCheckToken(),p=h?`#${yM}=${encodeURIComponent(h)}`:"";return`${_M(n)}?${ec(u).slice(1)}${p}`}function _M({config:n}){return n.emulator?F_(n,gM):`https://${n.authDomain}/${mM}`}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ty="webStorageSupport";class vM{constructor(){this.eventManagers={},this.iframes={},this.originValidationPromises={},this._redirectPersistence=xI,this._completeRedirectFn=$O,this._overrideRedirectResult=UO}async _openPopup(e,t,r,s){Zs(this.eventManagers[e._key()]?.manager,"_initialize() not called before _openPopup()");const o=await Qx(e,t,r,My(),s);return fM(e,o,W_())}async _openRedirect(e,t,r,s){await this._originValidation(e);const o=await Qx(e,t,r,My(),s);return xO(o),new Promise(()=>{})}_initialize(e){const t=e._key();if(this.eventManagers[t]){const{manager:s,promise:o}=this.eventManagers[t];return s?Promise.resolve(s):(Zs(o,"If manager is not set, promise should be"),o)}const r=this.initAndGetManager(e);return this.eventManagers[t]={promise:r},r.catch(()=>{delete this.eventManagers[t]}),r}async initAndGetManager(e){const t=await aM(e),r=new HO(e);return t.register("authEvent",s=>(De(s?.authEvent,e,"invalid-auth-event"),{status:r.onEvent(s.authEvent)?"ACK":"ERROR"}),gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER),this.eventManagers[e._key()]={manager:r},this.iframes[e._key()]=t,r}_isIframeWebStorageSupported(e,t){this.iframes[e._key()].send(ty,{type:ty},s=>{const o=s?.[0]?.[ty];o!==void 0&&t(!!o),Mr(e,"internal-error")},gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER)}_originValidation(e){const t=e._key();return this.originValidationPromises[t]||(this.originValidationPromises[t]=YO(e)),this.originValidationPromises[t]}get _shouldInitProactively(){return cI()||rI()||z_()}}const wM=vM;var Yx="@firebase/auth",Xx="1.11.0";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class EM{constructor(e){this.auth=e,this.internalListeners=new Map}getUid(){return this.assertAuthConfigured(),this.auth.currentUser?.uid||null}async getToken(e){return this.assertAuthConfigured(),await this.auth._initializationPromise,this.auth.currentUser?{accessToken:await this.auth.currentUser.getIdToken(e)}:null}addAuthTokenListener(e){if(this.assertAuthConfigured(),this.internalListeners.has(e))return;const t=this.auth.onIdTokenChanged(r=>{e(r?.stsTokenManager.accessToken||null)});this.internalListeners.set(e,t),this.updateProactiveRefresh()}removeAuthTokenListener(e){this.assertAuthConfigured();const t=this.internalListeners.get(e);t&&(this.internalListeners.delete(e),t(),this.updateProactiveRefresh())}assertAuthConfigured(){De(this.auth._initializationPromise,"dependent-sdk-initialized-before-auth")}updateProactiveRefresh(){this.internalListeners.size>0?this.auth._startProactiveRefresh():this.auth._stopProactiveRefresh()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function xM(n){switch(n){case"Node":return"node";case"ReactNative":return"rn";case"Worker":return"webworker";case"Cordova":return"cordova";case"WebExtension":return"web-extension";default:return}}function TM(n){oo(new Xs("auth",(e,{options:t})=>{const r=e.getProvider("app").getImmediate(),s=e.getProvider("heartbeat"),o=e.getProvider("app-check-internal"),{apiKey:l,authDomain:u}=r.options;De(l&&!l.includes(":"),"invalid-api-key",{appName:r.name});const h={apiKey:l,authDomain:u,clientPlatform:n,apiHost:"identitytoolkit.googleapis.com",tokenApiHost:"securetoken.googleapis.com",apiScheme:"https",sdkClientVersion:uI(n)},p=new U2(r,s,o,h);return Y2(p,t),p},"PUBLIC").setInstantiationMode("EXPLICIT").setInstanceCreatedCallback((e,t,r)=>{e.getProvider("auth-internal").initialize()})),oo(new Xs("auth-internal",e=>{const t=xo(e.getProvider("auth").getImmediate());return(r=>new EM(r))(t)},"PRIVATE").setInstantiationMode("EXPLICIT")),gr(Yx,Xx,xM(n)),gr(Yx,Xx,"esm2020")}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const CM=300,SM=US("authIdTokenMaxAge")||CM;let Jx=null;const IM=n=>async e=>{const t=e&&await e.getIdTokenResult(),r=t&&(new Date().getTime()-Date.parse(t.issuedAtTime))/1e3;if(r&&r>SM)return;const s=t?.token;Jx!==s&&(Jx=s,await fetch(n,{method:s?"POST":"DELETE",headers:s?{Authorization:`Bearer ${s}`}:{}}))};function bM(n=xp()){const e=od(n,"auth");if(e.isInitialized())return e.getImmediate();const t=Q2(n,{popupRedirectResolver:wM,persistence:[NO,vO,xI]}),r=US("authTokenSyncURL");if(r&&typeof isSecureContext=="boolean"&&isSecureContext){const o=new URL(r,location.origin);if(location.origin===o.origin){const l=IM(o.toString());pO(t,l,()=>l(t.currentUser)),fO(t,u=>l(u))}}const s=VS("auth");return s&&X2(t,`http://${s}`),t}function RM(){return document.getElementsByTagName("head")?.[0]??document}z2({loadJS(n){return new Promise((e,t)=>{const r=document.createElement("script");r.setAttribute("src",n),r.onload=e,r.onerror=s=>{const o=ls("internal-error");o.customData=s,t(o)},r.type="text/javascript",r.charset="UTF-8",RM().appendChild(r)})},gapiScript:"https://apis.google.com/js/api.js",recaptchaV2Script:"https://www.google.com/recaptcha/api.js",recaptchaEnterpriseScript:"https://www.google.com/recaptcha/enterprise.js?render="});TM("Browser");var Zx=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};/** @license
Copyright The Closure Library Authors.
SPDX-License-Identifier: Apache-2.0
*/var Zi,AI;(function(){var n;/** @license

 Copyright The Closure Library Authors.
 SPDX-License-Identifier: Apache-2.0
*/function e(P,R){function N(){}N.prototype=R.prototype,P.F=R.prototype,P.prototype=new N,P.prototype.constructor=P,P.D=function(L,O,F){for(var D=Array(arguments.length-2),Ce=2;Ce<arguments.length;Ce++)D[Ce-2]=arguments[Ce];return R.prototype[O].apply(L,D)}}function t(){this.blockSize=-1}function r(){this.blockSize=-1,this.blockSize=64,this.g=Array(4),this.C=Array(this.blockSize),this.o=this.h=0,this.u()}e(r,t),r.prototype.u=function(){this.g[0]=1732584193,this.g[1]=4023233417,this.g[2]=2562383102,this.g[3]=271733878,this.o=this.h=0};function s(P,R,N){N||(N=0);const L=Array(16);if(typeof R=="string")for(var O=0;O<16;++O)L[O]=R.charCodeAt(N++)|R.charCodeAt(N++)<<8|R.charCodeAt(N++)<<16|R.charCodeAt(N++)<<24;else for(O=0;O<16;++O)L[O]=R[N++]|R[N++]<<8|R[N++]<<16|R[N++]<<24;R=P.g[0],N=P.g[1],O=P.g[2];let F=P.g[3],D;D=R+(F^N&(O^F))+L[0]+3614090360&4294967295,R=N+(D<<7&4294967295|D>>>25),D=F+(O^R&(N^O))+L[1]+3905402710&4294967295,F=R+(D<<12&4294967295|D>>>20),D=O+(N^F&(R^N))+L[2]+606105819&4294967295,O=F+(D<<17&4294967295|D>>>15),D=N+(R^O&(F^R))+L[3]+3250441966&4294967295,N=O+(D<<22&4294967295|D>>>10),D=R+(F^N&(O^F))+L[4]+4118548399&4294967295,R=N+(D<<7&4294967295|D>>>25),D=F+(O^R&(N^O))+L[5]+1200080426&4294967295,F=R+(D<<12&4294967295|D>>>20),D=O+(N^F&(R^N))+L[6]+2821735955&4294967295,O=F+(D<<17&4294967295|D>>>15),D=N+(R^O&(F^R))+L[7]+4249261313&4294967295,N=O+(D<<22&4294967295|D>>>10),D=R+(F^N&(O^F))+L[8]+1770035416&4294967295,R=N+(D<<7&4294967295|D>>>25),D=F+(O^R&(N^O))+L[9]+2336552879&4294967295,F=R+(D<<12&4294967295|D>>>20),D=O+(N^F&(R^N))+L[10]+4294925233&4294967295,O=F+(D<<17&4294967295|D>>>15),D=N+(R^O&(F^R))+L[11]+2304563134&4294967295,N=O+(D<<22&4294967295|D>>>10),D=R+(F^N&(O^F))+L[12]+1804603682&4294967295,R=N+(D<<7&4294967295|D>>>25),D=F+(O^R&(N^O))+L[13]+4254626195&4294967295,F=R+(D<<12&4294967295|D>>>20),D=O+(N^F&(R^N))+L[14]+2792965006&4294967295,O=F+(D<<17&4294967295|D>>>15),D=N+(R^O&(F^R))+L[15]+1236535329&4294967295,N=O+(D<<22&4294967295|D>>>10),D=R+(O^F&(N^O))+L[1]+4129170786&4294967295,R=N+(D<<5&4294967295|D>>>27),D=F+(N^O&(R^N))+L[6]+3225465664&4294967295,F=R+(D<<9&4294967295|D>>>23),D=O+(R^N&(F^R))+L[11]+643717713&4294967295,O=F+(D<<14&4294967295|D>>>18),D=N+(F^R&(O^F))+L[0]+3921069994&4294967295,N=O+(D<<20&4294967295|D>>>12),D=R+(O^F&(N^O))+L[5]+3593408605&4294967295,R=N+(D<<5&4294967295|D>>>27),D=F+(N^O&(R^N))+L[10]+38016083&4294967295,F=R+(D<<9&4294967295|D>>>23),D=O+(R^N&(F^R))+L[15]+3634488961&4294967295,O=F+(D<<14&4294967295|D>>>18),D=N+(F^R&(O^F))+L[4]+3889429448&4294967295,N=O+(D<<20&4294967295|D>>>12),D=R+(O^F&(N^O))+L[9]+568446438&4294967295,R=N+(D<<5&4294967295|D>>>27),D=F+(N^O&(R^N))+L[14]+3275163606&4294967295,F=R+(D<<9&4294967295|D>>>23),D=O+(R^N&(F^R))+L[3]+4107603335&4294967295,O=F+(D<<14&4294967295|D>>>18),D=N+(F^R&(O^F))+L[8]+1163531501&4294967295,N=O+(D<<20&4294967295|D>>>12),D=R+(O^F&(N^O))+L[13]+2850285829&4294967295,R=N+(D<<5&4294967295|D>>>27),D=F+(N^O&(R^N))+L[2]+4243563512&4294967295,F=R+(D<<9&4294967295|D>>>23),D=O+(R^N&(F^R))+L[7]+1735328473&4294967295,O=F+(D<<14&4294967295|D>>>18),D=N+(F^R&(O^F))+L[12]+2368359562&4294967295,N=O+(D<<20&4294967295|D>>>12),D=R+(N^O^F)+L[5]+4294588738&4294967295,R=N+(D<<4&4294967295|D>>>28),D=F+(R^N^O)+L[8]+2272392833&4294967295,F=R+(D<<11&4294967295|D>>>21),D=O+(F^R^N)+L[11]+1839030562&4294967295,O=F+(D<<16&4294967295|D>>>16),D=N+(O^F^R)+L[14]+4259657740&4294967295,N=O+(D<<23&4294967295|D>>>9),D=R+(N^O^F)+L[1]+2763975236&4294967295,R=N+(D<<4&4294967295|D>>>28),D=F+(R^N^O)+L[4]+1272893353&4294967295,F=R+(D<<11&4294967295|D>>>21),D=O+(F^R^N)+L[7]+4139469664&4294967295,O=F+(D<<16&4294967295|D>>>16),D=N+(O^F^R)+L[10]+3200236656&4294967295,N=O+(D<<23&4294967295|D>>>9),D=R+(N^O^F)+L[13]+681279174&4294967295,R=N+(D<<4&4294967295|D>>>28),D=F+(R^N^O)+L[0]+3936430074&4294967295,F=R+(D<<11&4294967295|D>>>21),D=O+(F^R^N)+L[3]+3572445317&4294967295,O=F+(D<<16&4294967295|D>>>16),D=N+(O^F^R)+L[6]+76029189&4294967295,N=O+(D<<23&4294967295|D>>>9),D=R+(N^O^F)+L[9]+3654602809&4294967295,R=N+(D<<4&4294967295|D>>>28),D=F+(R^N^O)+L[12]+3873151461&4294967295,F=R+(D<<11&4294967295|D>>>21),D=O+(F^R^N)+L[15]+530742520&4294967295,O=F+(D<<16&4294967295|D>>>16),D=N+(O^F^R)+L[2]+3299628645&4294967295,N=O+(D<<23&4294967295|D>>>9),D=R+(O^(N|~F))+L[0]+4096336452&4294967295,R=N+(D<<6&4294967295|D>>>26),D=F+(N^(R|~O))+L[7]+1126891415&4294967295,F=R+(D<<10&4294967295|D>>>22),D=O+(R^(F|~N))+L[14]+2878612391&4294967295,O=F+(D<<15&4294967295|D>>>17),D=N+(F^(O|~R))+L[5]+4237533241&4294967295,N=O+(D<<21&4294967295|D>>>11),D=R+(O^(N|~F))+L[12]+1700485571&4294967295,R=N+(D<<6&4294967295|D>>>26),D=F+(N^(R|~O))+L[3]+2399980690&4294967295,F=R+(D<<10&4294967295|D>>>22),D=O+(R^(F|~N))+L[10]+4293915773&4294967295,O=F+(D<<15&4294967295|D>>>17),D=N+(F^(O|~R))+L[1]+2240044497&4294967295,N=O+(D<<21&4294967295|D>>>11),D=R+(O^(N|~F))+L[8]+1873313359&4294967295,R=N+(D<<6&4294967295|D>>>26),D=F+(N^(R|~O))+L[15]+4264355552&4294967295,F=R+(D<<10&4294967295|D>>>22),D=O+(R^(F|~N))+L[6]+2734768916&4294967295,O=F+(D<<15&4294967295|D>>>17),D=N+(F^(O|~R))+L[13]+1309151649&4294967295,N=O+(D<<21&4294967295|D>>>11),D=R+(O^(N|~F))+L[4]+4149444226&4294967295,R=N+(D<<6&4294967295|D>>>26),D=F+(N^(R|~O))+L[11]+3174756917&4294967295,F=R+(D<<10&4294967295|D>>>22),D=O+(R^(F|~N))+L[2]+718787259&4294967295,O=F+(D<<15&4294967295|D>>>17),D=N+(F^(O|~R))+L[9]+3951481745&4294967295,P.g[0]=P.g[0]+R&4294967295,P.g[1]=P.g[1]+(O+(D<<21&4294967295|D>>>11))&4294967295,P.g[2]=P.g[2]+O&4294967295,P.g[3]=P.g[3]+F&4294967295}r.prototype.v=function(P,R){R===void 0&&(R=P.length);const N=R-this.blockSize,L=this.C;let O=this.h,F=0;for(;F<R;){if(O==0)for(;F<=N;)s(this,P,F),F+=this.blockSize;if(typeof P=="string"){for(;F<R;)if(L[O++]=P.charCodeAt(F++),O==this.blockSize){s(this,L),O=0;break}}else for(;F<R;)if(L[O++]=P[F++],O==this.blockSize){s(this,L),O=0;break}}this.h=O,this.o+=R},r.prototype.A=function(){var P=Array((this.h<56?this.blockSize:this.blockSize*2)-this.h);P[0]=128;for(var R=1;R<P.length-8;++R)P[R]=0;R=this.o*8;for(var N=P.length-8;N<P.length;++N)P[N]=R&255,R/=256;for(this.v(P),P=Array(16),R=0,N=0;N<4;++N)for(let L=0;L<32;L+=8)P[R++]=this.g[N]>>>L&255;return P};function o(P,R){var N=u;return Object.prototype.hasOwnProperty.call(N,P)?N[P]:N[P]=R(P)}function l(P,R){this.h=R;const N=[];let L=!0;for(let O=P.length-1;O>=0;O--){const F=P[O]|0;L&&F==R||(N[O]=F,L=!1)}this.g=N}var u={};function h(P){return-128<=P&&P<128?o(P,function(R){return new l([R|0],R<0?-1:0)}):new l([P|0],P<0?-1:0)}function p(P){if(isNaN(P)||!isFinite(P))return _;if(P<0)return b(p(-P));const R=[];let N=1;for(let L=0;P>=N;L++)R[L]=P/N|0,N*=4294967296;return new l(R,0)}function g(P,R){if(P.length==0)throw Error("number format error: empty string");if(R=R||10,R<2||36<R)throw Error("radix out of range: "+R);if(P.charAt(0)=="-")return b(g(P.substring(1),R));if(P.indexOf("-")>=0)throw Error('number format error: interior "-" character');const N=p(Math.pow(R,8));let L=_;for(let F=0;F<P.length;F+=8){var O=Math.min(8,P.length-F);const D=parseInt(P.substring(F,F+O),R);O<8?(O=p(Math.pow(R,O)),L=L.j(O).add(p(D))):(L=L.j(N),L=L.add(p(D)))}return L}var _=h(0),v=h(1),T=h(16777216);n=l.prototype,n.m=function(){if(I(this))return-b(this).m();let P=0,R=1;for(let N=0;N<this.g.length;N++){const L=this.i(N);P+=(L>=0?L:4294967296+L)*R,R*=4294967296}return P},n.toString=function(P){if(P=P||10,P<2||36<P)throw Error("radix out of range: "+P);if(A(this))return"0";if(I(this))return"-"+b(this).toString(P);const R=p(Math.pow(P,6));var N=this;let L="";for(;;){const O=G(N,R).g;N=j(N,O.j(R));let F=((N.g.length>0?N.g[0]:N.h)>>>0).toString(P);if(N=O,A(N))return F+L;for(;F.length<6;)F="0"+F;L=F+L}},n.i=function(P){return P<0?0:P<this.g.length?this.g[P]:this.h};function A(P){if(P.h!=0)return!1;for(let R=0;R<P.g.length;R++)if(P.g[R]!=0)return!1;return!0}function I(P){return P.h==-1}n.l=function(P){return P=j(this,P),I(P)?-1:A(P)?0:1};function b(P){const R=P.g.length,N=[];for(let L=0;L<R;L++)N[L]=~P.g[L];return new l(N,~P.h).add(v)}n.abs=function(){return I(this)?b(this):this},n.add=function(P){const R=Math.max(this.g.length,P.g.length),N=[];let L=0;for(let O=0;O<=R;O++){let F=L+(this.i(O)&65535)+(P.i(O)&65535),D=(F>>>16)+(this.i(O)>>>16)+(P.i(O)>>>16);L=D>>>16,F&=65535,D&=65535,N[O]=D<<16|F}return new l(N,N[N.length-1]&-2147483648?-1:0)};function j(P,R){return P.add(b(R))}n.j=function(P){if(A(this)||A(P))return _;if(I(this))return I(P)?b(this).j(b(P)):b(b(this).j(P));if(I(P))return b(this.j(b(P)));if(this.l(T)<0&&P.l(T)<0)return p(this.m()*P.m());const R=this.g.length+P.g.length,N=[];for(var L=0;L<2*R;L++)N[L]=0;for(L=0;L<this.g.length;L++)for(let O=0;O<P.g.length;O++){const F=this.i(L)>>>16,D=this.i(L)&65535,Ce=P.i(O)>>>16,je=P.i(O)&65535;N[2*L+2*O]+=D*je,U(N,2*L+2*O),N[2*L+2*O+1]+=F*je,U(N,2*L+2*O+1),N[2*L+2*O+1]+=D*Ce,U(N,2*L+2*O+1),N[2*L+2*O+2]+=F*Ce,U(N,2*L+2*O+2)}for(P=0;P<R;P++)N[P]=N[2*P+1]<<16|N[2*P];for(P=R;P<2*R;P++)N[P]=0;return new l(N,0)};function U(P,R){for(;(P[R]&65535)!=P[R];)P[R+1]+=P[R]>>>16,P[R]&=65535,R++}function $(P,R){this.g=P,this.h=R}function G(P,R){if(A(R))throw Error("division by zero");if(A(P))return new $(_,_);if(I(P))return R=G(b(P),R),new $(b(R.g),b(R.h));if(I(R))return R=G(P,b(R)),new $(b(R.g),R.h);if(P.g.length>30){if(I(P)||I(R))throw Error("slowDivide_ only works with positive integers.");for(var N=v,L=R;L.l(P)<=0;)N=X(N),L=X(L);var O=ne(N,1),F=ne(L,1);for(L=ne(L,2),N=ne(N,2);!A(L);){var D=F.add(L);D.l(P)<=0&&(O=O.add(N),F=D),L=ne(L,1),N=ne(N,1)}return R=j(P,O.j(R)),new $(O,R)}for(O=_;P.l(R)>=0;){for(N=Math.max(1,Math.floor(P.m()/R.m())),L=Math.ceil(Math.log(N)/Math.LN2),L=L<=48?1:Math.pow(2,L-48),F=p(N),D=F.j(R);I(D)||D.l(P)>0;)N-=L,F=p(N),D=F.j(R);A(F)&&(F=v),O=O.add(F),P=j(P,D)}return new $(O,P)}n.B=function(P){return G(this,P).h},n.and=function(P){const R=Math.max(this.g.length,P.g.length),N=[];for(let L=0;L<R;L++)N[L]=this.i(L)&P.i(L);return new l(N,this.h&P.h)},n.or=function(P){const R=Math.max(this.g.length,P.g.length),N=[];for(let L=0;L<R;L++)N[L]=this.i(L)|P.i(L);return new l(N,this.h|P.h)},n.xor=function(P){const R=Math.max(this.g.length,P.g.length),N=[];for(let L=0;L<R;L++)N[L]=this.i(L)^P.i(L);return new l(N,this.h^P.h)};function X(P){const R=P.g.length+1,N=[];for(let L=0;L<R;L++)N[L]=P.i(L)<<1|P.i(L-1)>>>31;return new l(N,P.h)}function ne(P,R){const N=R>>5;R%=32;const L=P.g.length-N,O=[];for(let F=0;F<L;F++)O[F]=R>0?P.i(F+N)>>>R|P.i(F+N+1)<<32-R:P.i(F+N);return new l(O,P.h)}r.prototype.digest=r.prototype.A,r.prototype.reset=r.prototype.u,r.prototype.update=r.prototype.v,AI=r,l.prototype.add=l.prototype.add,l.prototype.multiply=l.prototype.j,l.prototype.modulo=l.prototype.B,l.prototype.compare=l.prototype.l,l.prototype.toNumber=l.prototype.m,l.prototype.toString=l.prototype.toString,l.prototype.getBits=l.prototype.i,l.fromNumber=p,l.fromString=g,Zi=l}).apply(typeof Zx<"u"?Zx:typeof self<"u"?self:typeof window<"u"?window:{});var $h=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};/** @license
Copyright The Closure Library Authors.
SPDX-License-Identifier: Apache-2.0
*/var kI,gu,NI,df,Fy,PI,DI,OI;(function(){var n,e=Object.defineProperty;function t(d){d=[typeof globalThis=="object"&&globalThis,d,typeof window=="object"&&window,typeof self=="object"&&self,typeof $h=="object"&&$h];for(var E=0;E<d.length;++E){var x=d[E];if(x&&x.Math==Math)return x}throw Error("Cannot find global object")}var r=t(this);function s(d,E){if(E)e:{var x=r;d=d.split(".");for(var k=0;k<d.length-1;k++){var q=d[k];if(!(q in x))break e;x=x[q]}d=d[d.length-1],k=x[d],E=E(k),E!=k&&E!=null&&e(x,d,{configurable:!0,writable:!0,value:E})}}s("Symbol.dispose",function(d){return d||Symbol("Symbol.dispose")}),s("Array.prototype.values",function(d){return d||function(){return this[Symbol.iterator]()}}),s("Object.entries",function(d){return d||function(E){var x=[],k;for(k in E)Object.prototype.hasOwnProperty.call(E,k)&&x.push([k,E[k]]);return x}});/** @license

 Copyright The Closure Library Authors.
 SPDX-License-Identifier: Apache-2.0
*/var o=o||{},l=this||self;function u(d){var E=typeof d;return E=="object"&&d!=null||E=="function"}function h(d,E,x){return d.call.apply(d.bind,arguments)}function p(d,E,x){return p=h,p.apply(null,arguments)}function g(d,E){var x=Array.prototype.slice.call(arguments,1);return function(){var k=x.slice();return k.push.apply(k,arguments),d.apply(this,k)}}function _(d,E){function x(){}x.prototype=E.prototype,d.Z=E.prototype,d.prototype=new x,d.prototype.constructor=d,d.Ob=function(k,q,Y){for(var ce=Array(arguments.length-2),ze=2;ze<arguments.length;ze++)ce[ze-2]=arguments[ze];return E.prototype[q].apply(k,ce)}}var v=typeof AsyncContext<"u"&&typeof AsyncContext.Snapshot=="function"?d=>d&&AsyncContext.Snapshot.wrap(d):d=>d;function T(d){const E=d.length;if(E>0){const x=Array(E);for(let k=0;k<E;k++)x[k]=d[k];return x}return[]}function A(d,E){for(let k=1;k<arguments.length;k++){const q=arguments[k];var x=typeof q;if(x=x!="object"?x:q?Array.isArray(q)?"array":x:"null",x=="array"||x=="object"&&typeof q.length=="number"){x=d.length||0;const Y=q.length||0;d.length=x+Y;for(let ce=0;ce<Y;ce++)d[x+ce]=q[ce]}else d.push(q)}}class I{constructor(E,x){this.i=E,this.j=x,this.h=0,this.g=null}get(){let E;return this.h>0?(this.h--,E=this.g,this.g=E.next,E.next=null):E=this.i(),E}}function b(d){l.setTimeout(()=>{throw d},0)}function j(){var d=P;let E=null;return d.g&&(E=d.g,d.g=d.g.next,d.g||(d.h=null),E.next=null),E}class U{constructor(){this.h=this.g=null}add(E,x){const k=$.get();k.set(E,x),this.h?this.h.next=k:this.g=k,this.h=k}}var $=new I(()=>new G,d=>d.reset());class G{constructor(){this.next=this.g=this.h=null}set(E,x){this.h=E,this.g=x,this.next=null}reset(){this.next=this.g=this.h=null}}let X,ne=!1,P=new U,R=()=>{const d=Promise.resolve(void 0);X=()=>{d.then(N)}};function N(){for(var d;d=j();){try{d.h.call(d.g)}catch(x){b(x)}var E=$;E.j(d),E.h<100&&(E.h++,d.next=E.g,E.g=d)}ne=!1}function L(){this.u=this.u,this.C=this.C}L.prototype.u=!1,L.prototype.dispose=function(){this.u||(this.u=!0,this.N())},L.prototype[Symbol.dispose]=function(){this.dispose()},L.prototype.N=function(){if(this.C)for(;this.C.length;)this.C.shift()()};function O(d,E){this.type=d,this.g=this.target=E,this.defaultPrevented=!1}O.prototype.h=function(){this.defaultPrevented=!0};var F=(function(){if(!l.addEventListener||!Object.defineProperty)return!1;var d=!1,E=Object.defineProperty({},"passive",{get:function(){d=!0}});try{const x=()=>{};l.addEventListener("test",x,E),l.removeEventListener("test",x,E)}catch{}return d})();function D(d){return/^[\s\xa0]*$/.test(d)}function Ce(d,E){O.call(this,d?d.type:""),this.relatedTarget=this.g=this.target=null,this.button=this.screenY=this.screenX=this.clientY=this.clientX=0,this.key="",this.metaKey=this.shiftKey=this.altKey=this.ctrlKey=!1,this.state=null,this.pointerId=0,this.pointerType="",this.i=null,d&&this.init(d,E)}_(Ce,O),Ce.prototype.init=function(d,E){const x=this.type=d.type,k=d.changedTouches&&d.changedTouches.length?d.changedTouches[0]:null;this.target=d.target||d.srcElement,this.g=E,E=d.relatedTarget,E||(x=="mouseover"?E=d.fromElement:x=="mouseout"&&(E=d.toElement)),this.relatedTarget=E,k?(this.clientX=k.clientX!==void 0?k.clientX:k.pageX,this.clientY=k.clientY!==void 0?k.clientY:k.pageY,this.screenX=k.screenX||0,this.screenY=k.screenY||0):(this.clientX=d.clientX!==void 0?d.clientX:d.pageX,this.clientY=d.clientY!==void 0?d.clientY:d.pageY,this.screenX=d.screenX||0,this.screenY=d.screenY||0),this.button=d.button,this.key=d.key||"",this.ctrlKey=d.ctrlKey,this.altKey=d.altKey,this.shiftKey=d.shiftKey,this.metaKey=d.metaKey,this.pointerId=d.pointerId||0,this.pointerType=d.pointerType,this.state=d.state,this.i=d,d.defaultPrevented&&Ce.Z.h.call(this)},Ce.prototype.h=function(){Ce.Z.h.call(this);const d=this.i;d.preventDefault?d.preventDefault():d.returnValue=!1};var je="closure_listenable_"+(Math.random()*1e6|0),Se=0;function Ie(d,E,x,k,q){this.listener=d,this.proxy=null,this.src=E,this.type=x,this.capture=!!k,this.ha=q,this.key=++Se,this.da=this.fa=!1}function W(d){d.da=!0,d.listener=null,d.proxy=null,d.src=null,d.ha=null}function J(d,E,x){for(const k in d)E.call(x,d[k],k,d)}function oe(d,E){for(const x in d)E.call(void 0,d[x],x,d)}function B(d){const E={};for(const x in d)E[x]=d[x];return E}const Z="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");function me(d,E){let x,k;for(let q=1;q<arguments.length;q++){k=arguments[q];for(x in k)d[x]=k[x];for(let Y=0;Y<Z.length;Y++)x=Z[Y],Object.prototype.hasOwnProperty.call(k,x)&&(d[x]=k[x])}}function _e(d){this.src=d,this.g={},this.h=0}_e.prototype.add=function(d,E,x,k,q){const Y=d.toString();d=this.g[Y],d||(d=this.g[Y]=[],this.h++);const ce=Pe(d,E,k,q);return ce>-1?(E=d[ce],x||(E.fa=!1)):(E=new Ie(E,this.src,Y,!!k,q),E.fa=x,d.push(E)),E};function Ne(d,E){const x=E.type;if(x in d.g){var k=d.g[x],q=Array.prototype.indexOf.call(k,E,void 0),Y;(Y=q>=0)&&Array.prototype.splice.call(k,q,1),Y&&(W(E),d.g[x].length==0&&(delete d.g[x],d.h--))}}function Pe(d,E,x,k){for(let q=0;q<d.length;++q){const Y=d[q];if(!Y.da&&Y.listener==E&&Y.capture==!!x&&Y.ha==k)return q}return-1}var he="closure_lm_"+(Math.random()*1e6|0),Fe={};function Ye(d,E,x,k,q){if(Array.isArray(E)){for(let Y=0;Y<E.length;Y++)Ye(d,E[Y],x,k,q);return null}return x=Re(x),d&&d[je]?d.J(E,x,u(k)?!!k.capture:!1,q):xt(d,E,x,!1,k,q)}function xt(d,E,x,k,q,Y){if(!E)throw Error("Invalid event type");const ce=u(q)?!!q.capture:!!q;let ze=di(d);if(ze||(d[he]=ze=new _e(d)),x=ze.add(E,x,k,ce,Y),x.proxy)return x;if(k=An(),x.proxy=k,k.src=d,k.listener=x,d.addEventListener)F||(q=ce),q===void 0&&(q=!1),d.addEventListener(E.toString(),k,q);else if(d.attachEvent)d.attachEvent(ui(E.toString()),k);else if(d.addListener&&d.removeListener)d.addListener(k);else throw Error("addEventListener and attachEvent are unavailable.");return x}function An(){function d(x){return E.call(d.src,d.listener,x)}const E=Aa;return d}function kn(d,E,x,k,q){if(Array.isArray(E))for(var Y=0;Y<E.length;Y++)kn(d,E[Y],x,k,q);else k=u(k)?!!k.capture:!!k,x=Re(x),d&&d[je]?(d=d.i,Y=String(E).toString(),Y in d.g&&(E=d.g[Y],x=Pe(E,x,k,q),x>-1&&(W(E[x]),Array.prototype.splice.call(E,x,1),E.length==0&&(delete d.g[Y],d.h--)))):d&&(d=di(d))&&(E=d.g[E.toString()],d=-1,E&&(d=Pe(E,x,k,q)),(x=d>-1?E[d]:null)&&Tn(x))}function Tn(d){if(typeof d!="number"&&d&&!d.da){var E=d.src;if(E&&E[je])Ne(E.i,d);else{var x=d.type,k=d.proxy;E.removeEventListener?E.removeEventListener(x,k,d.capture):E.detachEvent?E.detachEvent(ui(x),k):E.addListener&&E.removeListener&&E.removeListener(k),(x=di(E))?(Ne(x,d),x.h==0&&(x.src=null,E[he]=null)):W(d)}}}function ui(d){return d in Fe?Fe[d]:Fe[d]="on"+d}function Aa(d,E){if(d.da)d=!0;else{E=new Ce(E,this);const x=d.listener,k=d.ha||d.src;d.fa&&Tn(d),d=x.call(k,E)}return d}function di(d){return d=d[he],d instanceof _e?d:null}var ge="__closure_events_fn_"+(Math.random()*1e9>>>0);function Re(d){return typeof d=="function"?d:(d[ge]||(d[ge]=function(E){return d.handleEvent(E)}),d[ge])}function $e(){L.call(this),this.i=new _e(this),this.M=this,this.G=null}_($e,L),$e.prototype[je]=!0,$e.prototype.removeEventListener=function(d,E,x,k){kn(this,d,E,x,k)};function nt(d,E){var x,k=d.G;if(k)for(x=[];k;k=k.G)x.push(k);if(d=d.M,k=E.type||E,typeof E=="string")E=new O(E,d);else if(E instanceof O)E.target=E.target||d;else{var q=E;E=new O(k,d),me(E,q)}q=!0;let Y,ce;if(x)for(ce=x.length-1;ce>=0;ce--)Y=E.g=x[ce],q=tn(Y,k,!0,E)&&q;if(Y=E.g=d,q=tn(Y,k,!0,E)&&q,q=tn(Y,k,!1,E)&&q,x)for(ce=0;ce<x.length;ce++)Y=E.g=x[ce],q=tn(Y,k,!1,E)&&q}$e.prototype.N=function(){if($e.Z.N.call(this),this.i){var d=this.i;for(const E in d.g){const x=d.g[E];for(let k=0;k<x.length;k++)W(x[k]);delete d.g[E],d.h--}}this.G=null},$e.prototype.J=function(d,E,x,k){return this.i.add(String(d),E,!1,x,k)},$e.prototype.K=function(d,E,x,k){return this.i.add(String(d),E,!0,x,k)};function tn(d,E,x,k){if(E=d.i.g[String(E)],!E)return!0;E=E.concat();let q=!0;for(let Y=0;Y<E.length;++Y){const ce=E[Y];if(ce&&!ce.da&&ce.capture==x){const ze=ce.listener,Pt=ce.ha||ce.src;ce.fa&&Ne(d.i,ce),q=ze.call(Pt,k)!==!1&&q}}return q&&!k.defaultPrevented}function mc(d,E){if(typeof d!="function")if(d&&typeof d.handleEvent=="function")d=p(d.handleEvent,d);else throw Error("Invalid listener argument");return Number(E)>2147483647?-1:l.setTimeout(d,E||0)}function gc(d){d.g=mc(()=>{d.g=null,d.i&&(d.i=!1,gc(d))},d.l);const E=d.h;d.h=null,d.m.apply(null,E)}class bd extends L{constructor(E,x){super(),this.m=E,this.l=x,this.h=null,this.i=!1,this.g=null}j(E){this.h=arguments,this.g?this.i=!0:gc(this)}N(){super.N(),this.g&&(l.clearTimeout(this.g),this.g=null,this.i=!1,this.h=null)}}function hi(d){L.call(this),this.h=d,this.g={}}_(hi,L);var yc=[];function ka(d){J(d.g,function(E,x){this.g.hasOwnProperty(x)&&Tn(E)},d),d.g={}}hi.prototype.N=function(){hi.Z.N.call(this),ka(this)},hi.prototype.handleEvent=function(){throw Error("EventHandler.handleEvent not implemented")};var fi=l.JSON.stringify,Rd=l.JSON.parse,Io=class{stringify(d){return l.JSON.stringify(d,void 0)}parse(d){return l.JSON.parse(d,void 0)}};function pi(){}function Ad(){}var mi={OPEN:"a",hb:"b",ERROR:"c",tb:"d"};function Na(){O.call(this,"d")}_(Na,O);function _c(){O.call(this,"c")}_(_c,O);var wr={},Pa=null;function gi(){return Pa=Pa||new $e}wr.Ia="serverreachability";function Da(d){O.call(this,wr.Ia,d)}_(Da,O);function Cs(d){const E=gi();nt(E,new Da(E))}wr.STAT_EVENT="statevent";function Ss(d,E){O.call(this,wr.STAT_EVENT,d),this.stat=E}_(Ss,O);function bt(d){const E=gi();nt(E,new Ss(E,d))}wr.Ja="timingevent";function vc(d,E){O.call(this,wr.Ja,d),this.size=E}_(vc,O);function yi(d,E){if(typeof d!="function")throw Error("Fn must not be null and must be a function");return l.setTimeout(function(){d()},E)}function _i(){this.g=!0}_i.prototype.ua=function(){this.g=!1};function kd(d,E,x,k,q,Y){d.info(function(){if(d.g)if(Y){var ce="",ze=Y.split("&");for(let ct=0;ct<ze.length;ct++){var Pt=ze[ct].split("=");if(Pt.length>1){const jt=Pt[0];Pt=Pt[1];const Gn=jt.split("_");ce=Gn.length>=2&&Gn[1]=="type"?ce+(jt+"="+Pt+"&"):ce+(jt+"=redacted&")}}}else ce=null;else ce=Y;return"XMLHTTP REQ ("+k+") [attempt "+q+"]: "+E+`
`+x+`
`+ce})}function Nd(d,E,x,k,q,Y,ce){d.info(function(){return"XMLHTTP RESP ("+k+") [ attempt "+q+"]: "+E+`
`+x+`
`+Y+" "+ce})}function Ur(d,E,x,k){d.info(function(){return"XMLHTTP TEXT ("+E+"): "+bo(d,x)+(k?" "+k:"")})}function Pd(d,E){d.info(function(){return"TIMEOUT: "+E})}_i.prototype.info=function(){};function bo(d,E){if(!d.g)return E;if(!E)return null;try{const Y=JSON.parse(E);if(Y){for(d=0;d<Y.length;d++)if(Array.isArray(Y[d])){var x=Y[d];if(!(x.length<2)){var k=x[1];if(Array.isArray(k)&&!(k.length<1)){var q=k[0];if(q!="noop"&&q!="stop"&&q!="close")for(let ce=1;ce<k.length;ce++)k[ce]=""}}}}return fi(Y)}catch{return E}}var vi={NO_ERROR:0,cb:1,qb:2,pb:3,kb:4,ob:5,rb:6,Ga:7,TIMEOUT:8,ub:9},wi={ib:"complete",Fb:"success",ERROR:"error",Ga:"abort",xb:"ready",yb:"readystatechange",TIMEOUT:"timeout",sb:"incrementaldata",wb:"progress",lb:"downloadprogress",Nb:"uploadprogress"},Dd;function Is(){}_(Is,pi),Is.prototype.g=function(){return new XMLHttpRequest},Dd=new Is;function zr(d){return encodeURIComponent(String(d))}function Oa(d){var E=1;d=d.split(":");const x=[];for(;E>0&&d.length;)x.push(d.shift()),E--;return d.length&&x.push(d.join(":")),x}function or(d,E,x,k){this.j=d,this.i=E,this.l=x,this.S=k||1,this.V=new hi(this),this.H=45e3,this.J=null,this.o=!1,this.u=this.B=this.A=this.M=this.F=this.T=this.D=null,this.G=[],this.g=null,this.C=0,this.m=this.v=null,this.X=-1,this.K=!1,this.P=0,this.O=null,this.W=this.L=this.U=this.R=!1,this.h=new Od}function Od(){this.i=null,this.g="",this.h=!1}var Md={},wc={};function Er(d,E,x){d.M=1,d.A=Rs(ar(E)),d.u=x,d.R=!0,Ec(d,null)}function Ec(d,E){d.F=Date.now(),Ro(d),d.B=ar(d.A);var x=d.B,k=d.S;Array.isArray(k)||(k=[String(k)]),Nc(x.i,"t",k),d.C=0,x=d.j.L,d.h=new Od,d.g=Hd(d.j,x?E:null,!d.u),d.P>0&&(d.O=new bd(p(d.Y,d,d.g),d.P)),E=d.V,x=d.g,k=d.ba;var q="readystatechange";Array.isArray(q)||(q&&(yc[0]=q.toString()),q=yc);for(let Y=0;Y<q.length;Y++){const ce=Ye(x,q[Y],k||E.handleEvent,!1,E.h||E);if(!ce)break;E.g[ce.key]=ce}E=d.J?B(d.J):{},d.u?(d.v||(d.v="POST"),E["Content-Type"]="application/x-www-form-urlencoded",d.g.ea(d.B,d.v,d.u,E)):(d.v="GET",d.g.ea(d.B,d.v,null,E)),Cs(),kd(d.i,d.v,d.B,d.l,d.S,d.u)}or.prototype.ba=function(d){d=d.target;const E=this.O;E&&Kr(d)==3?E.j():this.Y(d)},or.prototype.Y=function(d){try{if(d==this.g)e:{const ze=Kr(this.g),Pt=this.g.ya(),ct=this.g.ca();if(!(ze<3)&&(ze!=3||this.g&&(this.h.h||this.g.la()||$d(this.g)))){this.K||ze!=4||Pt==7||(Pt==8||ct<=0?Cs(3):Cs(2)),Ma(this);var E=this.g.ca();this.X=E;var x=Ld(this);if(this.o=E==200,Nd(this.i,this.v,this.B,this.l,this.S,ze,E),this.o){if(this.U&&!this.L){t:{if(this.g){var k,q=this.g;if((k=q.g?q.g.getResponseHeader("X-HTTP-Initial-Response"):null)&&!D(k)){var Y=k;break t}}Y=null}if(d=Y)Ur(this.i,this.l,d,"Initial handshake response via X-HTTP-Initial-Response"),this.L=!0,gt(this,d);else{this.o=!1,this.m=3,bt(12),bs(this),Ao(this);break e}}if(this.R){d=!0;let jt;for(;!this.K&&this.C<x.length;)if(jt=Vd(this,x),jt==wc){ze==4&&(this.m=4,bt(14),d=!1),Ur(this.i,this.l,null,"[Incomplete Response]");break}else if(jt==Md){this.m=4,bt(15),Ur(this.i,this.l,x,"[Invalid Chunk]"),d=!1;break}else Ur(this.i,this.l,jt,null),gt(this,jt);if(jd(this)&&this.C!=0&&(this.h.g=this.h.g.slice(this.C),this.C=0),ze!=4||x.length!=0||this.h.h||(this.m=1,bt(16),d=!1),this.o=this.o&&d,!d)Ur(this.i,this.l,x,"[Invalid Chunked Response]"),bs(this),Ao(this);else if(x.length>0&&!this.W){this.W=!0;var ce=this.j;ce.g==this&&ce.aa&&!ce.P&&(ce.j.info("Great, no buffering proxy detected. Bytes received: "+x.length),Vo(ce),ce.P=!0,bt(11))}}else Ur(this.i,this.l,x,null),gt(this,x);ze==4&&bs(this),this.o&&!this.K&&(ze==4?Ha(this.j,this):(this.o=!1,Ro(this)))}else Dc(this.g),E==400&&x.indexOf("Unknown SID")>0?(this.m=3,bt(12)):(this.m=0,bt(13)),bs(this),Ao(this)}}}catch{}finally{}};function Ld(d){if(!jd(d))return d.g.la();const E=$d(d.g);if(E==="")return"";let x="";const k=E.length,q=Kr(d.g)==4;if(!d.h.i){if(typeof TextDecoder>"u")return bs(d),Ao(d),"";d.h.i=new l.TextDecoder}for(let Y=0;Y<k;Y++)d.h.h=!0,x+=d.h.i.decode(E[Y],{stream:!(q&&Y==k-1)});return E.length=0,d.h.g+=x,d.C=0,d.h.g}function jd(d){return d.g?d.v=="GET"&&d.M!=2&&d.j.Aa:!1}function Vd(d,E){var x=d.C,k=E.indexOf(`
`,x);return k==-1?wc:(x=Number(E.substring(x,k)),isNaN(x)?Md:(k+=1,k+x>E.length?wc:(E=E.slice(k,k+x),d.C=k+x,E)))}or.prototype.cancel=function(){this.K=!0,bs(this)};function Ro(d){d.T=Date.now()+d.H,xc(d,d.H)}function xc(d,E){if(d.D!=null)throw Error("WatchDog timer not null");d.D=yi(p(d.aa,d),E)}function Ma(d){d.D&&(l.clearTimeout(d.D),d.D=null)}or.prototype.aa=function(){this.D=null;const d=Date.now();d-this.T>=0?(Pd(this.i,this.B),this.M!=2&&(Cs(),bt(17)),bs(this),this.m=2,Ao(this)):xc(this,this.T-d)};function Ao(d){d.j.I==0||d.K||Ha(d.j,d)}function bs(d){Ma(d);var E=d.O;E&&typeof E.dispose=="function"&&E.dispose(),d.O=null,ka(d.V),d.g&&(E=d.g,d.g=null,E.abort(),E.dispose())}function gt(d,E){try{var x=d.j;if(x.I!=0&&(x.g==d||Cc(x.h,d))){if(!d.L&&Cc(x.h,d)&&x.I==3){try{var k=x.Ba.g.parse(E)}catch{k=null}if(Array.isArray(k)&&k.length==3){var q=k;if(q[0]==0){e:if(!x.v){if(x.g)if(x.g.F+3e3<d.F)Wa(x),Hn(x);else break e;Xr(x),bt(18)}}else x.xa=q[1],0<x.xa-x.K&&q[2]<37500&&x.F&&x.A==0&&!x.C&&(x.C=yi(p(x.Va,x),6e3));ko(x.h)<=1&&x.ta&&(x.ta=void 0)}else qn(x,11)}else if((d.L||x.g==d)&&Wa(x),!D(E))for(q=x.Ba.g.parse(E),E=0;E<q.length;E++){let ct=q[E];const jt=ct[0];if(!(jt<=x.K))if(x.K=jt,ct=ct[1],x.I==2)if(ct[0]=="c"){x.M=ct[1],x.ba=ct[2];const Gn=ct[3];Gn!=null&&(x.ka=Gn,x.j.info("VER="+x.ka));const Ds=ct[4];Ds!=null&&(x.za=Ds,x.j.info("SVER="+x.za));const Jr=ct[5];Jr!=null&&typeof Jr=="number"&&Jr>0&&(k=1.5*Jr,x.O=k,x.j.info("backChannelRequestTimeoutMs_="+k)),k=x;const Zr=d.g;if(Zr){const Ka=Zr.g?Zr.g.getResponseHeader("X-Client-Wire-Protocol"):null;if(Ka){var Y=k.h;Y.g||Ka.indexOf("spdy")==-1&&Ka.indexOf("quic")==-1&&Ka.indexOf("h2")==-1||(Y.j=Y.l,Y.g=new Set,Y.h&&(ja(Y,Y.h),Y.h=null))}if(k.G){const Lc=Zr.g?Zr.g.getResponseHeader("X-HTTP-Session-Id"):null;Lc&&(k.wa=Lc,ot(k.J,k.G,Lc))}}x.I=3,x.l&&x.l.ra(),x.aa&&(x.T=Date.now()-d.F,x.j.info("Handshake RTT: "+x.T+"ms")),k=x;var ce=d;if(k.na=Mc(k,k.L?k.ba:null,k.W),ce.L){No(k.h,ce);var ze=ce,Pt=k.O;Pt&&(ze.H=Pt),ze.D&&(Ma(ze),Ro(ze)),k.g=ce}else fn(k);x.i.length>0&&Ps(x)}else ct[0]!="stop"&&ct[0]!="close"||qn(x,7);else x.I==3&&(ct[0]=="stop"||ct[0]=="close"?ct[0]=="stop"?qn(x,7):Ba(x):ct[0]!="noop"&&x.l&&x.l.qa(ct),x.A=0)}}Cs(4)}catch{}}var Em=class{constructor(d,E){this.g=d,this.map=E}};function La(d){this.l=d||10,l.PerformanceNavigationTiming?(d=l.performance.getEntriesByType("navigation"),d=d.length>0&&(d[0].nextHopProtocol=="hq"||d[0].nextHopProtocol=="h2")):d=!!(l.chrome&&l.chrome.loadTimes&&l.chrome.loadTimes()&&l.chrome.loadTimes().wasFetchedViaSpdy),this.j=d?this.l:1,this.g=null,this.j>1&&(this.g=new Set),this.h=null,this.i=[]}function Tc(d){return d.h?!0:d.g?d.g.size>=d.j:!1}function ko(d){return d.h?1:d.g?d.g.size:0}function Cc(d,E){return d.h?d.h==E:d.g?d.g.has(E):!1}function ja(d,E){d.g?d.g.add(E):d.h=E}function No(d,E){d.h&&d.h==E?d.h=null:d.g&&d.g.has(E)&&d.g.delete(E)}La.prototype.cancel=function(){if(this.i=Bn(this),this.h)this.h.cancel(),this.h=null;else if(this.g&&this.g.size!==0){for(const d of this.g.values())d.cancel();this.g.clear()}};function Bn(d){if(d.h!=null)return d.i.concat(d.h.G);if(d.g!=null&&d.g.size!==0){let E=d.i;for(const x of d.g.values())E=E.concat(x.G);return E}return T(d.i)}var Fd=RegExp("^(?:([^:/?#.]+):)?(?://(?:([^\\\\/?#]*)@)?([^\\\\/?#]*?)(?::([0-9]+))?(?=[\\\\/?#]|$))?([^?#]+)?(?:\\?([^#]*))?(?:#([\\s\\S]*))?$");function $n(d,E){if(d){d=d.split("&");for(let x=0;x<d.length;x++){const k=d[x].indexOf("=");let q,Y=null;k>=0?(q=d[x].substring(0,k),Y=d[x].substring(k+1)):q=d[x],E(q,Y?decodeURIComponent(Y.replace(/\+/g," ")):"")}}}function Br(d){this.g=this.o=this.j="",this.u=null,this.m=this.h="",this.l=!1;let E;d instanceof Br?(this.l=d.l,Po(this,d.j),this.o=d.o,this.g=d.g,$r(this,d.u),this.h=d.h,Ei(this,Pc(d.i)),this.m=d.m):d&&(E=String(d).match(Fd))?(this.l=!1,Po(this,E[1]||"",!0),this.o=Do(E[2]||""),this.g=Do(E[3]||"",!0),$r(this,E[4]),this.h=Do(E[5]||"",!0),Ei(this,E[6]||"",!0),this.m=Do(E[7]||"")):(this.l=!1,this.i=new Ze(null,this.l))}Br.prototype.toString=function(){const d=[];var E=this.j;E&&d.push(Oo(E,Ic,!0),":");var x=this.g;return(x||E=="file")&&(d.push("//"),(E=this.o)&&d.push(Oo(E,Ic,!0),"@"),d.push(zr(x).replace(/%25([0-9a-fA-F]{2})/g,"%$1")),x=this.u,x!=null&&d.push(":",String(x))),(x=this.h)&&(this.g&&x.charAt(0)!="/"&&d.push("/"),d.push(Oo(x,x.charAt(0)=="/"?Mo:bc,!0))),(x=this.i.toString())&&d.push("?",x),(x=this.m)&&d.push("#",Oo(x,Rc)),d.join("")},Br.prototype.resolve=function(d){const E=ar(this);let x=!!d.j;x?Po(E,d.j):x=!!d.o,x?E.o=d.o:x=!!d.g,x?E.g=d.g:x=d.u!=null;var k=d.h;if(x)$r(E,d.u);else if(x=!!d.h){if(k.charAt(0)!="/")if(this.g&&!this.h)k="/"+k;else{var q=E.h.lastIndexOf("/");q!=-1&&(k=E.h.slice(0,q+1)+k)}if(q=k,q==".."||q==".")k="";else if(q.indexOf("./")!=-1||q.indexOf("/.")!=-1){k=q.lastIndexOf("/",0)==0,q=q.split("/");const Y=[];for(let ce=0;ce<q.length;){const ze=q[ce++];ze=="."?k&&ce==q.length&&Y.push(""):ze==".."?((Y.length>1||Y.length==1&&Y[0]!="")&&Y.pop(),k&&ce==q.length&&Y.push("")):(Y.push(ze),k=!0)}k=Y.join("/")}else k=q}return x?E.h=k:x=d.i.toString()!=="",x?Ei(E,Pc(d.i)):x=!!d.m,x&&(E.m=d.m),E};function ar(d){return new Br(d)}function Po(d,E,x){d.j=x?Do(E,!0):E,d.j&&(d.j=d.j.replace(/:$/,""))}function $r(d,E){if(E){if(E=Number(E),isNaN(E)||E<0)throw Error("Bad port number "+E);d.u=E}else d.u=null}function Ei(d,E,x){E instanceof Ze?(d.i=E,Fa(d.i,d.l)):(x||(E=Oo(E,xm)),d.i=new Ze(E,d.l))}function ot(d,E,x){d.i.set(E,x)}function Rs(d){return ot(d,"zx",Math.floor(Math.random()*2147483648).toString(36)+Math.abs(Math.floor(Math.random()*2147483648)^Date.now()).toString(36)),d}function Do(d,E){return d?E?decodeURI(d.replace(/%25/g,"%2525")):decodeURIComponent(d):""}function Oo(d,E,x){return typeof d=="string"?(d=encodeURI(d).replace(E,Sc),x&&(d=d.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),d):null}function Sc(d){return d=d.charCodeAt(0),"%"+(d>>4&15).toString(16)+(d&15).toString(16)}var Ic=/[#\/\?@]/g,bc=/[#\?:]/g,Mo=/[#\?]/g,xm=/[#\?@]/g,Rc=/#/g;function Ze(d,E){this.h=this.g=null,this.i=d||null,this.j=!!E}function Wr(d){d.g||(d.g=new Map,d.h=0,d.i&&$n(d.i,function(E,x){d.add(decodeURIComponent(E.replace(/\+/g," ")),x)}))}n=Ze.prototype,n.add=function(d,E){Wr(this),this.i=null,d=Hr(this,d);let x=this.g.get(d);return x||this.g.set(d,x=[]),x.push(E),this.h+=1,this};function Ac(d,E){Wr(d),E=Hr(d,E),d.g.has(E)&&(d.i=null,d.h-=d.g.get(E).length,d.g.delete(E))}function Va(d,E){return Wr(d),E=Hr(d,E),d.g.has(E)}n.forEach=function(d,E){Wr(this),this.g.forEach(function(x,k){x.forEach(function(q){d.call(E,q,k,this)},this)},this)};function kc(d,E){Wr(d);let x=[];if(typeof E=="string")Va(d,E)&&(x=x.concat(d.g.get(Hr(d,E))));else for(d=Array.from(d.g.values()),E=0;E<d.length;E++)x=x.concat(d[E]);return x}n.set=function(d,E){return Wr(this),this.i=null,d=Hr(this,d),Va(this,d)&&(this.h-=this.g.get(d).length),this.g.set(d,[E]),this.h+=1,this},n.get=function(d,E){return d?(d=kc(this,d),d.length>0?String(d[0]):E):E};function Nc(d,E,x){Ac(d,E),x.length>0&&(d.i=null,d.g.set(Hr(d,E),T(x)),d.h+=x.length)}n.toString=function(){if(this.i)return this.i;if(!this.g)return"";const d=[],E=Array.from(this.g.keys());for(let k=0;k<E.length;k++){var x=E[k];const q=zr(x);x=kc(this,x);for(let Y=0;Y<x.length;Y++){let ce=q;x[Y]!==""&&(ce+="="+zr(x[Y])),d.push(ce)}}return this.i=d.join("&")};function Pc(d){const E=new Ze;return E.i=d.i,d.g&&(E.g=new Map(d.g),E.h=d.h),E}function Hr(d,E){return E=String(E),d.j&&(E=E.toLowerCase()),E}function Fa(d,E){E&&!d.j&&(Wr(d),d.i=null,d.g.forEach(function(x,k){const q=k.toLowerCase();k!=q&&(Ac(this,k),Nc(this,q,x))},d)),d.j=E}function qr(d,E){const x=new _i;if(l.Image){const k=new Image;k.onload=g(nn,x,"TestLoadImage: loaded",!0,E,k),k.onerror=g(nn,x,"TestLoadImage: error",!1,E,k),k.onabort=g(nn,x,"TestLoadImage: abort",!1,E,k),k.ontimeout=g(nn,x,"TestLoadImage: timeout",!1,E,k),l.setTimeout(function(){k.ontimeout&&k.ontimeout()},1e4),k.src=d}else E(!1)}function Gr(d,E){const x=new _i,k=new AbortController,q=setTimeout(()=>{k.abort(),nn(x,"TestPingServer: timeout",!1,E)},1e4);fetch(d,{signal:k.signal}).then(Y=>{clearTimeout(q),Y.ok?nn(x,"TestPingServer: ok",!0,E):nn(x,"TestPingServer: server error",!1,E)}).catch(()=>{clearTimeout(q),nn(x,"TestPingServer: error",!1,E)})}function nn(d,E,x,k,q){try{q&&(q.onload=null,q.onerror=null,q.onabort=null,q.ontimeout=null),k(x)}catch{}}function Lo(){this.g=new Io}function As(d){this.i=d.Sb||null,this.h=d.ab||!1}_(As,pi),As.prototype.g=function(){return new Wn(this.i,this.h)};function Wn(d,E){$e.call(this),this.H=d,this.o=E,this.m=void 0,this.status=this.readyState=0,this.responseType=this.responseText=this.response=this.statusText="",this.onreadystatechange=null,this.A=new Headers,this.h=null,this.F="GET",this.D="",this.g=!1,this.B=this.j=this.l=null,this.v=new AbortController}_(Wn,$e),n=Wn.prototype,n.open=function(d,E){if(this.readyState!=0)throw this.abort(),Error("Error reopening a connection");this.F=d,this.D=E,this.readyState=1,xr(this)},n.send=function(d){if(this.readyState!=1)throw this.abort(),Error("need to call open() first. ");if(this.v.signal.aborted)throw this.abort(),Error("Request was aborted.");this.g=!0;const E={headers:this.A,method:this.F,credentials:this.m,cache:void 0,signal:this.v.signal};d&&(E.body=d),(this.H||l).fetch(new Request(this.D,E)).then(this.Pa.bind(this),this.ga.bind(this))},n.abort=function(){this.response=this.responseText="",this.A=new Headers,this.status=0,this.v.abort(),this.j&&this.j.cancel("Request was aborted.").catch(()=>{}),this.readyState>=1&&this.g&&this.readyState!=4&&(this.g=!1,xi(this)),this.readyState=0},n.Pa=function(d){if(this.g&&(this.l=d,this.h||(this.status=this.l.status,this.statusText=this.l.statusText,this.h=d.headers,this.readyState=2,xr(this)),this.g&&(this.readyState=3,xr(this),this.g)))if(this.responseType==="arraybuffer")d.arrayBuffer().then(this.Na.bind(this),this.ga.bind(this));else if(typeof l.ReadableStream<"u"&&"body"in d){if(this.j=d.body.getReader(),this.o){if(this.responseType)throw Error('responseType must be empty for "streamBinaryChunks" mode responses.');this.response=[]}else this.response=this.responseText="",this.B=new TextDecoder;Ud(this)}else d.text().then(this.Oa.bind(this),this.ga.bind(this))};function Ud(d){d.j.read().then(d.Ma.bind(d)).catch(d.ga.bind(d))}n.Ma=function(d){if(this.g){if(this.o&&d.value)this.response.push(d.value);else if(!this.o){var E=d.value?d.value:new Uint8Array(0);(E=this.B.decode(E,{stream:!d.done}))&&(this.response=this.responseText+=E)}d.done?xi(this):xr(this),this.readyState==3&&Ud(this)}},n.Oa=function(d){this.g&&(this.response=this.responseText=d,xi(this))},n.Na=function(d){this.g&&(this.response=d,xi(this))},n.ga=function(){this.g&&xi(this)};function xi(d){d.readyState=4,d.l=null,d.j=null,d.B=null,xr(d)}n.setRequestHeader=function(d,E){this.A.append(d,E)},n.getResponseHeader=function(d){return this.h&&this.h.get(d.toLowerCase())||""},n.getAllResponseHeaders=function(){if(!this.h)return"";const d=[],E=this.h.entries();for(var x=E.next();!x.done;)x=x.value,d.push(x[0]+": "+x[1]),x=E.next();return d.join(`\r
`)};function xr(d){d.onreadystatechange&&d.onreadystatechange.call(d)}Object.defineProperty(Wn.prototype,"withCredentials",{get:function(){return this.m==="include"},set:function(d){this.m=d?"include":"same-origin"}});function zd(d){let E="";return J(d,function(x,k){E+=k,E+=":",E+=x,E+=`\r
`}),E}function Ua(d,E,x){e:{for(k in x){var k=!1;break e}k=!0}k||(x=zd(x),typeof d=="string"?x!=null&&zr(x):ot(d,E,x))}function ht(d){$e.call(this),this.headers=new Map,this.L=d||null,this.h=!1,this.g=null,this.D="",this.o=0,this.l="",this.j=this.B=this.v=this.A=!1,this.m=null,this.F="",this.H=!1}_(ht,$e);var Bd=/^https?$/i,Tm=["POST","PUT"];n=ht.prototype,n.Fa=function(d){this.H=d},n.ea=function(d,E,x,k){if(this.g)throw Error("[goog.net.XhrIo] Object is active with another request="+this.D+"; newUri="+d);E=E?E.toUpperCase():"GET",this.D=d,this.l="",this.o=0,this.A=!1,this.h=!0,this.g=this.L?this.L.g():Dd.g(),this.g.onreadystatechange=v(p(this.Ca,this));try{this.B=!0,this.g.open(E,String(d),!0),this.B=!1}catch(Y){Ti(this,Y);return}if(d=x||"",x=new Map(this.headers),k)if(Object.getPrototypeOf(k)===Object.prototype)for(var q in k)x.set(q,k[q]);else if(typeof k.keys=="function"&&typeof k.get=="function")for(const Y of k.keys())x.set(Y,k.get(Y));else throw Error("Unknown input type for opt_headers: "+String(k));k=Array.from(x.keys()).find(Y=>Y.toLowerCase()=="content-type"),q=l.FormData&&d instanceof l.FormData,!(Array.prototype.indexOf.call(Tm,E,void 0)>=0)||k||q||x.set("Content-Type","application/x-www-form-urlencoded;charset=utf-8");for(const[Y,ce]of x)this.g.setRequestHeader(Y,ce);this.F&&(this.g.responseType=this.F),"withCredentials"in this.g&&this.g.withCredentials!==this.H&&(this.g.withCredentials=this.H);try{this.m&&(clearTimeout(this.m),this.m=null),this.v=!0,this.g.send(d),this.v=!1}catch(Y){Ti(this,Y)}};function Ti(d,E){d.h=!1,d.g&&(d.j=!0,d.g.abort(),d.j=!1),d.l=E,d.o=5,Ci(d),Ns(d)}function Ci(d){d.A||(d.A=!0,nt(d,"complete"),nt(d,"error"))}n.abort=function(d){this.g&&this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1,this.o=d||7,nt(this,"complete"),nt(this,"abort"),Ns(this))},n.N=function(){this.g&&(this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1),Ns(this,!0)),ht.Z.N.call(this)},n.Ca=function(){this.u||(this.B||this.v||this.j?ks(this):this.Xa())},n.Xa=function(){ks(this)};function ks(d){if(d.h&&typeof o<"u"){if(d.v&&Kr(d)==4)setTimeout(d.Ca.bind(d),0);else if(nt(d,"readystatechange"),Kr(d)==4){d.h=!1;try{const Y=d.ca();e:switch(Y){case 200:case 201:case 202:case 204:case 206:case 304:case 1223:var E=!0;break e;default:E=!1}var x;if(!(x=E)){var k;if(k=Y===0){let ce=String(d.D).match(Fd)[1]||null;!ce&&l.self&&l.self.location&&(ce=l.self.location.protocol.slice(0,-1)),k=!Bd.test(ce?ce.toLowerCase():"")}x=k}if(x)nt(d,"complete"),nt(d,"success");else{d.o=6;try{var q=Kr(d)>2?d.g.statusText:""}catch{q=""}d.l=q+" ["+d.ca()+"]",Ci(d)}}finally{Ns(d)}}}}function Ns(d,E){if(d.g){d.m&&(clearTimeout(d.m),d.m=null);const x=d.g;d.g=null,E||nt(d,"ready");try{x.onreadystatechange=null}catch{}}}n.isActive=function(){return!!this.g};function Kr(d){return d.g?d.g.readyState:0}n.ca=function(){try{return Kr(this)>2?this.g.status:-1}catch{return-1}},n.la=function(){try{return this.g?this.g.responseText:""}catch{return""}},n.La=function(d){if(this.g){var E=this.g.responseText;return d&&E.indexOf(d)==0&&(E=E.substring(d.length)),Rd(E)}};function $d(d){try{if(!d.g)return null;if("response"in d.g)return d.g.response;switch(d.F){case"":case"text":return d.g.responseText;case"arraybuffer":if("mozResponseArrayBuffer"in d.g)return d.g.mozResponseArrayBuffer}return null}catch{return null}}function Dc(d){const E={};d=(d.g&&Kr(d)>=2&&d.g.getAllResponseHeaders()||"").split(`\r
`);for(let k=0;k<d.length;k++){if(D(d[k]))continue;var x=Oa(d[k]);const q=x[0];if(x=x[1],typeof x!="string")continue;x=x.trim();const Y=E[q]||[];E[q]=Y,Y.push(x)}oe(E,function(k){return k.join(", ")})}n.ya=function(){return this.o},n.Ha=function(){return typeof this.l=="string"?this.l:String(this.l)};function Qr(d,E,x){return x&&x.internalChannelParams&&x.internalChannelParams[d]||E}function za(d){this.za=0,this.i=[],this.j=new _i,this.ba=this.na=this.J=this.W=this.g=this.wa=this.G=this.H=this.u=this.U=this.o=null,this.Ya=this.V=0,this.Sa=Qr("failFast",!1,d),this.F=this.C=this.v=this.m=this.l=null,this.X=!0,this.xa=this.K=-1,this.Y=this.A=this.D=0,this.Qa=Qr("baseRetryDelayMs",5e3,d),this.Za=Qr("retryDelaySeedMs",1e4,d),this.Ta=Qr("forwardChannelMaxRetries",2,d),this.va=Qr("forwardChannelRequestTimeoutMs",2e4,d),this.ma=d&&d.xmlHttpFactory||void 0,this.Ua=d&&d.Rb||void 0,this.Aa=d&&d.useFetchStreams||!1,this.O=void 0,this.L=d&&d.supportsCrossDomainXhr||!1,this.M="",this.h=new La(d&&d.concurrentRequestLimit),this.Ba=new Lo,this.S=d&&d.fastHandshake||!1,this.R=d&&d.encodeInitMessageHeaders||!1,this.S&&this.R&&(this.R=!1),this.Ra=d&&d.Pb||!1,d&&d.ua&&this.j.ua(),d&&d.forceLongPolling&&(this.X=!1),this.aa=!this.S&&this.X&&d&&d.detectBufferingProxy||!1,this.ia=void 0,d&&d.longPollingTimeout&&d.longPollingTimeout>0&&(this.ia=d.longPollingTimeout),this.ta=void 0,this.T=0,this.P=!1,this.ja=this.B=null}n=za.prototype,n.ka=8,n.I=1,n.connect=function(d,E,x,k){bt(0),this.W=d,this.H=E||{},x&&k!==void 0&&(this.H.OSID=x,this.H.OAID=k),this.F=this.X,this.J=Mc(this,null,this.W),Ps(this)};function Ba(d){if($a(d),d.I==3){var E=d.V++,x=ar(d.J);if(ot(x,"SID",d.M),ot(x,"RID",E),ot(x,"TYPE","terminate"),Yr(d,x),E=new or(d,d.j,E),E.M=2,E.A=Rs(ar(x)),x=!1,l.navigator&&l.navigator.sendBeacon)try{x=l.navigator.sendBeacon(E.A.toString(),"")}catch{}!x&&l.Image&&(new Image().src=E.A,x=!0),x||(E.g=Hd(E.j,null),E.g.ea(E.A)),E.F=Date.now(),Ro(E)}Fo(d)}function Hn(d){d.g&&(Vo(d),d.g.cancel(),d.g=null)}function $a(d){Hn(d),d.v&&(l.clearTimeout(d.v),d.v=null),Wa(d),d.h.cancel(),d.m&&(typeof d.m=="number"&&l.clearTimeout(d.m),d.m=null)}function Ps(d){if(!Tc(d.h)&&!d.m){d.m=!0;var E=d.Ea;X||R(),ne||(X(),ne=!0),P.add(E,d),d.D=0}}function Wd(d,E){return ko(d.h)>=d.h.j-(d.m?1:0)?!1:d.m?(d.i=E.G.concat(d.i),!0):d.I==1||d.I==2||d.D>=(d.Sa?0:d.Ta)?!1:(d.m=yi(p(d.Ea,d,E),qa(d,d.D)),d.D++,!0)}n.Ea=function(d){if(this.m)if(this.m=null,this.I==1){if(!d){this.V=Math.floor(Math.random()*1e5),d=this.V++;const q=new or(this,this.j,d);let Y=this.o;if(this.U&&(Y?(Y=B(Y),me(Y,this.U)):Y=this.U),this.u!==null||this.R||(q.J=Y,Y=null),this.S)e:{for(var E=0,x=0;x<this.i.length;x++){t:{var k=this.i[x];if("__data__"in k.map&&(k=k.map.__data__,typeof k=="string")){k=k.length;break t}k=void 0}if(k===void 0)break;if(E+=k,E>4096){E=x;break e}if(E===4096||x===this.i.length-1){E=x+1;break e}}E=1e3}else E=1e3;E=Oc(this,q,E),x=ar(this.J),ot(x,"RID",d),ot(x,"CVER",22),this.G&&ot(x,"X-HTTP-Session-Id",this.G),Yr(this,x),Y&&(this.R?E="headers="+zr(zd(Y))+"&"+E:this.u&&Ua(x,this.u,Y)),ja(this.h,q),this.Ra&&ot(x,"TYPE","init"),this.S?(ot(x,"$req",E),ot(x,"SID","null"),q.U=!0,Er(q,x,null)):Er(q,x,E),this.I=2}}else this.I==3&&(d?jo(this,d):this.i.length==0||Tc(this.h)||jo(this))};function jo(d,E){var x;E?x=E.l:x=d.V++;const k=ar(d.J);ot(k,"SID",d.M),ot(k,"RID",x),ot(k,"AID",d.K),Yr(d,k),d.u&&d.o&&Ua(k,d.u,d.o),x=new or(d,d.j,x,d.D+1),d.u===null&&(x.J=d.o),E&&(d.i=E.G.concat(d.i)),E=Oc(d,x,1e3),x.H=Math.round(d.va*.5)+Math.round(d.va*.5*Math.random()),ja(d.h,x),Er(x,k,E)}function Yr(d,E){d.H&&J(d.H,function(x,k){ot(E,k,x)}),d.l&&J({},function(x,k){ot(E,k,x)})}function Oc(d,E,x){x=Math.min(d.i.length,x);const k=d.l?p(d.l.Ka,d.l,d):null;e:{var q=d.i;let ze=-1;for(;;){const Pt=["count="+x];ze==-1?x>0?(ze=q[0].g,Pt.push("ofs="+ze)):ze=0:Pt.push("ofs="+ze);let ct=!0;for(let jt=0;jt<x;jt++){var Y=q[jt].g;const Gn=q[jt].map;if(Y-=ze,Y<0)ze=Math.max(0,q[jt].g-100),ct=!1;else try{Y="req"+Y+"_"||"";try{var ce=Gn instanceof Map?Gn:Object.entries(Gn);for(const[Ds,Jr]of ce){let Zr=Jr;u(Jr)&&(Zr=fi(Jr)),Pt.push(Y+Ds+"="+encodeURIComponent(Zr))}}catch(Ds){throw Pt.push(Y+"type="+encodeURIComponent("_badmap")),Ds}}catch{k&&k(Gn)}}if(ct){ce=Pt.join("&");break e}}ce=void 0}return d=d.i.splice(0,x),E.G=d,ce}function fn(d){if(!d.g&&!d.v){d.Y=1;var E=d.Da;X||R(),ne||(X(),ne=!0),P.add(E,d),d.A=0}}function Xr(d){return d.g||d.v||d.A>=3?!1:(d.Y++,d.v=yi(p(d.Da,d),qa(d,d.A)),d.A++,!0)}n.Da=function(){if(this.v=null,Si(this),this.aa&&!(this.P||this.g==null||this.T<=0)){var d=4*this.T;this.j.info("BP detection timer enabled: "+d),this.B=yi(p(this.Wa,this),d)}},n.Wa=function(){this.B&&(this.B=null,this.j.info("BP detection timeout reached."),this.j.info("Buffering proxy detected and switch to long-polling!"),this.F=!1,this.P=!0,bt(10),Hn(this),Si(this))};function Vo(d){d.B!=null&&(l.clearTimeout(d.B),d.B=null)}function Si(d){d.g=new or(d,d.j,"rpc",d.Y),d.u===null&&(d.g.J=d.o),d.g.P=0;var E=ar(d.na);ot(E,"RID","rpc"),ot(E,"SID",d.M),ot(E,"AID",d.K),ot(E,"CI",d.F?"0":"1"),!d.F&&d.ia&&ot(E,"TO",d.ia),ot(E,"TYPE","xmlhttp"),Yr(d,E),d.u&&d.o&&Ua(E,d.u,d.o),d.O&&(d.g.H=d.O);var x=d.g;d=d.ba,x.M=1,x.A=Rs(ar(E)),x.u=null,x.R=!0,Ec(x,d)}n.Va=function(){this.C!=null&&(this.C=null,Hn(this),Xr(this),bt(19))};function Wa(d){d.C!=null&&(l.clearTimeout(d.C),d.C=null)}function Ha(d,E){var x=null;if(d.g==E){Wa(d),Vo(d),d.g=null;var k=2}else if(Cc(d.h,E))x=E.G,No(d.h,E),k=1;else return;if(d.I!=0){if(E.o)if(k==1){x=E.u?E.u.length:0,E=Date.now()-E.F;var q=d.D;k=gi(),nt(k,new vc(k,x)),Ps(d)}else fn(d);else if(q=E.m,q==3||q==0&&E.X>0||!(k==1&&Wd(d,E)||k==2&&Xr(d)))switch(x&&x.length>0&&(E=d.h,E.i=E.i.concat(x)),q){case 1:qn(d,5);break;case 4:qn(d,10);break;case 3:qn(d,6);break;default:qn(d,2)}}}function qa(d,E){let x=d.Qa+Math.floor(Math.random()*d.Za);return d.isActive()||(x*=2),x*E}function qn(d,E){if(d.j.info("Error code "+E),E==2){var x=p(d.bb,d),k=d.Ua;const q=!k;k=new Br(k||"//www.google.com/images/cleardot.gif"),l.location&&l.location.protocol=="http"||Po(k,"https"),Rs(k),q?qr(k.toString(),x):Gr(k.toString(),x)}else bt(2);d.I=0,d.l&&d.l.pa(E),Fo(d),$a(d)}n.bb=function(d){d?(this.j.info("Successfully pinged google.com"),bt(2)):(this.j.info("Failed to ping google.com"),bt(1))};function Fo(d){if(d.I=0,d.ja=[],d.l){const E=Bn(d.h);(E.length!=0||d.i.length!=0)&&(A(d.ja,E),A(d.ja,d.i),d.h.i.length=0,T(d.i),d.i.length=0),d.l.oa()}}function Mc(d,E,x){var k=x instanceof Br?ar(x):new Br(x);if(k.g!="")E&&(k.g=E+"."+k.g),$r(k,k.u);else{var q=l.location;k=q.protocol,E=E?E+"."+q.hostname:q.hostname,q=+q.port;const Y=new Br(null);k&&Po(Y,k),E&&(Y.g=E),q&&$r(Y,q),x&&(Y.h=x),k=Y}return x=d.G,E=d.wa,x&&E&&ot(k,x,E),ot(k,"VER",d.ka),Yr(d,k),k}function Hd(d,E,x){if(E&&!d.L)throw Error("Can't create secondary domain capable XhrIo object.");return E=d.Aa&&!d.ma?new ht(new As({ab:x})):new ht(d.ma),E.Fa(d.L),E}n.isActive=function(){return!!this.l&&this.l.isActive(this)};function qd(){}n=qd.prototype,n.ra=function(){},n.qa=function(){},n.pa=function(){},n.oa=function(){},n.isActive=function(){return!0},n.Ka=function(){};function Ga(){}Ga.prototype.g=function(d,E){return new rn(d,E)};function rn(d,E){$e.call(this),this.g=new za(E),this.l=d,this.h=E&&E.messageUrlParams||null,d=E&&E.messageHeaders||null,E&&E.clientProtocolHeaderRequired&&(d?d["X-Client-Protocol"]="webchannel":d={"X-Client-Protocol":"webchannel"}),this.g.o=d,d=E&&E.initMessageHeaders||null,E&&E.messageContentType&&(d?d["X-WebChannel-Content-Type"]=E.messageContentType:d={"X-WebChannel-Content-Type":E.messageContentType}),E&&E.sa&&(d?d["X-WebChannel-Client-Profile"]=E.sa:d={"X-WebChannel-Client-Profile":E.sa}),this.g.U=d,(d=E&&E.Qb)&&!D(d)&&(this.g.u=d),this.A=E&&E.supportsCrossDomainXhr||!1,this.v=E&&E.sendRawJson||!1,(E=E&&E.httpSessionIdParam)&&!D(E)&&(this.g.G=E,d=this.h,d!==null&&E in d&&(d=this.h,E in d&&delete d[E])),this.j=new Ii(this)}_(rn,$e),rn.prototype.m=function(){this.g.l=this.j,this.A&&(this.g.L=!0),this.g.connect(this.l,this.h||void 0)},rn.prototype.close=function(){Ba(this.g)},rn.prototype.o=function(d){var E=this.g;if(typeof d=="string"){var x={};x.__data__=d,d=x}else this.v&&(x={},x.__data__=fi(d),d=x);E.i.push(new Em(E.Ya++,d)),E.I==3&&Ps(E)},rn.prototype.N=function(){this.g.l=null,delete this.j,Ba(this.g),delete this.g,rn.Z.N.call(this)};function Gd(d){Na.call(this),d.__headers__&&(this.headers=d.__headers__,this.statusCode=d.__status__,delete d.__headers__,delete d.__status__);var E=d.__sm__;if(E){e:{for(const x in E){d=x;break e}d=void 0}(this.i=d)&&(d=this.i,E=E!==null&&d in E?E[d]:void 0),this.data=E}else this.data=d}_(Gd,Na);function Kd(){_c.call(this),this.status=1}_(Kd,_c);function Ii(d){this.g=d}_(Ii,qd),Ii.prototype.ra=function(){nt(this.g,"a")},Ii.prototype.qa=function(d){nt(this.g,new Gd(d))},Ii.prototype.pa=function(d){nt(this.g,new Kd)},Ii.prototype.oa=function(){nt(this.g,"b")},Ga.prototype.createWebChannel=Ga.prototype.g,rn.prototype.send=rn.prototype.o,rn.prototype.open=rn.prototype.m,rn.prototype.close=rn.prototype.close,OI=function(){return new Ga},DI=function(){return gi()},PI=wr,Fy={jb:0,mb:1,nb:2,Hb:3,Mb:4,Jb:5,Kb:6,Ib:7,Gb:8,Lb:9,PROXY:10,NOPROXY:11,Eb:12,Ab:13,Bb:14,zb:15,Cb:16,Db:17,fb:18,eb:19,gb:20},vi.NO_ERROR=0,vi.TIMEOUT=8,vi.HTTP_ERROR=6,df=vi,wi.COMPLETE="complete",NI=wi,Ad.EventType=mi,mi.OPEN="a",mi.CLOSE="b",mi.ERROR="c",mi.MESSAGE="d",$e.prototype.listen=$e.prototype.J,gu=Ad,ht.prototype.listenOnce=ht.prototype.K,ht.prototype.getLastError=ht.prototype.Ha,ht.prototype.getLastErrorCode=ht.prototype.ya,ht.prototype.getStatus=ht.prototype.ca,ht.prototype.getResponseJson=ht.prototype.La,ht.prototype.getResponseText=ht.prototype.la,ht.prototype.send=ht.prototype.ea,ht.prototype.setWithCredentials=ht.prototype.Fa,kI=ht}).apply(typeof $h<"u"?$h:typeof self<"u"?self:typeof window<"u"?window:{});const eT="@firebase/firestore",tT="4.9.2";/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let vn=class{constructor(e){this.uid=e}isAuthenticated(){return this.uid!=null}toKey(){return this.isAuthenticated()?"uid:"+this.uid:"anonymous-user"}isEqual(e){return e.uid===this.uid}};vn.UNAUTHENTICATED=new vn(null),vn.GOOGLE_CREDENTIALS=new vn("google-credentials-uid"),vn.FIRST_PARTY=new vn("first-party-uid"),vn.MOCK_USER=new vn("mock-user");/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let nc="12.3.0";/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const la=new Ep("@firebase/firestore");function wl(){return la.logLevel}function pe(n,...e){if(la.logLevel<=Qe.DEBUG){const t=e.map(q_);la.debug(`Firestore (${nc}): ${n}`,...t)}}function ti(n,...e){if(la.logLevel<=Qe.ERROR){const t=e.map(q_);la.error(`Firestore (${nc}): ${n}`,...t)}}function Vl(n,...e){if(la.logLevel<=Qe.WARN){const t=e.map(q_);la.warn(`Firestore (${nc}): ${n}`,...t)}}function q_(n){if(typeof n=="string")return n;try{/**
* @license
* Copyright 2020 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/return(function(t){return JSON.stringify(t)})(n)}catch{return n}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Oe(n,e,t){let r="Unexpected state";typeof e=="string"?r=e:t=e,MI(n,r,t)}function MI(n,e,t){let r=`FIRESTORE (${nc}) INTERNAL ASSERTION FAILED: ${e} (ID: ${n.toString(16)})`;if(t!==void 0)try{r+=" CONTEXT: "+JSON.stringify(t)}catch{r+=" CONTEXT: "+t}throw ti(r),new Error(r)}function lt(n,e,t,r){let s="Unexpected state";typeof t=="string"?s=t:r=t,n||MI(e,s,r)}function Be(n,e){return n}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ee={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"};class de extends ws{constructor(e,t){super(e,t),this.code=e,this.message=t,this.toString=()=>`${this.name}: [code=${this.code}]: ${this.message}`}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Qs{constructor(){this.promise=new Promise(((e,t)=>{this.resolve=e,this.reject=t}))}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class LI{constructor(e,t){this.user=t,this.type="OAuth",this.headers=new Map,this.headers.set("Authorization",`Bearer ${e}`)}}class AM{getToken(){return Promise.resolve(null)}invalidateToken(){}start(e,t){e.enqueueRetryable((()=>t(vn.UNAUTHENTICATED)))}shutdown(){}}class kM{constructor(e){this.token=e,this.changeListener=null}getToken(){return Promise.resolve(this.token)}invalidateToken(){}start(e,t){this.changeListener=t,e.enqueueRetryable((()=>t(this.token.user)))}shutdown(){this.changeListener=null}}class NM{constructor(e){this.t=e,this.currentUser=vn.UNAUTHENTICATED,this.i=0,this.forceRefresh=!1,this.auth=null}start(e,t){lt(this.o===void 0,42304);let r=this.i;const s=h=>this.i!==r?(r=this.i,t(h)):Promise.resolve();let o=new Qs;this.o=()=>{this.i++,this.currentUser=this.u(),o.resolve(),o=new Qs,e.enqueueRetryable((()=>s(this.currentUser)))};const l=()=>{const h=o;e.enqueueRetryable((async()=>{await h.promise,await s(this.currentUser)}))},u=h=>{pe("FirebaseAuthCredentialsProvider","Auth detected"),this.auth=h,this.o&&(this.auth.addAuthTokenListener(this.o),l())};this.t.onInit((h=>u(h))),setTimeout((()=>{if(!this.auth){const h=this.t.getImmediate({optional:!0});h?u(h):(pe("FirebaseAuthCredentialsProvider","Auth not yet detected"),o.resolve(),o=new Qs)}}),0),l()}getToken(){const e=this.i,t=this.forceRefresh;return this.forceRefresh=!1,this.auth?this.auth.getToken(t).then((r=>this.i!==e?(pe("FirebaseAuthCredentialsProvider","getToken aborted due to token change."),this.getToken()):r?(lt(typeof r.accessToken=="string",31837,{l:r}),new LI(r.accessToken,this.currentUser)):null)):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.auth&&this.o&&this.auth.removeAuthTokenListener(this.o),this.o=void 0}u(){const e=this.auth&&this.auth.getUid();return lt(e===null||typeof e=="string",2055,{h:e}),new vn(e)}}class PM{constructor(e,t,r){this.P=e,this.T=t,this.I=r,this.type="FirstParty",this.user=vn.FIRST_PARTY,this.A=new Map}R(){return this.I?this.I():null}get headers(){this.A.set("X-Goog-AuthUser",this.P);const e=this.R();return e&&this.A.set("Authorization",e),this.T&&this.A.set("X-Goog-Iam-Authorization-Token",this.T),this.A}}class DM{constructor(e,t,r){this.P=e,this.T=t,this.I=r}getToken(){return Promise.resolve(new PM(this.P,this.T,this.I))}start(e,t){e.enqueueRetryable((()=>t(vn.FIRST_PARTY)))}shutdown(){}invalidateToken(){}}class nT{constructor(e){this.value=e,this.type="AppCheck",this.headers=new Map,e&&e.length>0&&this.headers.set("x-firebase-appcheck",this.value)}}class OM{constructor(e,t){this.V=t,this.forceRefresh=!1,this.appCheck=null,this.m=null,this.p=null,bn(e)&&e.settings.appCheckToken&&(this.p=e.settings.appCheckToken)}start(e,t){lt(this.o===void 0,3512);const r=o=>{o.error!=null&&pe("FirebaseAppCheckTokenProvider",`Error getting App Check token; using placeholder token instead. Error: ${o.error.message}`);const l=o.token!==this.m;return this.m=o.token,pe("FirebaseAppCheckTokenProvider",`Received ${l?"new":"existing"} token.`),l?t(o.token):Promise.resolve()};this.o=o=>{e.enqueueRetryable((()=>r(o)))};const s=o=>{pe("FirebaseAppCheckTokenProvider","AppCheck detected"),this.appCheck=o,this.o&&this.appCheck.addTokenListener(this.o)};this.V.onInit((o=>s(o))),setTimeout((()=>{if(!this.appCheck){const o=this.V.getImmediate({optional:!0});o?s(o):pe("FirebaseAppCheckTokenProvider","AppCheck not yet detected")}}),0)}getToken(){if(this.p)return Promise.resolve(new nT(this.p));const e=this.forceRefresh;return this.forceRefresh=!1,this.appCheck?this.appCheck.getToken(e).then((t=>t?(lt(typeof t.token=="string",44558,{tokenResult:t}),this.m=t.token,new nT(t.token)):null)):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.appCheck&&this.o&&this.appCheck.removeTokenListener(this.o),this.o=void 0}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function MM(n){const e=typeof self<"u"&&(self.crypto||self.msCrypto),t=new Uint8Array(n);if(e&&typeof e.getRandomValues=="function")e.getRandomValues(t);else for(let r=0;r<n;r++)t[r]=Math.floor(256*Math.random());return t}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class G_{static newId(){const e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",t=62*Math.floor(4.129032258064516);let r="";for(;r.length<20;){const s=MM(40);for(let o=0;o<s.length;++o)r.length<20&&s[o]<t&&(r+=e.charAt(s[o]%62))}return r}}function Xe(n,e){return n<e?-1:n>e?1:0}function Uy(n,e){const t=Math.min(n.length,e.length);for(let r=0;r<t;r++){const s=n.charAt(r),o=e.charAt(r);if(s!==o)return ny(s)===ny(o)?Xe(s,o):ny(s)?1:-1}return Xe(n.length,e.length)}const LM=55296,jM=57343;function ny(n){const e=n.charCodeAt(0);return e>=LM&&e<=jM}function Fl(n,e,t){return n.length===e.length&&n.every(((r,s)=>t(r,e[s])))}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const rT="__name__";class ss{constructor(e,t,r){t===void 0?t=0:t>e.length&&Oe(637,{offset:t,range:e.length}),r===void 0?r=e.length-t:r>e.length-t&&Oe(1746,{length:r,range:e.length-t}),this.segments=e,this.offset=t,this.len=r}get length(){return this.len}isEqual(e){return ss.comparator(this,e)===0}child(e){const t=this.segments.slice(this.offset,this.limit());return e instanceof ss?e.forEach((r=>{t.push(r)})):t.push(e),this.construct(t)}limit(){return this.offset+this.length}popFirst(e){return e=e===void 0?1:e,this.construct(this.segments,this.offset+e,this.length-e)}popLast(){return this.construct(this.segments,this.offset,this.length-1)}firstSegment(){return this.segments[this.offset]}lastSegment(){return this.get(this.length-1)}get(e){return this.segments[this.offset+e]}isEmpty(){return this.length===0}isPrefixOf(e){if(e.length<this.length)return!1;for(let t=0;t<this.length;t++)if(this.get(t)!==e.get(t))return!1;return!0}isImmediateParentOf(e){if(this.length+1!==e.length)return!1;for(let t=0;t<this.length;t++)if(this.get(t)!==e.get(t))return!1;return!0}forEach(e){for(let t=this.offset,r=this.limit();t<r;t++)e(this.segments[t])}toArray(){return this.segments.slice(this.offset,this.limit())}static comparator(e,t){const r=Math.min(e.length,t.length);for(let s=0;s<r;s++){const o=ss.compareSegments(e.get(s),t.get(s));if(o!==0)return o}return Xe(e.length,t.length)}static compareSegments(e,t){const r=ss.isNumericId(e),s=ss.isNumericId(t);return r&&!s?-1:!r&&s?1:r&&s?ss.extractNumericId(e).compare(ss.extractNumericId(t)):Uy(e,t)}static isNumericId(e){return e.startsWith("__id")&&e.endsWith("__")}static extractNumericId(e){return Zi.fromString(e.substring(4,e.length-2))}}class mt extends ss{construct(e,t,r){return new mt(e,t,r)}canonicalString(){return this.toArray().join("/")}toString(){return this.canonicalString()}toUriEncodedString(){return this.toArray().map(encodeURIComponent).join("/")}static fromString(...e){const t=[];for(const r of e){if(r.indexOf("//")>=0)throw new de(ee.INVALID_ARGUMENT,`Invalid segment (${r}). Paths must not contain // in them.`);t.push(...r.split("/").filter((s=>s.length>0)))}return new mt(t)}static emptyPath(){return new mt([])}}const VM=/^[_a-zA-Z][_a-zA-Z0-9]*$/;class cn extends ss{construct(e,t,r){return new cn(e,t,r)}static isValidIdentifier(e){return VM.test(e)}canonicalString(){return this.toArray().map((e=>(e=e.replace(/\\/g,"\\\\").replace(/`/g,"\\`"),cn.isValidIdentifier(e)||(e="`"+e+"`"),e))).join(".")}toString(){return this.canonicalString()}isKeyField(){return this.length===1&&this.get(0)===rT}static keyField(){return new cn([rT])}static fromServerFormat(e){const t=[];let r="",s=0;const o=()=>{if(r.length===0)throw new de(ee.INVALID_ARGUMENT,`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`);t.push(r),r=""};let l=!1;for(;s<e.length;){const u=e[s];if(u==="\\"){if(s+1===e.length)throw new de(ee.INVALID_ARGUMENT,"Path has trailing escape character: "+e);const h=e[s+1];if(h!=="\\"&&h!=="."&&h!=="`")throw new de(ee.INVALID_ARGUMENT,"Path has invalid escape sequence: "+e);r+=h,s+=2}else u==="`"?(l=!l,s++):u!=="."||l?(r+=u,s++):(o(),s++)}if(o(),l)throw new de(ee.INVALID_ARGUMENT,"Unterminated ` in path: "+e);return new cn(t)}static emptyPath(){return new cn([])}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class be{constructor(e){this.path=e}static fromPath(e){return new be(mt.fromString(e))}static fromName(e){return new be(mt.fromString(e).popFirst(5))}static empty(){return new be(mt.emptyPath())}get collectionGroup(){return this.path.popLast().lastSegment()}hasCollectionId(e){return this.path.length>=2&&this.path.get(this.path.length-2)===e}getCollectionGroup(){return this.path.get(this.path.length-2)}getCollectionPath(){return this.path.popLast()}isEqual(e){return e!==null&&mt.comparator(this.path,e.path)===0}toString(){return this.path.toString()}static comparator(e,t){return mt.comparator(e.path,t.path)}static isDocumentKey(e){return e.length%2==0}static fromSegments(e){return new be(new mt(e.slice()))}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function jI(n,e,t){if(!t)throw new de(ee.INVALID_ARGUMENT,`Function ${n}() cannot be called with an empty ${e}.`)}function FM(n,e,t,r){if(e===!0&&r===!0)throw new de(ee.INVALID_ARGUMENT,`${n} and ${t} cannot be used together.`)}function sT(n){if(!be.isDocumentKey(n))throw new de(ee.INVALID_ARGUMENT,`Invalid document reference. Document references must have an even number of segments, but ${n} has ${n.length}.`)}function iT(n){if(be.isDocumentKey(n))throw new de(ee.INVALID_ARGUMENT,`Invalid collection reference. Collection references must have an odd number of segments, but ${n} has ${n.length}.`)}function VI(n){return typeof n=="object"&&n!==null&&(Object.getPrototypeOf(n)===Object.prototype||Object.getPrototypeOf(n)===null)}function Ip(n){if(n===void 0)return"undefined";if(n===null)return"null";if(typeof n=="string")return n.length>20&&(n=`${n.substring(0,20)}...`),JSON.stringify(n);if(typeof n=="number"||typeof n=="boolean")return""+n;if(typeof n=="object"){if(n instanceof Array)return"an array";{const e=(function(r){return r.constructor?r.constructor.name:null})(n);return e?`a custom ${e} object`:"an object"}}return typeof n=="function"?"a function":Oe(12329,{type:typeof n})}function er(n,e){if("_delegate"in n&&(n=n._delegate),!(n instanceof e)){if(e.name===n.constructor.name)throw new de(ee.INVALID_ARGUMENT,"Type does not match the expected instance. Did you pass a reference from a different Firestore SDK?");{const t=Ip(n);throw new de(ee.INVALID_ARGUMENT,`Expected type '${e.name}', but it was: ${t}`)}}return n}/**
 * @license
 * Copyright 2025 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Bt(n,e){const t={typeString:n};return e&&(t.value=e),t}function dd(n,e){if(!VI(n))throw new de(ee.INVALID_ARGUMENT,"JSON must be an object");let t;for(const r in e)if(e[r]){const s=e[r].typeString,o="value"in e[r]?{value:e[r].value}:void 0;if(!(r in n)){t=`JSON missing required field: '${r}'`;break}const l=n[r];if(s&&typeof l!==s){t=`JSON field '${r}' must be a ${s}.`;break}if(o!==void 0&&l!==o.value){t=`Expected '${r}' field to equal '${o.value}'`;break}}if(t)throw new de(ee.INVALID_ARGUMENT,t);return!0}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const oT=-62135596800,aT=1e6;class wt{static now(){return wt.fromMillis(Date.now())}static fromDate(e){return wt.fromMillis(e.getTime())}static fromMillis(e){const t=Math.floor(e/1e3),r=Math.floor((e-1e3*t)*aT);return new wt(t,r)}constructor(e,t){if(this.seconds=e,this.nanoseconds=t,t<0)throw new de(ee.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+t);if(t>=1e9)throw new de(ee.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+t);if(e<oT)throw new de(ee.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e);if(e>=253402300800)throw new de(ee.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e)}toDate(){return new Date(this.toMillis())}toMillis(){return 1e3*this.seconds+this.nanoseconds/aT}_compareTo(e){return this.seconds===e.seconds?Xe(this.nanoseconds,e.nanoseconds):Xe(this.seconds,e.seconds)}isEqual(e){return e.seconds===this.seconds&&e.nanoseconds===this.nanoseconds}toString(){return"Timestamp(seconds="+this.seconds+", nanoseconds="+this.nanoseconds+")"}toJSON(){return{type:wt._jsonSchemaVersion,seconds:this.seconds,nanoseconds:this.nanoseconds}}static fromJSON(e){if(dd(e,wt._jsonSchema))return new wt(e.seconds,e.nanoseconds)}valueOf(){const e=this.seconds-oT;return String(e).padStart(12,"0")+"."+String(this.nanoseconds).padStart(9,"0")}}wt._jsonSchemaVersion="firestore/timestamp/1.0",wt._jsonSchema={type:Bt("string",wt._jsonSchemaVersion),seconds:Bt("number"),nanoseconds:Bt("number")};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ue{static fromTimestamp(e){return new Ue(e)}static min(){return new Ue(new wt(0,0))}static max(){return new Ue(new wt(253402300799,999999999))}constructor(e){this.timestamp=e}compareTo(e){return this.timestamp._compareTo(e.timestamp)}isEqual(e){return this.timestamp.isEqual(e.timestamp)}toMicroseconds(){return 1e6*this.timestamp.seconds+this.timestamp.nanoseconds/1e3}toString(){return"SnapshotVersion("+this.timestamp.toString()+")"}toTimestamp(){return this.timestamp}}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Fu=-1;function UM(n,e){const t=n.toTimestamp().seconds,r=n.toTimestamp().nanoseconds+1,s=Ue.fromTimestamp(r===1e9?new wt(t+1,0):new wt(t,r));return new ao(s,be.empty(),e)}function zM(n){return new ao(n.readTime,n.key,Fu)}class ao{constructor(e,t,r){this.readTime=e,this.documentKey=t,this.largestBatchId=r}static min(){return new ao(Ue.min(),be.empty(),Fu)}static max(){return new ao(Ue.max(),be.empty(),Fu)}}function BM(n,e){let t=n.readTime.compareTo(e.readTime);return t!==0?t:(t=be.comparator(n.documentKey,e.documentKey),t!==0?t:Xe(n.largestBatchId,e.largestBatchId))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const $M="The current tab is not in the required state to perform this operation. It might be necessary to refresh the browser tab.";class WM{constructor(){this.onCommittedListeners=[]}addOnCommittedListener(e){this.onCommittedListeners.push(e)}raiseOnCommittedEvent(){this.onCommittedListeners.forEach((e=>e()))}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function rc(n){if(n.code!==ee.FAILED_PRECONDITION||n.message!==$M)throw n;pe("LocalStore","Unexpectedly lost primary lease")}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class te{constructor(e){this.nextCallback=null,this.catchCallback=null,this.result=void 0,this.error=void 0,this.isDone=!1,this.callbackAttached=!1,e((t=>{this.isDone=!0,this.result=t,this.nextCallback&&this.nextCallback(t)}),(t=>{this.isDone=!0,this.error=t,this.catchCallback&&this.catchCallback(t)}))}catch(e){return this.next(void 0,e)}next(e,t){return this.callbackAttached&&Oe(59440),this.callbackAttached=!0,this.isDone?this.error?this.wrapFailure(t,this.error):this.wrapSuccess(e,this.result):new te(((r,s)=>{this.nextCallback=o=>{this.wrapSuccess(e,o).next(r,s)},this.catchCallback=o=>{this.wrapFailure(t,o).next(r,s)}}))}toPromise(){return new Promise(((e,t)=>{this.next(e,t)}))}wrapUserFunction(e){try{const t=e();return t instanceof te?t:te.resolve(t)}catch(t){return te.reject(t)}}wrapSuccess(e,t){return e?this.wrapUserFunction((()=>e(t))):te.resolve(t)}wrapFailure(e,t){return e?this.wrapUserFunction((()=>e(t))):te.reject(t)}static resolve(e){return new te(((t,r)=>{t(e)}))}static reject(e){return new te(((t,r)=>{r(e)}))}static waitFor(e){return new te(((t,r)=>{let s=0,o=0,l=!1;e.forEach((u=>{++s,u.next((()=>{++o,l&&o===s&&t()}),(h=>r(h)))})),l=!0,o===s&&t()}))}static or(e){let t=te.resolve(!1);for(const r of e)t=t.next((s=>s?te.resolve(s):r()));return t}static forEach(e,t){const r=[];return e.forEach(((s,o)=>{r.push(t.call(this,s,o))})),this.waitFor(r)}static mapArray(e,t){return new te(((r,s)=>{const o=e.length,l=new Array(o);let u=0;for(let h=0;h<o;h++){const p=h;t(e[p]).next((g=>{l[p]=g,++u,u===o&&r(l)}),(g=>s(g)))}}))}static doWhile(e,t){return new te(((r,s)=>{const o=()=>{e()===!0?t().next((()=>{o()}),s):r()};o()}))}}function HM(n){const e=n.match(/Android ([\d.]+)/i),t=e?e[1].split(".").slice(0,2).join("."):"-1";return Number(t)}function sc(n){return n.name==="IndexedDbTransactionError"}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class bp{constructor(e,t){this.previousValue=e,t&&(t.sequenceNumberHandler=r=>this.ae(r),this.ue=r=>t.writeSequenceNumber(r))}ae(e){return this.previousValue=Math.max(e,this.previousValue),this.previousValue}next(){const e=++this.previousValue;return this.ue&&this.ue(e),e}}bp.ce=-1;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const K_=-1;function Rp(n){return n==null}function Df(n){return n===0&&1/n==-1/0}function qM(n){return typeof n=="number"&&Number.isInteger(n)&&!Df(n)&&n<=Number.MAX_SAFE_INTEGER&&n>=Number.MIN_SAFE_INTEGER}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const FI="";function GM(n){let e="";for(let t=0;t<n.length;t++)e.length>0&&(e=lT(e)),e=KM(n.get(t),e);return lT(e)}function KM(n,e){let t=e;const r=n.length;for(let s=0;s<r;s++){const o=n.charAt(s);switch(o){case"\0":t+="";break;case FI:t+="";break;default:t+=o}}return t}function lT(n){return n+FI+""}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function cT(n){let e=0;for(const t in n)Object.prototype.hasOwnProperty.call(n,t)&&e++;return e}function To(n,e){for(const t in n)Object.prototype.hasOwnProperty.call(n,t)&&e(t,n[t])}function UI(n){for(const e in n)if(Object.prototype.hasOwnProperty.call(n,e))return!1;return!0}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let $t=class zy{constructor(e,t){this.comparator=e,this.root=t||eo.EMPTY}insert(e,t){return new zy(this.comparator,this.root.insert(e,t,this.comparator).copy(null,null,eo.BLACK,null,null))}remove(e){return new zy(this.comparator,this.root.remove(e,this.comparator).copy(null,null,eo.BLACK,null,null))}get(e){let t=this.root;for(;!t.isEmpty();){const r=this.comparator(e,t.key);if(r===0)return t.value;r<0?t=t.left:r>0&&(t=t.right)}return null}indexOf(e){let t=0,r=this.root;for(;!r.isEmpty();){const s=this.comparator(e,r.key);if(s===0)return t+r.left.size;s<0?r=r.left:(t+=r.left.size+1,r=r.right)}return-1}isEmpty(){return this.root.isEmpty()}get size(){return this.root.size}minKey(){return this.root.minKey()}maxKey(){return this.root.maxKey()}inorderTraversal(e){return this.root.inorderTraversal(e)}forEach(e){this.inorderTraversal(((t,r)=>(e(t,r),!1)))}toString(){const e=[];return this.inorderTraversal(((t,r)=>(e.push(`${t}:${r}`),!1))),`{${e.join(", ")}}`}reverseTraversal(e){return this.root.reverseTraversal(e)}getIterator(){return new Wh(this.root,null,this.comparator,!1)}getIteratorFrom(e){return new Wh(this.root,e,this.comparator,!1)}getReverseIterator(){return new Wh(this.root,null,this.comparator,!0)}getReverseIteratorFrom(e){return new Wh(this.root,e,this.comparator,!0)}},Wh=class{constructor(e,t,r,s){this.isReverse=s,this.nodeStack=[];let o=1;for(;!e.isEmpty();)if(o=t?r(e.key,t):1,t&&s&&(o*=-1),o<0)e=this.isReverse?e.left:e.right;else{if(o===0){this.nodeStack.push(e);break}this.nodeStack.push(e),e=this.isReverse?e.right:e.left}}getNext(){let e=this.nodeStack.pop();const t={key:e.key,value:e.value};if(this.isReverse)for(e=e.left;!e.isEmpty();)this.nodeStack.push(e),e=e.right;else for(e=e.right;!e.isEmpty();)this.nodeStack.push(e),e=e.left;return t}hasNext(){return this.nodeStack.length>0}peek(){if(this.nodeStack.length===0)return null;const e=this.nodeStack[this.nodeStack.length-1];return{key:e.key,value:e.value}}},eo=class $s{constructor(e,t,r,s,o){this.key=e,this.value=t,this.color=r??$s.RED,this.left=s??$s.EMPTY,this.right=o??$s.EMPTY,this.size=this.left.size+1+this.right.size}copy(e,t,r,s,o){return new $s(e??this.key,t??this.value,r??this.color,s??this.left,o??this.right)}isEmpty(){return!1}inorderTraversal(e){return this.left.inorderTraversal(e)||e(this.key,this.value)||this.right.inorderTraversal(e)}reverseTraversal(e){return this.right.reverseTraversal(e)||e(this.key,this.value)||this.left.reverseTraversal(e)}min(){return this.left.isEmpty()?this:this.left.min()}minKey(){return this.min().key}maxKey(){return this.right.isEmpty()?this.key:this.right.maxKey()}insert(e,t,r){let s=this;const o=r(e,s.key);return s=o<0?s.copy(null,null,null,s.left.insert(e,t,r),null):o===0?s.copy(null,t,null,null,null):s.copy(null,null,null,null,s.right.insert(e,t,r)),s.fixUp()}removeMin(){if(this.left.isEmpty())return $s.EMPTY;let e=this;return e.left.isRed()||e.left.left.isRed()||(e=e.moveRedLeft()),e=e.copy(null,null,null,e.left.removeMin(),null),e.fixUp()}remove(e,t){let r,s=this;if(t(e,s.key)<0)s.left.isEmpty()||s.left.isRed()||s.left.left.isRed()||(s=s.moveRedLeft()),s=s.copy(null,null,null,s.left.remove(e,t),null);else{if(s.left.isRed()&&(s=s.rotateRight()),s.right.isEmpty()||s.right.isRed()||s.right.left.isRed()||(s=s.moveRedRight()),t(e,s.key)===0){if(s.right.isEmpty())return $s.EMPTY;r=s.right.min(),s=s.copy(r.key,r.value,null,null,s.right.removeMin())}s=s.copy(null,null,null,null,s.right.remove(e,t))}return s.fixUp()}isRed(){return this.color}fixUp(){let e=this;return e.right.isRed()&&!e.left.isRed()&&(e=e.rotateLeft()),e.left.isRed()&&e.left.left.isRed()&&(e=e.rotateRight()),e.left.isRed()&&e.right.isRed()&&(e=e.colorFlip()),e}moveRedLeft(){let e=this.colorFlip();return e.right.left.isRed()&&(e=e.copy(null,null,null,null,e.right.rotateRight()),e=e.rotateLeft(),e=e.colorFlip()),e}moveRedRight(){let e=this.colorFlip();return e.left.left.isRed()&&(e=e.rotateRight(),e=e.colorFlip()),e}rotateLeft(){const e=this.copy(null,null,$s.RED,null,this.right.left);return this.right.copy(null,null,this.color,e,null)}rotateRight(){const e=this.copy(null,null,$s.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,e)}colorFlip(){const e=this.left.copy(null,null,!this.left.color,null,null),t=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,e,t)}checkMaxDepth(){const e=this.check();return Math.pow(2,e)<=this.size+1}check(){if(this.isRed()&&this.left.isRed())throw Oe(43730,{key:this.key,value:this.value});if(this.right.isRed())throw Oe(14113,{key:this.key,value:this.value});const e=this.left.check();if(e!==this.right.check())throw Oe(27949);return e+(this.isRed()?0:1)}};eo.EMPTY=null,eo.RED=!0,eo.BLACK=!1;eo.EMPTY=new class{constructor(){this.size=0}get key(){throw Oe(57766)}get value(){throw Oe(16141)}get color(){throw Oe(16727)}get left(){throw Oe(29726)}get right(){throw Oe(36894)}copy(e,t,r,s,o){return this}insert(e,t,r){return new eo(e,t)}remove(e,t){return this}isEmpty(){return!0}inorderTraversal(e){return!1}reverseTraversal(e){return!1}minKey(){return null}maxKey(){return null}isRed(){return!1}checkMaxDepth(){return!0}check(){return 0}};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Gt{constructor(e){this.comparator=e,this.data=new $t(this.comparator)}has(e){return this.data.get(e)!==null}first(){return this.data.minKey()}last(){return this.data.maxKey()}get size(){return this.data.size}indexOf(e){return this.data.indexOf(e)}forEach(e){this.data.inorderTraversal(((t,r)=>(e(t),!1)))}forEachInRange(e,t){const r=this.data.getIteratorFrom(e[0]);for(;r.hasNext();){const s=r.getNext();if(this.comparator(s.key,e[1])>=0)return;t(s.key)}}forEachWhile(e,t){let r;for(r=t!==void 0?this.data.getIteratorFrom(t):this.data.getIterator();r.hasNext();)if(!e(r.getNext().key))return}firstAfterOrEqual(e){const t=this.data.getIteratorFrom(e);return t.hasNext()?t.getNext().key:null}getIterator(){return new uT(this.data.getIterator())}getIteratorFrom(e){return new uT(this.data.getIteratorFrom(e))}add(e){return this.copy(this.data.remove(e).insert(e,!0))}delete(e){return this.has(e)?this.copy(this.data.remove(e)):this}isEmpty(){return this.data.isEmpty()}unionWith(e){let t=this;return t.size<e.size&&(t=e,e=this),e.forEach((r=>{t=t.add(r)})),t}isEqual(e){if(!(e instanceof Gt)||this.size!==e.size)return!1;const t=this.data.getIterator(),r=e.data.getIterator();for(;t.hasNext();){const s=t.getNext().key,o=r.getNext().key;if(this.comparator(s,o)!==0)return!1}return!0}toArray(){const e=[];return this.forEach((t=>{e.push(t)})),e}toString(){const e=[];return this.forEach((t=>e.push(t))),"SortedSet("+e.toString()+")"}copy(e){const t=new Gt(this.comparator);return t.data=e,t}}class uT{constructor(e){this.iter=e}getNext(){return this.iter.getNext().key}hasNext(){return this.iter.hasNext()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Jn{constructor(e){this.fields=e,e.sort(cn.comparator)}static empty(){return new Jn([])}unionWith(e){let t=new Gt(cn.comparator);for(const r of this.fields)t=t.add(r);for(const r of e)t=t.add(r);return new Jn(t.toArray())}covers(e){for(const t of this.fields)if(t.isPrefixOf(e))return!0;return!1}isEqual(e){return Fl(this.fields,e.fields,((t,r)=>t.isEqual(r)))}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class zI extends Error{constructor(){super(...arguments),this.name="Base64DecodeError"}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class dn{constructor(e){this.binaryString=e}static fromBase64String(e){const t=(function(s){try{return atob(s)}catch(o){throw typeof DOMException<"u"&&o instanceof DOMException?new zI("Invalid base64 string: "+o):o}})(e);return new dn(t)}static fromUint8Array(e){const t=(function(s){let o="";for(let l=0;l<s.length;++l)o+=String.fromCharCode(s[l]);return o})(e);return new dn(t)}[Symbol.iterator](){let e=0;return{next:()=>e<this.binaryString.length?{value:this.binaryString.charCodeAt(e++),done:!1}:{value:void 0,done:!0}}}toBase64(){return(function(t){return btoa(t)})(this.binaryString)}toUint8Array(){return(function(t){const r=new Uint8Array(t.length);for(let s=0;s<t.length;s++)r[s]=t.charCodeAt(s);return r})(this.binaryString)}approximateByteSize(){return 2*this.binaryString.length}compareTo(e){return Xe(this.binaryString,e.binaryString)}isEqual(e){return this.binaryString===e.binaryString}}dn.EMPTY_BYTE_STRING=new dn("");const QM=new RegExp(/^\d{4}-\d\d-\d\dT\d\d:\d\d:\d\d(?:\.(\d+))?Z$/);function lo(n){if(lt(!!n,39018),typeof n=="string"){let e=0;const t=QM.exec(n);if(lt(!!t,46558,{timestamp:n}),t[1]){let s=t[1];s=(s+"000000000").substr(0,9),e=Number(s)}const r=new Date(n);return{seconds:Math.floor(r.getTime()/1e3),nanos:e}}return{seconds:Ot(n.seconds),nanos:Ot(n.nanos)}}function Ot(n){return typeof n=="number"?n:typeof n=="string"?Number(n):0}function co(n){return typeof n=="string"?dn.fromBase64String(n):dn.fromUint8Array(n)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const BI="server_timestamp",$I="__type__",WI="__previous_value__",HI="__local_write_time__";function Q_(n){return(n?.mapValue?.fields||{})[$I]?.stringValue===BI}function Ap(n){const e=n.mapValue.fields[WI];return Q_(e)?Ap(e):e}function Uu(n){const e=lo(n.mapValue.fields[HI].timestampValue);return new wt(e.seconds,e.nanos)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class YM{constructor(e,t,r,s,o,l,u,h,p,g){this.databaseId=e,this.appId=t,this.persistenceKey=r,this.host=s,this.ssl=o,this.forceLongPolling=l,this.autoDetectLongPolling=u,this.longPollingOptions=h,this.useFetchStreams=p,this.isUsingEmulator=g}}const Of="(default)";class zu{constructor(e,t){this.projectId=e,this.database=t||Of}static empty(){return new zu("","")}get isDefaultDatabase(){return this.database===Of}isEqual(e){return e instanceof zu&&e.projectId===this.projectId&&e.database===this.database}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const qI="__type__",XM="__max__",Hh={mapValue:{}},GI="__vector__",Mf="value";function uo(n){return"nullValue"in n?0:"booleanValue"in n?1:"integerValue"in n||"doubleValue"in n?2:"timestampValue"in n?3:"stringValue"in n?5:"bytesValue"in n?6:"referenceValue"in n?7:"geoPointValue"in n?8:"arrayValue"in n?9:"mapValue"in n?Q_(n)?4:ZM(n)?9007199254740991:JM(n)?10:11:Oe(28295,{value:n})}function gs(n,e){if(n===e)return!0;const t=uo(n);if(t!==uo(e))return!1;switch(t){case 0:case 9007199254740991:return!0;case 1:return n.booleanValue===e.booleanValue;case 4:return Uu(n).isEqual(Uu(e));case 3:return(function(s,o){if(typeof s.timestampValue=="string"&&typeof o.timestampValue=="string"&&s.timestampValue.length===o.timestampValue.length)return s.timestampValue===o.timestampValue;const l=lo(s.timestampValue),u=lo(o.timestampValue);return l.seconds===u.seconds&&l.nanos===u.nanos})(n,e);case 5:return n.stringValue===e.stringValue;case 6:return(function(s,o){return co(s.bytesValue).isEqual(co(o.bytesValue))})(n,e);case 7:return n.referenceValue===e.referenceValue;case 8:return(function(s,o){return Ot(s.geoPointValue.latitude)===Ot(o.geoPointValue.latitude)&&Ot(s.geoPointValue.longitude)===Ot(o.geoPointValue.longitude)})(n,e);case 2:return(function(s,o){if("integerValue"in s&&"integerValue"in o)return Ot(s.integerValue)===Ot(o.integerValue);if("doubleValue"in s&&"doubleValue"in o){const l=Ot(s.doubleValue),u=Ot(o.doubleValue);return l===u?Df(l)===Df(u):isNaN(l)&&isNaN(u)}return!1})(n,e);case 9:return Fl(n.arrayValue.values||[],e.arrayValue.values||[],gs);case 10:case 11:return(function(s,o){const l=s.mapValue.fields||{},u=o.mapValue.fields||{};if(cT(l)!==cT(u))return!1;for(const h in l)if(l.hasOwnProperty(h)&&(u[h]===void 0||!gs(l[h],u[h])))return!1;return!0})(n,e);default:return Oe(52216,{left:n})}}function Bu(n,e){return(n.values||[]).find((t=>gs(t,e)))!==void 0}function Ul(n,e){if(n===e)return 0;const t=uo(n),r=uo(e);if(t!==r)return Xe(t,r);switch(t){case 0:case 9007199254740991:return 0;case 1:return Xe(n.booleanValue,e.booleanValue);case 2:return(function(o,l){const u=Ot(o.integerValue||o.doubleValue),h=Ot(l.integerValue||l.doubleValue);return u<h?-1:u>h?1:u===h?0:isNaN(u)?isNaN(h)?0:-1:1})(n,e);case 3:return dT(n.timestampValue,e.timestampValue);case 4:return dT(Uu(n),Uu(e));case 5:return Uy(n.stringValue,e.stringValue);case 6:return(function(o,l){const u=co(o),h=co(l);return u.compareTo(h)})(n.bytesValue,e.bytesValue);case 7:return(function(o,l){const u=o.split("/"),h=l.split("/");for(let p=0;p<u.length&&p<h.length;p++){const g=Xe(u[p],h[p]);if(g!==0)return g}return Xe(u.length,h.length)})(n.referenceValue,e.referenceValue);case 8:return(function(o,l){const u=Xe(Ot(o.latitude),Ot(l.latitude));return u!==0?u:Xe(Ot(o.longitude),Ot(l.longitude))})(n.geoPointValue,e.geoPointValue);case 9:return hT(n.arrayValue,e.arrayValue);case 10:return(function(o,l){const u=o.fields||{},h=l.fields||{},p=u[Mf]?.arrayValue,g=h[Mf]?.arrayValue,_=Xe(p?.values?.length||0,g?.values?.length||0);return _!==0?_:hT(p,g)})(n.mapValue,e.mapValue);case 11:return(function(o,l){if(o===Hh.mapValue&&l===Hh.mapValue)return 0;if(o===Hh.mapValue)return 1;if(l===Hh.mapValue)return-1;const u=o.fields||{},h=Object.keys(u),p=l.fields||{},g=Object.keys(p);h.sort(),g.sort();for(let _=0;_<h.length&&_<g.length;++_){const v=Uy(h[_],g[_]);if(v!==0)return v;const T=Ul(u[h[_]],p[g[_]]);if(T!==0)return T}return Xe(h.length,g.length)})(n.mapValue,e.mapValue);default:throw Oe(23264,{he:t})}}function dT(n,e){if(typeof n=="string"&&typeof e=="string"&&n.length===e.length)return Xe(n,e);const t=lo(n),r=lo(e),s=Xe(t.seconds,r.seconds);return s!==0?s:Xe(t.nanos,r.nanos)}function hT(n,e){const t=n.values||[],r=e.values||[];for(let s=0;s<t.length&&s<r.length;++s){const o=Ul(t[s],r[s]);if(o)return o}return Xe(t.length,r.length)}function zl(n){return By(n)}function By(n){return"nullValue"in n?"null":"booleanValue"in n?""+n.booleanValue:"integerValue"in n?""+n.integerValue:"doubleValue"in n?""+n.doubleValue:"timestampValue"in n?(function(t){const r=lo(t);return`time(${r.seconds},${r.nanos})`})(n.timestampValue):"stringValue"in n?n.stringValue:"bytesValue"in n?(function(t){return co(t).toBase64()})(n.bytesValue):"referenceValue"in n?(function(t){return be.fromName(t).toString()})(n.referenceValue):"geoPointValue"in n?(function(t){return`geo(${t.latitude},${t.longitude})`})(n.geoPointValue):"arrayValue"in n?(function(t){let r="[",s=!0;for(const o of t.values||[])s?s=!1:r+=",",r+=By(o);return r+"]"})(n.arrayValue):"mapValue"in n?(function(t){const r=Object.keys(t.fields||{}).sort();let s="{",o=!0;for(const l of r)o?o=!1:s+=",",s+=`${l}:${By(t.fields[l])}`;return s+"}"})(n.mapValue):Oe(61005,{value:n})}function hf(n){switch(uo(n)){case 0:case 1:return 4;case 2:return 8;case 3:case 8:return 16;case 4:const e=Ap(n);return e?16+hf(e):16;case 5:return 2*n.stringValue.length;case 6:return co(n.bytesValue).approximateByteSize();case 7:return n.referenceValue.length;case 9:return(function(r){return(r.values||[]).reduce(((s,o)=>s+hf(o)),0)})(n.arrayValue);case 10:case 11:return(function(r){let s=0;return To(r.fields,((o,l)=>{s+=o.length+hf(l)})),s})(n.mapValue);default:throw Oe(13486,{value:n})}}function fT(n,e){return{referenceValue:`projects/${n.projectId}/databases/${n.database}/documents/${e.path.canonicalString()}`}}function $y(n){return!!n&&"integerValue"in n}function Y_(n){return!!n&&"arrayValue"in n}function pT(n){return!!n&&"nullValue"in n}function mT(n){return!!n&&"doubleValue"in n&&isNaN(Number(n.doubleValue))}function ff(n){return!!n&&"mapValue"in n}function JM(n){return(n?.mapValue?.fields||{})[qI]?.stringValue===GI}function Cu(n){if(n.geoPointValue)return{geoPointValue:{...n.geoPointValue}};if(n.timestampValue&&typeof n.timestampValue=="object")return{timestampValue:{...n.timestampValue}};if(n.mapValue){const e={mapValue:{fields:{}}};return To(n.mapValue.fields,((t,r)=>e.mapValue.fields[t]=Cu(r))),e}if(n.arrayValue){const e={arrayValue:{values:[]}};for(let t=0;t<(n.arrayValue.values||[]).length;++t)e.arrayValue.values[t]=Cu(n.arrayValue.values[t]);return e}return{...n}}function ZM(n){return(((n.mapValue||{}).fields||{}).__type__||{}).stringValue===XM}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Vn{constructor(e){this.value=e}static empty(){return new Vn({mapValue:{}})}field(e){if(e.isEmpty())return this.value;{let t=this.value;for(let r=0;r<e.length-1;++r)if(t=(t.mapValue.fields||{})[e.get(r)],!ff(t))return null;return t=(t.mapValue.fields||{})[e.lastSegment()],t||null}}set(e,t){this.getFieldsMap(e.popLast())[e.lastSegment()]=Cu(t)}setAll(e){let t=cn.emptyPath(),r={},s=[];e.forEach(((l,u)=>{if(!t.isImmediateParentOf(u)){const h=this.getFieldsMap(t);this.applyChanges(h,r,s),r={},s=[],t=u.popLast()}l?r[u.lastSegment()]=Cu(l):s.push(u.lastSegment())}));const o=this.getFieldsMap(t);this.applyChanges(o,r,s)}delete(e){const t=this.field(e.popLast());ff(t)&&t.mapValue.fields&&delete t.mapValue.fields[e.lastSegment()]}isEqual(e){return gs(this.value,e.value)}getFieldsMap(e){let t=this.value;t.mapValue.fields||(t.mapValue={fields:{}});for(let r=0;r<e.length;++r){let s=t.mapValue.fields[e.get(r)];ff(s)&&s.mapValue.fields||(s={mapValue:{fields:{}}},t.mapValue.fields[e.get(r)]=s),t=s}return t.mapValue.fields}applyChanges(e,t,r){To(t,((s,o)=>e[s]=o));for(const s of r)delete e[s]}clone(){return new Vn(Cu(this.value))}}function KI(n){const e=[];return To(n.fields,((t,r)=>{const s=new cn([t]);if(ff(r)){const o=KI(r.mapValue).fields;if(o.length===0)e.push(s);else for(const l of o)e.push(s.child(l))}else e.push(s)})),new Jn(e)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class wn{constructor(e,t,r,s,o,l,u){this.key=e,this.documentType=t,this.version=r,this.readTime=s,this.createTime=o,this.data=l,this.documentState=u}static newInvalidDocument(e){return new wn(e,0,Ue.min(),Ue.min(),Ue.min(),Vn.empty(),0)}static newFoundDocument(e,t,r,s){return new wn(e,1,t,Ue.min(),r,s,0)}static newNoDocument(e,t){return new wn(e,2,t,Ue.min(),Ue.min(),Vn.empty(),0)}static newUnknownDocument(e,t){return new wn(e,3,t,Ue.min(),Ue.min(),Vn.empty(),2)}convertToFoundDocument(e,t){return!this.createTime.isEqual(Ue.min())||this.documentType!==2&&this.documentType!==0||(this.createTime=e),this.version=e,this.documentType=1,this.data=t,this.documentState=0,this}convertToNoDocument(e){return this.version=e,this.documentType=2,this.data=Vn.empty(),this.documentState=0,this}convertToUnknownDocument(e){return this.version=e,this.documentType=3,this.data=Vn.empty(),this.documentState=2,this}setHasCommittedMutations(){return this.documentState=2,this}setHasLocalMutations(){return this.documentState=1,this.version=Ue.min(),this}setReadTime(e){return this.readTime=e,this}get hasLocalMutations(){return this.documentState===1}get hasCommittedMutations(){return this.documentState===2}get hasPendingWrites(){return this.hasLocalMutations||this.hasCommittedMutations}isValidDocument(){return this.documentType!==0}isFoundDocument(){return this.documentType===1}isNoDocument(){return this.documentType===2}isUnknownDocument(){return this.documentType===3}isEqual(e){return e instanceof wn&&this.key.isEqual(e.key)&&this.version.isEqual(e.version)&&this.documentType===e.documentType&&this.documentState===e.documentState&&this.data.isEqual(e.data)}mutableCopy(){return new wn(this.key,this.documentType,this.version,this.readTime,this.createTime,this.data.clone(),this.documentState)}toString(){return`Document(${this.key}, ${this.version}, ${JSON.stringify(this.data.value)}, {createTime: ${this.createTime}}), {documentType: ${this.documentType}}), {documentState: ${this.documentState}})`}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Lf{constructor(e,t){this.position=e,this.inclusive=t}}function gT(n,e,t){let r=0;for(let s=0;s<n.position.length;s++){const o=e[s],l=n.position[s];if(o.field.isKeyField()?r=be.comparator(be.fromName(l.referenceValue),t.key):r=Ul(l,t.data.field(o.field)),o.dir==="desc"&&(r*=-1),r!==0)break}return r}function yT(n,e){if(n===null)return e===null;if(e===null||n.inclusive!==e.inclusive||n.position.length!==e.position.length)return!1;for(let t=0;t<n.position.length;t++)if(!gs(n.position[t],e.position[t]))return!1;return!0}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class $u{constructor(e,t="asc"){this.field=e,this.dir=t}}function eL(n,e){return n.dir===e.dir&&n.field.isEqual(e.field)}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class QI{}class zt extends QI{constructor(e,t,r){super(),this.field=e,this.op=t,this.value=r}static create(e,t,r){return e.isKeyField()?t==="in"||t==="not-in"?this.createKeyFieldInFilter(e,t,r):new nL(e,t,r):t==="array-contains"?new iL(e,r):t==="in"?new oL(e,r):t==="not-in"?new aL(e,r):t==="array-contains-any"?new lL(e,r):new zt(e,t,r)}static createKeyFieldInFilter(e,t,r){return t==="in"?new rL(e,r):new sL(e,r)}matches(e){const t=e.data.field(this.field);return this.op==="!="?t!==null&&t.nullValue===void 0&&this.matchesComparison(Ul(t,this.value)):t!==null&&uo(this.value)===uo(t)&&this.matchesComparison(Ul(t,this.value))}matchesComparison(e){switch(this.op){case"<":return e<0;case"<=":return e<=0;case"==":return e===0;case"!=":return e!==0;case">":return e>0;case">=":return e>=0;default:return Oe(47266,{operator:this.op})}}isInequality(){return["<","<=",">",">=","!=","not-in"].indexOf(this.op)>=0}getFlattenedFilters(){return[this]}getFilters(){return[this]}}class Lr extends QI{constructor(e,t){super(),this.filters=e,this.op=t,this.Pe=null}static create(e,t){return new Lr(e,t)}matches(e){return YI(this)?this.filters.find((t=>!t.matches(e)))===void 0:this.filters.find((t=>t.matches(e)))!==void 0}getFlattenedFilters(){return this.Pe!==null||(this.Pe=this.filters.reduce(((e,t)=>e.concat(t.getFlattenedFilters())),[])),this.Pe}getFilters(){return Object.assign([],this.filters)}}function YI(n){return n.op==="and"}function XI(n){return tL(n)&&YI(n)}function tL(n){for(const e of n.filters)if(e instanceof Lr)return!1;return!0}function Wy(n){if(n instanceof zt)return n.field.canonicalString()+n.op.toString()+zl(n.value);if(XI(n))return n.filters.map((e=>Wy(e))).join(",");{const e=n.filters.map((t=>Wy(t))).join(",");return`${n.op}(${e})`}}function JI(n,e){return n instanceof zt?(function(r,s){return s instanceof zt&&r.op===s.op&&r.field.isEqual(s.field)&&gs(r.value,s.value)})(n,e):n instanceof Lr?(function(r,s){return s instanceof Lr&&r.op===s.op&&r.filters.length===s.filters.length?r.filters.reduce(((o,l,u)=>o&&JI(l,s.filters[u])),!0):!1})(n,e):void Oe(19439)}function ZI(n){return n instanceof zt?(function(t){return`${t.field.canonicalString()} ${t.op} ${zl(t.value)}`})(n):n instanceof Lr?(function(t){return t.op.toString()+" {"+t.getFilters().map(ZI).join(" ,")+"}"})(n):"Filter"}class nL extends zt{constructor(e,t,r){super(e,t,r),this.key=be.fromName(r.referenceValue)}matches(e){const t=be.comparator(e.key,this.key);return this.matchesComparison(t)}}class rL extends zt{constructor(e,t){super(e,"in",t),this.keys=eb("in",t)}matches(e){return this.keys.some((t=>t.isEqual(e.key)))}}class sL extends zt{constructor(e,t){super(e,"not-in",t),this.keys=eb("not-in",t)}matches(e){return!this.keys.some((t=>t.isEqual(e.key)))}}function eb(n,e){return(e.arrayValue?.values||[]).map((t=>be.fromName(t.referenceValue)))}class iL extends zt{constructor(e,t){super(e,"array-contains",t)}matches(e){const t=e.data.field(this.field);return Y_(t)&&Bu(t.arrayValue,this.value)}}class oL extends zt{constructor(e,t){super(e,"in",t)}matches(e){const t=e.data.field(this.field);return t!==null&&Bu(this.value.arrayValue,t)}}class aL extends zt{constructor(e,t){super(e,"not-in",t)}matches(e){if(Bu(this.value.arrayValue,{nullValue:"NULL_VALUE"}))return!1;const t=e.data.field(this.field);return t!==null&&t.nullValue===void 0&&!Bu(this.value.arrayValue,t)}}class lL extends zt{constructor(e,t){super(e,"array-contains-any",t)}matches(e){const t=e.data.field(this.field);return!(!Y_(t)||!t.arrayValue.values)&&t.arrayValue.values.some((r=>Bu(this.value.arrayValue,r)))}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class cL{constructor(e,t=null,r=[],s=[],o=null,l=null,u=null){this.path=e,this.collectionGroup=t,this.orderBy=r,this.filters=s,this.limit=o,this.startAt=l,this.endAt=u,this.Te=null}}function _T(n,e=null,t=[],r=[],s=null,o=null,l=null){return new cL(n,e,t,r,s,o,l)}function X_(n){const e=Be(n);if(e.Te===null){let t=e.path.canonicalString();e.collectionGroup!==null&&(t+="|cg:"+e.collectionGroup),t+="|f:",t+=e.filters.map((r=>Wy(r))).join(","),t+="|ob:",t+=e.orderBy.map((r=>(function(o){return o.field.canonicalString()+o.dir})(r))).join(","),Rp(e.limit)||(t+="|l:",t+=e.limit),e.startAt&&(t+="|lb:",t+=e.startAt.inclusive?"b:":"a:",t+=e.startAt.position.map((r=>zl(r))).join(",")),e.endAt&&(t+="|ub:",t+=e.endAt.inclusive?"a:":"b:",t+=e.endAt.position.map((r=>zl(r))).join(",")),e.Te=t}return e.Te}function J_(n,e){if(n.limit!==e.limit||n.orderBy.length!==e.orderBy.length)return!1;for(let t=0;t<n.orderBy.length;t++)if(!eL(n.orderBy[t],e.orderBy[t]))return!1;if(n.filters.length!==e.filters.length)return!1;for(let t=0;t<n.filters.length;t++)if(!JI(n.filters[t],e.filters[t]))return!1;return n.collectionGroup===e.collectionGroup&&!!n.path.isEqual(e.path)&&!!yT(n.startAt,e.startAt)&&yT(n.endAt,e.endAt)}function Hy(n){return be.isDocumentKey(n.path)&&n.collectionGroup===null&&n.filters.length===0}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ic{constructor(e,t=null,r=[],s=[],o=null,l="F",u=null,h=null){this.path=e,this.collectionGroup=t,this.explicitOrderBy=r,this.filters=s,this.limit=o,this.limitType=l,this.startAt=u,this.endAt=h,this.Ie=null,this.Ee=null,this.de=null,this.startAt,this.endAt}}function uL(n,e,t,r,s,o,l,u){return new ic(n,e,t,r,s,o,l,u)}function kp(n){return new ic(n)}function vT(n){return n.filters.length===0&&n.limit===null&&n.startAt==null&&n.endAt==null&&(n.explicitOrderBy.length===0||n.explicitOrderBy.length===1&&n.explicitOrderBy[0].field.isKeyField())}function tb(n){return n.collectionGroup!==null}function Su(n){const e=Be(n);if(e.Ie===null){e.Ie=[];const t=new Set;for(const o of e.explicitOrderBy)e.Ie.push(o),t.add(o.field.canonicalString());const r=e.explicitOrderBy.length>0?e.explicitOrderBy[e.explicitOrderBy.length-1].dir:"asc";(function(l){let u=new Gt(cn.comparator);return l.filters.forEach((h=>{h.getFlattenedFilters().forEach((p=>{p.isInequality()&&(u=u.add(p.field))}))})),u})(e).forEach((o=>{t.has(o.canonicalString())||o.isKeyField()||e.Ie.push(new $u(o,r))})),t.has(cn.keyField().canonicalString())||e.Ie.push(new $u(cn.keyField(),r))}return e.Ie}function ds(n){const e=Be(n);return e.Ee||(e.Ee=dL(e,Su(n))),e.Ee}function dL(n,e){if(n.limitType==="F")return _T(n.path,n.collectionGroup,e,n.filters,n.limit,n.startAt,n.endAt);{e=e.map((s=>{const o=s.dir==="desc"?"asc":"desc";return new $u(s.field,o)}));const t=n.endAt?new Lf(n.endAt.position,n.endAt.inclusive):null,r=n.startAt?new Lf(n.startAt.position,n.startAt.inclusive):null;return _T(n.path,n.collectionGroup,e,n.filters,n.limit,t,r)}}function qy(n,e){const t=n.filters.concat([e]);return new ic(n.path,n.collectionGroup,n.explicitOrderBy.slice(),t,n.limit,n.limitType,n.startAt,n.endAt)}function jf(n,e,t){return new ic(n.path,n.collectionGroup,n.explicitOrderBy.slice(),n.filters.slice(),e,t,n.startAt,n.endAt)}function Np(n,e){return J_(ds(n),ds(e))&&n.limitType===e.limitType}function nb(n){return`${X_(ds(n))}|lt:${n.limitType}`}function El(n){return`Query(target=${(function(t){let r=t.path.canonicalString();return t.collectionGroup!==null&&(r+=" collectionGroup="+t.collectionGroup),t.filters.length>0&&(r+=`, filters: [${t.filters.map((s=>ZI(s))).join(", ")}]`),Rp(t.limit)||(r+=", limit: "+t.limit),t.orderBy.length>0&&(r+=`, orderBy: [${t.orderBy.map((s=>(function(l){return`${l.field.canonicalString()} (${l.dir})`})(s))).join(", ")}]`),t.startAt&&(r+=", startAt: ",r+=t.startAt.inclusive?"b:":"a:",r+=t.startAt.position.map((s=>zl(s))).join(",")),t.endAt&&(r+=", endAt: ",r+=t.endAt.inclusive?"a:":"b:",r+=t.endAt.position.map((s=>zl(s))).join(",")),`Target(${r})`})(ds(n))}; limitType=${n.limitType})`}function Pp(n,e){return e.isFoundDocument()&&(function(r,s){const o=s.key.path;return r.collectionGroup!==null?s.key.hasCollectionId(r.collectionGroup)&&r.path.isPrefixOf(o):be.isDocumentKey(r.path)?r.path.isEqual(o):r.path.isImmediateParentOf(o)})(n,e)&&(function(r,s){for(const o of Su(r))if(!o.field.isKeyField()&&s.data.field(o.field)===null)return!1;return!0})(n,e)&&(function(r,s){for(const o of r.filters)if(!o.matches(s))return!1;return!0})(n,e)&&(function(r,s){return!(r.startAt&&!(function(l,u,h){const p=gT(l,u,h);return l.inclusive?p<=0:p<0})(r.startAt,Su(r),s)||r.endAt&&!(function(l,u,h){const p=gT(l,u,h);return l.inclusive?p>=0:p>0})(r.endAt,Su(r),s))})(n,e)}function hL(n){return n.collectionGroup||(n.path.length%2==1?n.path.lastSegment():n.path.get(n.path.length-2))}function rb(n){return(e,t)=>{let r=!1;for(const s of Su(n)){const o=fL(s,e,t);if(o!==0)return o;r=r||s.field.isKeyField()}return 0}}function fL(n,e,t){const r=n.field.isKeyField()?be.comparator(e.key,t.key):(function(o,l,u){const h=l.data.field(o),p=u.data.field(o);return h!==null&&p!==null?Ul(h,p):Oe(42886)})(n.field,e,t);switch(n.dir){case"asc":return r;case"desc":return-1*r;default:return Oe(19790,{direction:n.dir})}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class _a{constructor(e,t){this.mapKeyFn=e,this.equalsFn=t,this.inner={},this.innerSize=0}get(e){const t=this.mapKeyFn(e),r=this.inner[t];if(r!==void 0){for(const[s,o]of r)if(this.equalsFn(s,e))return o}}has(e){return this.get(e)!==void 0}set(e,t){const r=this.mapKeyFn(e),s=this.inner[r];if(s===void 0)return this.inner[r]=[[e,t]],void this.innerSize++;for(let o=0;o<s.length;o++)if(this.equalsFn(s[o][0],e))return void(s[o]=[e,t]);s.push([e,t]),this.innerSize++}delete(e){const t=this.mapKeyFn(e),r=this.inner[t];if(r===void 0)return!1;for(let s=0;s<r.length;s++)if(this.equalsFn(r[s][0],e))return r.length===1?delete this.inner[t]:r.splice(s,1),this.innerSize--,!0;return!1}forEach(e){To(this.inner,((t,r)=>{for(const[s,o]of r)e(s,o)}))}isEmpty(){return UI(this.inner)}size(){return this.innerSize}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const pL=new $t(be.comparator);function ni(){return pL}const sb=new $t(be.comparator);function yu(...n){let e=sb;for(const t of n)e=e.insert(t.key,t);return e}function ib(n){let e=sb;return n.forEach(((t,r)=>e=e.insert(t,r.overlayedDocument))),e}function ta(){return Iu()}function ob(){return Iu()}function Iu(){return new _a((n=>n.toString()),((n,e)=>n.isEqual(e)))}const mL=new $t(be.comparator),gL=new Gt(be.comparator);function Je(...n){let e=gL;for(const t of n)e=e.add(t);return e}const yL=new Gt(Xe);function _L(){return yL}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Z_(n,e){if(n.useProto3Json){if(isNaN(e))return{doubleValue:"NaN"};if(e===1/0)return{doubleValue:"Infinity"};if(e===-1/0)return{doubleValue:"-Infinity"}}return{doubleValue:Df(e)?"-0":e}}function ab(n){return{integerValue:""+n}}function vL(n,e){return qM(e)?ab(e):Z_(n,e)}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Dp{constructor(){this._=void 0}}function wL(n,e,t){return n instanceof Wu?(function(s,o){const l={fields:{[$I]:{stringValue:BI},[HI]:{timestampValue:{seconds:s.seconds,nanos:s.nanoseconds}}}};return o&&Q_(o)&&(o=Ap(o)),o&&(l.fields[WI]=o),{mapValue:l}})(t,e):n instanceof Hu?cb(n,e):n instanceof qu?ub(n,e):(function(s,o){const l=lb(s,o),u=wT(l)+wT(s.Ae);return $y(l)&&$y(s.Ae)?ab(u):Z_(s.serializer,u)})(n,e)}function EL(n,e,t){return n instanceof Hu?cb(n,e):n instanceof qu?ub(n,e):t}function lb(n,e){return n instanceof Vf?(function(r){return $y(r)||(function(o){return!!o&&"doubleValue"in o})(r)})(e)?e:{integerValue:0}:null}class Wu extends Dp{}class Hu extends Dp{constructor(e){super(),this.elements=e}}function cb(n,e){const t=db(e);for(const r of n.elements)t.some((s=>gs(s,r)))||t.push(r);return{arrayValue:{values:t}}}class qu extends Dp{constructor(e){super(),this.elements=e}}function ub(n,e){let t=db(e);for(const r of n.elements)t=t.filter((s=>!gs(s,r)));return{arrayValue:{values:t}}}class Vf extends Dp{constructor(e,t){super(),this.serializer=e,this.Ae=t}}function wT(n){return Ot(n.integerValue||n.doubleValue)}function db(n){return Y_(n)&&n.arrayValue.values?n.arrayValue.values.slice():[]}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class xL{constructor(e,t){this.field=e,this.transform=t}}function TL(n,e){return n.field.isEqual(e.field)&&(function(r,s){return r instanceof Hu&&s instanceof Hu||r instanceof qu&&s instanceof qu?Fl(r.elements,s.elements,gs):r instanceof Vf&&s instanceof Vf?gs(r.Ae,s.Ae):r instanceof Wu&&s instanceof Wu})(n.transform,e.transform)}class CL{constructor(e,t){this.version=e,this.transformResults=t}}class Dr{constructor(e,t){this.updateTime=e,this.exists=t}static none(){return new Dr}static exists(e){return new Dr(void 0,e)}static updateTime(e){return new Dr(e)}get isNone(){return this.updateTime===void 0&&this.exists===void 0}isEqual(e){return this.exists===e.exists&&(this.updateTime?!!e.updateTime&&this.updateTime.isEqual(e.updateTime):!e.updateTime)}}function pf(n,e){return n.updateTime!==void 0?e.isFoundDocument()&&e.version.isEqual(n.updateTime):n.exists===void 0||n.exists===e.isFoundDocument()}class Op{}function hb(n,e){if(!n.hasLocalMutations||e&&e.fields.length===0)return null;if(e===null)return n.isNoDocument()?new pb(n.key,Dr.none()):new hd(n.key,n.data,Dr.none());{const t=n.data,r=Vn.empty();let s=new Gt(cn.comparator);for(let o of e.fields)if(!s.has(o)){let l=t.field(o);l===null&&o.length>1&&(o=o.popLast(),l=t.field(o)),l===null?r.delete(o):r.set(o,l),s=s.add(o)}return new Co(n.key,r,new Jn(s.toArray()),Dr.none())}}function SL(n,e,t){n instanceof hd?(function(s,o,l){const u=s.value.clone(),h=xT(s.fieldTransforms,o,l.transformResults);u.setAll(h),o.convertToFoundDocument(l.version,u).setHasCommittedMutations()})(n,e,t):n instanceof Co?(function(s,o,l){if(!pf(s.precondition,o))return void o.convertToUnknownDocument(l.version);const u=xT(s.fieldTransforms,o,l.transformResults),h=o.data;h.setAll(fb(s)),h.setAll(u),o.convertToFoundDocument(l.version,h).setHasCommittedMutations()})(n,e,t):(function(s,o,l){o.convertToNoDocument(l.version).setHasCommittedMutations()})(0,e,t)}function bu(n,e,t,r){return n instanceof hd?(function(o,l,u,h){if(!pf(o.precondition,l))return u;const p=o.value.clone(),g=TT(o.fieldTransforms,h,l);return p.setAll(g),l.convertToFoundDocument(l.version,p).setHasLocalMutations(),null})(n,e,t,r):n instanceof Co?(function(o,l,u,h){if(!pf(o.precondition,l))return u;const p=TT(o.fieldTransforms,h,l),g=l.data;return g.setAll(fb(o)),g.setAll(p),l.convertToFoundDocument(l.version,g).setHasLocalMutations(),u===null?null:u.unionWith(o.fieldMask.fields).unionWith(o.fieldTransforms.map((_=>_.field)))})(n,e,t,r):(function(o,l,u){return pf(o.precondition,l)?(l.convertToNoDocument(l.version).setHasLocalMutations(),null):u})(n,e,t)}function IL(n,e){let t=null;for(const r of n.fieldTransforms){const s=e.data.field(r.field),o=lb(r.transform,s||null);o!=null&&(t===null&&(t=Vn.empty()),t.set(r.field,o))}return t||null}function ET(n,e){return n.type===e.type&&!!n.key.isEqual(e.key)&&!!n.precondition.isEqual(e.precondition)&&!!(function(r,s){return r===void 0&&s===void 0||!(!r||!s)&&Fl(r,s,((o,l)=>TL(o,l)))})(n.fieldTransforms,e.fieldTransforms)&&(n.type===0?n.value.isEqual(e.value):n.type!==1||n.data.isEqual(e.data)&&n.fieldMask.isEqual(e.fieldMask))}class hd extends Op{constructor(e,t,r,s=[]){super(),this.key=e,this.value=t,this.precondition=r,this.fieldTransforms=s,this.type=0}getFieldMask(){return null}}class Co extends Op{constructor(e,t,r,s,o=[]){super(),this.key=e,this.data=t,this.fieldMask=r,this.precondition=s,this.fieldTransforms=o,this.type=1}getFieldMask(){return this.fieldMask}}function fb(n){const e=new Map;return n.fieldMask.fields.forEach((t=>{if(!t.isEmpty()){const r=n.data.field(t);e.set(t,r)}})),e}function xT(n,e,t){const r=new Map;lt(n.length===t.length,32656,{Re:t.length,Ve:n.length});for(let s=0;s<t.length;s++){const o=n[s],l=o.transform,u=e.data.field(o.field);r.set(o.field,EL(l,u,t[s]))}return r}function TT(n,e,t){const r=new Map;for(const s of n){const o=s.transform,l=t.data.field(s.field);r.set(s.field,wL(o,l,e))}return r}class pb extends Op{constructor(e,t){super(),this.key=e,this.precondition=t,this.type=2,this.fieldTransforms=[]}getFieldMask(){return null}}class bL extends Op{constructor(e,t){super(),this.key=e,this.precondition=t,this.type=3,this.fieldTransforms=[]}getFieldMask(){return null}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class RL{constructor(e,t,r,s){this.batchId=e,this.localWriteTime=t,this.baseMutations=r,this.mutations=s}applyToRemoteDocument(e,t){const r=t.mutationResults;for(let s=0;s<this.mutations.length;s++){const o=this.mutations[s];o.key.isEqual(e.key)&&SL(o,e,r[s])}}applyToLocalView(e,t){for(const r of this.baseMutations)r.key.isEqual(e.key)&&(t=bu(r,e,t,this.localWriteTime));for(const r of this.mutations)r.key.isEqual(e.key)&&(t=bu(r,e,t,this.localWriteTime));return t}applyToLocalDocumentSet(e,t){const r=ob();return this.mutations.forEach((s=>{const o=e.get(s.key),l=o.overlayedDocument;let u=this.applyToLocalView(l,o.mutatedFields);u=t.has(s.key)?null:u;const h=hb(l,u);h!==null&&r.set(s.key,h),l.isValidDocument()||l.convertToNoDocument(Ue.min())})),r}keys(){return this.mutations.reduce(((e,t)=>e.add(t.key)),Je())}isEqual(e){return this.batchId===e.batchId&&Fl(this.mutations,e.mutations,((t,r)=>ET(t,r)))&&Fl(this.baseMutations,e.baseMutations,((t,r)=>ET(t,r)))}}class ev{constructor(e,t,r,s){this.batch=e,this.commitVersion=t,this.mutationResults=r,this.docVersions=s}static from(e,t,r){lt(e.mutations.length===r.length,58842,{me:e.mutations.length,fe:r.length});let s=(function(){return mL})();const o=e.mutations;for(let l=0;l<o.length;l++)s=s.insert(o[l].key,r[l].version);return new ev(e,t,r,s)}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let AL=class{constructor(e,t){this.largestBatchId=e,this.mutation=t}getKey(){return this.mutation.key}isEqual(e){return e!==null&&this.mutation===e.mutation}toString(){return`Overlay{
      largestBatchId: ${this.largestBatchId},
      mutation: ${this.mutation.toString()}
    }`}};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class kL{constructor(e,t){this.count=e,this.unchangedNames=t}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var Ft,et;function NL(n){switch(n){case ee.OK:return Oe(64938);case ee.CANCELLED:case ee.UNKNOWN:case ee.DEADLINE_EXCEEDED:case ee.RESOURCE_EXHAUSTED:case ee.INTERNAL:case ee.UNAVAILABLE:case ee.UNAUTHENTICATED:return!1;case ee.INVALID_ARGUMENT:case ee.NOT_FOUND:case ee.ALREADY_EXISTS:case ee.PERMISSION_DENIED:case ee.FAILED_PRECONDITION:case ee.ABORTED:case ee.OUT_OF_RANGE:case ee.UNIMPLEMENTED:case ee.DATA_LOSS:return!0;default:return Oe(15467,{code:n})}}function mb(n){if(n===void 0)return ti("GRPC error has no .code"),ee.UNKNOWN;switch(n){case Ft.OK:return ee.OK;case Ft.CANCELLED:return ee.CANCELLED;case Ft.UNKNOWN:return ee.UNKNOWN;case Ft.DEADLINE_EXCEEDED:return ee.DEADLINE_EXCEEDED;case Ft.RESOURCE_EXHAUSTED:return ee.RESOURCE_EXHAUSTED;case Ft.INTERNAL:return ee.INTERNAL;case Ft.UNAVAILABLE:return ee.UNAVAILABLE;case Ft.UNAUTHENTICATED:return ee.UNAUTHENTICATED;case Ft.INVALID_ARGUMENT:return ee.INVALID_ARGUMENT;case Ft.NOT_FOUND:return ee.NOT_FOUND;case Ft.ALREADY_EXISTS:return ee.ALREADY_EXISTS;case Ft.PERMISSION_DENIED:return ee.PERMISSION_DENIED;case Ft.FAILED_PRECONDITION:return ee.FAILED_PRECONDITION;case Ft.ABORTED:return ee.ABORTED;case Ft.OUT_OF_RANGE:return ee.OUT_OF_RANGE;case Ft.UNIMPLEMENTED:return ee.UNIMPLEMENTED;case Ft.DATA_LOSS:return ee.DATA_LOSS;default:return Oe(39323,{code:n})}}(et=Ft||(Ft={}))[et.OK=0]="OK",et[et.CANCELLED=1]="CANCELLED",et[et.UNKNOWN=2]="UNKNOWN",et[et.INVALID_ARGUMENT=3]="INVALID_ARGUMENT",et[et.DEADLINE_EXCEEDED=4]="DEADLINE_EXCEEDED",et[et.NOT_FOUND=5]="NOT_FOUND",et[et.ALREADY_EXISTS=6]="ALREADY_EXISTS",et[et.PERMISSION_DENIED=7]="PERMISSION_DENIED",et[et.UNAUTHENTICATED=16]="UNAUTHENTICATED",et[et.RESOURCE_EXHAUSTED=8]="RESOURCE_EXHAUSTED",et[et.FAILED_PRECONDITION=9]="FAILED_PRECONDITION",et[et.ABORTED=10]="ABORTED",et[et.OUT_OF_RANGE=11]="OUT_OF_RANGE",et[et.UNIMPLEMENTED=12]="UNIMPLEMENTED",et[et.INTERNAL=13]="INTERNAL",et[et.UNAVAILABLE=14]="UNAVAILABLE",et[et.DATA_LOSS=15]="DATA_LOSS";/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function PL(){return new TextEncoder}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const DL=new Zi([4294967295,4294967295],0);function CT(n){const e=PL().encode(n),t=new AI;return t.update(e),new Uint8Array(t.digest())}function ST(n){const e=new DataView(n.buffer),t=e.getUint32(0,!0),r=e.getUint32(4,!0),s=e.getUint32(8,!0),o=e.getUint32(12,!0);return[new Zi([t,r],0),new Zi([s,o],0)]}class tv{constructor(e,t,r){if(this.bitmap=e,this.padding=t,this.hashCount=r,t<0||t>=8)throw new _u(`Invalid padding: ${t}`);if(r<0)throw new _u(`Invalid hash count: ${r}`);if(e.length>0&&this.hashCount===0)throw new _u(`Invalid hash count: ${r}`);if(e.length===0&&t!==0)throw new _u(`Invalid padding when bitmap length is 0: ${t}`);this.ge=8*e.length-t,this.pe=Zi.fromNumber(this.ge)}ye(e,t,r){let s=e.add(t.multiply(Zi.fromNumber(r)));return s.compare(DL)===1&&(s=new Zi([s.getBits(0),s.getBits(1)],0)),s.modulo(this.pe).toNumber()}we(e){return!!(this.bitmap[Math.floor(e/8)]&1<<e%8)}mightContain(e){if(this.ge===0)return!1;const t=CT(e),[r,s]=ST(t);for(let o=0;o<this.hashCount;o++){const l=this.ye(r,s,o);if(!this.we(l))return!1}return!0}static create(e,t,r){const s=e%8==0?0:8-e%8,o=new Uint8Array(Math.ceil(e/8)),l=new tv(o,s,t);return r.forEach((u=>l.insert(u))),l}insert(e){if(this.ge===0)return;const t=CT(e),[r,s]=ST(t);for(let o=0;o<this.hashCount;o++){const l=this.ye(r,s,o);this.Se(l)}}Se(e){const t=Math.floor(e/8),r=e%8;this.bitmap[t]|=1<<r}}class _u extends Error{constructor(){super(...arguments),this.name="BloomFilterError"}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Mp{constructor(e,t,r,s,o){this.snapshotVersion=e,this.targetChanges=t,this.targetMismatches=r,this.documentUpdates=s,this.resolvedLimboDocuments=o}static createSynthesizedRemoteEventForCurrentChange(e,t,r){const s=new Map;return s.set(e,fd.createSynthesizedTargetChangeForCurrentChange(e,t,r)),new Mp(Ue.min(),s,new $t(Xe),ni(),Je())}}class fd{constructor(e,t,r,s,o){this.resumeToken=e,this.current=t,this.addedDocuments=r,this.modifiedDocuments=s,this.removedDocuments=o}static createSynthesizedTargetChangeForCurrentChange(e,t,r){return new fd(r,t,Je(),Je(),Je())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class mf{constructor(e,t,r,s){this.be=e,this.removedTargetIds=t,this.key=r,this.De=s}}class gb{constructor(e,t){this.targetId=e,this.Ce=t}}class yb{constructor(e,t,r=dn.EMPTY_BYTE_STRING,s=null){this.state=e,this.targetIds=t,this.resumeToken=r,this.cause=s}}class IT{constructor(){this.ve=0,this.Fe=bT(),this.Me=dn.EMPTY_BYTE_STRING,this.xe=!1,this.Oe=!0}get current(){return this.xe}get resumeToken(){return this.Me}get Ne(){return this.ve!==0}get Be(){return this.Oe}Le(e){e.approximateByteSize()>0&&(this.Oe=!0,this.Me=e)}ke(){let e=Je(),t=Je(),r=Je();return this.Fe.forEach(((s,o)=>{switch(o){case 0:e=e.add(s);break;case 2:t=t.add(s);break;case 1:r=r.add(s);break;default:Oe(38017,{changeType:o})}})),new fd(this.Me,this.xe,e,t,r)}qe(){this.Oe=!1,this.Fe=bT()}Qe(e,t){this.Oe=!0,this.Fe=this.Fe.insert(e,t)}$e(e){this.Oe=!0,this.Fe=this.Fe.remove(e)}Ue(){this.ve+=1}Ke(){this.ve-=1,lt(this.ve>=0,3241,{ve:this.ve})}We(){this.Oe=!0,this.xe=!0}}class OL{constructor(e){this.Ge=e,this.ze=new Map,this.je=ni(),this.Je=qh(),this.He=qh(),this.Ye=new $t(Xe)}Ze(e){for(const t of e.be)e.De&&e.De.isFoundDocument()?this.Xe(t,e.De):this.et(t,e.key,e.De);for(const t of e.removedTargetIds)this.et(t,e.key,e.De)}tt(e){this.forEachTarget(e,(t=>{const r=this.nt(t);switch(e.state){case 0:this.rt(t)&&r.Le(e.resumeToken);break;case 1:r.Ke(),r.Ne||r.qe(),r.Le(e.resumeToken);break;case 2:r.Ke(),r.Ne||this.removeTarget(t);break;case 3:this.rt(t)&&(r.We(),r.Le(e.resumeToken));break;case 4:this.rt(t)&&(this.it(t),r.Le(e.resumeToken));break;default:Oe(56790,{state:e.state})}}))}forEachTarget(e,t){e.targetIds.length>0?e.targetIds.forEach(t):this.ze.forEach(((r,s)=>{this.rt(s)&&t(s)}))}st(e){const t=e.targetId,r=e.Ce.count,s=this.ot(t);if(s){const o=s.target;if(Hy(o))if(r===0){const l=new be(o.path);this.et(t,l,wn.newNoDocument(l,Ue.min()))}else lt(r===1,20013,{expectedCount:r});else{const l=this._t(t);if(l!==r){const u=this.ut(e),h=u?this.ct(u,e,l):1;if(h!==0){this.it(t);const p=h===2?"TargetPurposeExistenceFilterMismatchBloom":"TargetPurposeExistenceFilterMismatch";this.Ye=this.Ye.insert(t,p)}}}}}ut(e){const t=e.Ce.unchangedNames;if(!t||!t.bits)return null;const{bits:{bitmap:r="",padding:s=0},hashCount:o=0}=t;let l,u;try{l=co(r).toUint8Array()}catch(h){if(h instanceof zI)return Vl("Decoding the base64 bloom filter in existence filter failed ("+h.message+"); ignoring the bloom filter and falling back to full re-query."),null;throw h}try{u=new tv(l,s,o)}catch(h){return Vl(h instanceof _u?"BloomFilter error: ":"Applying bloom filter failed: ",h),null}return u.ge===0?null:u}ct(e,t,r){return t.Ce.count===r-this.Pt(e,t.targetId)?0:2}Pt(e,t){const r=this.Ge.getRemoteKeysForTarget(t);let s=0;return r.forEach((o=>{const l=this.Ge.ht(),u=`projects/${l.projectId}/databases/${l.database}/documents/${o.path.canonicalString()}`;e.mightContain(u)||(this.et(t,o,null),s++)})),s}Tt(e){const t=new Map;this.ze.forEach(((o,l)=>{const u=this.ot(l);if(u){if(o.current&&Hy(u.target)){const h=new be(u.target.path);this.It(h).has(l)||this.Et(l,h)||this.et(l,h,wn.newNoDocument(h,e))}o.Be&&(t.set(l,o.ke()),o.qe())}}));let r=Je();this.He.forEach(((o,l)=>{let u=!0;l.forEachWhile((h=>{const p=this.ot(h);return!p||p.purpose==="TargetPurposeLimboResolution"||(u=!1,!1)})),u&&(r=r.add(o))})),this.je.forEach(((o,l)=>l.setReadTime(e)));const s=new Mp(e,t,this.Ye,this.je,r);return this.je=ni(),this.Je=qh(),this.He=qh(),this.Ye=new $t(Xe),s}Xe(e,t){if(!this.rt(e))return;const r=this.Et(e,t.key)?2:0;this.nt(e).Qe(t.key,r),this.je=this.je.insert(t.key,t),this.Je=this.Je.insert(t.key,this.It(t.key).add(e)),this.He=this.He.insert(t.key,this.dt(t.key).add(e))}et(e,t,r){if(!this.rt(e))return;const s=this.nt(e);this.Et(e,t)?s.Qe(t,1):s.$e(t),this.He=this.He.insert(t,this.dt(t).delete(e)),this.He=this.He.insert(t,this.dt(t).add(e)),r&&(this.je=this.je.insert(t,r))}removeTarget(e){this.ze.delete(e)}_t(e){const t=this.nt(e).ke();return this.Ge.getRemoteKeysForTarget(e).size+t.addedDocuments.size-t.removedDocuments.size}Ue(e){this.nt(e).Ue()}nt(e){let t=this.ze.get(e);return t||(t=new IT,this.ze.set(e,t)),t}dt(e){let t=this.He.get(e);return t||(t=new Gt(Xe),this.He=this.He.insert(e,t)),t}It(e){let t=this.Je.get(e);return t||(t=new Gt(Xe),this.Je=this.Je.insert(e,t)),t}rt(e){const t=this.ot(e)!==null;return t||pe("WatchChangeAggregator","Detected inactive target",e),t}ot(e){const t=this.ze.get(e);return t&&t.Ne?null:this.Ge.At(e)}it(e){this.ze.set(e,new IT),this.Ge.getRemoteKeysForTarget(e).forEach((t=>{this.et(e,t,null)}))}Et(e,t){return this.Ge.getRemoteKeysForTarget(e).has(t)}}function qh(){return new $t(be.comparator)}function bT(){return new $t(be.comparator)}const ML={asc:"ASCENDING",desc:"DESCENDING"},LL={"<":"LESS_THAN","<=":"LESS_THAN_OR_EQUAL",">":"GREATER_THAN",">=":"GREATER_THAN_OR_EQUAL","==":"EQUAL","!=":"NOT_EQUAL","array-contains":"ARRAY_CONTAINS",in:"IN","not-in":"NOT_IN","array-contains-any":"ARRAY_CONTAINS_ANY"},jL={and:"AND",or:"OR"};class VL{constructor(e,t){this.databaseId=e,this.useProto3Json=t}}function Gy(n,e){return n.useProto3Json||Rp(e)?e:{value:e}}function Ff(n,e){return n.useProto3Json?`${new Date(1e3*e.seconds).toISOString().replace(/\.\d*/,"").replace("Z","")}.${("000000000"+e.nanoseconds).slice(-9)}Z`:{seconds:""+e.seconds,nanos:e.nanoseconds}}function _b(n,e){return n.useProto3Json?e.toBase64():e.toUint8Array()}function FL(n,e){return Ff(n,e.toTimestamp())}function hs(n){return lt(!!n,49232),Ue.fromTimestamp((function(t){const r=lo(t);return new wt(r.seconds,r.nanos)})(n))}function nv(n,e){return Ky(n,e).canonicalString()}function Ky(n,e){const t=(function(s){return new mt(["projects",s.projectId,"databases",s.database])})(n).child("documents");return e===void 0?t:t.child(e)}function vb(n){const e=mt.fromString(n);return lt(Cb(e),10190,{key:e.toString()}),e}function Qy(n,e){return nv(n.databaseId,e.path)}function ry(n,e){const t=vb(e);if(t.get(1)!==n.databaseId.projectId)throw new de(ee.INVALID_ARGUMENT,"Tried to deserialize key from different project: "+t.get(1)+" vs "+n.databaseId.projectId);if(t.get(3)!==n.databaseId.database)throw new de(ee.INVALID_ARGUMENT,"Tried to deserialize key from different database: "+t.get(3)+" vs "+n.databaseId.database);return new be(Eb(t))}function wb(n,e){return nv(n.databaseId,e)}function UL(n){const e=vb(n);return e.length===4?mt.emptyPath():Eb(e)}function Yy(n){return new mt(["projects",n.databaseId.projectId,"databases",n.databaseId.database]).canonicalString()}function Eb(n){return lt(n.length>4&&n.get(4)==="documents",29091,{key:n.toString()}),n.popFirst(5)}function RT(n,e,t){return{name:Qy(n,e),fields:t.value.mapValue.fields}}function zL(n,e){let t;if("targetChange"in e){e.targetChange;const r=(function(p){return p==="NO_CHANGE"?0:p==="ADD"?1:p==="REMOVE"?2:p==="CURRENT"?3:p==="RESET"?4:Oe(39313,{state:p})})(e.targetChange.targetChangeType||"NO_CHANGE"),s=e.targetChange.targetIds||[],o=(function(p,g){return p.useProto3Json?(lt(g===void 0||typeof g=="string",58123),dn.fromBase64String(g||"")):(lt(g===void 0||g instanceof Buffer||g instanceof Uint8Array,16193),dn.fromUint8Array(g||new Uint8Array))})(n,e.targetChange.resumeToken),l=e.targetChange.cause,u=l&&(function(p){const g=p.code===void 0?ee.UNKNOWN:mb(p.code);return new de(g,p.message||"")})(l);t=new yb(r,s,o,u||null)}else if("documentChange"in e){e.documentChange;const r=e.documentChange;r.document,r.document.name,r.document.updateTime;const s=ry(n,r.document.name),o=hs(r.document.updateTime),l=r.document.createTime?hs(r.document.createTime):Ue.min(),u=new Vn({mapValue:{fields:r.document.fields}}),h=wn.newFoundDocument(s,o,l,u),p=r.targetIds||[],g=r.removedTargetIds||[];t=new mf(p,g,h.key,h)}else if("documentDelete"in e){e.documentDelete;const r=e.documentDelete;r.document;const s=ry(n,r.document),o=r.readTime?hs(r.readTime):Ue.min(),l=wn.newNoDocument(s,o),u=r.removedTargetIds||[];t=new mf([],u,l.key,l)}else if("documentRemove"in e){e.documentRemove;const r=e.documentRemove;r.document;const s=ry(n,r.document),o=r.removedTargetIds||[];t=new mf([],o,s,null)}else{if(!("filter"in e))return Oe(11601,{Rt:e});{e.filter;const r=e.filter;r.targetId;const{count:s=0,unchangedNames:o}=r,l=new kL(s,o),u=r.targetId;t=new gb(u,l)}}return t}function BL(n,e){let t;if(e instanceof hd)t={update:RT(n,e.key,e.value)};else if(e instanceof pb)t={delete:Qy(n,e.key)};else if(e instanceof Co)t={update:RT(n,e.key,e.data),updateMask:XL(e.fieldMask)};else{if(!(e instanceof bL))return Oe(16599,{Vt:e.type});t={verify:Qy(n,e.key)}}return e.fieldTransforms.length>0&&(t.updateTransforms=e.fieldTransforms.map((r=>(function(o,l){const u=l.transform;if(u instanceof Wu)return{fieldPath:l.field.canonicalString(),setToServerValue:"REQUEST_TIME"};if(u instanceof Hu)return{fieldPath:l.field.canonicalString(),appendMissingElements:{values:u.elements}};if(u instanceof qu)return{fieldPath:l.field.canonicalString(),removeAllFromArray:{values:u.elements}};if(u instanceof Vf)return{fieldPath:l.field.canonicalString(),increment:u.Ae};throw Oe(20930,{transform:l.transform})})(0,r)))),e.precondition.isNone||(t.currentDocument=(function(s,o){return o.updateTime!==void 0?{updateTime:FL(s,o.updateTime)}:o.exists!==void 0?{exists:o.exists}:Oe(27497)})(n,e.precondition)),t}function $L(n,e){return n&&n.length>0?(lt(e!==void 0,14353),n.map((t=>(function(s,o){let l=s.updateTime?hs(s.updateTime):hs(o);return l.isEqual(Ue.min())&&(l=hs(o)),new CL(l,s.transformResults||[])})(t,e)))):[]}function WL(n,e){return{documents:[wb(n,e.path)]}}function HL(n,e){const t={structuredQuery:{}},r=e.path;let s;e.collectionGroup!==null?(s=r,t.structuredQuery.from=[{collectionId:e.collectionGroup,allDescendants:!0}]):(s=r.popLast(),t.structuredQuery.from=[{collectionId:r.lastSegment()}]),t.parent=wb(n,s);const o=(function(p){if(p.length!==0)return Tb(Lr.create(p,"and"))})(e.filters);o&&(t.structuredQuery.where=o);const l=(function(p){if(p.length!==0)return p.map((g=>(function(v){return{field:xl(v.field),direction:KL(v.dir)}})(g)))})(e.orderBy);l&&(t.structuredQuery.orderBy=l);const u=Gy(n,e.limit);return u!==null&&(t.structuredQuery.limit=u),e.startAt&&(t.structuredQuery.startAt=(function(p){return{before:p.inclusive,values:p.position}})(e.startAt)),e.endAt&&(t.structuredQuery.endAt=(function(p){return{before:!p.inclusive,values:p.position}})(e.endAt)),{ft:t,parent:s}}function qL(n){let e=UL(n.parent);const t=n.structuredQuery,r=t.from?t.from.length:0;let s=null;if(r>0){lt(r===1,65062);const g=t.from[0];g.allDescendants?s=g.collectionId:e=e.child(g.collectionId)}let o=[];t.where&&(o=(function(_){const v=xb(_);return v instanceof Lr&&XI(v)?v.getFilters():[v]})(t.where));let l=[];t.orderBy&&(l=(function(_){return _.map((v=>(function(A){return new $u(Tl(A.field),(function(b){switch(b){case"ASCENDING":return"asc";case"DESCENDING":return"desc";default:return}})(A.direction))})(v)))})(t.orderBy));let u=null;t.limit&&(u=(function(_){let v;return v=typeof _=="object"?_.value:_,Rp(v)?null:v})(t.limit));let h=null;t.startAt&&(h=(function(_){const v=!!_.before,T=_.values||[];return new Lf(T,v)})(t.startAt));let p=null;return t.endAt&&(p=(function(_){const v=!_.before,T=_.values||[];return new Lf(T,v)})(t.endAt)),uL(e,s,l,o,u,"F",h,p)}function GL(n,e){const t=(function(s){switch(s){case"TargetPurposeListen":return null;case"TargetPurposeExistenceFilterMismatch":return"existence-filter-mismatch";case"TargetPurposeExistenceFilterMismatchBloom":return"existence-filter-mismatch-bloom";case"TargetPurposeLimboResolution":return"limbo-document";default:return Oe(28987,{purpose:s})}})(e.purpose);return t==null?null:{"goog-listen-tags":t}}function xb(n){return n.unaryFilter!==void 0?(function(t){switch(t.unaryFilter.op){case"IS_NAN":const r=Tl(t.unaryFilter.field);return zt.create(r,"==",{doubleValue:NaN});case"IS_NULL":const s=Tl(t.unaryFilter.field);return zt.create(s,"==",{nullValue:"NULL_VALUE"});case"IS_NOT_NAN":const o=Tl(t.unaryFilter.field);return zt.create(o,"!=",{doubleValue:NaN});case"IS_NOT_NULL":const l=Tl(t.unaryFilter.field);return zt.create(l,"!=",{nullValue:"NULL_VALUE"});case"OPERATOR_UNSPECIFIED":return Oe(61313);default:return Oe(60726)}})(n):n.fieldFilter!==void 0?(function(t){return zt.create(Tl(t.fieldFilter.field),(function(s){switch(s){case"EQUAL":return"==";case"NOT_EQUAL":return"!=";case"GREATER_THAN":return">";case"GREATER_THAN_OR_EQUAL":return">=";case"LESS_THAN":return"<";case"LESS_THAN_OR_EQUAL":return"<=";case"ARRAY_CONTAINS":return"array-contains";case"IN":return"in";case"NOT_IN":return"not-in";case"ARRAY_CONTAINS_ANY":return"array-contains-any";case"OPERATOR_UNSPECIFIED":return Oe(58110);default:return Oe(50506)}})(t.fieldFilter.op),t.fieldFilter.value)})(n):n.compositeFilter!==void 0?(function(t){return Lr.create(t.compositeFilter.filters.map((r=>xb(r))),(function(s){switch(s){case"AND":return"and";case"OR":return"or";default:return Oe(1026)}})(t.compositeFilter.op))})(n):Oe(30097,{filter:n})}function KL(n){return ML[n]}function QL(n){return LL[n]}function YL(n){return jL[n]}function xl(n){return{fieldPath:n.canonicalString()}}function Tl(n){return cn.fromServerFormat(n.fieldPath)}function Tb(n){return n instanceof zt?(function(t){if(t.op==="=="){if(mT(t.value))return{unaryFilter:{field:xl(t.field),op:"IS_NAN"}};if(pT(t.value))return{unaryFilter:{field:xl(t.field),op:"IS_NULL"}}}else if(t.op==="!="){if(mT(t.value))return{unaryFilter:{field:xl(t.field),op:"IS_NOT_NAN"}};if(pT(t.value))return{unaryFilter:{field:xl(t.field),op:"IS_NOT_NULL"}}}return{fieldFilter:{field:xl(t.field),op:QL(t.op),value:t.value}}})(n):n instanceof Lr?(function(t){const r=t.getFilters().map((s=>Tb(s)));return r.length===1?r[0]:{compositeFilter:{op:YL(t.op),filters:r}}})(n):Oe(54877,{filter:n})}function XL(n){const e=[];return n.fields.forEach((t=>e.push(t.canonicalString()))),{fieldPaths:e}}function Cb(n){return n.length>=4&&n.get(0)==="projects"&&n.get(2)==="databases"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Yi{constructor(e,t,r,s,o=Ue.min(),l=Ue.min(),u=dn.EMPTY_BYTE_STRING,h=null){this.target=e,this.targetId=t,this.purpose=r,this.sequenceNumber=s,this.snapshotVersion=o,this.lastLimboFreeSnapshotVersion=l,this.resumeToken=u,this.expectedCount=h}withSequenceNumber(e){return new Yi(this.target,this.targetId,this.purpose,e,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,this.expectedCount)}withResumeToken(e,t){return new Yi(this.target,this.targetId,this.purpose,this.sequenceNumber,t,this.lastLimboFreeSnapshotVersion,e,null)}withExpectedCount(e){return new Yi(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,e)}withLastLimboFreeSnapshotVersion(e){return new Yi(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,e,this.resumeToken,this.expectedCount)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class JL{constructor(e){this.yt=e}}function ZL(n){const e=qL({parent:n.parent,structuredQuery:n.structuredQuery});return n.limitType==="LAST"?jf(e,e.limit,"L"):e}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class e4{constructor(){this.Cn=new t4}addToCollectionParentIndex(e,t){return this.Cn.add(t),te.resolve()}getCollectionParents(e,t){return te.resolve(this.Cn.getEntries(t))}addFieldIndex(e,t){return te.resolve()}deleteFieldIndex(e,t){return te.resolve()}deleteAllFieldIndexes(e){return te.resolve()}createTargetIndexes(e,t){return te.resolve()}getDocumentsMatchingTarget(e,t){return te.resolve(null)}getIndexType(e,t){return te.resolve(0)}getFieldIndexes(e,t){return te.resolve([])}getNextCollectionGroupToUpdate(e){return te.resolve(null)}getMinOffset(e,t){return te.resolve(ao.min())}getMinOffsetFromCollectionGroup(e,t){return te.resolve(ao.min())}updateCollectionGroup(e,t,r){return te.resolve()}updateIndexEntries(e,t){return te.resolve()}}class t4{constructor(){this.index={}}add(e){const t=e.lastSegment(),r=e.popLast(),s=this.index[t]||new Gt(mt.comparator),o=!s.has(r);return this.index[t]=s.add(r),o}has(e){const t=e.lastSegment(),r=e.popLast(),s=this.index[t];return s&&s.has(r)}getEntries(e){return(this.index[e]||new Gt(mt.comparator)).toArray()}}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const AT={didRun:!1,sequenceNumbersCollected:0,targetsRemoved:0,documentsRemoved:0},Sb=41943040;class jn{static withCacheSize(e){return new jn(e,jn.DEFAULT_COLLECTION_PERCENTILE,jn.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT)}constructor(e,t,r){this.cacheSizeCollectionThreshold=e,this.percentileToCollect=t,this.maximumSequenceNumbersToCollect=r}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */jn.DEFAULT_COLLECTION_PERCENTILE=10,jn.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT=1e3,jn.DEFAULT=new jn(Sb,jn.DEFAULT_COLLECTION_PERCENTILE,jn.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT),jn.DISABLED=new jn(-1,0,0);/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Bl{constructor(e){this.ar=e}next(){return this.ar+=2,this.ar}static ur(){return new Bl(0)}static cr(){return new Bl(-1)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const kT="LruGarbageCollector",n4=1048576;function NT([n,e],[t,r]){const s=Xe(n,t);return s===0?Xe(e,r):s}class r4{constructor(e){this.Ir=e,this.buffer=new Gt(NT),this.Er=0}dr(){return++this.Er}Ar(e){const t=[e,this.dr()];if(this.buffer.size<this.Ir)this.buffer=this.buffer.add(t);else{const r=this.buffer.last();NT(t,r)<0&&(this.buffer=this.buffer.delete(r).add(t))}}get maxValue(){return this.buffer.last()[0]}}class s4{constructor(e,t,r){this.garbageCollector=e,this.asyncQueue=t,this.localStore=r,this.Rr=null}start(){this.garbageCollector.params.cacheSizeCollectionThreshold!==-1&&this.Vr(6e4)}stop(){this.Rr&&(this.Rr.cancel(),this.Rr=null)}get started(){return this.Rr!==null}Vr(e){pe(kT,`Garbage collection scheduled in ${e}ms`),this.Rr=this.asyncQueue.enqueueAfterDelay("lru_garbage_collection",e,(async()=>{this.Rr=null;try{await this.localStore.collectGarbage(this.garbageCollector)}catch(t){sc(t)?pe(kT,"Ignoring IndexedDB error during garbage collection: ",t):await rc(t)}await this.Vr(3e5)}))}}class i4{constructor(e,t){this.mr=e,this.params=t}calculateTargetCount(e,t){return this.mr.gr(e).next((r=>Math.floor(t/100*r)))}nthSequenceNumber(e,t){if(t===0)return te.resolve(bp.ce);const r=new r4(t);return this.mr.forEachTarget(e,(s=>r.Ar(s.sequenceNumber))).next((()=>this.mr.pr(e,(s=>r.Ar(s))))).next((()=>r.maxValue))}removeTargets(e,t,r){return this.mr.removeTargets(e,t,r)}removeOrphanedDocuments(e,t){return this.mr.removeOrphanedDocuments(e,t)}collect(e,t){return this.params.cacheSizeCollectionThreshold===-1?(pe("LruGarbageCollector","Garbage collection skipped; disabled"),te.resolve(AT)):this.getCacheSize(e).next((r=>r<this.params.cacheSizeCollectionThreshold?(pe("LruGarbageCollector",`Garbage collection skipped; Cache size ${r} is lower than threshold ${this.params.cacheSizeCollectionThreshold}`),AT):this.yr(e,t)))}getCacheSize(e){return this.mr.getCacheSize(e)}yr(e,t){let r,s,o,l,u,h,p;const g=Date.now();return this.calculateTargetCount(e,this.params.percentileToCollect).next((_=>(_>this.params.maximumSequenceNumbersToCollect?(pe("LruGarbageCollector",`Capping sequence numbers to collect down to the maximum of ${this.params.maximumSequenceNumbersToCollect} from ${_}`),s=this.params.maximumSequenceNumbersToCollect):s=_,l=Date.now(),this.nthSequenceNumber(e,s)))).next((_=>(r=_,u=Date.now(),this.removeTargets(e,r,t)))).next((_=>(o=_,h=Date.now(),this.removeOrphanedDocuments(e,r)))).next((_=>(p=Date.now(),wl()<=Qe.DEBUG&&pe("LruGarbageCollector",`LRU Garbage Collection
	Counted targets in ${l-g}ms
	Determined least recently used ${s} in `+(u-l)+`ms
	Removed ${o} targets in `+(h-u)+`ms
	Removed ${_} documents in `+(p-h)+`ms
Total Duration: ${p-g}ms`),te.resolve({didRun:!0,sequenceNumbersCollected:s,targetsRemoved:o,documentsRemoved:_}))))}}function o4(n,e){return new i4(n,e)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class a4{constructor(){this.changes=new _a((e=>e.toString()),((e,t)=>e.isEqual(t))),this.changesApplied=!1}addEntry(e){this.assertNotApplied(),this.changes.set(e.key,e)}removeEntry(e,t){this.assertNotApplied(),this.changes.set(e,wn.newInvalidDocument(e).setReadTime(t))}getEntry(e,t){this.assertNotApplied();const r=this.changes.get(t);return r!==void 0?te.resolve(r):this.getFromCache(e,t)}getEntries(e,t){return this.getAllFromCache(e,t)}apply(e){return this.assertNotApplied(),this.changesApplied=!0,this.applyChanges(e)}assertNotApplied(){}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class l4{constructor(e,t){this.overlayedDocument=e,this.mutatedFields=t}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class c4{constructor(e,t,r,s){this.remoteDocumentCache=e,this.mutationQueue=t,this.documentOverlayCache=r,this.indexManager=s}getDocument(e,t){let r=null;return this.documentOverlayCache.getOverlay(e,t).next((s=>(r=s,this.remoteDocumentCache.getEntry(e,t)))).next((s=>(r!==null&&bu(r.mutation,s,Jn.empty(),wt.now()),s)))}getDocuments(e,t){return this.remoteDocumentCache.getEntries(e,t).next((r=>this.getLocalViewOfDocuments(e,r,Je()).next((()=>r))))}getLocalViewOfDocuments(e,t,r=Je()){const s=ta();return this.populateOverlays(e,s,t).next((()=>this.computeViews(e,t,s,r).next((o=>{let l=yu();return o.forEach(((u,h)=>{l=l.insert(u,h.overlayedDocument)})),l}))))}getOverlayedDocuments(e,t){const r=ta();return this.populateOverlays(e,r,t).next((()=>this.computeViews(e,t,r,Je())))}populateOverlays(e,t,r){const s=[];return r.forEach((o=>{t.has(o)||s.push(o)})),this.documentOverlayCache.getOverlays(e,s).next((o=>{o.forEach(((l,u)=>{t.set(l,u)}))}))}computeViews(e,t,r,s){let o=ni();const l=Iu(),u=(function(){return Iu()})();return t.forEach(((h,p)=>{const g=r.get(p.key);s.has(p.key)&&(g===void 0||g.mutation instanceof Co)?o=o.insert(p.key,p):g!==void 0?(l.set(p.key,g.mutation.getFieldMask()),bu(g.mutation,p,g.mutation.getFieldMask(),wt.now())):l.set(p.key,Jn.empty())})),this.recalculateAndSaveOverlays(e,o).next((h=>(h.forEach(((p,g)=>l.set(p,g))),t.forEach(((p,g)=>u.set(p,new l4(g,l.get(p)??null)))),u)))}recalculateAndSaveOverlays(e,t){const r=Iu();let s=new $t(((l,u)=>l-u)),o=Je();return this.mutationQueue.getAllMutationBatchesAffectingDocumentKeys(e,t).next((l=>{for(const u of l)u.keys().forEach((h=>{const p=t.get(h);if(p===null)return;let g=r.get(h)||Jn.empty();g=u.applyToLocalView(p,g),r.set(h,g);const _=(s.get(u.batchId)||Je()).add(h);s=s.insert(u.batchId,_)}))})).next((()=>{const l=[],u=s.getReverseIterator();for(;u.hasNext();){const h=u.getNext(),p=h.key,g=h.value,_=ob();g.forEach((v=>{if(!o.has(v)){const T=hb(t.get(v),r.get(v));T!==null&&_.set(v,T),o=o.add(v)}})),l.push(this.documentOverlayCache.saveOverlays(e,p,_))}return te.waitFor(l)})).next((()=>r))}recalculateAndSaveOverlaysForDocumentKeys(e,t){return this.remoteDocumentCache.getEntries(e,t).next((r=>this.recalculateAndSaveOverlays(e,r)))}getDocumentsMatchingQuery(e,t,r,s){return(function(l){return be.isDocumentKey(l.path)&&l.collectionGroup===null&&l.filters.length===0})(t)?this.getDocumentsMatchingDocumentQuery(e,t.path):tb(t)?this.getDocumentsMatchingCollectionGroupQuery(e,t,r,s):this.getDocumentsMatchingCollectionQuery(e,t,r,s)}getNextDocuments(e,t,r,s){return this.remoteDocumentCache.getAllFromCollectionGroup(e,t,r,s).next((o=>{const l=s-o.size>0?this.documentOverlayCache.getOverlaysForCollectionGroup(e,t,r.largestBatchId,s-o.size):te.resolve(ta());let u=Fu,h=o;return l.next((p=>te.forEach(p,((g,_)=>(u<_.largestBatchId&&(u=_.largestBatchId),o.get(g)?te.resolve():this.remoteDocumentCache.getEntry(e,g).next((v=>{h=h.insert(g,v)}))))).next((()=>this.populateOverlays(e,p,o))).next((()=>this.computeViews(e,h,p,Je()))).next((g=>({batchId:u,changes:ib(g)})))))}))}getDocumentsMatchingDocumentQuery(e,t){return this.getDocument(e,new be(t)).next((r=>{let s=yu();return r.isFoundDocument()&&(s=s.insert(r.key,r)),s}))}getDocumentsMatchingCollectionGroupQuery(e,t,r,s){const o=t.collectionGroup;let l=yu();return this.indexManager.getCollectionParents(e,o).next((u=>te.forEach(u,(h=>{const p=(function(_,v){return new ic(v,null,_.explicitOrderBy.slice(),_.filters.slice(),_.limit,_.limitType,_.startAt,_.endAt)})(t,h.child(o));return this.getDocumentsMatchingCollectionQuery(e,p,r,s).next((g=>{g.forEach(((_,v)=>{l=l.insert(_,v)}))}))})).next((()=>l))))}getDocumentsMatchingCollectionQuery(e,t,r,s){let o;return this.documentOverlayCache.getOverlaysForCollection(e,t.path,r.largestBatchId).next((l=>(o=l,this.remoteDocumentCache.getDocumentsMatchingQuery(e,t,r,o,s)))).next((l=>{o.forEach(((h,p)=>{const g=p.getKey();l.get(g)===null&&(l=l.insert(g,wn.newInvalidDocument(g)))}));let u=yu();return l.forEach(((h,p)=>{const g=o.get(h);g!==void 0&&bu(g.mutation,p,Jn.empty(),wt.now()),Pp(t,p)&&(u=u.insert(h,p))})),u}))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class u4{constructor(e){this.serializer=e,this.Lr=new Map,this.kr=new Map}getBundleMetadata(e,t){return te.resolve(this.Lr.get(t))}saveBundleMetadata(e,t){return this.Lr.set(t.id,(function(s){return{id:s.id,version:s.version,createTime:hs(s.createTime)}})(t)),te.resolve()}getNamedQuery(e,t){return te.resolve(this.kr.get(t))}saveNamedQuery(e,t){return this.kr.set(t.name,(function(s){return{name:s.name,query:ZL(s.bundledQuery),readTime:hs(s.readTime)}})(t)),te.resolve()}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class d4{constructor(){this.overlays=new $t(be.comparator),this.qr=new Map}getOverlay(e,t){return te.resolve(this.overlays.get(t))}getOverlays(e,t){const r=ta();return te.forEach(t,(s=>this.getOverlay(e,s).next((o=>{o!==null&&r.set(s,o)})))).next((()=>r))}saveOverlays(e,t,r){return r.forEach(((s,o)=>{this.St(e,t,o)})),te.resolve()}removeOverlaysForBatchId(e,t,r){const s=this.qr.get(r);return s!==void 0&&(s.forEach((o=>this.overlays=this.overlays.remove(o))),this.qr.delete(r)),te.resolve()}getOverlaysForCollection(e,t,r){const s=ta(),o=t.length+1,l=new be(t.child("")),u=this.overlays.getIteratorFrom(l);for(;u.hasNext();){const h=u.getNext().value,p=h.getKey();if(!t.isPrefixOf(p.path))break;p.path.length===o&&h.largestBatchId>r&&s.set(h.getKey(),h)}return te.resolve(s)}getOverlaysForCollectionGroup(e,t,r,s){let o=new $t(((p,g)=>p-g));const l=this.overlays.getIterator();for(;l.hasNext();){const p=l.getNext().value;if(p.getKey().getCollectionGroup()===t&&p.largestBatchId>r){let g=o.get(p.largestBatchId);g===null&&(g=ta(),o=o.insert(p.largestBatchId,g)),g.set(p.getKey(),p)}}const u=ta(),h=o.getIterator();for(;h.hasNext()&&(h.getNext().value.forEach(((p,g)=>u.set(p,g))),!(u.size()>=s)););return te.resolve(u)}St(e,t,r){const s=this.overlays.get(r.key);if(s!==null){const l=this.qr.get(s.largestBatchId).delete(r.key);this.qr.set(s.largestBatchId,l)}this.overlays=this.overlays.insert(r.key,new AL(t,r));let o=this.qr.get(t);o===void 0&&(o=Je(),this.qr.set(t,o)),this.qr.set(t,o.add(r.key))}}/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class h4{constructor(){this.sessionToken=dn.EMPTY_BYTE_STRING}getSessionToken(e){return te.resolve(this.sessionToken)}setSessionToken(e,t){return this.sessionToken=t,te.resolve()}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class rv{constructor(){this.Qr=new Gt(Jt.$r),this.Ur=new Gt(Jt.Kr)}isEmpty(){return this.Qr.isEmpty()}addReference(e,t){const r=new Jt(e,t);this.Qr=this.Qr.add(r),this.Ur=this.Ur.add(r)}Wr(e,t){e.forEach((r=>this.addReference(r,t)))}removeReference(e,t){this.Gr(new Jt(e,t))}zr(e,t){e.forEach((r=>this.removeReference(r,t)))}jr(e){const t=new be(new mt([])),r=new Jt(t,e),s=new Jt(t,e+1),o=[];return this.Ur.forEachInRange([r,s],(l=>{this.Gr(l),o.push(l.key)})),o}Jr(){this.Qr.forEach((e=>this.Gr(e)))}Gr(e){this.Qr=this.Qr.delete(e),this.Ur=this.Ur.delete(e)}Hr(e){const t=new be(new mt([])),r=new Jt(t,e),s=new Jt(t,e+1);let o=Je();return this.Ur.forEachInRange([r,s],(l=>{o=o.add(l.key)})),o}containsKey(e){const t=new Jt(e,0),r=this.Qr.firstAfterOrEqual(t);return r!==null&&e.isEqual(r.key)}}class Jt{constructor(e,t){this.key=e,this.Yr=t}static $r(e,t){return be.comparator(e.key,t.key)||Xe(e.Yr,t.Yr)}static Kr(e,t){return Xe(e.Yr,t.Yr)||be.comparator(e.key,t.key)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class f4{constructor(e,t){this.indexManager=e,this.referenceDelegate=t,this.mutationQueue=[],this.tr=1,this.Zr=new Gt(Jt.$r)}checkEmpty(e){return te.resolve(this.mutationQueue.length===0)}addMutationBatch(e,t,r,s){const o=this.tr;this.tr++,this.mutationQueue.length>0&&this.mutationQueue[this.mutationQueue.length-1];const l=new RL(o,t,r,s);this.mutationQueue.push(l);for(const u of s)this.Zr=this.Zr.add(new Jt(u.key,o)),this.indexManager.addToCollectionParentIndex(e,u.key.path.popLast());return te.resolve(l)}lookupMutationBatch(e,t){return te.resolve(this.Xr(t))}getNextMutationBatchAfterBatchId(e,t){const r=t+1,s=this.ei(r),o=s<0?0:s;return te.resolve(this.mutationQueue.length>o?this.mutationQueue[o]:null)}getHighestUnacknowledgedBatchId(){return te.resolve(this.mutationQueue.length===0?K_:this.tr-1)}getAllMutationBatches(e){return te.resolve(this.mutationQueue.slice())}getAllMutationBatchesAffectingDocumentKey(e,t){const r=new Jt(t,0),s=new Jt(t,Number.POSITIVE_INFINITY),o=[];return this.Zr.forEachInRange([r,s],(l=>{const u=this.Xr(l.Yr);o.push(u)})),te.resolve(o)}getAllMutationBatchesAffectingDocumentKeys(e,t){let r=new Gt(Xe);return t.forEach((s=>{const o=new Jt(s,0),l=new Jt(s,Number.POSITIVE_INFINITY);this.Zr.forEachInRange([o,l],(u=>{r=r.add(u.Yr)}))})),te.resolve(this.ti(r))}getAllMutationBatchesAffectingQuery(e,t){const r=t.path,s=r.length+1;let o=r;be.isDocumentKey(o)||(o=o.child(""));const l=new Jt(new be(o),0);let u=new Gt(Xe);return this.Zr.forEachWhile((h=>{const p=h.key.path;return!!r.isPrefixOf(p)&&(p.length===s&&(u=u.add(h.Yr)),!0)}),l),te.resolve(this.ti(u))}ti(e){const t=[];return e.forEach((r=>{const s=this.Xr(r);s!==null&&t.push(s)})),t}removeMutationBatch(e,t){lt(this.ni(t.batchId,"removed")===0,55003),this.mutationQueue.shift();let r=this.Zr;return te.forEach(t.mutations,(s=>{const o=new Jt(s.key,t.batchId);return r=r.delete(o),this.referenceDelegate.markPotentiallyOrphaned(e,s.key)})).next((()=>{this.Zr=r}))}ir(e){}containsKey(e,t){const r=new Jt(t,0),s=this.Zr.firstAfterOrEqual(r);return te.resolve(t.isEqual(s&&s.key))}performConsistencyCheck(e){return this.mutationQueue.length,te.resolve()}ni(e,t){return this.ei(e)}ei(e){return this.mutationQueue.length===0?0:e-this.mutationQueue[0].batchId}Xr(e){const t=this.ei(e);return t<0||t>=this.mutationQueue.length?null:this.mutationQueue[t]}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class p4{constructor(e){this.ri=e,this.docs=(function(){return new $t(be.comparator)})(),this.size=0}setIndexManager(e){this.indexManager=e}addEntry(e,t){const r=t.key,s=this.docs.get(r),o=s?s.size:0,l=this.ri(t);return this.docs=this.docs.insert(r,{document:t.mutableCopy(),size:l}),this.size+=l-o,this.indexManager.addToCollectionParentIndex(e,r.path.popLast())}removeEntry(e){const t=this.docs.get(e);t&&(this.docs=this.docs.remove(e),this.size-=t.size)}getEntry(e,t){const r=this.docs.get(t);return te.resolve(r?r.document.mutableCopy():wn.newInvalidDocument(t))}getEntries(e,t){let r=ni();return t.forEach((s=>{const o=this.docs.get(s);r=r.insert(s,o?o.document.mutableCopy():wn.newInvalidDocument(s))})),te.resolve(r)}getDocumentsMatchingQuery(e,t,r,s){let o=ni();const l=t.path,u=new be(l.child("__id-9223372036854775808__")),h=this.docs.getIteratorFrom(u);for(;h.hasNext();){const{key:p,value:{document:g}}=h.getNext();if(!l.isPrefixOf(p.path))break;p.path.length>l.length+1||BM(zM(g),r)<=0||(s.has(g.key)||Pp(t,g))&&(o=o.insert(g.key,g.mutableCopy()))}return te.resolve(o)}getAllFromCollectionGroup(e,t,r,s){Oe(9500)}ii(e,t){return te.forEach(this.docs,(r=>t(r)))}newChangeBuffer(e){return new m4(this)}getSize(e){return te.resolve(this.size)}}class m4 extends a4{constructor(e){super(),this.Nr=e}applyChanges(e){const t=[];return this.changes.forEach(((r,s)=>{s.isValidDocument()?t.push(this.Nr.addEntry(e,s)):this.Nr.removeEntry(r)})),te.waitFor(t)}getFromCache(e,t){return this.Nr.getEntry(e,t)}getAllFromCache(e,t){return this.Nr.getEntries(e,t)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class g4{constructor(e){this.persistence=e,this.si=new _a((t=>X_(t)),J_),this.lastRemoteSnapshotVersion=Ue.min(),this.highestTargetId=0,this.oi=0,this._i=new rv,this.targetCount=0,this.ai=Bl.ur()}forEachTarget(e,t){return this.si.forEach(((r,s)=>t(s))),te.resolve()}getLastRemoteSnapshotVersion(e){return te.resolve(this.lastRemoteSnapshotVersion)}getHighestSequenceNumber(e){return te.resolve(this.oi)}allocateTargetId(e){return this.highestTargetId=this.ai.next(),te.resolve(this.highestTargetId)}setTargetsMetadata(e,t,r){return r&&(this.lastRemoteSnapshotVersion=r),t>this.oi&&(this.oi=t),te.resolve()}Pr(e){this.si.set(e.target,e);const t=e.targetId;t>this.highestTargetId&&(this.ai=new Bl(t),this.highestTargetId=t),e.sequenceNumber>this.oi&&(this.oi=e.sequenceNumber)}addTargetData(e,t){return this.Pr(t),this.targetCount+=1,te.resolve()}updateTargetData(e,t){return this.Pr(t),te.resolve()}removeTargetData(e,t){return this.si.delete(t.target),this._i.jr(t.targetId),this.targetCount-=1,te.resolve()}removeTargets(e,t,r){let s=0;const o=[];return this.si.forEach(((l,u)=>{u.sequenceNumber<=t&&r.get(u.targetId)===null&&(this.si.delete(l),o.push(this.removeMatchingKeysForTargetId(e,u.targetId)),s++)})),te.waitFor(o).next((()=>s))}getTargetCount(e){return te.resolve(this.targetCount)}getTargetData(e,t){const r=this.si.get(t)||null;return te.resolve(r)}addMatchingKeys(e,t,r){return this._i.Wr(t,r),te.resolve()}removeMatchingKeys(e,t,r){this._i.zr(t,r);const s=this.persistence.referenceDelegate,o=[];return s&&t.forEach((l=>{o.push(s.markPotentiallyOrphaned(e,l))})),te.waitFor(o)}removeMatchingKeysForTargetId(e,t){return this._i.jr(t),te.resolve()}getMatchingKeysForTargetId(e,t){const r=this._i.Hr(t);return te.resolve(r)}containsKey(e,t){return te.resolve(this._i.containsKey(t))}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ib{constructor(e,t){this.ui={},this.overlays={},this.ci=new bp(0),this.li=!1,this.li=!0,this.hi=new h4,this.referenceDelegate=e(this),this.Pi=new g4(this),this.indexManager=new e4,this.remoteDocumentCache=(function(s){return new p4(s)})((r=>this.referenceDelegate.Ti(r))),this.serializer=new JL(t),this.Ii=new u4(this.serializer)}start(){return Promise.resolve()}shutdown(){return this.li=!1,Promise.resolve()}get started(){return this.li}setDatabaseDeletedListener(){}setNetworkEnabled(){}getIndexManager(e){return this.indexManager}getDocumentOverlayCache(e){let t=this.overlays[e.toKey()];return t||(t=new d4,this.overlays[e.toKey()]=t),t}getMutationQueue(e,t){let r=this.ui[e.toKey()];return r||(r=new f4(t,this.referenceDelegate),this.ui[e.toKey()]=r),r}getGlobalsCache(){return this.hi}getTargetCache(){return this.Pi}getRemoteDocumentCache(){return this.remoteDocumentCache}getBundleCache(){return this.Ii}runTransaction(e,t,r){pe("MemoryPersistence","Starting transaction:",e);const s=new y4(this.ci.next());return this.referenceDelegate.Ei(),r(s).next((o=>this.referenceDelegate.di(s).next((()=>o)))).toPromise().then((o=>(s.raiseOnCommittedEvent(),o)))}Ai(e,t){return te.or(Object.values(this.ui).map((r=>()=>r.containsKey(e,t))))}}class y4 extends WM{constructor(e){super(),this.currentSequenceNumber=e}}class sv{constructor(e){this.persistence=e,this.Ri=new rv,this.Vi=null}static mi(e){return new sv(e)}get fi(){if(this.Vi)return this.Vi;throw Oe(60996)}addReference(e,t,r){return this.Ri.addReference(r,t),this.fi.delete(r.toString()),te.resolve()}removeReference(e,t,r){return this.Ri.removeReference(r,t),this.fi.add(r.toString()),te.resolve()}markPotentiallyOrphaned(e,t){return this.fi.add(t.toString()),te.resolve()}removeTarget(e,t){this.Ri.jr(t.targetId).forEach((s=>this.fi.add(s.toString())));const r=this.persistence.getTargetCache();return r.getMatchingKeysForTargetId(e,t.targetId).next((s=>{s.forEach((o=>this.fi.add(o.toString())))})).next((()=>r.removeTargetData(e,t)))}Ei(){this.Vi=new Set}di(e){const t=this.persistence.getRemoteDocumentCache().newChangeBuffer();return te.forEach(this.fi,(r=>{const s=be.fromPath(r);return this.gi(e,s).next((o=>{o||t.removeEntry(s,Ue.min())}))})).next((()=>(this.Vi=null,t.apply(e))))}updateLimboDocument(e,t){return this.gi(e,t).next((r=>{r?this.fi.delete(t.toString()):this.fi.add(t.toString())}))}Ti(e){return 0}gi(e,t){return te.or([()=>te.resolve(this.Ri.containsKey(t)),()=>this.persistence.getTargetCache().containsKey(e,t),()=>this.persistence.Ai(e,t)])}}class Uf{constructor(e,t){this.persistence=e,this.pi=new _a((r=>GM(r.path)),((r,s)=>r.isEqual(s))),this.garbageCollector=o4(this,t)}static mi(e,t){return new Uf(e,t)}Ei(){}di(e){return te.resolve()}forEachTarget(e,t){return this.persistence.getTargetCache().forEachTarget(e,t)}gr(e){const t=this.wr(e);return this.persistence.getTargetCache().getTargetCount(e).next((r=>t.next((s=>r+s))))}wr(e){let t=0;return this.pr(e,(r=>{t++})).next((()=>t))}pr(e,t){return te.forEach(this.pi,((r,s)=>this.br(e,r,s).next((o=>o?te.resolve():t(s)))))}removeTargets(e,t,r){return this.persistence.getTargetCache().removeTargets(e,t,r)}removeOrphanedDocuments(e,t){let r=0;const s=this.persistence.getRemoteDocumentCache(),o=s.newChangeBuffer();return s.ii(e,(l=>this.br(e,l,t).next((u=>{u||(r++,o.removeEntry(l,Ue.min()))})))).next((()=>o.apply(e))).next((()=>r))}markPotentiallyOrphaned(e,t){return this.pi.set(t,e.currentSequenceNumber),te.resolve()}removeTarget(e,t){const r=t.withSequenceNumber(e.currentSequenceNumber);return this.persistence.getTargetCache().updateTargetData(e,r)}addReference(e,t,r){return this.pi.set(r,e.currentSequenceNumber),te.resolve()}removeReference(e,t,r){return this.pi.set(r,e.currentSequenceNumber),te.resolve()}updateLimboDocument(e,t){return this.pi.set(t,e.currentSequenceNumber),te.resolve()}Ti(e){let t=e.key.toString().length;return e.isFoundDocument()&&(t+=hf(e.data.value)),t}br(e,t,r){return te.or([()=>this.persistence.Ai(e,t),()=>this.persistence.getTargetCache().containsKey(e,t),()=>{const s=this.pi.get(t);return te.resolve(s!==void 0&&s>r)}])}getCacheSize(e){return this.persistence.getRemoteDocumentCache().getSize(e)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class iv{constructor(e,t,r,s){this.targetId=e,this.fromCache=t,this.Es=r,this.ds=s}static As(e,t){let r=Je(),s=Je();for(const o of t.docChanges)switch(o.type){case 0:r=r.add(o.doc.key);break;case 1:s=s.add(o.doc.key)}return new iv(e,t.fromCache,r,s)}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class _4{constructor(){this._documentReadCount=0}get documentReadCount(){return this._documentReadCount}incrementDocumentReadCount(e){this._documentReadCount+=e}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class v4{constructor(){this.Rs=!1,this.Vs=!1,this.fs=100,this.gs=(function(){return HP()?8:HM(En())>0?6:4})()}initialize(e,t){this.ps=e,this.indexManager=t,this.Rs=!0}getDocumentsMatchingQuery(e,t,r,s){const o={result:null};return this.ys(e,t).next((l=>{o.result=l})).next((()=>{if(!o.result)return this.ws(e,t,s,r).next((l=>{o.result=l}))})).next((()=>{if(o.result)return;const l=new _4;return this.Ss(e,t,l).next((u=>{if(o.result=u,this.Vs)return this.bs(e,t,l,u.size)}))})).next((()=>o.result))}bs(e,t,r,s){return r.documentReadCount<this.fs?(wl()<=Qe.DEBUG&&pe("QueryEngine","SDK will not create cache indexes for query:",El(t),"since it only creates cache indexes for collection contains","more than or equal to",this.fs,"documents"),te.resolve()):(wl()<=Qe.DEBUG&&pe("QueryEngine","Query:",El(t),"scans",r.documentReadCount,"local documents and returns",s,"documents as results."),r.documentReadCount>this.gs*s?(wl()<=Qe.DEBUG&&pe("QueryEngine","The SDK decides to create cache indexes for query:",El(t),"as using cache indexes may help improve performance."),this.indexManager.createTargetIndexes(e,ds(t))):te.resolve())}ys(e,t){if(vT(t))return te.resolve(null);let r=ds(t);return this.indexManager.getIndexType(e,r).next((s=>s===0?null:(t.limit!==null&&s===1&&(t=jf(t,null,"F"),r=ds(t)),this.indexManager.getDocumentsMatchingTarget(e,r).next((o=>{const l=Je(...o);return this.ps.getDocuments(e,l).next((u=>this.indexManager.getMinOffset(e,r).next((h=>{const p=this.Ds(t,u);return this.Cs(t,p,l,h.readTime)?this.ys(e,jf(t,null,"F")):this.vs(e,p,t,h)}))))})))))}ws(e,t,r,s){return vT(t)||s.isEqual(Ue.min())?te.resolve(null):this.ps.getDocuments(e,r).next((o=>{const l=this.Ds(t,o);return this.Cs(t,l,r,s)?te.resolve(null):(wl()<=Qe.DEBUG&&pe("QueryEngine","Re-using previous result from %s to execute query: %s",s.toString(),El(t)),this.vs(e,l,t,UM(s,Fu)).next((u=>u)))}))}Ds(e,t){let r=new Gt(rb(e));return t.forEach(((s,o)=>{Pp(e,o)&&(r=r.add(o))})),r}Cs(e,t,r,s){if(e.limit===null)return!1;if(r.size!==t.size)return!0;const o=e.limitType==="F"?t.last():t.first();return!!o&&(o.hasPendingWrites||o.version.compareTo(s)>0)}Ss(e,t,r){return wl()<=Qe.DEBUG&&pe("QueryEngine","Using full collection scan to execute query:",El(t)),this.ps.getDocumentsMatchingQuery(e,t,ao.min(),r)}vs(e,t,r,s){return this.ps.getDocumentsMatchingQuery(e,r,s).next((o=>(t.forEach((l=>{o=o.insert(l.key,l)})),o)))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ov="LocalStore",w4=3e8;class E4{constructor(e,t,r,s){this.persistence=e,this.Fs=t,this.serializer=s,this.Ms=new $t(Xe),this.xs=new _a((o=>X_(o)),J_),this.Os=new Map,this.Ns=e.getRemoteDocumentCache(),this.Pi=e.getTargetCache(),this.Ii=e.getBundleCache(),this.Bs(r)}Bs(e){this.documentOverlayCache=this.persistence.getDocumentOverlayCache(e),this.indexManager=this.persistence.getIndexManager(e),this.mutationQueue=this.persistence.getMutationQueue(e,this.indexManager),this.localDocuments=new c4(this.Ns,this.mutationQueue,this.documentOverlayCache,this.indexManager),this.Ns.setIndexManager(this.indexManager),this.Fs.initialize(this.localDocuments,this.indexManager)}collectGarbage(e){return this.persistence.runTransaction("Collect garbage","readwrite-primary",(t=>e.collect(t,this.Ms)))}}function x4(n,e,t,r){return new E4(n,e,t,r)}async function bb(n,e){const t=Be(n);return await t.persistence.runTransaction("Handle user change","readonly",(r=>{let s;return t.mutationQueue.getAllMutationBatches(r).next((o=>(s=o,t.Bs(e),t.mutationQueue.getAllMutationBatches(r)))).next((o=>{const l=[],u=[];let h=Je();for(const p of s){l.push(p.batchId);for(const g of p.mutations)h=h.add(g.key)}for(const p of o){u.push(p.batchId);for(const g of p.mutations)h=h.add(g.key)}return t.localDocuments.getDocuments(r,h).next((p=>({Ls:p,removedBatchIds:l,addedBatchIds:u})))}))}))}function T4(n,e){const t=Be(n);return t.persistence.runTransaction("Acknowledge batch","readwrite-primary",(r=>{const s=e.batch.keys(),o=t.Ns.newChangeBuffer({trackRemovals:!0});return(function(u,h,p,g){const _=p.batch,v=_.keys();let T=te.resolve();return v.forEach((A=>{T=T.next((()=>g.getEntry(h,A))).next((I=>{const b=p.docVersions.get(A);lt(b!==null,48541),I.version.compareTo(b)<0&&(_.applyToRemoteDocument(I,p),I.isValidDocument()&&(I.setReadTime(p.commitVersion),g.addEntry(I)))}))})),T.next((()=>u.mutationQueue.removeMutationBatch(h,_)))})(t,r,e,o).next((()=>o.apply(r))).next((()=>t.mutationQueue.performConsistencyCheck(r))).next((()=>t.documentOverlayCache.removeOverlaysForBatchId(r,s,e.batch.batchId))).next((()=>t.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(r,(function(u){let h=Je();for(let p=0;p<u.mutationResults.length;++p)u.mutationResults[p].transformResults.length>0&&(h=h.add(u.batch.mutations[p].key));return h})(e)))).next((()=>t.localDocuments.getDocuments(r,s)))}))}function Rb(n){const e=Be(n);return e.persistence.runTransaction("Get last remote snapshot version","readonly",(t=>e.Pi.getLastRemoteSnapshotVersion(t)))}function C4(n,e){const t=Be(n),r=e.snapshotVersion;let s=t.Ms;return t.persistence.runTransaction("Apply remote event","readwrite-primary",(o=>{const l=t.Ns.newChangeBuffer({trackRemovals:!0});s=t.Ms;const u=[];e.targetChanges.forEach(((g,_)=>{const v=s.get(_);if(!v)return;u.push(t.Pi.removeMatchingKeys(o,g.removedDocuments,_).next((()=>t.Pi.addMatchingKeys(o,g.addedDocuments,_))));let T=v.withSequenceNumber(o.currentSequenceNumber);e.targetMismatches.get(_)!==null?T=T.withResumeToken(dn.EMPTY_BYTE_STRING,Ue.min()).withLastLimboFreeSnapshotVersion(Ue.min()):g.resumeToken.approximateByteSize()>0&&(T=T.withResumeToken(g.resumeToken,r)),s=s.insert(_,T),(function(I,b,j){return I.resumeToken.approximateByteSize()===0||b.snapshotVersion.toMicroseconds()-I.snapshotVersion.toMicroseconds()>=w4?!0:j.addedDocuments.size+j.modifiedDocuments.size+j.removedDocuments.size>0})(v,T,g)&&u.push(t.Pi.updateTargetData(o,T))}));let h=ni(),p=Je();if(e.documentUpdates.forEach((g=>{e.resolvedLimboDocuments.has(g)&&u.push(t.persistence.referenceDelegate.updateLimboDocument(o,g))})),u.push(S4(o,l,e.documentUpdates).next((g=>{h=g.ks,p=g.qs}))),!r.isEqual(Ue.min())){const g=t.Pi.getLastRemoteSnapshotVersion(o).next((_=>t.Pi.setTargetsMetadata(o,o.currentSequenceNumber,r)));u.push(g)}return te.waitFor(u).next((()=>l.apply(o))).next((()=>t.localDocuments.getLocalViewOfDocuments(o,h,p))).next((()=>h))})).then((o=>(t.Ms=s,o)))}function S4(n,e,t){let r=Je(),s=Je();return t.forEach((o=>r=r.add(o))),e.getEntries(n,r).next((o=>{let l=ni();return t.forEach(((u,h)=>{const p=o.get(u);h.isFoundDocument()!==p.isFoundDocument()&&(s=s.add(u)),h.isNoDocument()&&h.version.isEqual(Ue.min())?(e.removeEntry(u,h.readTime),l=l.insert(u,h)):!p.isValidDocument()||h.version.compareTo(p.version)>0||h.version.compareTo(p.version)===0&&p.hasPendingWrites?(e.addEntry(h),l=l.insert(u,h)):pe(ov,"Ignoring outdated watch update for ",u,". Current version:",p.version," Watch version:",h.version)})),{ks:l,qs:s}}))}function I4(n,e){const t=Be(n);return t.persistence.runTransaction("Get next mutation batch","readonly",(r=>(e===void 0&&(e=K_),t.mutationQueue.getNextMutationBatchAfterBatchId(r,e))))}function b4(n,e){const t=Be(n);return t.persistence.runTransaction("Allocate target","readwrite",(r=>{let s;return t.Pi.getTargetData(r,e).next((o=>o?(s=o,te.resolve(s)):t.Pi.allocateTargetId(r).next((l=>(s=new Yi(e,l,"TargetPurposeListen",r.currentSequenceNumber),t.Pi.addTargetData(r,s).next((()=>s)))))))})).then((r=>{const s=t.Ms.get(r.targetId);return(s===null||r.snapshotVersion.compareTo(s.snapshotVersion)>0)&&(t.Ms=t.Ms.insert(r.targetId,r),t.xs.set(e,r.targetId)),r}))}async function Xy(n,e,t){const r=Be(n),s=r.Ms.get(e),o=t?"readwrite":"readwrite-primary";try{t||await r.persistence.runTransaction("Release target",o,(l=>r.persistence.referenceDelegate.removeTarget(l,s)))}catch(l){if(!sc(l))throw l;pe(ov,`Failed to update sequence numbers for target ${e}: ${l}`)}r.Ms=r.Ms.remove(e),r.xs.delete(s.target)}function PT(n,e,t){const r=Be(n);let s=Ue.min(),o=Je();return r.persistence.runTransaction("Execute query","readwrite",(l=>(function(h,p,g){const _=Be(h),v=_.xs.get(g);return v!==void 0?te.resolve(_.Ms.get(v)):_.Pi.getTargetData(p,g)})(r,l,ds(e)).next((u=>{if(u)return s=u.lastLimboFreeSnapshotVersion,r.Pi.getMatchingKeysForTargetId(l,u.targetId).next((h=>{o=h}))})).next((()=>r.Fs.getDocumentsMatchingQuery(l,e,t?s:Ue.min(),t?o:Je()))).next((u=>(R4(r,hL(e),u),{documents:u,Qs:o})))))}function R4(n,e,t){let r=n.Os.get(e)||Ue.min();t.forEach(((s,o)=>{o.readTime.compareTo(r)>0&&(r=o.readTime)})),n.Os.set(e,r)}class DT{constructor(){this.activeTargetIds=_L()}zs(e){this.activeTargetIds=this.activeTargetIds.add(e)}js(e){this.activeTargetIds=this.activeTargetIds.delete(e)}Gs(){const e={activeTargetIds:this.activeTargetIds.toArray(),updateTimeMs:Date.now()};return JSON.stringify(e)}}class A4{constructor(){this.Mo=new DT,this.xo={},this.onlineStateHandler=null,this.sequenceNumberHandler=null}addPendingMutation(e){}updateMutationState(e,t,r){}addLocalQueryTarget(e,t=!0){return t&&this.Mo.zs(e),this.xo[e]||"not-current"}updateQueryState(e,t,r){this.xo[e]=t}removeLocalQueryTarget(e){this.Mo.js(e)}isLocalQueryTarget(e){return this.Mo.activeTargetIds.has(e)}clearQueryState(e){delete this.xo[e]}getAllActiveQueryTargets(){return this.Mo.activeTargetIds}isActiveQueryTarget(e){return this.Mo.activeTargetIds.has(e)}start(){return this.Mo=new DT,Promise.resolve()}handleUserChange(e,t,r){}setOnlineState(e){}shutdown(){}writeSequenceNumber(e){}notifyBundleLoaded(e){}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class k4{Oo(e){}shutdown(){}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const OT="ConnectivityMonitor";class MT{constructor(){this.No=()=>this.Bo(),this.Lo=()=>this.ko(),this.qo=[],this.Qo()}Oo(e){this.qo.push(e)}shutdown(){window.removeEventListener("online",this.No),window.removeEventListener("offline",this.Lo)}Qo(){window.addEventListener("online",this.No),window.addEventListener("offline",this.Lo)}Bo(){pe(OT,"Network connectivity changed: AVAILABLE");for(const e of this.qo)e(0)}ko(){pe(OT,"Network connectivity changed: UNAVAILABLE");for(const e of this.qo)e(1)}static v(){return typeof window<"u"&&window.addEventListener!==void 0&&window.removeEventListener!==void 0}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let Gh=null;function Jy(){return Gh===null?Gh=(function(){return 268435456+Math.round(2147483648*Math.random())})():Gh++,"0x"+Gh.toString(16)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const sy="RestConnection",N4={BatchGetDocuments:"batchGet",Commit:"commit",RunQuery:"runQuery",RunAggregationQuery:"runAggregationQuery"};class P4{get $o(){return!1}constructor(e){this.databaseInfo=e,this.databaseId=e.databaseId;const t=e.ssl?"https":"http",r=encodeURIComponent(this.databaseId.projectId),s=encodeURIComponent(this.databaseId.database);this.Uo=t+"://"+e.host,this.Ko=`projects/${r}/databases/${s}`,this.Wo=this.databaseId.database===Of?`project_id=${r}`:`project_id=${r}&database_id=${s}`}Go(e,t,r,s,o){const l=Jy(),u=this.zo(e,t.toUriEncodedString());pe(sy,`Sending RPC '${e}' ${l}:`,u,r);const h={"google-cloud-resource-prefix":this.Ko,"x-goog-request-params":this.Wo};this.jo(h,s,o);const{host:p}=new URL(u),g=vs(p);return this.Jo(e,u,h,r,g).then((_=>(pe(sy,`Received RPC '${e}' ${l}: `,_),_)),(_=>{throw Vl(sy,`RPC '${e}' ${l} failed with error: `,_,"url: ",u,"request:",r),_}))}Ho(e,t,r,s,o,l){return this.Go(e,t,r,s,o)}jo(e,t,r){e["X-Goog-Api-Client"]=(function(){return"gl-js/ fire/"+nc})(),e["Content-Type"]="text/plain",this.databaseInfo.appId&&(e["X-Firebase-GMPID"]=this.databaseInfo.appId),t&&t.headers.forEach(((s,o)=>e[o]=s)),r&&r.headers.forEach(((s,o)=>e[o]=s))}zo(e,t){const r=N4[e];return`${this.Uo}/v1/${t}:${r}`}terminate(){}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class D4{constructor(e){this.Yo=e.Yo,this.Zo=e.Zo}Xo(e){this.e_=e}t_(e){this.n_=e}r_(e){this.i_=e}onMessage(e){this.s_=e}close(){this.Zo()}send(e){this.Yo(e)}o_(){this.e_()}__(){this.n_()}a_(e){this.i_(e)}u_(e){this.s_(e)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const _n="WebChannelConnection";class O4 extends P4{constructor(e){super(e),this.c_=[],this.forceLongPolling=e.forceLongPolling,this.autoDetectLongPolling=e.autoDetectLongPolling,this.useFetchStreams=e.useFetchStreams,this.longPollingOptions=e.longPollingOptions}Jo(e,t,r,s,o){const l=Jy();return new Promise(((u,h)=>{const p=new kI;p.setWithCredentials(!0),p.listenOnce(NI.COMPLETE,(()=>{try{switch(p.getLastErrorCode()){case df.NO_ERROR:const _=p.getResponseJson();pe(_n,`XHR for RPC '${e}' ${l} received:`,JSON.stringify(_)),u(_);break;case df.TIMEOUT:pe(_n,`RPC '${e}' ${l} timed out`),h(new de(ee.DEADLINE_EXCEEDED,"Request time out"));break;case df.HTTP_ERROR:const v=p.getStatus();if(pe(_n,`RPC '${e}' ${l} failed with status:`,v,"response text:",p.getResponseText()),v>0){let T=p.getResponseJson();Array.isArray(T)&&(T=T[0]);const A=T?.error;if(A&&A.status&&A.message){const I=(function(j){const U=j.toLowerCase().replace(/_/g,"-");return Object.values(ee).indexOf(U)>=0?U:ee.UNKNOWN})(A.status);h(new de(I,A.message))}else h(new de(ee.UNKNOWN,"Server responded with status "+p.getStatus()))}else h(new de(ee.UNAVAILABLE,"Connection failed."));break;default:Oe(9055,{l_:e,streamId:l,h_:p.getLastErrorCode(),P_:p.getLastError()})}}finally{pe(_n,`RPC '${e}' ${l} completed.`)}}));const g=JSON.stringify(s);pe(_n,`RPC '${e}' ${l} sending request:`,s),p.send(t,"POST",g,r,15)}))}T_(e,t,r){const s=Jy(),o=[this.Uo,"/","google.firestore.v1.Firestore","/",e,"/channel"],l=OI(),u=DI(),h={httpSessionIdParam:"gsessionid",initMessageHeaders:{},messageUrlParams:{database:`projects/${this.databaseId.projectId}/databases/${this.databaseId.database}`},sendRawJson:!0,supportsCrossDomainXhr:!0,internalChannelParams:{forwardChannelRequestTimeoutMs:6e5},forceLongPolling:this.forceLongPolling,detectBufferingProxy:this.autoDetectLongPolling},p=this.longPollingOptions.timeoutSeconds;p!==void 0&&(h.longPollingTimeout=Math.round(1e3*p)),this.useFetchStreams&&(h.useFetchStreams=!0),this.jo(h.initMessageHeaders,t,r),h.encodeInitMessageHeaders=!0;const g=o.join("");pe(_n,`Creating RPC '${e}' stream ${s}: ${g}`,h);const _=l.createWebChannel(g,h);this.I_(_);let v=!1,T=!1;const A=new D4({Yo:b=>{T?pe(_n,`Not sending because RPC '${e}' stream ${s} is closed:`,b):(v||(pe(_n,`Opening RPC '${e}' stream ${s} transport.`),_.open(),v=!0),pe(_n,`RPC '${e}' stream ${s} sending:`,b),_.send(b))},Zo:()=>_.close()}),I=(b,j,U)=>{b.listen(j,($=>{try{U($)}catch(G){setTimeout((()=>{throw G}),0)}}))};return I(_,gu.EventType.OPEN,(()=>{T||(pe(_n,`RPC '${e}' stream ${s} transport opened.`),A.o_())})),I(_,gu.EventType.CLOSE,(()=>{T||(T=!0,pe(_n,`RPC '${e}' stream ${s} transport closed`),A.a_(),this.E_(_))})),I(_,gu.EventType.ERROR,(b=>{T||(T=!0,Vl(_n,`RPC '${e}' stream ${s} transport errored. Name:`,b.name,"Message:",b.message),A.a_(new de(ee.UNAVAILABLE,"The operation could not be completed")))})),I(_,gu.EventType.MESSAGE,(b=>{if(!T){const j=b.data[0];lt(!!j,16349);const U=j,$=U?.error||U[0]?.error;if($){pe(_n,`RPC '${e}' stream ${s} received error:`,$);const G=$.status;let X=(function(R){const N=Ft[R];if(N!==void 0)return mb(N)})(G),ne=$.message;X===void 0&&(X=ee.INTERNAL,ne="Unknown error status: "+G+" with message "+$.message),T=!0,A.a_(new de(X,ne)),_.close()}else pe(_n,`RPC '${e}' stream ${s} received:`,j),A.u_(j)}})),I(u,PI.STAT_EVENT,(b=>{b.stat===Fy.PROXY?pe(_n,`RPC '${e}' stream ${s} detected buffering proxy`):b.stat===Fy.NOPROXY&&pe(_n,`RPC '${e}' stream ${s} detected no buffering proxy`)})),setTimeout((()=>{A.__()}),0),A}terminate(){this.c_.forEach((e=>e.close())),this.c_=[]}I_(e){this.c_.push(e)}E_(e){this.c_=this.c_.filter((t=>t===e))}}function iy(){return typeof document<"u"?document:null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Lp(n){return new VL(n,!0)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ab{constructor(e,t,r=1e3,s=1.5,o=6e4){this.Mi=e,this.timerId=t,this.d_=r,this.A_=s,this.R_=o,this.V_=0,this.m_=null,this.f_=Date.now(),this.reset()}reset(){this.V_=0}g_(){this.V_=this.R_}p_(e){this.cancel();const t=Math.floor(this.V_+this.y_()),r=Math.max(0,Date.now()-this.f_),s=Math.max(0,t-r);s>0&&pe("ExponentialBackoff",`Backing off for ${s} ms (base delay: ${this.V_} ms, delay with jitter: ${t} ms, last attempt: ${r} ms ago)`),this.m_=this.Mi.enqueueAfterDelay(this.timerId,s,(()=>(this.f_=Date.now(),e()))),this.V_*=this.A_,this.V_<this.d_&&(this.V_=this.d_),this.V_>this.R_&&(this.V_=this.R_)}w_(){this.m_!==null&&(this.m_.skipDelay(),this.m_=null)}cancel(){this.m_!==null&&(this.m_.cancel(),this.m_=null)}y_(){return(Math.random()-.5)*this.V_}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const LT="PersistentStream";class kb{constructor(e,t,r,s,o,l,u,h){this.Mi=e,this.S_=r,this.b_=s,this.connection=o,this.authCredentialsProvider=l,this.appCheckCredentialsProvider=u,this.listener=h,this.state=0,this.D_=0,this.C_=null,this.v_=null,this.stream=null,this.F_=0,this.M_=new Ab(e,t)}x_(){return this.state===1||this.state===5||this.O_()}O_(){return this.state===2||this.state===3}start(){this.F_=0,this.state!==4?this.auth():this.N_()}async stop(){this.x_()&&await this.close(0)}B_(){this.state=0,this.M_.reset()}L_(){this.O_()&&this.C_===null&&(this.C_=this.Mi.enqueueAfterDelay(this.S_,6e4,(()=>this.k_())))}q_(e){this.Q_(),this.stream.send(e)}async k_(){if(this.O_())return this.close(0)}Q_(){this.C_&&(this.C_.cancel(),this.C_=null)}U_(){this.v_&&(this.v_.cancel(),this.v_=null)}async close(e,t){this.Q_(),this.U_(),this.M_.cancel(),this.D_++,e!==4?this.M_.reset():t&&t.code===ee.RESOURCE_EXHAUSTED?(ti(t.toString()),ti("Using maximum backoff delay to prevent overloading the backend."),this.M_.g_()):t&&t.code===ee.UNAUTHENTICATED&&this.state!==3&&(this.authCredentialsProvider.invalidateToken(),this.appCheckCredentialsProvider.invalidateToken()),this.stream!==null&&(this.K_(),this.stream.close(),this.stream=null),this.state=e,await this.listener.r_(t)}K_(){}auth(){this.state=1;const e=this.W_(this.D_),t=this.D_;Promise.all([this.authCredentialsProvider.getToken(),this.appCheckCredentialsProvider.getToken()]).then((([r,s])=>{this.D_===t&&this.G_(r,s)}),(r=>{e((()=>{const s=new de(ee.UNKNOWN,"Fetching auth token failed: "+r.message);return this.z_(s)}))}))}G_(e,t){const r=this.W_(this.D_);this.stream=this.j_(e,t),this.stream.Xo((()=>{r((()=>this.listener.Xo()))})),this.stream.t_((()=>{r((()=>(this.state=2,this.v_=this.Mi.enqueueAfterDelay(this.b_,1e4,(()=>(this.O_()&&(this.state=3),Promise.resolve()))),this.listener.t_())))})),this.stream.r_((s=>{r((()=>this.z_(s)))})),this.stream.onMessage((s=>{r((()=>++this.F_==1?this.J_(s):this.onNext(s)))}))}N_(){this.state=5,this.M_.p_((async()=>{this.state=0,this.start()}))}z_(e){return pe(LT,`close with error: ${e}`),this.stream=null,this.close(4,e)}W_(e){return t=>{this.Mi.enqueueAndForget((()=>this.D_===e?t():(pe(LT,"stream callback skipped by getCloseGuardedDispatcher."),Promise.resolve())))}}}class M4 extends kb{constructor(e,t,r,s,o,l){super(e,"listen_stream_connection_backoff","listen_stream_idle","health_check_timeout",t,r,s,l),this.serializer=o}j_(e,t){return this.connection.T_("Listen",e,t)}J_(e){return this.onNext(e)}onNext(e){this.M_.reset();const t=zL(this.serializer,e),r=(function(o){if(!("targetChange"in o))return Ue.min();const l=o.targetChange;return l.targetIds&&l.targetIds.length?Ue.min():l.readTime?hs(l.readTime):Ue.min()})(e);return this.listener.H_(t,r)}Y_(e){const t={};t.database=Yy(this.serializer),t.addTarget=(function(o,l){let u;const h=l.target;if(u=Hy(h)?{documents:WL(o,h)}:{query:HL(o,h).ft},u.targetId=l.targetId,l.resumeToken.approximateByteSize()>0){u.resumeToken=_b(o,l.resumeToken);const p=Gy(o,l.expectedCount);p!==null&&(u.expectedCount=p)}else if(l.snapshotVersion.compareTo(Ue.min())>0){u.readTime=Ff(o,l.snapshotVersion.toTimestamp());const p=Gy(o,l.expectedCount);p!==null&&(u.expectedCount=p)}return u})(this.serializer,e);const r=GL(this.serializer,e);r&&(t.labels=r),this.q_(t)}Z_(e){const t={};t.database=Yy(this.serializer),t.removeTarget=e,this.q_(t)}}class L4 extends kb{constructor(e,t,r,s,o,l){super(e,"write_stream_connection_backoff","write_stream_idle","health_check_timeout",t,r,s,l),this.serializer=o}get X_(){return this.F_>0}start(){this.lastStreamToken=void 0,super.start()}K_(){this.X_&&this.ea([])}j_(e,t){return this.connection.T_("Write",e,t)}J_(e){return lt(!!e.streamToken,31322),this.lastStreamToken=e.streamToken,lt(!e.writeResults||e.writeResults.length===0,55816),this.listener.ta()}onNext(e){lt(!!e.streamToken,12678),this.lastStreamToken=e.streamToken,this.M_.reset();const t=$L(e.writeResults,e.commitTime),r=hs(e.commitTime);return this.listener.na(r,t)}ra(){const e={};e.database=Yy(this.serializer),this.q_(e)}ea(e){const t={streamToken:this.lastStreamToken,writes:e.map((r=>BL(this.serializer,r)))};this.q_(t)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class j4{}class V4 extends j4{constructor(e,t,r,s){super(),this.authCredentials=e,this.appCheckCredentials=t,this.connection=r,this.serializer=s,this.ia=!1}sa(){if(this.ia)throw new de(ee.FAILED_PRECONDITION,"The client has already been terminated.")}Go(e,t,r,s){return this.sa(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then((([o,l])=>this.connection.Go(e,Ky(t,r),s,o,l))).catch((o=>{throw o.name==="FirebaseError"?(o.code===ee.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),o):new de(ee.UNKNOWN,o.toString())}))}Ho(e,t,r,s,o){return this.sa(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then((([l,u])=>this.connection.Ho(e,Ky(t,r),s,l,u,o))).catch((l=>{throw l.name==="FirebaseError"?(l.code===ee.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),l):new de(ee.UNKNOWN,l.toString())}))}terminate(){this.ia=!0,this.connection.terminate()}}class F4{constructor(e,t){this.asyncQueue=e,this.onlineStateHandler=t,this.state="Unknown",this.oa=0,this._a=null,this.aa=!0}ua(){this.oa===0&&(this.ca("Unknown"),this._a=this.asyncQueue.enqueueAfterDelay("online_state_timeout",1e4,(()=>(this._a=null,this.la("Backend didn't respond within 10 seconds."),this.ca("Offline"),Promise.resolve()))))}ha(e){this.state==="Online"?this.ca("Unknown"):(this.oa++,this.oa>=1&&(this.Pa(),this.la(`Connection failed 1 times. Most recent error: ${e.toString()}`),this.ca("Offline")))}set(e){this.Pa(),this.oa=0,e==="Online"&&(this.aa=!1),this.ca(e)}ca(e){e!==this.state&&(this.state=e,this.onlineStateHandler(e))}la(e){const t=`Could not reach Cloud Firestore backend. ${e}
This typically indicates that your device does not have a healthy Internet connection at the moment. The client will operate in offline mode until it is able to successfully connect to the backend.`;this.aa?(ti(t),this.aa=!1):pe("OnlineStateTracker",t)}Pa(){this._a!==null&&(this._a.cancel(),this._a=null)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ca="RemoteStore";class U4{constructor(e,t,r,s,o){this.localStore=e,this.datastore=t,this.asyncQueue=r,this.remoteSyncer={},this.Ta=[],this.Ia=new Map,this.Ea=new Set,this.da=[],this.Aa=o,this.Aa.Oo((l=>{r.enqueueAndForget((async()=>{va(this)&&(pe(ca,"Restarting streams for network reachability change."),await(async function(h){const p=Be(h);p.Ea.add(4),await pd(p),p.Ra.set("Unknown"),p.Ea.delete(4),await jp(p)})(this))}))})),this.Ra=new F4(r,s)}}async function jp(n){if(va(n))for(const e of n.da)await e(!0)}async function pd(n){for(const e of n.da)await e(!1)}function Nb(n,e){const t=Be(n);t.Ia.has(e.targetId)||(t.Ia.set(e.targetId,e),uv(t)?cv(t):oc(t).O_()&&lv(t,e))}function av(n,e){const t=Be(n),r=oc(t);t.Ia.delete(e),r.O_()&&Pb(t,e),t.Ia.size===0&&(r.O_()?r.L_():va(t)&&t.Ra.set("Unknown"))}function lv(n,e){if(n.Va.Ue(e.targetId),e.resumeToken.approximateByteSize()>0||e.snapshotVersion.compareTo(Ue.min())>0){const t=n.remoteSyncer.getRemoteKeysForTarget(e.targetId).size;e=e.withExpectedCount(t)}oc(n).Y_(e)}function Pb(n,e){n.Va.Ue(e),oc(n).Z_(e)}function cv(n){n.Va=new OL({getRemoteKeysForTarget:e=>n.remoteSyncer.getRemoteKeysForTarget(e),At:e=>n.Ia.get(e)||null,ht:()=>n.datastore.serializer.databaseId}),oc(n).start(),n.Ra.ua()}function uv(n){return va(n)&&!oc(n).x_()&&n.Ia.size>0}function va(n){return Be(n).Ea.size===0}function Db(n){n.Va=void 0}async function z4(n){n.Ra.set("Online")}async function B4(n){n.Ia.forEach(((e,t)=>{lv(n,e)}))}async function $4(n,e){Db(n),uv(n)?(n.Ra.ha(e),cv(n)):n.Ra.set("Unknown")}async function W4(n,e,t){if(n.Ra.set("Online"),e instanceof yb&&e.state===2&&e.cause)try{await(async function(s,o){const l=o.cause;for(const u of o.targetIds)s.Ia.has(u)&&(await s.remoteSyncer.rejectListen(u,l),s.Ia.delete(u),s.Va.removeTarget(u))})(n,e)}catch(r){pe(ca,"Failed to remove targets %s: %s ",e.targetIds.join(","),r),await zf(n,r)}else if(e instanceof mf?n.Va.Ze(e):e instanceof gb?n.Va.st(e):n.Va.tt(e),!t.isEqual(Ue.min()))try{const r=await Rb(n.localStore);t.compareTo(r)>=0&&await(function(o,l){const u=o.Va.Tt(l);return u.targetChanges.forEach(((h,p)=>{if(h.resumeToken.approximateByteSize()>0){const g=o.Ia.get(p);g&&o.Ia.set(p,g.withResumeToken(h.resumeToken,l))}})),u.targetMismatches.forEach(((h,p)=>{const g=o.Ia.get(h);if(!g)return;o.Ia.set(h,g.withResumeToken(dn.EMPTY_BYTE_STRING,g.snapshotVersion)),Pb(o,h);const _=new Yi(g.target,h,p,g.sequenceNumber);lv(o,_)})),o.remoteSyncer.applyRemoteEvent(u)})(n,t)}catch(r){pe(ca,"Failed to raise snapshot:",r),await zf(n,r)}}async function zf(n,e,t){if(!sc(e))throw e;n.Ea.add(1),await pd(n),n.Ra.set("Offline"),t||(t=()=>Rb(n.localStore)),n.asyncQueue.enqueueRetryable((async()=>{pe(ca,"Retrying IndexedDB access"),await t(),n.Ea.delete(1),await jp(n)}))}function Ob(n,e){return e().catch((t=>zf(n,t,e)))}async function Vp(n){const e=Be(n),t=ho(e);let r=e.Ta.length>0?e.Ta[e.Ta.length-1].batchId:K_;for(;H4(e);)try{const s=await I4(e.localStore,r);if(s===null){e.Ta.length===0&&t.L_();break}r=s.batchId,q4(e,s)}catch(s){await zf(e,s)}Mb(e)&&Lb(e)}function H4(n){return va(n)&&n.Ta.length<10}function q4(n,e){n.Ta.push(e);const t=ho(n);t.O_()&&t.X_&&t.ea(e.mutations)}function Mb(n){return va(n)&&!ho(n).x_()&&n.Ta.length>0}function Lb(n){ho(n).start()}async function G4(n){ho(n).ra()}async function K4(n){const e=ho(n);for(const t of n.Ta)e.ea(t.mutations)}async function Q4(n,e,t){const r=n.Ta.shift(),s=ev.from(r,e,t);await Ob(n,(()=>n.remoteSyncer.applySuccessfulWrite(s))),await Vp(n)}async function Y4(n,e){e&&ho(n).X_&&await(async function(r,s){if((function(l){return NL(l)&&l!==ee.ABORTED})(s.code)){const o=r.Ta.shift();ho(r).B_(),await Ob(r,(()=>r.remoteSyncer.rejectFailedWrite(o.batchId,s))),await Vp(r)}})(n,e),Mb(n)&&Lb(n)}async function jT(n,e){const t=Be(n);t.asyncQueue.verifyOperationInProgress(),pe(ca,"RemoteStore received new credentials");const r=va(t);t.Ea.add(3),await pd(t),r&&t.Ra.set("Unknown"),await t.remoteSyncer.handleCredentialChange(e),t.Ea.delete(3),await jp(t)}async function X4(n,e){const t=Be(n);e?(t.Ea.delete(2),await jp(t)):e||(t.Ea.add(2),await pd(t),t.Ra.set("Unknown"))}function oc(n){return n.ma||(n.ma=(function(t,r,s){const o=Be(t);return o.sa(),new M4(r,o.connection,o.authCredentials,o.appCheckCredentials,o.serializer,s)})(n.datastore,n.asyncQueue,{Xo:z4.bind(null,n),t_:B4.bind(null,n),r_:$4.bind(null,n),H_:W4.bind(null,n)}),n.da.push((async e=>{e?(n.ma.B_(),uv(n)?cv(n):n.Ra.set("Unknown")):(await n.ma.stop(),Db(n))}))),n.ma}function ho(n){return n.fa||(n.fa=(function(t,r,s){const o=Be(t);return o.sa(),new L4(r,o.connection,o.authCredentials,o.appCheckCredentials,o.serializer,s)})(n.datastore,n.asyncQueue,{Xo:()=>Promise.resolve(),t_:G4.bind(null,n),r_:Y4.bind(null,n),ta:K4.bind(null,n),na:Q4.bind(null,n)}),n.da.push((async e=>{e?(n.fa.B_(),await Vp(n)):(await n.fa.stop(),n.Ta.length>0&&(pe(ca,`Stopping write stream with ${n.Ta.length} pending writes`),n.Ta=[]))}))),n.fa}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class dv{constructor(e,t,r,s,o){this.asyncQueue=e,this.timerId=t,this.targetTimeMs=r,this.op=s,this.removalCallback=o,this.deferred=new Qs,this.then=this.deferred.promise.then.bind(this.deferred.promise),this.deferred.promise.catch((l=>{}))}get promise(){return this.deferred.promise}static createAndSchedule(e,t,r,s,o){const l=Date.now()+r,u=new dv(e,t,l,s,o);return u.start(r),u}start(e){this.timerHandle=setTimeout((()=>this.handleDelayElapsed()),e)}skipDelay(){return this.handleDelayElapsed()}cancel(e){this.timerHandle!==null&&(this.clearTimeout(),this.deferred.reject(new de(ee.CANCELLED,"Operation cancelled"+(e?": "+e:""))))}handleDelayElapsed(){this.asyncQueue.enqueueAndForget((()=>this.timerHandle!==null?(this.clearTimeout(),this.op().then((e=>this.deferred.resolve(e)))):Promise.resolve()))}clearTimeout(){this.timerHandle!==null&&(this.removalCallback(this),clearTimeout(this.timerHandle),this.timerHandle=null)}}function hv(n,e){if(ti("AsyncQueue",`${e}: ${n}`),sc(n))return new de(ee.UNAVAILABLE,`${e}: ${n}`);throw n}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Al{static emptySet(e){return new Al(e.comparator)}constructor(e){this.comparator=e?(t,r)=>e(t,r)||be.comparator(t.key,r.key):(t,r)=>be.comparator(t.key,r.key),this.keyedMap=yu(),this.sortedSet=new $t(this.comparator)}has(e){return this.keyedMap.get(e)!=null}get(e){return this.keyedMap.get(e)}first(){return this.sortedSet.minKey()}last(){return this.sortedSet.maxKey()}isEmpty(){return this.sortedSet.isEmpty()}indexOf(e){const t=this.keyedMap.get(e);return t?this.sortedSet.indexOf(t):-1}get size(){return this.sortedSet.size}forEach(e){this.sortedSet.inorderTraversal(((t,r)=>(e(t),!1)))}add(e){const t=this.delete(e.key);return t.copy(t.keyedMap.insert(e.key,e),t.sortedSet.insert(e,null))}delete(e){const t=this.get(e);return t?this.copy(this.keyedMap.remove(e),this.sortedSet.remove(t)):this}isEqual(e){if(!(e instanceof Al)||this.size!==e.size)return!1;const t=this.sortedSet.getIterator(),r=e.sortedSet.getIterator();for(;t.hasNext();){const s=t.getNext().key,o=r.getNext().key;if(!s.isEqual(o))return!1}return!0}toString(){const e=[];return this.forEach((t=>{e.push(t.toString())})),e.length===0?"DocumentSet ()":`DocumentSet (
  `+e.join(`  
`)+`
)`}copy(e,t){const r=new Al;return r.comparator=this.comparator,r.keyedMap=e,r.sortedSet=t,r}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class VT{constructor(){this.ga=new $t(be.comparator)}track(e){const t=e.doc.key,r=this.ga.get(t);r?e.type!==0&&r.type===3?this.ga=this.ga.insert(t,e):e.type===3&&r.type!==1?this.ga=this.ga.insert(t,{type:r.type,doc:e.doc}):e.type===2&&r.type===2?this.ga=this.ga.insert(t,{type:2,doc:e.doc}):e.type===2&&r.type===0?this.ga=this.ga.insert(t,{type:0,doc:e.doc}):e.type===1&&r.type===0?this.ga=this.ga.remove(t):e.type===1&&r.type===2?this.ga=this.ga.insert(t,{type:1,doc:r.doc}):e.type===0&&r.type===1?this.ga=this.ga.insert(t,{type:2,doc:e.doc}):Oe(63341,{Rt:e,pa:r}):this.ga=this.ga.insert(t,e)}ya(){const e=[];return this.ga.inorderTraversal(((t,r)=>{e.push(r)})),e}}class $l{constructor(e,t,r,s,o,l,u,h,p){this.query=e,this.docs=t,this.oldDocs=r,this.docChanges=s,this.mutatedKeys=o,this.fromCache=l,this.syncStateChanged=u,this.excludesMetadataChanges=h,this.hasCachedResults=p}static fromInitialDocuments(e,t,r,s,o){const l=[];return t.forEach((u=>{l.push({type:0,doc:u})})),new $l(e,t,Al.emptySet(t),l,r,s,!0,!1,o)}get hasPendingWrites(){return!this.mutatedKeys.isEmpty()}isEqual(e){if(!(this.fromCache===e.fromCache&&this.hasCachedResults===e.hasCachedResults&&this.syncStateChanged===e.syncStateChanged&&this.mutatedKeys.isEqual(e.mutatedKeys)&&Np(this.query,e.query)&&this.docs.isEqual(e.docs)&&this.oldDocs.isEqual(e.oldDocs)))return!1;const t=this.docChanges,r=e.docChanges;if(t.length!==r.length)return!1;for(let s=0;s<t.length;s++)if(t[s].type!==r[s].type||!t[s].doc.isEqual(r[s].doc))return!1;return!0}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class J4{constructor(){this.wa=void 0,this.Sa=[]}ba(){return this.Sa.some((e=>e.Da()))}}class Z4{constructor(){this.queries=FT(),this.onlineState="Unknown",this.Ca=new Set}terminate(){(function(t,r){const s=Be(t),o=s.queries;s.queries=FT(),o.forEach(((l,u)=>{for(const h of u.Sa)h.onError(r)}))})(this,new de(ee.ABORTED,"Firestore shutting down"))}}function FT(){return new _a((n=>nb(n)),Np)}async function fv(n,e){const t=Be(n);let r=3;const s=e.query;let o=t.queries.get(s);o?!o.ba()&&e.Da()&&(r=2):(o=new J4,r=e.Da()?0:1);try{switch(r){case 0:o.wa=await t.onListen(s,!0);break;case 1:o.wa=await t.onListen(s,!1);break;case 2:await t.onFirstRemoteStoreListen(s)}}catch(l){const u=hv(l,`Initialization of query '${El(e.query)}' failed`);return void e.onError(u)}t.queries.set(s,o),o.Sa.push(e),e.va(t.onlineState),o.wa&&e.Fa(o.wa)&&mv(t)}async function pv(n,e){const t=Be(n),r=e.query;let s=3;const o=t.queries.get(r);if(o){const l=o.Sa.indexOf(e);l>=0&&(o.Sa.splice(l,1),o.Sa.length===0?s=e.Da()?0:1:!o.ba()&&e.Da()&&(s=2))}switch(s){case 0:return t.queries.delete(r),t.onUnlisten(r,!0);case 1:return t.queries.delete(r),t.onUnlisten(r,!1);case 2:return t.onLastRemoteStoreUnlisten(r);default:return}}function ej(n,e){const t=Be(n);let r=!1;for(const s of e){const o=s.query,l=t.queries.get(o);if(l){for(const u of l.Sa)u.Fa(s)&&(r=!0);l.wa=s}}r&&mv(t)}function tj(n,e,t){const r=Be(n),s=r.queries.get(e);if(s)for(const o of s.Sa)o.onError(t);r.queries.delete(e)}function mv(n){n.Ca.forEach((e=>{e.next()}))}var Zy,UT;(UT=Zy||(Zy={})).Ma="default",UT.Cache="cache";class gv{constructor(e,t,r){this.query=e,this.xa=t,this.Oa=!1,this.Na=null,this.onlineState="Unknown",this.options=r||{}}Fa(e){if(!this.options.includeMetadataChanges){const r=[];for(const s of e.docChanges)s.type!==3&&r.push(s);e=new $l(e.query,e.docs,e.oldDocs,r,e.mutatedKeys,e.fromCache,e.syncStateChanged,!0,e.hasCachedResults)}let t=!1;return this.Oa?this.Ba(e)&&(this.xa.next(e),t=!0):this.La(e,this.onlineState)&&(this.ka(e),t=!0),this.Na=e,t}onError(e){this.xa.error(e)}va(e){this.onlineState=e;let t=!1;return this.Na&&!this.Oa&&this.La(this.Na,e)&&(this.ka(this.Na),t=!0),t}La(e,t){if(!e.fromCache||!this.Da())return!0;const r=t!=="Offline";return(!this.options.qa||!r)&&(!e.docs.isEmpty()||e.hasCachedResults||t==="Offline")}Ba(e){if(e.docChanges.length>0)return!0;const t=this.Na&&this.Na.hasPendingWrites!==e.hasPendingWrites;return!(!e.syncStateChanged&&!t)&&this.options.includeMetadataChanges===!0}ka(e){e=$l.fromInitialDocuments(e.query,e.docs,e.mutatedKeys,e.fromCache,e.hasCachedResults),this.Oa=!0,this.xa.next(e)}Da(){return this.options.source!==Zy.Cache}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class jb{constructor(e){this.key=e}}class Vb{constructor(e){this.key=e}}class nj{constructor(e,t){this.query=e,this.Ya=t,this.Za=null,this.hasCachedResults=!1,this.current=!1,this.Xa=Je(),this.mutatedKeys=Je(),this.eu=rb(e),this.tu=new Al(this.eu)}get nu(){return this.Ya}ru(e,t){const r=t?t.iu:new VT,s=t?t.tu:this.tu;let o=t?t.mutatedKeys:this.mutatedKeys,l=s,u=!1;const h=this.query.limitType==="F"&&s.size===this.query.limit?s.last():null,p=this.query.limitType==="L"&&s.size===this.query.limit?s.first():null;if(e.inorderTraversal(((g,_)=>{const v=s.get(g),T=Pp(this.query,_)?_:null,A=!!v&&this.mutatedKeys.has(v.key),I=!!T&&(T.hasLocalMutations||this.mutatedKeys.has(T.key)&&T.hasCommittedMutations);let b=!1;v&&T?v.data.isEqual(T.data)?A!==I&&(r.track({type:3,doc:T}),b=!0):this.su(v,T)||(r.track({type:2,doc:T}),b=!0,(h&&this.eu(T,h)>0||p&&this.eu(T,p)<0)&&(u=!0)):!v&&T?(r.track({type:0,doc:T}),b=!0):v&&!T&&(r.track({type:1,doc:v}),b=!0,(h||p)&&(u=!0)),b&&(T?(l=l.add(T),o=I?o.add(g):o.delete(g)):(l=l.delete(g),o=o.delete(g)))})),this.query.limit!==null)for(;l.size>this.query.limit;){const g=this.query.limitType==="F"?l.last():l.first();l=l.delete(g.key),o=o.delete(g.key),r.track({type:1,doc:g})}return{tu:l,iu:r,Cs:u,mutatedKeys:o}}su(e,t){return e.hasLocalMutations&&t.hasCommittedMutations&&!t.hasLocalMutations}applyChanges(e,t,r,s){const o=this.tu;this.tu=e.tu,this.mutatedKeys=e.mutatedKeys;const l=e.iu.ya();l.sort(((g,_)=>(function(T,A){const I=b=>{switch(b){case 0:return 1;case 2:case 3:return 2;case 1:return 0;default:return Oe(20277,{Rt:b})}};return I(T)-I(A)})(g.type,_.type)||this.eu(g.doc,_.doc))),this.ou(r),s=s??!1;const u=t&&!s?this._u():[],h=this.Xa.size===0&&this.current&&!s?1:0,p=h!==this.Za;return this.Za=h,l.length!==0||p?{snapshot:new $l(this.query,e.tu,o,l,e.mutatedKeys,h===0,p,!1,!!r&&r.resumeToken.approximateByteSize()>0),au:u}:{au:u}}va(e){return this.current&&e==="Offline"?(this.current=!1,this.applyChanges({tu:this.tu,iu:new VT,mutatedKeys:this.mutatedKeys,Cs:!1},!1)):{au:[]}}uu(e){return!this.Ya.has(e)&&!!this.tu.has(e)&&!this.tu.get(e).hasLocalMutations}ou(e){e&&(e.addedDocuments.forEach((t=>this.Ya=this.Ya.add(t))),e.modifiedDocuments.forEach((t=>{})),e.removedDocuments.forEach((t=>this.Ya=this.Ya.delete(t))),this.current=e.current)}_u(){if(!this.current)return[];const e=this.Xa;this.Xa=Je(),this.tu.forEach((r=>{this.uu(r.key)&&(this.Xa=this.Xa.add(r.key))}));const t=[];return e.forEach((r=>{this.Xa.has(r)||t.push(new Vb(r))})),this.Xa.forEach((r=>{e.has(r)||t.push(new jb(r))})),t}cu(e){this.Ya=e.Qs,this.Xa=Je();const t=this.ru(e.documents);return this.applyChanges(t,!0)}lu(){return $l.fromInitialDocuments(this.query,this.tu,this.mutatedKeys,this.Za===0,this.hasCachedResults)}}const yv="SyncEngine";class rj{constructor(e,t,r){this.query=e,this.targetId=t,this.view=r}}class sj{constructor(e){this.key=e,this.hu=!1}}class ij{constructor(e,t,r,s,o,l){this.localStore=e,this.remoteStore=t,this.eventManager=r,this.sharedClientState=s,this.currentUser=o,this.maxConcurrentLimboResolutions=l,this.Pu={},this.Tu=new _a((u=>nb(u)),Np),this.Iu=new Map,this.Eu=new Set,this.du=new $t(be.comparator),this.Au=new Map,this.Ru=new rv,this.Vu={},this.mu=new Map,this.fu=Bl.cr(),this.onlineState="Unknown",this.gu=void 0}get isPrimaryClient(){return this.gu===!0}}async function oj(n,e,t=!0){const r=Wb(n);let s;const o=r.Tu.get(e);return o?(r.sharedClientState.addLocalQueryTarget(o.targetId),s=o.view.lu()):s=await Fb(r,e,t,!0),s}async function aj(n,e){const t=Wb(n);await Fb(t,e,!0,!1)}async function Fb(n,e,t,r){const s=await b4(n.localStore,ds(e)),o=s.targetId,l=n.sharedClientState.addLocalQueryTarget(o,t);let u;return r&&(u=await lj(n,e,o,l==="current",s.resumeToken)),n.isPrimaryClient&&t&&Nb(n.remoteStore,s),u}async function lj(n,e,t,r,s){n.pu=(_,v,T)=>(async function(I,b,j,U){let $=b.view.ru(j);$.Cs&&($=await PT(I.localStore,b.query,!1).then((({documents:P})=>b.view.ru(P,$))));const G=U&&U.targetChanges.get(b.targetId),X=U&&U.targetMismatches.get(b.targetId)!=null,ne=b.view.applyChanges($,I.isPrimaryClient,G,X);return BT(I,b.targetId,ne.au),ne.snapshot})(n,_,v,T);const o=await PT(n.localStore,e,!0),l=new nj(e,o.Qs),u=l.ru(o.documents),h=fd.createSynthesizedTargetChangeForCurrentChange(t,r&&n.onlineState!=="Offline",s),p=l.applyChanges(u,n.isPrimaryClient,h);BT(n,t,p.au);const g=new rj(e,t,l);return n.Tu.set(e,g),n.Iu.has(t)?n.Iu.get(t).push(e):n.Iu.set(t,[e]),p.snapshot}async function cj(n,e,t){const r=Be(n),s=r.Tu.get(e),o=r.Iu.get(s.targetId);if(o.length>1)return r.Iu.set(s.targetId,o.filter((l=>!Np(l,e)))),void r.Tu.delete(e);r.isPrimaryClient?(r.sharedClientState.removeLocalQueryTarget(s.targetId),r.sharedClientState.isActiveQueryTarget(s.targetId)||await Xy(r.localStore,s.targetId,!1).then((()=>{r.sharedClientState.clearQueryState(s.targetId),t&&av(r.remoteStore,s.targetId),e_(r,s.targetId)})).catch(rc)):(e_(r,s.targetId),await Xy(r.localStore,s.targetId,!0))}async function uj(n,e){const t=Be(n),r=t.Tu.get(e),s=t.Iu.get(r.targetId);t.isPrimaryClient&&s.length===1&&(t.sharedClientState.removeLocalQueryTarget(r.targetId),av(t.remoteStore,r.targetId))}async function dj(n,e,t){const r=_j(n);try{const s=await(function(l,u){const h=Be(l),p=wt.now(),g=u.reduce(((T,A)=>T.add(A.key)),Je());let _,v;return h.persistence.runTransaction("Locally write mutations","readwrite",(T=>{let A=ni(),I=Je();return h.Ns.getEntries(T,g).next((b=>{A=b,A.forEach(((j,U)=>{U.isValidDocument()||(I=I.add(j))}))})).next((()=>h.localDocuments.getOverlayedDocuments(T,A))).next((b=>{_=b;const j=[];for(const U of u){const $=IL(U,_.get(U.key).overlayedDocument);$!=null&&j.push(new Co(U.key,$,KI($.value.mapValue),Dr.exists(!0)))}return h.mutationQueue.addMutationBatch(T,p,j,u)})).next((b=>{v=b;const j=b.applyToLocalDocumentSet(_,I);return h.documentOverlayCache.saveOverlays(T,b.batchId,j)}))})).then((()=>({batchId:v.batchId,changes:ib(_)})))})(r.localStore,e);r.sharedClientState.addPendingMutation(s.batchId),(function(l,u,h){let p=l.Vu[l.currentUser.toKey()];p||(p=new $t(Xe)),p=p.insert(u,h),l.Vu[l.currentUser.toKey()]=p})(r,s.batchId,t),await md(r,s.changes),await Vp(r.remoteStore)}catch(s){const o=hv(s,"Failed to persist write");t.reject(o)}}async function Ub(n,e){const t=Be(n);try{const r=await C4(t.localStore,e);e.targetChanges.forEach(((s,o)=>{const l=t.Au.get(o);l&&(lt(s.addedDocuments.size+s.modifiedDocuments.size+s.removedDocuments.size<=1,22616),s.addedDocuments.size>0?l.hu=!0:s.modifiedDocuments.size>0?lt(l.hu,14607):s.removedDocuments.size>0&&(lt(l.hu,42227),l.hu=!1))})),await md(t,r,e)}catch(r){await rc(r)}}function zT(n,e,t){const r=Be(n);if(r.isPrimaryClient&&t===0||!r.isPrimaryClient&&t===1){const s=[];r.Tu.forEach(((o,l)=>{const u=l.view.va(e);u.snapshot&&s.push(u.snapshot)})),(function(l,u){const h=Be(l);h.onlineState=u;let p=!1;h.queries.forEach(((g,_)=>{for(const v of _.Sa)v.va(u)&&(p=!0)})),p&&mv(h)})(r.eventManager,e),s.length&&r.Pu.H_(s),r.onlineState=e,r.isPrimaryClient&&r.sharedClientState.setOnlineState(e)}}async function hj(n,e,t){const r=Be(n);r.sharedClientState.updateQueryState(e,"rejected",t);const s=r.Au.get(e),o=s&&s.key;if(o){let l=new $t(be.comparator);l=l.insert(o,wn.newNoDocument(o,Ue.min()));const u=Je().add(o),h=new Mp(Ue.min(),new Map,new $t(Xe),l,u);await Ub(r,h),r.du=r.du.remove(o),r.Au.delete(e),_v(r)}else await Xy(r.localStore,e,!1).then((()=>e_(r,e,t))).catch(rc)}async function fj(n,e){const t=Be(n),r=e.batch.batchId;try{const s=await T4(t.localStore,e);Bb(t,r,null),zb(t,r),t.sharedClientState.updateMutationState(r,"acknowledged"),await md(t,s)}catch(s){await rc(s)}}async function pj(n,e,t){const r=Be(n);try{const s=await(function(l,u){const h=Be(l);return h.persistence.runTransaction("Reject batch","readwrite-primary",(p=>{let g;return h.mutationQueue.lookupMutationBatch(p,u).next((_=>(lt(_!==null,37113),g=_.keys(),h.mutationQueue.removeMutationBatch(p,_)))).next((()=>h.mutationQueue.performConsistencyCheck(p))).next((()=>h.documentOverlayCache.removeOverlaysForBatchId(p,g,u))).next((()=>h.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(p,g))).next((()=>h.localDocuments.getDocuments(p,g)))}))})(r.localStore,e);Bb(r,e,t),zb(r,e),r.sharedClientState.updateMutationState(e,"rejected",t),await md(r,s)}catch(s){await rc(s)}}function zb(n,e){(n.mu.get(e)||[]).forEach((t=>{t.resolve()})),n.mu.delete(e)}function Bb(n,e,t){const r=Be(n);let s=r.Vu[r.currentUser.toKey()];if(s){const o=s.get(e);o&&(t?o.reject(t):o.resolve(),s=s.remove(e)),r.Vu[r.currentUser.toKey()]=s}}function e_(n,e,t=null){n.sharedClientState.removeLocalQueryTarget(e);for(const r of n.Iu.get(e))n.Tu.delete(r),t&&n.Pu.yu(r,t);n.Iu.delete(e),n.isPrimaryClient&&n.Ru.jr(e).forEach((r=>{n.Ru.containsKey(r)||$b(n,r)}))}function $b(n,e){n.Eu.delete(e.path.canonicalString());const t=n.du.get(e);t!==null&&(av(n.remoteStore,t),n.du=n.du.remove(e),n.Au.delete(t),_v(n))}function BT(n,e,t){for(const r of t)r instanceof jb?(n.Ru.addReference(r.key,e),mj(n,r)):r instanceof Vb?(pe(yv,"Document no longer in limbo: "+r.key),n.Ru.removeReference(r.key,e),n.Ru.containsKey(r.key)||$b(n,r.key)):Oe(19791,{wu:r})}function mj(n,e){const t=e.key,r=t.path.canonicalString();n.du.get(t)||n.Eu.has(r)||(pe(yv,"New document in limbo: "+t),n.Eu.add(r),_v(n))}function _v(n){for(;n.Eu.size>0&&n.du.size<n.maxConcurrentLimboResolutions;){const e=n.Eu.values().next().value;n.Eu.delete(e);const t=new be(mt.fromString(e)),r=n.fu.next();n.Au.set(r,new sj(t)),n.du=n.du.insert(t,r),Nb(n.remoteStore,new Yi(ds(kp(t.path)),r,"TargetPurposeLimboResolution",bp.ce))}}async function md(n,e,t){const r=Be(n),s=[],o=[],l=[];r.Tu.isEmpty()||(r.Tu.forEach(((u,h)=>{l.push(r.pu(h,e,t).then((p=>{if((p||t)&&r.isPrimaryClient){const g=p?!p.fromCache:t?.targetChanges.get(h.targetId)?.current;r.sharedClientState.updateQueryState(h.targetId,g?"current":"not-current")}if(p){s.push(p);const g=iv.As(h.targetId,p);o.push(g)}})))})),await Promise.all(l),r.Pu.H_(s),await(async function(h,p){const g=Be(h);try{await g.persistence.runTransaction("notifyLocalViewChanges","readwrite",(_=>te.forEach(p,(v=>te.forEach(v.Es,(T=>g.persistence.referenceDelegate.addReference(_,v.targetId,T))).next((()=>te.forEach(v.ds,(T=>g.persistence.referenceDelegate.removeReference(_,v.targetId,T)))))))))}catch(_){if(!sc(_))throw _;pe(ov,"Failed to update sequence numbers: "+_)}for(const _ of p){const v=_.targetId;if(!_.fromCache){const T=g.Ms.get(v),A=T.snapshotVersion,I=T.withLastLimboFreeSnapshotVersion(A);g.Ms=g.Ms.insert(v,I)}}})(r.localStore,o))}async function gj(n,e){const t=Be(n);if(!t.currentUser.isEqual(e)){pe(yv,"User change. New user:",e.toKey());const r=await bb(t.localStore,e);t.currentUser=e,(function(o,l){o.mu.forEach((u=>{u.forEach((h=>{h.reject(new de(ee.CANCELLED,l))}))})),o.mu.clear()})(t,"'waitForPendingWrites' promise is rejected due to a user change."),t.sharedClientState.handleUserChange(e,r.removedBatchIds,r.addedBatchIds),await md(t,r.Ls)}}function yj(n,e){const t=Be(n),r=t.Au.get(e);if(r&&r.hu)return Je().add(r.key);{let s=Je();const o=t.Iu.get(e);if(!o)return s;for(const l of o){const u=t.Tu.get(l);s=s.unionWith(u.view.nu)}return s}}function Wb(n){const e=Be(n);return e.remoteStore.remoteSyncer.applyRemoteEvent=Ub.bind(null,e),e.remoteStore.remoteSyncer.getRemoteKeysForTarget=yj.bind(null,e),e.remoteStore.remoteSyncer.rejectListen=hj.bind(null,e),e.Pu.H_=ej.bind(null,e.eventManager),e.Pu.yu=tj.bind(null,e.eventManager),e}function _j(n){const e=Be(n);return e.remoteStore.remoteSyncer.applySuccessfulWrite=fj.bind(null,e),e.remoteStore.remoteSyncer.rejectFailedWrite=pj.bind(null,e),e}class Bf{constructor(){this.kind="memory",this.synchronizeTabs=!1}async initialize(e){this.serializer=Lp(e.databaseInfo.databaseId),this.sharedClientState=this.Du(e),this.persistence=this.Cu(e),await this.persistence.start(),this.localStore=this.vu(e),this.gcScheduler=this.Fu(e,this.localStore),this.indexBackfillerScheduler=this.Mu(e,this.localStore)}Fu(e,t){return null}Mu(e,t){return null}vu(e){return x4(this.persistence,new v4,e.initialUser,this.serializer)}Cu(e){return new Ib(sv.mi,this.serializer)}Du(e){return new A4}async terminate(){this.gcScheduler?.stop(),this.indexBackfillerScheduler?.stop(),this.sharedClientState.shutdown(),await this.persistence.shutdown()}}Bf.provider={build:()=>new Bf};class vj extends Bf{constructor(e){super(),this.cacheSizeBytes=e}Fu(e,t){lt(this.persistence.referenceDelegate instanceof Uf,46915);const r=this.persistence.referenceDelegate.garbageCollector;return new s4(r,e.asyncQueue,t)}Cu(e){const t=this.cacheSizeBytes!==void 0?jn.withCacheSize(this.cacheSizeBytes):jn.DEFAULT;return new Ib((r=>Uf.mi(r,t)),this.serializer)}}class t_{async initialize(e,t){this.localStore||(this.localStore=e.localStore,this.sharedClientState=e.sharedClientState,this.datastore=this.createDatastore(t),this.remoteStore=this.createRemoteStore(t),this.eventManager=this.createEventManager(t),this.syncEngine=this.createSyncEngine(t,!e.synchronizeTabs),this.sharedClientState.onlineStateHandler=r=>zT(this.syncEngine,r,1),this.remoteStore.remoteSyncer.handleCredentialChange=gj.bind(null,this.syncEngine),await X4(this.remoteStore,this.syncEngine.isPrimaryClient))}createEventManager(e){return(function(){return new Z4})()}createDatastore(e){const t=Lp(e.databaseInfo.databaseId),r=(function(o){return new O4(o)})(e.databaseInfo);return(function(o,l,u,h){return new V4(o,l,u,h)})(e.authCredentials,e.appCheckCredentials,r,t)}createRemoteStore(e){return(function(r,s,o,l,u){return new U4(r,s,o,l,u)})(this.localStore,this.datastore,e.asyncQueue,(t=>zT(this.syncEngine,t,0)),(function(){return MT.v()?new MT:new k4})())}createSyncEngine(e,t){return(function(s,o,l,u,h,p,g){const _=new ij(s,o,l,u,h,p);return g&&(_.gu=!0),_})(this.localStore,this.remoteStore,this.eventManager,this.sharedClientState,e.initialUser,e.maxConcurrentLimboResolutions,t)}async terminate(){await(async function(t){const r=Be(t);pe(ca,"RemoteStore shutting down."),r.Ea.add(5),await pd(r),r.Aa.shutdown(),r.Ra.set("Unknown")})(this.remoteStore),this.datastore?.terminate(),this.eventManager?.terminate()}}t_.provider={build:()=>new t_};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class vv{constructor(e){this.observer=e,this.muted=!1}next(e){this.muted||this.observer.next&&this.Ou(this.observer.next,e)}error(e){this.muted||(this.observer.error?this.Ou(this.observer.error,e):ti("Uncaught Error in snapshot listener:",e.toString()))}Nu(){this.muted=!0}Ou(e,t){setTimeout((()=>{this.muted||e(t)}),0)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const fo="FirestoreClient";class wj{constructor(e,t,r,s,o){this.authCredentials=e,this.appCheckCredentials=t,this.asyncQueue=r,this.databaseInfo=s,this.user=vn.UNAUTHENTICATED,this.clientId=G_.newId(),this.authCredentialListener=()=>Promise.resolve(),this.appCheckCredentialListener=()=>Promise.resolve(),this._uninitializedComponentsProvider=o,this.authCredentials.start(r,(async l=>{pe(fo,"Received user=",l.uid),await this.authCredentialListener(l),this.user=l})),this.appCheckCredentials.start(r,(l=>(pe(fo,"Received new app check token=",l),this.appCheckCredentialListener(l,this.user))))}get configuration(){return{asyncQueue:this.asyncQueue,databaseInfo:this.databaseInfo,clientId:this.clientId,authCredentials:this.authCredentials,appCheckCredentials:this.appCheckCredentials,initialUser:this.user,maxConcurrentLimboResolutions:100}}setCredentialChangeListener(e){this.authCredentialListener=e}setAppCheckTokenChangeListener(e){this.appCheckCredentialListener=e}terminate(){this.asyncQueue.enterRestrictedMode();const e=new Qs;return this.asyncQueue.enqueueAndForgetEvenWhileRestricted((async()=>{try{this._onlineComponents&&await this._onlineComponents.terminate(),this._offlineComponents&&await this._offlineComponents.terminate(),this.authCredentials.shutdown(),this.appCheckCredentials.shutdown(),e.resolve()}catch(t){const r=hv(t,"Failed to shutdown persistence");e.reject(r)}})),e.promise}}async function oy(n,e){n.asyncQueue.verifyOperationInProgress(),pe(fo,"Initializing OfflineComponentProvider");const t=n.configuration;await e.initialize(t);let r=t.initialUser;n.setCredentialChangeListener((async s=>{r.isEqual(s)||(await bb(e.localStore,s),r=s)})),e.persistence.setDatabaseDeletedListener((()=>n.terminate())),n._offlineComponents=e}async function $T(n,e){n.asyncQueue.verifyOperationInProgress();const t=await Ej(n);pe(fo,"Initializing OnlineComponentProvider"),await e.initialize(t,n.configuration),n.setCredentialChangeListener((r=>jT(e.remoteStore,r))),n.setAppCheckTokenChangeListener(((r,s)=>jT(e.remoteStore,s))),n._onlineComponents=e}async function Ej(n){if(!n._offlineComponents)if(n._uninitializedComponentsProvider){pe(fo,"Using user provided OfflineComponentProvider");try{await oy(n,n._uninitializedComponentsProvider._offline)}catch(e){const t=e;if(!(function(s){return s.name==="FirebaseError"?s.code===ee.FAILED_PRECONDITION||s.code===ee.UNIMPLEMENTED:!(typeof DOMException<"u"&&s instanceof DOMException)||s.code===22||s.code===20||s.code===11})(t))throw t;Vl("Error using user provided cache. Falling back to memory cache: "+t),await oy(n,new Bf)}}else pe(fo,"Using default OfflineComponentProvider"),await oy(n,new vj(void 0));return n._offlineComponents}async function Hb(n){return n._onlineComponents||(n._uninitializedComponentsProvider?(pe(fo,"Using user provided OnlineComponentProvider"),await $T(n,n._uninitializedComponentsProvider._online)):(pe(fo,"Using default OnlineComponentProvider"),await $T(n,new t_))),n._onlineComponents}function xj(n){return Hb(n).then((e=>e.syncEngine))}async function $f(n){const e=await Hb(n),t=e.eventManager;return t.onListen=oj.bind(null,e.syncEngine),t.onUnlisten=cj.bind(null,e.syncEngine),t.onFirstRemoteStoreListen=aj.bind(null,e.syncEngine),t.onLastRemoteStoreUnlisten=uj.bind(null,e.syncEngine),t}function Tj(n,e,t={}){const r=new Qs;return n.asyncQueue.enqueueAndForget((async()=>(function(o,l,u,h,p){const g=new vv({next:v=>{g.Nu(),l.enqueueAndForget((()=>pv(o,_)));const T=v.docs.has(u);!T&&v.fromCache?p.reject(new de(ee.UNAVAILABLE,"Failed to get document because the client is offline.")):T&&v.fromCache&&h&&h.source==="server"?p.reject(new de(ee.UNAVAILABLE,'Failed to get document from server. (However, this document does exist in the local cache. Run again without setting source to "server" to retrieve the cached document.)')):p.resolve(v)},error:v=>p.reject(v)}),_=new gv(kp(u.path),g,{includeMetadataChanges:!0,qa:!0});return fv(o,_)})(await $f(n),n.asyncQueue,e,t,r))),r.promise}function Cj(n,e,t={}){const r=new Qs;return n.asyncQueue.enqueueAndForget((async()=>(function(o,l,u,h,p){const g=new vv({next:v=>{g.Nu(),l.enqueueAndForget((()=>pv(o,_))),v.fromCache&&h.source==="server"?p.reject(new de(ee.UNAVAILABLE,'Failed to get documents from server. (However, these documents may exist in the local cache. Run again without setting source to "server" to retrieve the cached documents.)')):p.resolve(v)},error:v=>p.reject(v)}),_=new gv(u,g,{includeMetadataChanges:!0,qa:!0});return fv(o,_)})(await $f(n),n.asyncQueue,e,t,r))),r.promise}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function qb(n){const e={};return n.timeoutSeconds!==void 0&&(e.timeoutSeconds=n.timeoutSeconds),e}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const WT=new Map;/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Gb="firestore.googleapis.com",HT=!0;class qT{constructor(e){if(e.host===void 0){if(e.ssl!==void 0)throw new de(ee.INVALID_ARGUMENT,"Can't provide ssl option if host option is not set");this.host=Gb,this.ssl=HT}else this.host=e.host,this.ssl=e.ssl??HT;if(this.isUsingEmulator=e.emulatorOptions!==void 0,this.credentials=e.credentials,this.ignoreUndefinedProperties=!!e.ignoreUndefinedProperties,this.localCache=e.localCache,e.cacheSizeBytes===void 0)this.cacheSizeBytes=Sb;else{if(e.cacheSizeBytes!==-1&&e.cacheSizeBytes<n4)throw new de(ee.INVALID_ARGUMENT,"cacheSizeBytes must be at least 1048576");this.cacheSizeBytes=e.cacheSizeBytes}FM("experimentalForceLongPolling",e.experimentalForceLongPolling,"experimentalAutoDetectLongPolling",e.experimentalAutoDetectLongPolling),this.experimentalForceLongPolling=!!e.experimentalForceLongPolling,this.experimentalForceLongPolling?this.experimentalAutoDetectLongPolling=!1:e.experimentalAutoDetectLongPolling===void 0?this.experimentalAutoDetectLongPolling=!0:this.experimentalAutoDetectLongPolling=!!e.experimentalAutoDetectLongPolling,this.experimentalLongPollingOptions=qb(e.experimentalLongPollingOptions??{}),(function(r){if(r.timeoutSeconds!==void 0){if(isNaN(r.timeoutSeconds))throw new de(ee.INVALID_ARGUMENT,`invalid long polling timeout: ${r.timeoutSeconds} (must not be NaN)`);if(r.timeoutSeconds<5)throw new de(ee.INVALID_ARGUMENT,`invalid long polling timeout: ${r.timeoutSeconds} (minimum allowed value is 5)`);if(r.timeoutSeconds>30)throw new de(ee.INVALID_ARGUMENT,`invalid long polling timeout: ${r.timeoutSeconds} (maximum allowed value is 30)`)}})(this.experimentalLongPollingOptions),this.useFetchStreams=!!e.useFetchStreams}isEqual(e){return this.host===e.host&&this.ssl===e.ssl&&this.credentials===e.credentials&&this.cacheSizeBytes===e.cacheSizeBytes&&this.experimentalForceLongPolling===e.experimentalForceLongPolling&&this.experimentalAutoDetectLongPolling===e.experimentalAutoDetectLongPolling&&(function(r,s){return r.timeoutSeconds===s.timeoutSeconds})(this.experimentalLongPollingOptions,e.experimentalLongPollingOptions)&&this.ignoreUndefinedProperties===e.ignoreUndefinedProperties&&this.useFetchStreams===e.useFetchStreams}}class Fp{constructor(e,t,r,s){this._authCredentials=e,this._appCheckCredentials=t,this._databaseId=r,this._app=s,this.type="firestore-lite",this._persistenceKey="(lite)",this._settings=new qT({}),this._settingsFrozen=!1,this._emulatorOptions={},this._terminateTask="notTerminated"}get app(){if(!this._app)throw new de(ee.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this._app}get _initialized(){return this._settingsFrozen}get _terminated(){return this._terminateTask!=="notTerminated"}_setSettings(e){if(this._settingsFrozen)throw new de(ee.FAILED_PRECONDITION,"Firestore has already been started and its settings can no longer be changed. You can only modify settings before calling any other methods on a Firestore object.");this._settings=new qT(e),this._emulatorOptions=e.emulatorOptions||{},e.credentials!==void 0&&(this._authCredentials=(function(r){if(!r)return new AM;switch(r.type){case"firstParty":return new DM(r.sessionIndex||"0",r.iamToken||null,r.authTokenFactory||null);case"provider":return r.client;default:throw new de(ee.INVALID_ARGUMENT,"makeAuthCredentialsProvider failed due to invalid credential type")}})(e.credentials))}_getSettings(){return this._settings}_getEmulatorOptions(){return this._emulatorOptions}_freezeSettings(){return this._settingsFrozen=!0,this._settings}_delete(){return this._terminateTask==="notTerminated"&&(this._terminateTask=this._terminate()),this._terminateTask}async _restart(){this._terminateTask==="notTerminated"?await this._terminate():this._terminateTask="notTerminated"}toJSON(){return{app:this._app,databaseId:this._databaseId,settings:this._settings}}_terminate(){return(function(t){const r=WT.get(t);r&&(pe("ComponentProvider","Removing Datastore"),WT.delete(t),r.terminate())})(this),Promise.resolve()}}function Sj(n,e,t,r={}){n=er(n,Fp);const s=vs(e),o=n._getSettings(),l={...o,emulatorOptions:n._getEmulatorOptions()},u=`${e}:${t}`;s&&(_p(`https://${u}`),vp("Firestore",!0)),o.host!==Gb&&o.host!==u&&Vl("Host has been set in both settings() and connectFirestoreEmulator(), emulator host will be used.");const h={...o,host:u,ssl:s,emulatorOptions:r};if(!io(h,l)&&(n._setSettings(h),r.mockUserToken)){let p,g;if(typeof r.mockUserToken=="string")p=r.mockUserToken,g=vn.MOCK_USER;else{p=M_(r.mockUserToken,n._app?.options.projectId);const _=r.mockUserToken.sub||r.mockUserToken.user_id;if(!_)throw new de(ee.INVALID_ARGUMENT,"mockUserToken must contain 'sub' or 'user_id' field!");g=new vn(_)}n._authCredentials=new kM(new LI(p,g))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ai{constructor(e,t,r){this.converter=t,this._query=r,this.type="query",this.firestore=e}withConverter(e){return new ai(this.firestore,e,this._query)}}class At{constructor(e,t,r){this.converter=t,this._key=r,this.type="document",this.firestore=e}get _path(){return this._key.path}get id(){return this._key.path.lastSegment()}get path(){return this._key.path.canonicalString()}get parent(){return new to(this.firestore,this.converter,this._key.path.popLast())}withConverter(e){return new At(this.firestore,e,this._key)}toJSON(){return{type:At._jsonSchemaVersion,referencePath:this._key.toString()}}static fromJSON(e,t,r){if(dd(t,At._jsonSchema))return new At(e,r||null,new be(mt.fromString(t.referencePath)))}}At._jsonSchemaVersion="firestore/documentReference/1.0",At._jsonSchema={type:Bt("string",At._jsonSchemaVersion),referencePath:Bt("string")};class to extends ai{constructor(e,t,r){super(e,t,kp(r)),this._path=r,this.type="collection"}get id(){return this._query.path.lastSegment()}get path(){return this._query.path.canonicalString()}get parent(){const e=this._path.popLast();return e.isEmpty()?null:new At(this.firestore,null,new be(e))}withConverter(e){return new to(this.firestore,e,this._path)}}function ys(n,e,...t){if(n=ut(n),jI("collection","path",e),n instanceof Fp){const r=mt.fromString(e,...t);return iT(r),new to(n,null,r)}{if(!(n instanceof At||n instanceof to))throw new de(ee.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const r=n._path.child(mt.fromString(e,...t));return iT(r),new to(n.firestore,null,r)}}function li(n,e,...t){if(n=ut(n),arguments.length===1&&(e=G_.newId()),jI("doc","path",e),n instanceof Fp){const r=mt.fromString(e,...t);return sT(r),new At(n,null,new be(r))}{if(!(n instanceof At||n instanceof to))throw new de(ee.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const r=n._path.child(mt.fromString(e,...t));return sT(r),new At(n.firestore,n instanceof to?n.converter:null,new be(r))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const GT="AsyncQueue";class KT{constructor(e=Promise.resolve()){this.Xu=[],this.ec=!1,this.tc=[],this.nc=null,this.rc=!1,this.sc=!1,this.oc=[],this.M_=new Ab(this,"async_queue_retry"),this._c=()=>{const r=iy();r&&pe(GT,"Visibility state changed to "+r.visibilityState),this.M_.w_()},this.ac=e;const t=iy();t&&typeof t.addEventListener=="function"&&t.addEventListener("visibilitychange",this._c)}get isShuttingDown(){return this.ec}enqueueAndForget(e){this.enqueue(e)}enqueueAndForgetEvenWhileRestricted(e){this.uc(),this.cc(e)}enterRestrictedMode(e){if(!this.ec){this.ec=!0,this.sc=e||!1;const t=iy();t&&typeof t.removeEventListener=="function"&&t.removeEventListener("visibilitychange",this._c)}}enqueue(e){if(this.uc(),this.ec)return new Promise((()=>{}));const t=new Qs;return this.cc((()=>this.ec&&this.sc?Promise.resolve():(e().then(t.resolve,t.reject),t.promise))).then((()=>t.promise))}enqueueRetryable(e){this.enqueueAndForget((()=>(this.Xu.push(e),this.lc())))}async lc(){if(this.Xu.length!==0){try{await this.Xu[0](),this.Xu.shift(),this.M_.reset()}catch(e){if(!sc(e))throw e;pe(GT,"Operation failed with retryable error: "+e)}this.Xu.length>0&&this.M_.p_((()=>this.lc()))}}cc(e){const t=this.ac.then((()=>(this.rc=!0,e().catch((r=>{throw this.nc=r,this.rc=!1,ti("INTERNAL UNHANDLED ERROR: ",QT(r)),r})).then((r=>(this.rc=!1,r))))));return this.ac=t,t}enqueueAfterDelay(e,t,r){this.uc(),this.oc.indexOf(e)>-1&&(t=0);const s=dv.createAndSchedule(this,e,t,r,(o=>this.hc(o)));return this.tc.push(s),s}uc(){this.nc&&Oe(47125,{Pc:QT(this.nc)})}verifyOperationInProgress(){}async Tc(){let e;do e=this.ac,await e;while(e!==this.ac)}Ic(e){for(const t of this.tc)if(t.timerId===e)return!0;return!1}Ec(e){return this.Tc().then((()=>{this.tc.sort(((t,r)=>t.targetTimeMs-r.targetTimeMs));for(const t of this.tc)if(t.skipDelay(),e!=="all"&&t.timerId===e)break;return this.Tc()}))}dc(e){this.oc.push(e)}hc(e){const t=this.tc.indexOf(e);this.tc.splice(t,1)}}function QT(n){let e=n.message||"";return n.stack&&(e=n.stack.includes(n.message)?n.stack:n.message+`
`+n.stack),e}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function YT(n){return(function(t,r){if(typeof t!="object"||t===null)return!1;const s=t;for(const o of r)if(o in s&&typeof s[o]=="function")return!0;return!1})(n,["next","error","complete"])}class po extends Fp{constructor(e,t,r,s){super(e,t,r,s),this.type="firestore",this._queue=new KT,this._persistenceKey=s?.name||"[DEFAULT]"}async _terminate(){if(this._firestoreClient){const e=this._firestoreClient.terminate();this._queue=new KT(e),this._firestoreClient=void 0,await e}}}function Ij(n,e){const t=typeof n=="object"?n:xp(),r=typeof n=="string"?n:Of,s=od(t,"firestore").getImmediate({identifier:r});if(!s._initialized){const o=O_("firestore");o&&Sj(s,...o)}return s}function Up(n){if(n._terminated)throw new de(ee.FAILED_PRECONDITION,"The client has already been terminated.");return n._firestoreClient||bj(n),n._firestoreClient}function bj(n){const e=n._freezeSettings(),t=(function(s,o,l,u){return new YM(s,o,l,u.host,u.ssl,u.experimentalForceLongPolling,u.experimentalAutoDetectLongPolling,qb(u.experimentalLongPollingOptions),u.useFetchStreams,u.isUsingEmulator)})(n._databaseId,n._app?.options.appId||"",n._persistenceKey,e);n._componentsProvider||e.localCache?._offlineComponentProvider&&e.localCache?._onlineComponentProvider&&(n._componentsProvider={_offline:e.localCache._offlineComponentProvider,_online:e.localCache._onlineComponentProvider}),n._firestoreClient=new wj(n._authCredentials,n._appCheckCredentials,n._queue,t,n._componentsProvider&&(function(s){const o=s?._online.build();return{_offline:s?._offline.build(o),_online:o}})(n._componentsProvider))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class pr{constructor(e){this._byteString=e}static fromBase64String(e){try{return new pr(dn.fromBase64String(e))}catch(t){throw new de(ee.INVALID_ARGUMENT,"Failed to construct data from Base64 string: "+t)}}static fromUint8Array(e){return new pr(dn.fromUint8Array(e))}toBase64(){return this._byteString.toBase64()}toUint8Array(){return this._byteString.toUint8Array()}toString(){return"Bytes(base64: "+this.toBase64()+")"}isEqual(e){return this._byteString.isEqual(e._byteString)}toJSON(){return{type:pr._jsonSchemaVersion,bytes:this.toBase64()}}static fromJSON(e){if(dd(e,pr._jsonSchema))return pr.fromBase64String(e.bytes)}}pr._jsonSchemaVersion="firestore/bytes/1.0",pr._jsonSchema={type:Bt("string",pr._jsonSchemaVersion),bytes:Bt("string")};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class zp{constructor(...e){for(let t=0;t<e.length;++t)if(e[t].length===0)throw new de(ee.INVALID_ARGUMENT,"Invalid field name at argument $(i + 1). Field names must not be empty.");this._internalPath=new cn(e)}isEqual(e){return this._internalPath.isEqual(e._internalPath)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Bp{constructor(e){this._methodName=e}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class fs{constructor(e,t){if(!isFinite(e)||e<-90||e>90)throw new de(ee.INVALID_ARGUMENT,"Latitude must be a number between -90 and 90, but was: "+e);if(!isFinite(t)||t<-180||t>180)throw new de(ee.INVALID_ARGUMENT,"Longitude must be a number between -180 and 180, but was: "+t);this._lat=e,this._long=t}get latitude(){return this._lat}get longitude(){return this._long}isEqual(e){return this._lat===e._lat&&this._long===e._long}_compareTo(e){return Xe(this._lat,e._lat)||Xe(this._long,e._long)}toJSON(){return{latitude:this._lat,longitude:this._long,type:fs._jsonSchemaVersion}}static fromJSON(e){if(dd(e,fs._jsonSchema))return new fs(e.latitude,e.longitude)}}fs._jsonSchemaVersion="firestore/geoPoint/1.0",fs._jsonSchema={type:Bt("string",fs._jsonSchemaVersion),latitude:Bt("number"),longitude:Bt("number")};/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ps{constructor(e){this._values=(e||[]).map((t=>t))}toArray(){return this._values.map((e=>e))}isEqual(e){return(function(r,s){if(r.length!==s.length)return!1;for(let o=0;o<r.length;++o)if(r[o]!==s[o])return!1;return!0})(this._values,e._values)}toJSON(){return{type:ps._jsonSchemaVersion,vectorValues:this._values}}static fromJSON(e){if(dd(e,ps._jsonSchema)){if(Array.isArray(e.vectorValues)&&e.vectorValues.every((t=>typeof t=="number")))return new ps(e.vectorValues);throw new de(ee.INVALID_ARGUMENT,"Expected 'vectorValues' field to be a number array")}}}ps._jsonSchemaVersion="firestore/vectorValue/1.0",ps._jsonSchema={type:Bt("string",ps._jsonSchemaVersion),vectorValues:Bt("object")};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Rj=/^__.*__$/;class Aj{constructor(e,t,r){this.data=e,this.fieldMask=t,this.fieldTransforms=r}toMutation(e,t){return this.fieldMask!==null?new Co(e,this.data,this.fieldMask,t,this.fieldTransforms):new hd(e,this.data,t,this.fieldTransforms)}}class Kb{constructor(e,t,r){this.data=e,this.fieldMask=t,this.fieldTransforms=r}toMutation(e,t){return new Co(e,this.data,this.fieldMask,t,this.fieldTransforms)}}function Qb(n){switch(n){case 0:case 2:case 1:return!0;case 3:case 4:return!1;default:throw Oe(40011,{Ac:n})}}class wv{constructor(e,t,r,s,o,l){this.settings=e,this.databaseId=t,this.serializer=r,this.ignoreUndefinedProperties=s,o===void 0&&this.Rc(),this.fieldTransforms=o||[],this.fieldMask=l||[]}get path(){return this.settings.path}get Ac(){return this.settings.Ac}Vc(e){return new wv({...this.settings,...e},this.databaseId,this.serializer,this.ignoreUndefinedProperties,this.fieldTransforms,this.fieldMask)}mc(e){const t=this.path?.child(e),r=this.Vc({path:t,fc:!1});return r.gc(e),r}yc(e){const t=this.path?.child(e),r=this.Vc({path:t,fc:!1});return r.Rc(),r}wc(e){return this.Vc({path:void 0,fc:!0})}Sc(e){return Wf(e,this.settings.methodName,this.settings.bc||!1,this.path,this.settings.Dc)}contains(e){return this.fieldMask.find((t=>e.isPrefixOf(t)))!==void 0||this.fieldTransforms.find((t=>e.isPrefixOf(t.field)))!==void 0}Rc(){if(this.path)for(let e=0;e<this.path.length;e++)this.gc(this.path.get(e))}gc(e){if(e.length===0)throw this.Sc("Document fields must not be empty");if(Qb(this.Ac)&&Rj.test(e))throw this.Sc('Document fields cannot begin and end with "__"')}}class kj{constructor(e,t,r){this.databaseId=e,this.ignoreUndefinedProperties=t,this.serializer=r||Lp(e)}Cc(e,t,r,s=!1){return new wv({Ac:e,methodName:t,Dc:r,path:cn.emptyPath(),fc:!1,bc:s},this.databaseId,this.serializer,this.ignoreUndefinedProperties)}}function $p(n){const e=n._freezeSettings(),t=Lp(n._databaseId);return new kj(n._databaseId,!!e.ignoreUndefinedProperties,t)}function Yb(n,e,t,r,s,o={}){const l=n.Cc(o.merge||o.mergeFields?2:0,e,t,s);xv("Data must be an object, but it was:",l,r);const u=Xb(r,l);let h,p;if(o.merge)h=new Jn(l.fieldMask),p=l.fieldTransforms;else if(o.mergeFields){const g=[];for(const _ of o.mergeFields){const v=n_(e,_,t);if(!l.contains(v))throw new de(ee.INVALID_ARGUMENT,`Field '${v}' is specified in your field mask but missing from your input data.`);Zb(g,v)||g.push(v)}h=new Jn(g),p=l.fieldTransforms.filter((_=>h.covers(_.field)))}else h=null,p=l.fieldTransforms;return new Aj(new Vn(u),h,p)}class Wp extends Bp{_toFieldTransform(e){if(e.Ac!==2)throw e.Ac===1?e.Sc(`${this._methodName}() can only appear at the top level of your update data`):e.Sc(`${this._methodName}() cannot be used with set() unless you pass {merge:true}`);return e.fieldMask.push(e.path),null}isEqual(e){return e instanceof Wp}}class Ev extends Bp{_toFieldTransform(e){return new xL(e.path,new Wu)}isEqual(e){return e instanceof Ev}}function Nj(n,e,t,r){const s=n.Cc(1,e,t);xv("Data must be an object, but it was:",s,r);const o=[],l=Vn.empty();To(r,((h,p)=>{const g=Tv(e,h,t);p=ut(p);const _=s.yc(g);if(p instanceof Wp)o.push(g);else{const v=gd(p,_);v!=null&&(o.push(g),l.set(g,v))}}));const u=new Jn(o);return new Kb(l,u,s.fieldTransforms)}function Pj(n,e,t,r,s,o){const l=n.Cc(1,e,t),u=[n_(e,r,t)],h=[s];if(o.length%2!=0)throw new de(ee.INVALID_ARGUMENT,`Function ${e}() needs to be called with an even number of arguments that alternate between field names and values.`);for(let v=0;v<o.length;v+=2)u.push(n_(e,o[v])),h.push(o[v+1]);const p=[],g=Vn.empty();for(let v=u.length-1;v>=0;--v)if(!Zb(p,u[v])){const T=u[v];let A=h[v];A=ut(A);const I=l.yc(T);if(A instanceof Wp)p.push(T);else{const b=gd(A,I);b!=null&&(p.push(T),g.set(T,b))}}const _=new Jn(p);return new Kb(g,_,l.fieldTransforms)}function Dj(n,e,t,r=!1){return gd(t,n.Cc(r?4:3,e))}function gd(n,e){if(Jb(n=ut(n)))return xv("Unsupported field value:",e,n),Xb(n,e);if(n instanceof Bp)return(function(r,s){if(!Qb(s.Ac))throw s.Sc(`${r._methodName}() can only be used with update() and set()`);if(!s.path)throw s.Sc(`${r._methodName}() is not currently supported inside arrays`);const o=r._toFieldTransform(s);o&&s.fieldTransforms.push(o)})(n,e),null;if(n===void 0&&e.ignoreUndefinedProperties)return null;if(e.path&&e.fieldMask.push(e.path),n instanceof Array){if(e.settings.fc&&e.Ac!==4)throw e.Sc("Nested arrays are not supported");return(function(r,s){const o=[];let l=0;for(const u of r){let h=gd(u,s.wc(l));h==null&&(h={nullValue:"NULL_VALUE"}),o.push(h),l++}return{arrayValue:{values:o}}})(n,e)}return(function(r,s){if((r=ut(r))===null)return{nullValue:"NULL_VALUE"};if(typeof r=="number")return vL(s.serializer,r);if(typeof r=="boolean")return{booleanValue:r};if(typeof r=="string")return{stringValue:r};if(r instanceof Date){const o=wt.fromDate(r);return{timestampValue:Ff(s.serializer,o)}}if(r instanceof wt){const o=new wt(r.seconds,1e3*Math.floor(r.nanoseconds/1e3));return{timestampValue:Ff(s.serializer,o)}}if(r instanceof fs)return{geoPointValue:{latitude:r.latitude,longitude:r.longitude}};if(r instanceof pr)return{bytesValue:_b(s.serializer,r._byteString)};if(r instanceof At){const o=s.databaseId,l=r.firestore._databaseId;if(!l.isEqual(o))throw s.Sc(`Document reference is for database ${l.projectId}/${l.database} but should be for database ${o.projectId}/${o.database}`);return{referenceValue:nv(r.firestore._databaseId||s.databaseId,r._key.path)}}if(r instanceof ps)return(function(l,u){return{mapValue:{fields:{[qI]:{stringValue:GI},[Mf]:{arrayValue:{values:l.toArray().map((p=>{if(typeof p!="number")throw u.Sc("VectorValues must only contain numeric values.");return Z_(u.serializer,p)}))}}}}}})(r,s);throw s.Sc(`Unsupported field value: ${Ip(r)}`)})(n,e)}function Xb(n,e){const t={};return UI(n)?e.path&&e.path.length>0&&e.fieldMask.push(e.path):To(n,((r,s)=>{const o=gd(s,e.mc(r));o!=null&&(t[r]=o)})),{mapValue:{fields:t}}}function Jb(n){return!(typeof n!="object"||n===null||n instanceof Array||n instanceof Date||n instanceof wt||n instanceof fs||n instanceof pr||n instanceof At||n instanceof Bp||n instanceof ps)}function xv(n,e,t){if(!Jb(t)||!VI(t)){const r=Ip(t);throw r==="an object"?e.Sc(n+" a custom object"):e.Sc(n+" "+r)}}function n_(n,e,t){if((e=ut(e))instanceof zp)return e._internalPath;if(typeof e=="string")return Tv(n,e);throw Wf("Field path arguments must be of type string or ",n,!1,void 0,t)}const Oj=new RegExp("[~\\*/\\[\\]]");function Tv(n,e,t){if(e.search(Oj)>=0)throw Wf(`Invalid field path (${e}). Paths must not contain '~', '*', '/', '[', or ']'`,n,!1,void 0,t);try{return new zp(...e.split("."))._internalPath}catch{throw Wf(`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`,n,!1,void 0,t)}}function Wf(n,e,t,r,s){const o=r&&!r.isEmpty(),l=s!==void 0;let u=`Function ${e}() called with invalid data`;t&&(u+=" (via `toFirestore()`)"),u+=". ";let h="";return(o||l)&&(h+=" (found",o&&(h+=` in field ${r}`),l&&(h+=` in document ${s}`),h+=")"),new de(ee.INVALID_ARGUMENT,u+n+h)}function Zb(n,e){return n.some((t=>t.isEqual(e)))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class eR{constructor(e,t,r,s,o){this._firestore=e,this._userDataWriter=t,this._key=r,this._document=s,this._converter=o}get id(){return this._key.path.lastSegment()}get ref(){return new At(this._firestore,this._converter,this._key)}exists(){return this._document!==null}data(){if(this._document){if(this._converter){const e=new Mj(this._firestore,this._userDataWriter,this._key,this._document,null);return this._converter.fromFirestore(e)}return this._userDataWriter.convertValue(this._document.data.value)}}get(e){if(this._document){const t=this._document.data.field(Hp("DocumentSnapshot.get",e));if(t!==null)return this._userDataWriter.convertValue(t)}}}class Mj extends eR{data(){return super.data()}}function Hp(n,e){return typeof e=="string"?Tv(n,e):e instanceof zp?e._internalPath:e._delegate._internalPath}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function tR(n){if(n.limitType==="L"&&n.explicitOrderBy.length===0)throw new de(ee.UNIMPLEMENTED,"limitToLast() queries require specifying at least one orderBy() clause")}class Cv{}class Sv extends Cv{}function Wl(n,e,...t){let r=[];e instanceof Cv&&r.push(e),r=r.concat(t),(function(o){const l=o.filter((h=>h instanceof Iv)).length,u=o.filter((h=>h instanceof qp)).length;if(l>1||l>0&&u>0)throw new de(ee.INVALID_ARGUMENT,"InvalidQuery. When using composite filters, you cannot use more than one filter at the top level. Consider nesting the multiple filters within an `and(...)` statement. For example: change `query(query, where(...), or(...))` to `query(query, and(where(...), or(...)))`.")})(r);for(const s of r)n=s._apply(n);return n}class qp extends Sv{constructor(e,t,r){super(),this._field=e,this._op=t,this._value=r,this.type="where"}static _create(e,t,r){return new qp(e,t,r)}_apply(e){const t=this._parse(e);return nR(e._query,t),new ai(e.firestore,e.converter,qy(e._query,t))}_parse(e){const t=$p(e.firestore);return(function(o,l,u,h,p,g,_){let v;if(p.isKeyField()){if(g==="array-contains"||g==="array-contains-any")throw new de(ee.INVALID_ARGUMENT,`Invalid Query. You can't perform '${g}' queries on documentId().`);if(g==="in"||g==="not-in"){JT(_,g);const A=[];for(const I of _)A.push(XT(h,o,I));v={arrayValue:{values:A}}}else v=XT(h,o,_)}else g!=="in"&&g!=="not-in"&&g!=="array-contains-any"||JT(_,g),v=Dj(u,l,_,g==="in"||g==="not-in");return zt.create(p,g,v)})(e._query,"where",t,e.firestore._databaseId,this._field,this._op,this._value)}}function Ru(n,e,t){const r=e,s=Hp("where",n);return qp._create(s,r,t)}class Iv extends Cv{constructor(e,t){super(),this.type=e,this._queryConstraints=t}static _create(e,t){return new Iv(e,t)}_parse(e){const t=this._queryConstraints.map((r=>r._parse(e))).filter((r=>r.getFilters().length>0));return t.length===1?t[0]:Lr.create(t,this._getOperator())}_apply(e){const t=this._parse(e);return t.getFilters().length===0?e:((function(s,o){let l=s;const u=o.getFlattenedFilters();for(const h of u)nR(l,h),l=qy(l,h)})(e._query,t),new ai(e.firestore,e.converter,qy(e._query,t)))}_getQueryConstraints(){return this._queryConstraints}_getOperator(){return this.type==="and"?"and":"or"}}class bv extends Sv{constructor(e,t){super(),this._field=e,this._direction=t,this.type="orderBy"}static _create(e,t){return new bv(e,t)}_apply(e){const t=(function(s,o,l){if(s.startAt!==null)throw new de(ee.INVALID_ARGUMENT,"Invalid query. You must not call startAt() or startAfter() before calling orderBy().");if(s.endAt!==null)throw new de(ee.INVALID_ARGUMENT,"Invalid query. You must not call endAt() or endBefore() before calling orderBy().");return new $u(o,l)})(e._query,this._field,this._direction);return new ai(e.firestore,e.converter,(function(s,o){const l=s.explicitOrderBy.concat([o]);return new ic(s.path,s.collectionGroup,l,s.filters.slice(),s.limit,s.limitType,s.startAt,s.endAt)})(e._query,t))}}function Gp(n,e="asc"){const t=e,r=Hp("orderBy",n);return bv._create(r,t)}class Rv extends Sv{constructor(e,t,r){super(),this.type=e,this._limit=t,this._limitType=r}static _create(e,t,r){return new Rv(e,t,r)}_apply(e){return new ai(e.firestore,e.converter,jf(e._query,this._limit,this._limitType))}}function Lj(n){return Rv._create("limit",n,"F")}function XT(n,e,t){if(typeof(t=ut(t))=="string"){if(t==="")throw new de(ee.INVALID_ARGUMENT,"Invalid query. When querying with documentId(), you must provide a valid document ID, but it was an empty string.");if(!tb(e)&&t.indexOf("/")!==-1)throw new de(ee.INVALID_ARGUMENT,`Invalid query. When querying a collection by documentId(), you must provide a plain document ID, but '${t}' contains a '/' character.`);const r=e.path.child(mt.fromString(t));if(!be.isDocumentKey(r))throw new de(ee.INVALID_ARGUMENT,`Invalid query. When querying a collection group by documentId(), the value provided must result in a valid document path, but '${r}' is not because it has an odd number of segments (${r.length}).`);return fT(n,new be(r))}if(t instanceof At)return fT(n,t._key);throw new de(ee.INVALID_ARGUMENT,`Invalid query. When querying with documentId(), you must provide a valid string or a DocumentReference, but it was: ${Ip(t)}.`)}function JT(n,e){if(!Array.isArray(n)||n.length===0)throw new de(ee.INVALID_ARGUMENT,`Invalid Query. A non-empty array is required for '${e.toString()}' filters.`)}function nR(n,e){const t=(function(s,o){for(const l of s)for(const u of l.getFlattenedFilters())if(o.indexOf(u.op)>=0)return u.op;return null})(n.filters,(function(s){switch(s){case"!=":return["!=","not-in"];case"array-contains-any":case"in":return["not-in"];case"not-in":return["array-contains-any","in","not-in","!="];default:return[]}})(e.op));if(t!==null)throw t===e.op?new de(ee.INVALID_ARGUMENT,`Invalid query. You cannot use more than one '${e.op.toString()}' filter.`):new de(ee.INVALID_ARGUMENT,`Invalid query. You cannot use '${e.op.toString()}' filters with '${t.toString()}' filters.`)}class jj{convertValue(e,t="none"){switch(uo(e)){case 0:return null;case 1:return e.booleanValue;case 2:return Ot(e.integerValue||e.doubleValue);case 3:return this.convertTimestamp(e.timestampValue);case 4:return this.convertServerTimestamp(e,t);case 5:return e.stringValue;case 6:return this.convertBytes(co(e.bytesValue));case 7:return this.convertReference(e.referenceValue);case 8:return this.convertGeoPoint(e.geoPointValue);case 9:return this.convertArray(e.arrayValue,t);case 11:return this.convertObject(e.mapValue,t);case 10:return this.convertVectorValue(e.mapValue);default:throw Oe(62114,{value:e})}}convertObject(e,t){return this.convertObjectMap(e.fields,t)}convertObjectMap(e,t="none"){const r={};return To(e,((s,o)=>{r[s]=this.convertValue(o,t)})),r}convertVectorValue(e){const t=e.fields?.[Mf].arrayValue?.values?.map((r=>Ot(r.doubleValue)));return new ps(t)}convertGeoPoint(e){return new fs(Ot(e.latitude),Ot(e.longitude))}convertArray(e,t){return(e.values||[]).map((r=>this.convertValue(r,t)))}convertServerTimestamp(e,t){switch(t){case"previous":const r=Ap(e);return r==null?null:this.convertValue(r,t);case"estimate":return this.convertTimestamp(Uu(e));default:return null}}convertTimestamp(e){const t=lo(e);return new wt(t.seconds,t.nanos)}convertDocumentKey(e,t){const r=mt.fromString(e);lt(Cb(r),9688,{name:e});const s=new zu(r.get(1),r.get(3)),o=new be(r.popFirst(5));return s.isEqual(t)||ti(`Document ${o} contains a document reference within a different database (${s.projectId}/${s.database}) which is not supported. It will be treated as a reference in the current database (${t.projectId}/${t.database}) instead.`),o}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function rR(n,e,t){let r;return r=n?n.toFirestore(e):e,r}class vu{constructor(e,t){this.hasPendingWrites=e,this.fromCache=t}isEqual(e){return this.hasPendingWrites===e.hasPendingWrites&&this.fromCache===e.fromCache}}class sa extends eR{constructor(e,t,r,s,o,l){super(e,t,r,s,l),this._firestore=e,this._firestoreImpl=e,this.metadata=o}exists(){return super.exists()}data(e={}){if(this._document){if(this._converter){const t=new gf(this._firestore,this._userDataWriter,this._key,this._document,this.metadata,null);return this._converter.fromFirestore(t,e)}return this._userDataWriter.convertValue(this._document.data.value,e.serverTimestamps)}}get(e,t={}){if(this._document){const r=this._document.data.field(Hp("DocumentSnapshot.get",e));if(r!==null)return this._userDataWriter.convertValue(r,t.serverTimestamps)}}toJSON(){if(this.metadata.hasPendingWrites)throw new de(ee.FAILED_PRECONDITION,"DocumentSnapshot.toJSON() attempted to serialize a document with pending writes. Await waitForPendingWrites() before invoking toJSON().");const e=this._document,t={};return t.type=sa._jsonSchemaVersion,t.bundle="",t.bundleSource="DocumentSnapshot",t.bundleName=this._key.toString(),!e||!e.isValidDocument()||!e.isFoundDocument()?t:(this._userDataWriter.convertObjectMap(e.data.value.mapValue.fields,"previous"),t.bundle=(this._firestore,this.ref.path,"NOT SUPPORTED"),t)}}sa._jsonSchemaVersion="firestore/documentSnapshot/1.0",sa._jsonSchema={type:Bt("string",sa._jsonSchemaVersion),bundleSource:Bt("string","DocumentSnapshot"),bundleName:Bt("string"),bundle:Bt("string")};class gf extends sa{data(e={}){return super.data(e)}}class ia{constructor(e,t,r,s){this._firestore=e,this._userDataWriter=t,this._snapshot=s,this.metadata=new vu(s.hasPendingWrites,s.fromCache),this.query=r}get docs(){const e=[];return this.forEach((t=>e.push(t))),e}get size(){return this._snapshot.docs.size}get empty(){return this.size===0}forEach(e,t){this._snapshot.docs.forEach((r=>{e.call(t,new gf(this._firestore,this._userDataWriter,r.key,r,new vu(this._snapshot.mutatedKeys.has(r.key),this._snapshot.fromCache),this.query.converter))}))}docChanges(e={}){const t=!!e.includeMetadataChanges;if(t&&this._snapshot.excludesMetadataChanges)throw new de(ee.INVALID_ARGUMENT,"To include metadata changes with your document changes, you must also pass { includeMetadataChanges:true } to onSnapshot().");return this._cachedChanges&&this._cachedChangesIncludeMetadataChanges===t||(this._cachedChanges=(function(s,o){if(s._snapshot.oldDocs.isEmpty()){let l=0;return s._snapshot.docChanges.map((u=>{const h=new gf(s._firestore,s._userDataWriter,u.doc.key,u.doc,new vu(s._snapshot.mutatedKeys.has(u.doc.key),s._snapshot.fromCache),s.query.converter);return u.doc,{type:"added",doc:h,oldIndex:-1,newIndex:l++}}))}{let l=s._snapshot.oldDocs;return s._snapshot.docChanges.filter((u=>o||u.type!==3)).map((u=>{const h=new gf(s._firestore,s._userDataWriter,u.doc.key,u.doc,new vu(s._snapshot.mutatedKeys.has(u.doc.key),s._snapshot.fromCache),s.query.converter);let p=-1,g=-1;return u.type!==0&&(p=l.indexOf(u.doc.key),l=l.delete(u.doc.key)),u.type!==1&&(l=l.add(u.doc),g=l.indexOf(u.doc.key)),{type:Vj(u.type),doc:h,oldIndex:p,newIndex:g}}))}})(this,t),this._cachedChangesIncludeMetadataChanges=t),this._cachedChanges}toJSON(){if(this.metadata.hasPendingWrites)throw new de(ee.FAILED_PRECONDITION,"QuerySnapshot.toJSON() attempted to serialize a document with pending writes. Await waitForPendingWrites() before invoking toJSON().");const e={};e.type=ia._jsonSchemaVersion,e.bundleSource="QuerySnapshot",e.bundleName=G_.newId(),this._firestore._databaseId.database,this._firestore._databaseId.projectId;const t=[],r=[],s=[];return this.docs.forEach((o=>{o._document!==null&&(t.push(o._document),r.push(this._userDataWriter.convertObjectMap(o._document.data.value.mapValue.fields,"previous")),s.push(o.ref.path))})),e.bundle=(this._firestore,this.query._query,e.bundleName,"NOT SUPPORTED"),e}}function Vj(n){switch(n){case 0:return"added";case 2:case 3:return"modified";case 1:return"removed";default:return Oe(61501,{type:n})}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function yd(n){n=er(n,At);const e=er(n.firestore,po);return Tj(Up(e),n._key).then((t=>sR(e,n,t)))}ia._jsonSchemaVersion="firestore/querySnapshot/1.0",ia._jsonSchema={type:Bt("string",ia._jsonSchemaVersion),bundleSource:Bt("string","QuerySnapshot"),bundleName:Bt("string"),bundle:Bt("string")};class Av extends jj{constructor(e){super(),this.firestore=e}convertBytes(e){return new pr(e)}convertReference(e){const t=this.convertDocumentKey(e,this.firestore._databaseId);return new At(this.firestore,null,t)}}function kv(n){n=er(n,ai);const e=er(n.firestore,po),t=Up(e),r=new Av(e);return tR(n._query),Cj(t,n._query).then((s=>new ia(e,r,n,s)))}function Nv(n,e,t){n=er(n,At);const r=er(n.firestore,po),s=rR(n.converter,e);return Ov(r,[Yb($p(r),"setDoc",n._key,s,n.converter!==null,t).toMutation(n._key,Dr.none())])}function Kp(n,e,t,...r){n=er(n,At);const s=er(n.firestore,po),o=$p(s);let l;return l=typeof(e=ut(e))=="string"||e instanceof zp?Pj(o,"updateDoc",n._key,e,t,r):Nj(o,"updateDoc",n._key,e),Ov(s,[l.toMutation(n._key,Dr.exists(!0))])}function Pv(n,e){const t=er(n.firestore,po),r=li(n),s=rR(n.converter,e);return Ov(t,[Yb($p(n.firestore),"addDoc",r._key,s,n.converter!==null,{}).toMutation(r._key,Dr.exists(!1))]).then((()=>r))}function Dv(n,...e){n=ut(n);let t={includeMetadataChanges:!1,source:"default"},r=0;typeof e[r]!="object"||YT(e[r])||(t=e[r++]);const s={includeMetadataChanges:t.includeMetadataChanges,source:t.source};if(YT(e[r])){const h=e[r];e[r]=h.next?.bind(h),e[r+1]=h.error?.bind(h),e[r+2]=h.complete?.bind(h)}let o,l,u;if(n instanceof At)l=er(n.firestore,po),u=kp(n._key.path),o={next:h=>{e[r]&&e[r](sR(l,n,h))},error:e[r+1],complete:e[r+2]};else{const h=er(n,ai);l=er(h.firestore,po),u=h._query;const p=new Av(l);o={next:g=>{e[r]&&e[r](new ia(l,p,h,g))},error:e[r+1],complete:e[r+2]},tR(n._query)}return(function(p,g,_,v){const T=new vv(v),A=new gv(g,T,_);return p.asyncQueue.enqueueAndForget((async()=>fv(await $f(p),A))),()=>{T.Nu(),p.asyncQueue.enqueueAndForget((async()=>pv(await $f(p),A)))}})(Up(l),u,s,o)}function Ov(n,e){return(function(r,s){const o=new Qs;return r.asyncQueue.enqueueAndForget((async()=>dj(await xj(r),s,o))),o.promise})(Up(n),e)}function sR(n,e,t){const r=t.docs.get(e._key),s=new Av(n);return new sa(n,s,e._key,r,new vu(t.hasPendingWrites,t.fromCache),e.converter)}function no(){return new Ev("serverTimestamp")}(function(e,t=!0){(function(s){nc=s})(vo),oo(new Xs("firestore",((r,{instanceIdentifier:s,options:o})=>{const l=r.getProvider("app").getImmediate(),u=new po(new NM(r.getProvider("auth-internal")),new OM(l,r.getProvider("app-check-internal")),(function(p,g){if(!Object.prototype.hasOwnProperty.apply(p.options,["projectId"]))throw new de(ee.INVALID_ARGUMENT,'"projectId" not provided in firebase.initializeApp.');return new zu(p.options.projectId,g)})(l,s),l);return o={useFetchStreams:t,...o},u._setSettings(o),u}),"PUBLIC").setMultipleInstances(!0)),gr(eT,tT,e),gr(eT,tT,"esm2020")})();/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const iR="firebasestorage.googleapis.com",oR="storageBucket",Fj=120*1e3,Uj=600*1e3;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Nt extends ws{constructor(e,t,r=0){super(ay(e),`Firebase Storage: ${t} (${ay(e)})`),this.status_=r,this.customData={serverResponse:null},this._baseMessage=this.message,Object.setPrototypeOf(this,Nt.prototype)}get status(){return this.status_}set status(e){this.status_=e}_codeEquals(e){return ay(e)===this.code}get serverResponse(){return this.customData.serverResponse}set serverResponse(e){this.customData.serverResponse=e,this.customData.serverResponse?this.message=`${this._baseMessage}
${this.customData.serverResponse}`:this.message=this._baseMessage}}var kt;(function(n){n.UNKNOWN="unknown",n.OBJECT_NOT_FOUND="object-not-found",n.BUCKET_NOT_FOUND="bucket-not-found",n.PROJECT_NOT_FOUND="project-not-found",n.QUOTA_EXCEEDED="quota-exceeded",n.UNAUTHENTICATED="unauthenticated",n.UNAUTHORIZED="unauthorized",n.UNAUTHORIZED_APP="unauthorized-app",n.RETRY_LIMIT_EXCEEDED="retry-limit-exceeded",n.INVALID_CHECKSUM="invalid-checksum",n.CANCELED="canceled",n.INVALID_EVENT_NAME="invalid-event-name",n.INVALID_URL="invalid-url",n.INVALID_DEFAULT_BUCKET="invalid-default-bucket",n.NO_DEFAULT_BUCKET="no-default-bucket",n.CANNOT_SLICE_BLOB="cannot-slice-blob",n.SERVER_FILE_WRONG_SIZE="server-file-wrong-size",n.NO_DOWNLOAD_URL="no-download-url",n.INVALID_ARGUMENT="invalid-argument",n.INVALID_ARGUMENT_COUNT="invalid-argument-count",n.APP_DELETED="app-deleted",n.INVALID_ROOT_OPERATION="invalid-root-operation",n.INVALID_FORMAT="invalid-format",n.INTERNAL_ERROR="internal-error",n.UNSUPPORTED_ENVIRONMENT="unsupported-environment"})(kt||(kt={}));function ay(n){return"storage/"+n}function Mv(){const n="An unknown error occurred, please check the error payload for server response.";return new Nt(kt.UNKNOWN,n)}function zj(n){return new Nt(kt.OBJECT_NOT_FOUND,"Object '"+n+"' does not exist.")}function Bj(n){return new Nt(kt.QUOTA_EXCEEDED,"Quota for bucket '"+n+"' exceeded, please view quota on https://firebase.google.com/pricing/.")}function $j(){const n="User is not authenticated, please authenticate using Firebase Authentication and try again.";return new Nt(kt.UNAUTHENTICATED,n)}function Wj(){return new Nt(kt.UNAUTHORIZED_APP,"This app does not have permission to access Firebase Storage on this project.")}function Hj(n){return new Nt(kt.UNAUTHORIZED,"User does not have permission to access '"+n+"'.")}function qj(){return new Nt(kt.RETRY_LIMIT_EXCEEDED,"Max retry time for operation exceeded, please try again.")}function Gj(){return new Nt(kt.CANCELED,"User canceled the upload/download.")}function Kj(n){return new Nt(kt.INVALID_URL,"Invalid URL '"+n+"'.")}function Qj(n){return new Nt(kt.INVALID_DEFAULT_BUCKET,"Invalid default bucket '"+n+"'.")}function Yj(){return new Nt(kt.NO_DEFAULT_BUCKET,"No default bucket found. Did you set the '"+oR+"' property when initializing the app?")}function Xj(){return new Nt(kt.CANNOT_SLICE_BLOB,"Cannot slice blob for upload. Please retry the upload.")}function Jj(){return new Nt(kt.NO_DOWNLOAD_URL,"The given file does not have any download URLs.")}function Zj(n){return new Nt(kt.UNSUPPORTED_ENVIRONMENT,`${n} is missing. Make sure to install the required polyfills. See https://firebase.google.com/docs/web/environments-js-sdk#polyfills for more information.`)}function r_(n){return new Nt(kt.INVALID_ARGUMENT,n)}function aR(){return new Nt(kt.APP_DELETED,"The Firebase app was deleted.")}function eV(n){return new Nt(kt.INVALID_ROOT_OPERATION,"The operation '"+n+"' cannot be performed on a root reference, create a non-root reference using child, such as .child('file.png').")}function Au(n,e){return new Nt(kt.INVALID_FORMAT,"String does not match format '"+n+"': "+e)}function lu(n){throw new Nt(kt.INTERNAL_ERROR,"Internal error: "+n)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Zn{constructor(e,t){this.bucket=e,this.path_=t}get path(){return this.path_}get isRoot(){return this.path.length===0}fullServerUrl(){const e=encodeURIComponent;return"/b/"+e(this.bucket)+"/o/"+e(this.path)}bucketOnlyServerUrl(){return"/b/"+encodeURIComponent(this.bucket)+"/o"}static makeFromBucketSpec(e,t){let r;try{r=Zn.makeFromUrl(e,t)}catch{return new Zn(e,"")}if(r.path==="")return r;throw Qj(e)}static makeFromUrl(e,t){let r=null;const s="([A-Za-z0-9.\\-_]+)";function o(G){G.path.charAt(G.path.length-1)==="/"&&(G.path_=G.path_.slice(0,-1))}const l="(/(.*))?$",u=new RegExp("^gs://"+s+l,"i"),h={bucket:1,path:3};function p(G){G.path_=decodeURIComponent(G.path)}const g="v[A-Za-z0-9_]+",_=t.replace(/[.]/g,"\\."),v="(/([^?#]*).*)?$",T=new RegExp(`^https?://${_}/${g}/b/${s}/o${v}`,"i"),A={bucket:1,path:3},I=t===iR?"(?:storage.googleapis.com|storage.cloud.google.com)":t,b="([^?#]*)",j=new RegExp(`^https?://${I}/${s}/${b}`,"i"),$=[{regex:u,indices:h,postModify:o},{regex:T,indices:A,postModify:p},{regex:j,indices:{bucket:1,path:2},postModify:p}];for(let G=0;G<$.length;G++){const X=$[G],ne=X.regex.exec(e);if(ne){const P=ne[X.indices.bucket];let R=ne[X.indices.path];R||(R=""),r=new Zn(P,R),X.postModify(r);break}}if(r==null)throw Kj(e);return r}}class tV{constructor(e){this.promise_=Promise.reject(e)}getPromise(){return this.promise_}cancel(e=!1){}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function nV(n,e,t){let r=1,s=null,o=null,l=!1,u=0;function h(){return u===2}let p=!1;function g(...b){p||(p=!0,e.apply(null,b))}function _(b){s=setTimeout(()=>{s=null,n(T,h())},b)}function v(){o&&clearTimeout(o)}function T(b,...j){if(p){v();return}if(b){v(),g.call(null,b,...j);return}if(h()||l){v(),g.call(null,b,...j);return}r<64&&(r*=2);let $;u===1?(u=2,$=0):$=(r+Math.random())*1e3,_($)}let A=!1;function I(b){A||(A=!0,v(),!p&&(s!==null?(b||(u=2),clearTimeout(s),_(0)):b||(u=1)))}return _(0),o=setTimeout(()=>{l=!0,I(!0)},t),I}function rV(n){n(!1)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function sV(n){return n!==void 0}function iV(n){return typeof n=="object"&&!Array.isArray(n)}function Lv(n){return typeof n=="string"||n instanceof String}function ZT(n){return jv()&&n instanceof Blob}function jv(){return typeof Blob<"u"}function eC(n,e,t,r){if(r<e)throw r_(`Invalid value for '${n}'. Expected ${e} or greater.`);if(r>t)throw r_(`Invalid value for '${n}'. Expected ${t} or less.`)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Vv(n,e,t){let r=e;return t==null&&(r=`https://${e}`),`${t}://${r}/v0${n}`}function lR(n){const e=encodeURIComponent;let t="?";for(const r in n)if(n.hasOwnProperty(r)){const s=e(r)+"="+e(n[r]);t=t+s+"&"}return t=t.slice(0,-1),t}var oa;(function(n){n[n.NO_ERROR=0]="NO_ERROR",n[n.NETWORK_ERROR=1]="NETWORK_ERROR",n[n.ABORT=2]="ABORT"})(oa||(oa={}));/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function oV(n,e){const t=n>=500&&n<600,s=[408,429].indexOf(n)!==-1,o=e.indexOf(n)!==-1;return t||s||o}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class aV{constructor(e,t,r,s,o,l,u,h,p,g,_,v=!0,T=!1){this.url_=e,this.method_=t,this.headers_=r,this.body_=s,this.successCodes_=o,this.additionalRetryCodes_=l,this.callback_=u,this.errorCallback_=h,this.timeout_=p,this.progressCallback_=g,this.connectionFactory_=_,this.retry=v,this.isUsingEmulator=T,this.pendingConnection_=null,this.backoffId_=null,this.canceled_=!1,this.appDelete_=!1,this.promise_=new Promise((A,I)=>{this.resolve_=A,this.reject_=I,this.start_()})}start_(){const e=(r,s)=>{if(s){r(!1,new Kh(!1,null,!0));return}const o=this.connectionFactory_();this.pendingConnection_=o;const l=u=>{const h=u.loaded,p=u.lengthComputable?u.total:-1;this.progressCallback_!==null&&this.progressCallback_(h,p)};this.progressCallback_!==null&&o.addUploadProgressListener(l),o.send(this.url_,this.method_,this.isUsingEmulator,this.body_,this.headers_).then(()=>{this.progressCallback_!==null&&o.removeUploadProgressListener(l),this.pendingConnection_=null;const u=o.getErrorCode()===oa.NO_ERROR,h=o.getStatus();if(!u||oV(h,this.additionalRetryCodes_)&&this.retry){const g=o.getErrorCode()===oa.ABORT;r(!1,new Kh(!1,null,g));return}const p=this.successCodes_.indexOf(h)!==-1;r(!0,new Kh(p,o))})},t=(r,s)=>{const o=this.resolve_,l=this.reject_,u=s.connection;if(s.wasSuccessCode)try{const h=this.callback_(u,u.getResponse());sV(h)?o(h):o()}catch(h){l(h)}else if(u!==null){const h=Mv();h.serverResponse=u.getErrorText(),this.errorCallback_?l(this.errorCallback_(u,h)):l(h)}else if(s.canceled){const h=this.appDelete_?aR():Gj();l(h)}else{const h=qj();l(h)}};this.canceled_?t(!1,new Kh(!1,null,!0)):this.backoffId_=nV(e,t,this.timeout_)}getPromise(){return this.promise_}cancel(e){this.canceled_=!0,this.appDelete_=e||!1,this.backoffId_!==null&&rV(this.backoffId_),this.pendingConnection_!==null&&this.pendingConnection_.abort()}}class Kh{constructor(e,t,r){this.wasSuccessCode=e,this.connection=t,this.canceled=!!r}}function lV(n,e){e!==null&&e.length>0&&(n.Authorization="Firebase "+e)}function cV(n,e){n["X-Firebase-Storage-Version"]="webjs/"+(e??"AppManager")}function uV(n,e){e&&(n["X-Firebase-GMPID"]=e)}function dV(n,e){e!==null&&(n["X-Firebase-AppCheck"]=e)}function hV(n,e,t,r,s,o,l=!0,u=!1){const h=lR(n.urlParams),p=n.url+h,g=Object.assign({},n.headers);return uV(g,e),lV(g,t),cV(g,o),dV(g,r),new aV(p,n.method,g,n.body,n.successCodes,n.additionalRetryCodes,n.handler,n.errorHandler,n.timeout,n.progressCallback,s,l,u)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function fV(){return typeof BlobBuilder<"u"?BlobBuilder:typeof WebKitBlobBuilder<"u"?WebKitBlobBuilder:void 0}function pV(...n){const e=fV();if(e!==void 0){const t=new e;for(let r=0;r<n.length;r++)t.append(n[r]);return t.getBlob()}else{if(jv())return new Blob(n);throw new Nt(kt.UNSUPPORTED_ENVIRONMENT,"This browser doesn't seem to support creating Blobs")}}function mV(n,e,t){return n.webkitSlice?n.webkitSlice(e,t):n.mozSlice?n.mozSlice(e,t):n.slice?n.slice(e,t):null}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function gV(n){if(typeof atob>"u")throw Zj("base-64");return atob(n)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const os={RAW:"raw",BASE64:"base64",BASE64URL:"base64url",DATA_URL:"data_url"};class ly{constructor(e,t){this.data=e,this.contentType=t||null}}function yV(n,e){switch(n){case os.RAW:return new ly(cR(e));case os.BASE64:case os.BASE64URL:return new ly(uR(n,e));case os.DATA_URL:return new ly(vV(e),wV(e))}throw Mv()}function cR(n){const e=[];for(let t=0;t<n.length;t++){let r=n.charCodeAt(t);if(r<=127)e.push(r);else if(r<=2047)e.push(192|r>>6,128|r&63);else if((r&64512)===55296)if(!(t<n.length-1&&(n.charCodeAt(t+1)&64512)===56320))e.push(239,191,189);else{const o=r,l=n.charCodeAt(++t);r=65536|(o&1023)<<10|l&1023,e.push(240|r>>18,128|r>>12&63,128|r>>6&63,128|r&63)}else(r&64512)===56320?e.push(239,191,189):e.push(224|r>>12,128|r>>6&63,128|r&63)}return new Uint8Array(e)}function _V(n){let e;try{e=decodeURIComponent(n)}catch{throw Au(os.DATA_URL,"Malformed data URL.")}return cR(e)}function uR(n,e){switch(n){case os.BASE64:{const s=e.indexOf("-")!==-1,o=e.indexOf("_")!==-1;if(s||o)throw Au(n,"Invalid character '"+(s?"-":"_")+"' found: is it base64url encoded?");break}case os.BASE64URL:{const s=e.indexOf("+")!==-1,o=e.indexOf("/")!==-1;if(s||o)throw Au(n,"Invalid character '"+(s?"+":"/")+"' found: is it base64 encoded?");e=e.replace(/-/g,"+").replace(/_/g,"/");break}}let t;try{t=gV(e)}catch(s){throw s.message.includes("polyfill")?s:Au(n,"Invalid character found")}const r=new Uint8Array(t.length);for(let s=0;s<t.length;s++)r[s]=t.charCodeAt(s);return r}class dR{constructor(e){this.base64=!1,this.contentType=null;const t=e.match(/^data:([^,]+)?,/);if(t===null)throw Au(os.DATA_URL,"Must be formatted 'data:[<mediatype>][;base64],<data>");const r=t[1]||null;r!=null&&(this.base64=EV(r,";base64"),this.contentType=this.base64?r.substring(0,r.length-7):r),this.rest=e.substring(e.indexOf(",")+1)}}function vV(n){const e=new dR(n);return e.base64?uR(os.BASE64,e.rest):_V(e.rest)}function wV(n){return new dR(n).contentType}function EV(n,e){return n.length>=e.length?n.substring(n.length-e.length)===e:!1}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Qi{constructor(e,t){let r=0,s="";ZT(e)?(this.data_=e,r=e.size,s=e.type):e instanceof ArrayBuffer?(t?this.data_=new Uint8Array(e):(this.data_=new Uint8Array(e.byteLength),this.data_.set(new Uint8Array(e))),r=this.data_.length):e instanceof Uint8Array&&(t?this.data_=e:(this.data_=new Uint8Array(e.length),this.data_.set(e)),r=e.length),this.size_=r,this.type_=s}size(){return this.size_}type(){return this.type_}slice(e,t){if(ZT(this.data_)){const r=this.data_,s=mV(r,e,t);return s===null?null:new Qi(s)}else{const r=new Uint8Array(this.data_.buffer,e,t-e);return new Qi(r,!0)}}static getBlob(...e){if(jv()){const t=e.map(r=>r instanceof Qi?r.data_:r);return new Qi(pV.apply(null,t))}else{const t=e.map(l=>Lv(l)?yV(os.RAW,l).data:l.data_);let r=0;t.forEach(l=>{r+=l.byteLength});const s=new Uint8Array(r);let o=0;return t.forEach(l=>{for(let u=0;u<l.length;u++)s[o++]=l[u]}),new Qi(s,!0)}}uploadData(){return this.data_}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function hR(n){let e;try{e=JSON.parse(n)}catch{return null}return iV(e)?e:null}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function xV(n){if(n.length===0)return null;const e=n.lastIndexOf("/");return e===-1?"":n.slice(0,e)}function TV(n,e){const t=e.split("/").filter(r=>r.length>0).join("/");return n.length===0?t:n+"/"+t}function fR(n){const e=n.lastIndexOf("/",n.length-2);return e===-1?n:n.slice(e+1)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function CV(n,e){return e}class In{constructor(e,t,r,s){this.server=e,this.local=t||e,this.writable=!!r,this.xform=s||CV}}let Qh=null;function SV(n){return!Lv(n)||n.length<2?n:fR(n)}function pR(){if(Qh)return Qh;const n=[];n.push(new In("bucket")),n.push(new In("generation")),n.push(new In("metageneration")),n.push(new In("name","fullPath",!0));function e(o,l){return SV(l)}const t=new In("name");t.xform=e,n.push(t);function r(o,l){return l!==void 0?Number(l):l}const s=new In("size");return s.xform=r,n.push(s),n.push(new In("timeCreated")),n.push(new In("updated")),n.push(new In("md5Hash",null,!0)),n.push(new In("cacheControl",null,!0)),n.push(new In("contentDisposition",null,!0)),n.push(new In("contentEncoding",null,!0)),n.push(new In("contentLanguage",null,!0)),n.push(new In("contentType",null,!0)),n.push(new In("metadata","customMetadata",!0)),Qh=n,Qh}function IV(n,e){function t(){const r=n.bucket,s=n.fullPath,o=new Zn(r,s);return e._makeStorageReference(o)}Object.defineProperty(n,"ref",{get:t})}function bV(n,e,t){const r={};r.type="file";const s=t.length;for(let o=0;o<s;o++){const l=t[o];r[l.local]=l.xform(r,e[l.server])}return IV(r,n),r}function mR(n,e,t){const r=hR(e);return r===null?null:bV(n,r,t)}function RV(n,e,t,r){const s=hR(e);if(s===null||!Lv(s.downloadTokens))return null;const o=s.downloadTokens;if(o.length===0)return null;const l=encodeURIComponent;return o.split(",").map(p=>{const g=n.bucket,_=n.fullPath,v="/b/"+l(g)+"/o/"+l(_),T=Vv(v,t,r),A=lR({alt:"media",token:p});return T+A})[0]}function AV(n,e){const t={},r=e.length;for(let s=0;s<r;s++){const o=e[s];o.writable&&(t[o.server]=n[o.local])}return JSON.stringify(t)}class gR{constructor(e,t,r,s){this.url=e,this.method=t,this.handler=r,this.timeout=s,this.urlParams={},this.headers={},this.body=null,this.errorHandler=null,this.progressCallback=null,this.successCodes=[200],this.additionalRetryCodes=[]}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function yR(n){if(!n)throw Mv()}function kV(n,e){function t(r,s){const o=mR(n,s,e);return yR(o!==null),o}return t}function NV(n,e){function t(r,s){const o=mR(n,s,e);return yR(o!==null),RV(o,s,n.host,n._protocol)}return t}function _R(n){function e(t,r){let s;return t.getStatus()===401?t.getErrorText().includes("Firebase App Check token is invalid")?s=Wj():s=$j():t.getStatus()===402?s=Bj(n.bucket):t.getStatus()===403?s=Hj(n.path):s=r,s.status=t.getStatus(),s.serverResponse=r.serverResponse,s}return e}function PV(n){const e=_R(n);function t(r,s){let o=e(r,s);return r.getStatus()===404&&(o=zj(n.path)),o.serverResponse=s.serverResponse,o}return t}function DV(n,e,t){const r=e.fullServerUrl(),s=Vv(r,n.host,n._protocol),o="GET",l=n.maxOperationRetryTime,u=new gR(s,o,NV(n,t),l);return u.errorHandler=PV(e),u}function OV(n,e){return n&&n.contentType||e&&e.type()||"application/octet-stream"}function MV(n,e,t){const r=Object.assign({},t);return r.fullPath=n.path,r.size=e.size(),r.contentType||(r.contentType=OV(null,e)),r}function LV(n,e,t,r,s){const o=e.bucketOnlyServerUrl(),l={"X-Goog-Upload-Protocol":"multipart"};function u(){let $="";for(let G=0;G<2;G++)$=$+Math.random().toString().slice(2);return $}const h=u();l["Content-Type"]="multipart/related; boundary="+h;const p=MV(e,r,s),g=AV(p,t),_="--"+h+`\r
Content-Type: application/json; charset=utf-8\r
\r
`+g+`\r
--`+h+`\r
Content-Type: `+p.contentType+`\r
\r
`,v=`\r
--`+h+"--",T=Qi.getBlob(_,r,v);if(T===null)throw Xj();const A={name:p.fullPath},I=Vv(o,n.host,n._protocol),b="POST",j=n.maxUploadRetryTime,U=new gR(I,b,kV(n,t),j);return U.urlParams=A,U.headers=l,U.body=T.uploadData(),U.errorHandler=_R(e),U}class jV{constructor(){this.sent_=!1,this.xhr_=new XMLHttpRequest,this.initXhr(),this.errorCode_=oa.NO_ERROR,this.sendPromise_=new Promise(e=>{this.xhr_.addEventListener("abort",()=>{this.errorCode_=oa.ABORT,e()}),this.xhr_.addEventListener("error",()=>{this.errorCode_=oa.NETWORK_ERROR,e()}),this.xhr_.addEventListener("load",()=>{e()})})}send(e,t,r,s,o){if(this.sent_)throw lu("cannot .send() more than once");if(vs(e)&&r&&(this.xhr_.withCredentials=!0),this.sent_=!0,this.xhr_.open(t,e,!0),o!==void 0)for(const l in o)o.hasOwnProperty(l)&&this.xhr_.setRequestHeader(l,o[l].toString());return s!==void 0?this.xhr_.send(s):this.xhr_.send(),this.sendPromise_}getErrorCode(){if(!this.sent_)throw lu("cannot .getErrorCode() before sending");return this.errorCode_}getStatus(){if(!this.sent_)throw lu("cannot .getStatus() before sending");try{return this.xhr_.status}catch{return-1}}getResponse(){if(!this.sent_)throw lu("cannot .getResponse() before sending");return this.xhr_.response}getErrorText(){if(!this.sent_)throw lu("cannot .getErrorText() before sending");return this.xhr_.statusText}abort(){this.xhr_.abort()}getResponseHeader(e){return this.xhr_.getResponseHeader(e)}addUploadProgressListener(e){this.xhr_.upload!=null&&this.xhr_.upload.addEventListener("progress",e)}removeUploadProgressListener(e){this.xhr_.upload!=null&&this.xhr_.upload.removeEventListener("progress",e)}}class VV extends jV{initXhr(){this.xhr_.responseType="text"}}function vR(){return new VV}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ua{constructor(e,t){this._service=e,t instanceof Zn?this._location=t:this._location=Zn.makeFromUrl(t,e.host)}toString(){return"gs://"+this._location.bucket+"/"+this._location.path}_newRef(e,t){return new ua(e,t)}get root(){const e=new Zn(this._location.bucket,"");return this._newRef(this._service,e)}get bucket(){return this._location.bucket}get fullPath(){return this._location.path}get name(){return fR(this._location.path)}get storage(){return this._service}get parent(){const e=xV(this._location.path);if(e===null)return null;const t=new Zn(this._location.bucket,e);return new ua(this._service,t)}_throwIfRoot(e){if(this._location.path==="")throw eV(e)}}function FV(n,e,t){n._throwIfRoot("uploadBytes");const r=LV(n.storage,n._location,pR(),new Qi(e,!0),t);return n.storage.makeRequestWithTokens(r,vR).then(s=>({metadata:s,ref:n}))}function UV(n){n._throwIfRoot("getDownloadURL");const e=DV(n.storage,n._location,pR());return n.storage.makeRequestWithTokens(e,vR).then(t=>{if(t===null)throw Jj();return t})}function zV(n,e){const t=TV(n._location.path,e),r=new Zn(n._location.bucket,t);return new ua(n.storage,r)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function BV(n){return/^[A-Za-z]+:\/\//.test(n)}function $V(n,e){return new ua(n,e)}function wR(n,e){if(n instanceof Fv){const t=n;if(t._bucket==null)throw Yj();const r=new ua(t,t._bucket);return e!=null?wR(r,e):r}else return e!==void 0?zV(n,e):n}function WV(n,e){if(e&&BV(e)){if(n instanceof Fv)return $V(n,e);throw r_("To use ref(service, url), the first argument must be a Storage instance.")}else return wR(n,e)}function tC(n,e){const t=e?.[oR];return t==null?null:Zn.makeFromBucketSpec(t,n)}function HV(n,e,t,r={}){n.host=`${e}:${t}`;const s=vs(e);s&&(_p(`https://${n.host}/b`),vp("Storage",!0)),n._isUsingEmulator=!0,n._protocol=s?"https":"http";const{mockUserToken:o}=r;o&&(n._overrideAuthToken=typeof o=="string"?o:M_(o,n.app.options.projectId))}class Fv{constructor(e,t,r,s,o,l=!1){this.app=e,this._authProvider=t,this._appCheckProvider=r,this._url=s,this._firebaseVersion=o,this._isUsingEmulator=l,this._bucket=null,this._host=iR,this._protocol="https",this._appId=null,this._deleted=!1,this._maxOperationRetryTime=Fj,this._maxUploadRetryTime=Uj,this._requests=new Set,s!=null?this._bucket=Zn.makeFromBucketSpec(s,this._host):this._bucket=tC(this._host,this.app.options)}get host(){return this._host}set host(e){this._host=e,this._url!=null?this._bucket=Zn.makeFromBucketSpec(this._url,e):this._bucket=tC(e,this.app.options)}get maxUploadRetryTime(){return this._maxUploadRetryTime}set maxUploadRetryTime(e){eC("time",0,Number.POSITIVE_INFINITY,e),this._maxUploadRetryTime=e}get maxOperationRetryTime(){return this._maxOperationRetryTime}set maxOperationRetryTime(e){eC("time",0,Number.POSITIVE_INFINITY,e),this._maxOperationRetryTime=e}async _getAuthToken(){if(this._overrideAuthToken)return this._overrideAuthToken;const e=this._authProvider.getImmediate({optional:!0});if(e){const t=await e.getToken();if(t!==null)return t.accessToken}return null}async _getAppCheckToken(){if(bn(this.app)&&this.app.settings.appCheckToken)return this.app.settings.appCheckToken;const e=this._appCheckProvider.getImmediate({optional:!0});return e?(await e.getToken()).token:null}_delete(){return this._deleted||(this._deleted=!0,this._requests.forEach(e=>e.cancel()),this._requests.clear()),Promise.resolve()}_makeStorageReference(e){return new ua(this,e)}_makeRequest(e,t,r,s,o=!0){if(this._deleted)return new tV(aR());{const l=hV(e,this._appId,r,s,t,this._firebaseVersion,o,this._isUsingEmulator);return this._requests.add(l),l.getPromise().then(()=>this._requests.delete(l),()=>this._requests.delete(l)),l}}async makeRequestWithTokens(e,t){const[r,s]=await Promise.all([this._getAuthToken(),this._getAppCheckToken()]);return this._makeRequest(e,t,r,s).getPromise()}}const nC="@firebase/storage",rC="0.14.0";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ER="storage";function Uv(n,e,t){return n=ut(n),FV(n,e,t)}function zv(n){return n=ut(n),UV(n)}function Bv(n,e){return n=ut(n),WV(n,e)}function qV(n=xp(),e){n=ut(n);const r=od(n,ER).getImmediate({identifier:e}),s=O_("storage");return s&&GV(r,...s),r}function GV(n,e,t,r={}){HV(n,e,t,r)}function KV(n,{instanceIdentifier:e}){const t=n.getProvider("app").getImmediate(),r=n.getProvider("auth-internal"),s=n.getProvider("app-check-internal");return new Fv(t,r,s,e,vo)}function QV(){oo(new Xs(ER,KV,"PUBLIC").setMultipleInstances(!0)),gr(nC,rC,""),gr(nC,rC,"esm2020")}QV();var sC={};const iC="@firebase/database",oC="1.1.0";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let xR="";function YV(n){xR=n}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class XV{constructor(e){this.domStorage_=e,this.prefix_="firebase:"}set(e,t){t==null?this.domStorage_.removeItem(this.prefixedName_(e)):this.domStorage_.setItem(this.prefixedName_(e),en(t))}get(e){const t=this.domStorage_.getItem(this.prefixedName_(e));return t==null?null:Mu(t)}remove(e){this.domStorage_.removeItem(this.prefixedName_(e))}prefixedName_(e){return this.prefix_+e}toString(){return this.domStorage_.toString()}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class JV{constructor(){this.cache_={},this.isInMemoryStorage=!0}set(e,t){t==null?delete this.cache_[e]:this.cache_[e]=t}get(e){return Es(this.cache_,e)?this.cache_[e]:null}remove(e){delete this.cache_[e]}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const TR=function(n){try{if(typeof window<"u"&&typeof window[n]<"u"){const e=window[n];return e.setItem("firebase:sentinel","cache"),e.removeItem("firebase:sentinel"),new XV(e)}}catch{}return new JV},na=TR("localStorage"),ZV=TR("sessionStorage");/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const kl=new Ep("@firebase/database"),eF=(function(){let n=1;return function(){return n++}})(),CR=function(n){const e=rD(n),t=new ZP;t.update(e);const r=t.digest();return D_.encodeByteArray(r)},_d=function(...n){let e="";for(let t=0;t<n.length;t++){const r=n[t];Array.isArray(r)||r&&typeof r=="object"&&typeof r.length=="number"?e+=_d.apply(null,r):typeof r=="object"?e+=en(r):e+=r,e+=" "}return e};let ku=null,aC=!0;const tF=function(n,e){le(!0,"Can't turn on custom loggers persistently."),kl.logLevel=Qe.VERBOSE,ku=kl.log.bind(kl)},an=function(...n){if(aC===!0&&(aC=!1,ku===null&&ZV.get("logging_enabled")===!0&&tF()),ku){const e=_d.apply(null,n);ku(e)}},vd=function(n){return function(...e){an(n,...e)}},s_=function(...n){const e="FIREBASE INTERNAL ERROR: "+_d(...n);kl.error(e)},ri=function(...n){const e=`FIREBASE FATAL ERROR: ${_d(...n)}`;throw kl.error(e),new Error(e)},zn=function(...n){const e="FIREBASE WARNING: "+_d(...n);kl.warn(e)},nF=function(){typeof window<"u"&&window.location&&window.location.protocol&&window.location.protocol.indexOf("https:")!==-1&&zn("Insecure Firebase access from a secure page. Please use https in calls to new Firebase().")},Qp=function(n){return typeof n=="number"&&(n!==n||n===Number.POSITIVE_INFINITY||n===Number.NEGATIVE_INFINITY)},rF=function(n){if(document.readyState==="complete")n();else{let e=!1;const t=function(){if(!document.body){setTimeout(t,Math.floor(10));return}e||(e=!0,n())};document.addEventListener?(document.addEventListener("DOMContentLoaded",t,!1),window.addEventListener("load",t,!1)):document.attachEvent&&(document.attachEvent("onreadystatechange",()=>{document.readyState==="complete"&&t()}),window.attachEvent("onload",t))}},Hl="[MIN_NAME]",da="[MAX_NAME]",wa=function(n,e){if(n===e)return 0;if(n===Hl||e===da)return-1;if(e===Hl||n===da)return 1;{const t=lC(n),r=lC(e);return t!==null?r!==null?t-r===0?n.length-e.length:t-r:-1:r!==null?1:n<e?-1:1}},sF=function(n,e){return n===e?0:n<e?-1:1},cu=function(n,e){if(e&&n in e)return e[n];throw new Error("Missing required key ("+n+") in object: "+en(e))},$v=function(n){if(typeof n!="object"||n===null)return en(n);const e=[];for(const r in n)e.push(r);e.sort();let t="{";for(let r=0;r<e.length;r++)r!==0&&(t+=","),t+=en(e[r]),t+=":",t+=$v(n[e[r]]);return t+="}",t},SR=function(n,e){const t=n.length;if(t<=e)return[n];const r=[];for(let s=0;s<t;s+=e)s+e>t?r.push(n.substring(s,t)):r.push(n.substring(s,s+e));return r};function xn(n,e){for(const t in n)n.hasOwnProperty(t)&&e(t,n[t])}const IR=function(n){le(!Qp(n),"Invalid JSON number");const e=11,t=52,r=(1<<e-1)-1;let s,o,l,u,h;n===0?(o=0,l=0,s=1/n===-1/0?1:0):(s=n<0,n=Math.abs(n),n>=Math.pow(2,1-r)?(u=Math.min(Math.floor(Math.log(n)/Math.LN2),r),o=u+r,l=Math.round(n*Math.pow(2,t-u)-Math.pow(2,t))):(o=0,l=Math.round(n/Math.pow(2,1-r-t))));const p=[];for(h=t;h;h-=1)p.push(l%2?1:0),l=Math.floor(l/2);for(h=e;h;h-=1)p.push(o%2?1:0),o=Math.floor(o/2);p.push(s?1:0),p.reverse();const g=p.join("");let _="";for(h=0;h<64;h+=8){let v=parseInt(g.substr(h,8),2).toString(16);v.length===1&&(v="0"+v),_=_+v}return _.toLowerCase()},iF=function(){return!!(typeof window=="object"&&window.chrome&&window.chrome.extension&&!/^chrome/.test(window.location.href))},oF=function(){return typeof Windows=="object"&&typeof Windows.UI=="object"};function aF(n,e){let t="Unknown Error";n==="too_big"?t="The data requested exceeds the maximum size that can be accessed with a single request.":n==="permission_denied"?t="Client doesn't have permission to access the desired data.":n==="unavailable"&&(t="The service is unavailable");const r=new Error(n+" at "+e._path.toString()+": "+t);return r.code=n.toUpperCase(),r}const lF=new RegExp("^-?(0*)\\d{1,10}$"),cF=-2147483648,uF=2147483647,lC=function(n){if(lF.test(n)){const e=Number(n);if(e>=cF&&e<=uF)return e}return null},ac=function(n){try{n()}catch(e){setTimeout(()=>{const t=e.stack||"";throw zn("Exception was thrown by user callback.",t),e},Math.floor(0))}},dF=function(){return(typeof window=="object"&&window.navigator&&window.navigator.userAgent||"").search(/googlebot|google webmaster tools|bingbot|yahoo! slurp|baiduspider|yandexbot|duckduckbot/i)>=0},Nu=function(n,e){const t=setTimeout(n,e);return typeof t=="number"&&typeof Deno<"u"&&Deno.unrefTimer?Deno.unrefTimer(t):typeof t=="object"&&t.unref&&t.unref(),t};/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class hF{constructor(e,t){this.appCheckProvider=t,this.appName=e.name,bn(e)&&e.settings.appCheckToken&&(this.serverAppAppCheckToken=e.settings.appCheckToken),this.appCheck=t?.getImmediate({optional:!0}),this.appCheck||t?.get().then(r=>this.appCheck=r)}getToken(e){if(this.serverAppAppCheckToken){if(e)throw new Error("Attempted reuse of `FirebaseServerApp.appCheckToken` after previous usage failed.");return Promise.resolve({token:this.serverAppAppCheckToken})}return this.appCheck?this.appCheck.getToken(e):new Promise((t,r)=>{setTimeout(()=>{this.appCheck?this.getToken(e).then(t,r):t(null)},0)})}addTokenChangeListener(e){this.appCheckProvider?.get().then(t=>t.addTokenListener(e))}notifyForInvalidToken(){zn(`Provided AppCheck credentials for the app named "${this.appName}" are invalid. This usually indicates your app was not initialized correctly.`)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class fF{constructor(e,t,r){this.appName_=e,this.firebaseOptions_=t,this.authProvider_=r,this.auth_=null,this.auth_=r.getImmediate({optional:!0}),this.auth_||r.onInit(s=>this.auth_=s)}getToken(e){return this.auth_?this.auth_.getToken(e).catch(t=>t&&t.code==="auth/token-not-initialized"?(an("Got auth/token-not-initialized error.  Treating as null token."),null):Promise.reject(t)):new Promise((t,r)=>{setTimeout(()=>{this.auth_?this.getToken(e).then(t,r):t(null)},0)})}addTokenChangeListener(e){this.auth_?this.auth_.addAuthTokenListener(e):this.authProvider_.get().then(t=>t.addAuthTokenListener(e))}removeTokenChangeListener(e){this.authProvider_.get().then(t=>t.removeAuthTokenListener(e))}notifyForInvalidToken(){let e='Provided authentication credentials for the app named "'+this.appName_+'" are invalid. This usually indicates your app was not initialized correctly. ';"credential"in this.firebaseOptions_?e+='Make sure the "credential" property provided to initializeApp() is authorized to access the specified "databaseURL" and is from the correct project.':"serviceAccount"in this.firebaseOptions_?e+='Make sure the "serviceAccount" property provided to initializeApp() is authorized to access the specified "databaseURL" and is from the correct project.':e+='Make sure the "apiKey" and "databaseURL" properties provided to initializeApp() match the values provided for your app at https://console.firebase.google.com/.',zn(e)}}class yf{constructor(e){this.accessToken=e}getToken(e){return Promise.resolve({accessToken:this.accessToken})}addTokenChangeListener(e){e(this.accessToken)}removeTokenChangeListener(e){}notifyForInvalidToken(){}}yf.OWNER="owner";/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Wv="5",bR="v",RR="s",AR="r",kR="f",NR=/(console\.firebase|firebase-console-\w+\.corp|firebase\.corp)\.google\.com/,PR="ls",DR="p",i_="ac",OR="websocket",MR="long_polling";/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class LR{constructor(e,t,r,s,o=!1,l="",u=!1,h=!1,p=null){this.secure=t,this.namespace=r,this.webSocketOnly=s,this.nodeAdmin=o,this.persistenceKey=l,this.includeNamespaceInQueryParams=u,this.isUsingEmulator=h,this.emulatorOptions=p,this._host=e.toLowerCase(),this._domain=this._host.substr(this._host.indexOf(".")+1),this.internalHost=na.get("host:"+e)||this._host}isCacheableHost(){return this.internalHost.substr(0,2)==="s-"}isCustomHost(){return this._domain!=="firebaseio.com"&&this._domain!=="firebaseio-demo.com"}get host(){return this._host}set host(e){e!==this.internalHost&&(this.internalHost=e,this.isCacheableHost()&&na.set("host:"+this._host,this.internalHost))}toString(){let e=this.toURLString();return this.persistenceKey&&(e+="<"+this.persistenceKey+">"),e}toURLString(){const e=this.secure?"https://":"http://",t=this.includeNamespaceInQueryParams?`?ns=${this.namespace}`:"";return`${e}${this.host}/${t}`}}function pF(n){return n.host!==n.internalHost||n.isCustomHost()||n.includeNamespaceInQueryParams}function jR(n,e,t){le(typeof e=="string","typeof type must == string"),le(typeof t=="object","typeof params must == object");let r;if(e===OR)r=(n.secure?"wss://":"ws://")+n.internalHost+"/.ws?";else if(e===MR)r=(n.secure?"https://":"http://")+n.internalHost+"/.lp?";else throw new Error("Unknown connection type: "+e);pF(n)&&(t.ns=n.namespace);const s=[];return xn(t,(o,l)=>{s.push(o+"="+l)}),r+s.join("&")}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class mF{constructor(){this.counters_={}}incrementCounter(e,t=1){Es(this.counters_,e)||(this.counters_[e]=0),this.counters_[e]+=t}get(){return PP(this.counters_)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const cy={},uy={};function Hv(n){const e=n.toString();return cy[e]||(cy[e]=new mF),cy[e]}function gF(n,e){const t=n.toString();return uy[t]||(uy[t]=e()),uy[t]}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class yF{constructor(e){this.onMessage_=e,this.pendingResponses=[],this.currentResponseNum=0,this.closeAfterResponse=-1,this.onClose=null}closeAfter(e,t){this.closeAfterResponse=e,this.onClose=t,this.closeAfterResponse<this.currentResponseNum&&(this.onClose(),this.onClose=null)}handleResponse(e,t){for(this.pendingResponses[e]=t;this.pendingResponses[this.currentResponseNum];){const r=this.pendingResponses[this.currentResponseNum];delete this.pendingResponses[this.currentResponseNum];for(let s=0;s<r.length;++s)r[s]&&ac(()=>{this.onMessage_(r[s])});if(this.currentResponseNum===this.closeAfterResponse){this.onClose&&(this.onClose(),this.onClose=null);break}this.currentResponseNum++}}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const cC="start",_F="close",vF="pLPCommand",wF="pRTLPCB",VR="id",FR="pw",UR="ser",EF="cb",xF="seg",TF="ts",CF="d",SF="dframe",zR=1870,BR=30,IF=zR-BR,bF=25e3,RF=3e4;class Sl{constructor(e,t,r,s,o,l,u){this.connId=e,this.repoInfo=t,this.applicationId=r,this.appCheckToken=s,this.authToken=o,this.transportSessionId=l,this.lastSessionId=u,this.bytesSent=0,this.bytesReceived=0,this.everConnected_=!1,this.log_=vd(e),this.stats_=Hv(t),this.urlFn=h=>(this.appCheckToken&&(h[i_]=this.appCheckToken),jR(t,MR,h))}open(e,t){this.curSegmentNum=0,this.onDisconnect_=t,this.myPacketOrderer=new yF(e),this.isClosed_=!1,this.connectTimeoutTimer_=setTimeout(()=>{this.log_("Timed out trying to connect."),this.onClosed_(),this.connectTimeoutTimer_=null},Math.floor(RF)),rF(()=>{if(this.isClosed_)return;this.scriptTagHolder=new qv((...o)=>{const[l,u,h,p,g]=o;if(this.incrementIncomingBytes_(o),!!this.scriptTagHolder)if(this.connectTimeoutTimer_&&(clearTimeout(this.connectTimeoutTimer_),this.connectTimeoutTimer_=null),this.everConnected_=!0,l===cC)this.id=u,this.password=h;else if(l===_F)u?(this.scriptTagHolder.sendNewPolls=!1,this.myPacketOrderer.closeAfter(u,()=>{this.onClosed_()})):this.onClosed_();else throw new Error("Unrecognized command received: "+l)},(...o)=>{const[l,u]=o;this.incrementIncomingBytes_(o),this.myPacketOrderer.handleResponse(l,u)},()=>{this.onClosed_()},this.urlFn);const r={};r[cC]="t",r[UR]=Math.floor(Math.random()*1e8),this.scriptTagHolder.uniqueCallbackIdentifier&&(r[EF]=this.scriptTagHolder.uniqueCallbackIdentifier),r[bR]=Wv,this.transportSessionId&&(r[RR]=this.transportSessionId),this.lastSessionId&&(r[PR]=this.lastSessionId),this.applicationId&&(r[DR]=this.applicationId),this.appCheckToken&&(r[i_]=this.appCheckToken),typeof location<"u"&&location.hostname&&NR.test(location.hostname)&&(r[AR]=kR);const s=this.urlFn(r);this.log_("Connecting via long-poll to "+s),this.scriptTagHolder.addTag(s,()=>{})})}start(){this.scriptTagHolder.startLongPoll(this.id,this.password),this.addDisconnectPingFrame(this.id,this.password)}static forceAllow(){Sl.forceAllow_=!0}static forceDisallow(){Sl.forceDisallow_=!0}static isAvailable(){return Sl.forceAllow_?!0:!Sl.forceDisallow_&&typeof document<"u"&&document.createElement!=null&&!iF()&&!oF()}markConnectionHealthy(){}shutdown_(){this.isClosed_=!0,this.scriptTagHolder&&(this.scriptTagHolder.close(),this.scriptTagHolder=null),this.myDisconnFrame&&(document.body.removeChild(this.myDisconnFrame),this.myDisconnFrame=null),this.connectTimeoutTimer_&&(clearTimeout(this.connectTimeoutTimer_),this.connectTimeoutTimer_=null)}onClosed_(){this.isClosed_||(this.log_("Longpoll is closing itself"),this.shutdown_(),this.onDisconnect_&&(this.onDisconnect_(this.everConnected_),this.onDisconnect_=null))}close(){this.isClosed_||(this.log_("Longpoll is being closed."),this.shutdown_())}send(e){const t=en(e);this.bytesSent+=t.length,this.stats_.incrementCounter("bytes_sent",t.length);const r=LS(t),s=SR(r,IF);for(let o=0;o<s.length;o++)this.scriptTagHolder.enqueueSegment(this.curSegmentNum,s.length,s[o]),this.curSegmentNum++}addDisconnectPingFrame(e,t){this.myDisconnFrame=document.createElement("iframe");const r={};r[SF]="t",r[VR]=e,r[FR]=t,this.myDisconnFrame.src=this.urlFn(r),this.myDisconnFrame.style.display="none",document.body.appendChild(this.myDisconnFrame)}incrementIncomingBytes_(e){const t=en(e).length;this.bytesReceived+=t,this.stats_.incrementCounter("bytes_received",t)}}class qv{constructor(e,t,r,s){this.onDisconnect=r,this.urlFn=s,this.outstandingRequests=new Set,this.pendingSegs=[],this.currentSerial=Math.floor(Math.random()*1e8),this.sendNewPolls=!0;{this.uniqueCallbackIdentifier=eF(),window[vF+this.uniqueCallbackIdentifier]=e,window[wF+this.uniqueCallbackIdentifier]=t,this.myIFrame=qv.createIFrame_();let o="";this.myIFrame.src&&this.myIFrame.src.substr(0,11)==="javascript:"&&(o='<script>document.domain="'+document.domain+'";<\/script>');const l="<html><body>"+o+"</body></html>";try{this.myIFrame.doc.open(),this.myIFrame.doc.write(l),this.myIFrame.doc.close()}catch(u){an("frame writing exception"),u.stack&&an(u.stack),an(u)}}}static createIFrame_(){const e=document.createElement("iframe");if(e.style.display="none",document.body){document.body.appendChild(e);try{e.contentWindow.document||an("No IE domain setting required")}catch{const r=document.domain;e.src="javascript:void((function(){document.open();document.domain='"+r+"';document.close();})())"}}else throw"Document body has not initialized. Wait to initialize Firebase until after the document is ready.";return e.contentDocument?e.doc=e.contentDocument:e.contentWindow?e.doc=e.contentWindow.document:e.document&&(e.doc=e.document),e}close(){this.alive=!1,this.myIFrame&&(this.myIFrame.doc.body.textContent="",setTimeout(()=>{this.myIFrame!==null&&(document.body.removeChild(this.myIFrame),this.myIFrame=null)},Math.floor(0)));const e=this.onDisconnect;e&&(this.onDisconnect=null,e())}startLongPoll(e,t){for(this.myID=e,this.myPW=t,this.alive=!0;this.newRequest_(););}newRequest_(){if(this.alive&&this.sendNewPolls&&this.outstandingRequests.size<(this.pendingSegs.length>0?2:1)){this.currentSerial++;const e={};e[VR]=this.myID,e[FR]=this.myPW,e[UR]=this.currentSerial;let t=this.urlFn(e),r="",s=0;for(;this.pendingSegs.length>0&&this.pendingSegs[0].d.length+BR+r.length<=zR;){const l=this.pendingSegs.shift();r=r+"&"+xF+s+"="+l.seg+"&"+TF+s+"="+l.ts+"&"+CF+s+"="+l.d,s++}return t=t+r,this.addLongPollTag_(t,this.currentSerial),!0}else return!1}enqueueSegment(e,t,r){this.pendingSegs.push({seg:e,ts:t,d:r}),this.alive&&this.newRequest_()}addLongPollTag_(e,t){this.outstandingRequests.add(t);const r=()=>{this.outstandingRequests.delete(t),this.newRequest_()},s=setTimeout(r,Math.floor(bF)),o=()=>{clearTimeout(s),r()};this.addTag(e,o)}addTag(e,t){setTimeout(()=>{try{if(!this.sendNewPolls)return;const r=this.myIFrame.doc.createElement("script");r.type="text/javascript",r.async=!0,r.src=e,r.onload=r.onreadystatechange=function(){const s=r.readyState;(!s||s==="loaded"||s==="complete")&&(r.onload=r.onreadystatechange=null,r.parentNode&&r.parentNode.removeChild(r),t())},r.onerror=()=>{an("Long-poll script failed to load: "+e),this.sendNewPolls=!1,this.close()},this.myIFrame.doc.body.appendChild(r)}catch{}},Math.floor(1))}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const AF=16384,kF=45e3;let Hf=null;typeof MozWebSocket<"u"?Hf=MozWebSocket:typeof WebSocket<"u"&&(Hf=WebSocket);class Ar{constructor(e,t,r,s,o,l,u){this.connId=e,this.applicationId=r,this.appCheckToken=s,this.authToken=o,this.keepaliveTimer=null,this.frames=null,this.totalFrames=0,this.bytesSent=0,this.bytesReceived=0,this.log_=vd(this.connId),this.stats_=Hv(t),this.connURL=Ar.connectionURL_(t,l,u,s,r),this.nodeAdmin=t.nodeAdmin}static connectionURL_(e,t,r,s,o){const l={};return l[bR]=Wv,typeof location<"u"&&location.hostname&&NR.test(location.hostname)&&(l[AR]=kR),t&&(l[RR]=t),r&&(l[PR]=r),s&&(l[i_]=s),o&&(l[DR]=o),jR(e,OR,l)}open(e,t){this.onDisconnect=t,this.onMessage=e,this.log_("Websocket connecting to "+this.connURL),this.everConnected_=!1,na.set("previous_websocket_failure",!0);try{let r;WP(),this.mySock=new Hf(this.connURL,[],r)}catch(r){this.log_("Error instantiating WebSocket.");const s=r.message||r.data;s&&this.log_(s),this.onClosed_();return}this.mySock.onopen=()=>{this.log_("Websocket connected."),this.everConnected_=!0},this.mySock.onclose=()=>{this.log_("Websocket connection was disconnected."),this.mySock=null,this.onClosed_()},this.mySock.onmessage=r=>{this.handleIncomingFrame(r)},this.mySock.onerror=r=>{this.log_("WebSocket error.  Closing connection.");const s=r.message||r.data;s&&this.log_(s),this.onClosed_()}}start(){}static forceDisallow(){Ar.forceDisallow_=!0}static isAvailable(){let e=!1;if(typeof navigator<"u"&&navigator.userAgent){const t=/Android ([0-9]{0,}\.[0-9]{0,})/,r=navigator.userAgent.match(t);r&&r.length>1&&parseFloat(r[1])<4.4&&(e=!0)}return!e&&Hf!==null&&!Ar.forceDisallow_}static previouslyFailed(){return na.isInMemoryStorage||na.get("previous_websocket_failure")===!0}markConnectionHealthy(){na.remove("previous_websocket_failure")}appendFrame_(e){if(this.frames.push(e),this.frames.length===this.totalFrames){const t=this.frames.join("");this.frames=null;const r=Mu(t);this.onMessage(r)}}handleNewFrameCount_(e){this.totalFrames=e,this.frames=[]}extractFrameCount_(e){if(le(this.frames===null,"We already have a frame buffer"),e.length<=6){const t=Number(e);if(!isNaN(t))return this.handleNewFrameCount_(t),null}return this.handleNewFrameCount_(1),e}handleIncomingFrame(e){if(this.mySock===null)return;const t=e.data;if(this.bytesReceived+=t.length,this.stats_.incrementCounter("bytes_received",t.length),this.resetKeepAlive(),this.frames!==null)this.appendFrame_(t);else{const r=this.extractFrameCount_(t);r!==null&&this.appendFrame_(r)}}send(e){this.resetKeepAlive();const t=en(e);this.bytesSent+=t.length,this.stats_.incrementCounter("bytes_sent",t.length);const r=SR(t,AF);r.length>1&&this.sendString_(String(r.length));for(let s=0;s<r.length;s++)this.sendString_(r[s])}shutdown_(){this.isClosed_=!0,this.keepaliveTimer&&(clearInterval(this.keepaliveTimer),this.keepaliveTimer=null),this.mySock&&(this.mySock.close(),this.mySock=null)}onClosed_(){this.isClosed_||(this.log_("WebSocket is closing itself"),this.shutdown_(),this.onDisconnect&&(this.onDisconnect(this.everConnected_),this.onDisconnect=null))}close(){this.isClosed_||(this.log_("WebSocket is being closed"),this.shutdown_())}resetKeepAlive(){clearInterval(this.keepaliveTimer),this.keepaliveTimer=setInterval(()=>{this.mySock&&this.sendString_("0"),this.resetKeepAlive()},Math.floor(kF))}sendString_(e){try{this.mySock.send(e)}catch(t){this.log_("Exception thrown from WebSocket.send():",t.message||t.data,"Closing connection."),setTimeout(this.onClosed_.bind(this),0)}}}Ar.responsesRequiredToBeHealthy=2;Ar.healthyTimeout=3e4;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Gu{static get ALL_TRANSPORTS(){return[Sl,Ar]}static get IS_TRANSPORT_INITIALIZED(){return this.globalTransportInitialized_}constructor(e){this.initTransports_(e)}initTransports_(e){const t=Ar&&Ar.isAvailable();let r=t&&!Ar.previouslyFailed();if(e.webSocketOnly&&(t||zn("wss:// URL used, but browser isn't known to support websockets.  Trying anyway."),r=!0),r)this.transports_=[Ar];else{const s=this.transports_=[];for(const o of Gu.ALL_TRANSPORTS)o&&o.isAvailable()&&s.push(o);Gu.globalTransportInitialized_=!0}}initialTransport(){if(this.transports_.length>0)return this.transports_[0];throw new Error("No transports available")}upgradeTransport(){return this.transports_.length>1?this.transports_[1]:null}}Gu.globalTransportInitialized_=!1;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const NF=6e4,PF=5e3,DF=10*1024,OF=100*1024,dy="t",uC="d",MF="s",dC="r",LF="e",hC="o",fC="a",pC="n",mC="p",jF="h";class VF{constructor(e,t,r,s,o,l,u,h,p,g){this.id=e,this.repoInfo_=t,this.applicationId_=r,this.appCheckToken_=s,this.authToken_=o,this.onMessage_=l,this.onReady_=u,this.onDisconnect_=h,this.onKill_=p,this.lastSessionId=g,this.connectionCount=0,this.pendingDataMessages=[],this.state_=0,this.log_=vd("c:"+this.id+":"),this.transportManager_=new Gu(t),this.log_("Connection created"),this.start_()}start_(){const e=this.transportManager_.initialTransport();this.conn_=new e(this.nextTransportId_(),this.repoInfo_,this.applicationId_,this.appCheckToken_,this.authToken_,null,this.lastSessionId),this.primaryResponsesRequired_=e.responsesRequiredToBeHealthy||0;const t=this.connReceiver_(this.conn_),r=this.disconnReceiver_(this.conn_);this.tx_=this.conn_,this.rx_=this.conn_,this.secondaryConn_=null,this.isHealthy_=!1,setTimeout(()=>{this.conn_&&this.conn_.open(t,r)},Math.floor(0));const s=e.healthyTimeout||0;s>0&&(this.healthyTimeout_=Nu(()=>{this.healthyTimeout_=null,this.isHealthy_||(this.conn_&&this.conn_.bytesReceived>OF?(this.log_("Connection exceeded healthy timeout but has received "+this.conn_.bytesReceived+" bytes.  Marking connection healthy."),this.isHealthy_=!0,this.conn_.markConnectionHealthy()):this.conn_&&this.conn_.bytesSent>DF?this.log_("Connection exceeded healthy timeout but has sent "+this.conn_.bytesSent+" bytes.  Leaving connection alive."):(this.log_("Closing unhealthy connection after timeout."),this.close()))},Math.floor(s)))}nextTransportId_(){return"c:"+this.id+":"+this.connectionCount++}disconnReceiver_(e){return t=>{e===this.conn_?this.onConnectionLost_(t):e===this.secondaryConn_?(this.log_("Secondary connection lost."),this.onSecondaryConnectionLost_()):this.log_("closing an old connection")}}connReceiver_(e){return t=>{this.state_!==2&&(e===this.rx_?this.onPrimaryMessageReceived_(t):e===this.secondaryConn_?this.onSecondaryMessageReceived_(t):this.log_("message on old connection"))}}sendRequest(e){const t={t:"d",d:e};this.sendData_(t)}tryCleanupConnection(){this.tx_===this.secondaryConn_&&this.rx_===this.secondaryConn_&&(this.log_("cleaning up and promoting a connection: "+this.secondaryConn_.connId),this.conn_=this.secondaryConn_,this.secondaryConn_=null)}onSecondaryControl_(e){if(dy in e){const t=e[dy];t===fC?this.upgradeIfSecondaryHealthy_():t===dC?(this.log_("Got a reset on secondary, closing it"),this.secondaryConn_.close(),(this.tx_===this.secondaryConn_||this.rx_===this.secondaryConn_)&&this.close()):t===hC&&(this.log_("got pong on secondary."),this.secondaryResponsesRequired_--,this.upgradeIfSecondaryHealthy_())}}onSecondaryMessageReceived_(e){const t=cu("t",e),r=cu("d",e);if(t==="c")this.onSecondaryControl_(r);else if(t==="d")this.pendingDataMessages.push(r);else throw new Error("Unknown protocol layer: "+t)}upgradeIfSecondaryHealthy_(){this.secondaryResponsesRequired_<=0?(this.log_("Secondary connection is healthy."),this.isHealthy_=!0,this.secondaryConn_.markConnectionHealthy(),this.proceedWithUpgrade_()):(this.log_("sending ping on secondary."),this.secondaryConn_.send({t:"c",d:{t:mC,d:{}}}))}proceedWithUpgrade_(){this.secondaryConn_.start(),this.log_("sending client ack on secondary"),this.secondaryConn_.send({t:"c",d:{t:fC,d:{}}}),this.log_("Ending transmission on primary"),this.conn_.send({t:"c",d:{t:pC,d:{}}}),this.tx_=this.secondaryConn_,this.tryCleanupConnection()}onPrimaryMessageReceived_(e){const t=cu("t",e),r=cu("d",e);t==="c"?this.onControl_(r):t==="d"&&this.onDataMessage_(r)}onDataMessage_(e){this.onPrimaryResponse_(),this.onMessage_(e)}onPrimaryResponse_(){this.isHealthy_||(this.primaryResponsesRequired_--,this.primaryResponsesRequired_<=0&&(this.log_("Primary connection is healthy."),this.isHealthy_=!0,this.conn_.markConnectionHealthy()))}onControl_(e){const t=cu(dy,e);if(uC in e){const r=e[uC];if(t===jF){const s={...r};this.repoInfo_.isUsingEmulator&&(s.h=this.repoInfo_.host),this.onHandshake_(s)}else if(t===pC){this.log_("recvd end transmission on primary"),this.rx_=this.secondaryConn_;for(let s=0;s<this.pendingDataMessages.length;++s)this.onDataMessage_(this.pendingDataMessages[s]);this.pendingDataMessages=[],this.tryCleanupConnection()}else t===MF?this.onConnectionShutdown_(r):t===dC?this.onReset_(r):t===LF?s_("Server Error: "+r):t===hC?(this.log_("got pong on primary."),this.onPrimaryResponse_(),this.sendPingOnPrimaryIfNecessary_()):s_("Unknown control packet command: "+t)}}onHandshake_(e){const t=e.ts,r=e.v,s=e.h;this.sessionId=e.s,this.repoInfo_.host=s,this.state_===0&&(this.conn_.start(),this.onConnectionEstablished_(this.conn_,t),Wv!==r&&zn("Protocol version mismatch detected"),this.tryStartUpgrade_())}tryStartUpgrade_(){const e=this.transportManager_.upgradeTransport();e&&this.startUpgrade_(e)}startUpgrade_(e){this.secondaryConn_=new e(this.nextTransportId_(),this.repoInfo_,this.applicationId_,this.appCheckToken_,this.authToken_,this.sessionId),this.secondaryResponsesRequired_=e.responsesRequiredToBeHealthy||0;const t=this.connReceiver_(this.secondaryConn_),r=this.disconnReceiver_(this.secondaryConn_);this.secondaryConn_.open(t,r),Nu(()=>{this.secondaryConn_&&(this.log_("Timed out trying to upgrade."),this.secondaryConn_.close())},Math.floor(NF))}onReset_(e){this.log_("Reset packet received.  New host: "+e),this.repoInfo_.host=e,this.state_===1?this.close():(this.closeConnections_(),this.start_())}onConnectionEstablished_(e,t){this.log_("Realtime connection established."),this.conn_=e,this.state_=1,this.onReady_&&(this.onReady_(t,this.sessionId),this.onReady_=null),this.primaryResponsesRequired_===0?(this.log_("Primary connection is healthy."),this.isHealthy_=!0):Nu(()=>{this.sendPingOnPrimaryIfNecessary_()},Math.floor(PF))}sendPingOnPrimaryIfNecessary_(){!this.isHealthy_&&this.state_===1&&(this.log_("sending ping on primary."),this.sendData_({t:"c",d:{t:mC,d:{}}}))}onSecondaryConnectionLost_(){const e=this.secondaryConn_;this.secondaryConn_=null,(this.tx_===e||this.rx_===e)&&this.close()}onConnectionLost_(e){this.conn_=null,!e&&this.state_===0?(this.log_("Realtime connection failed."),this.repoInfo_.isCacheableHost()&&(na.remove("host:"+this.repoInfo_.host),this.repoInfo_.internalHost=this.repoInfo_.host)):this.state_===1&&this.log_("Realtime connection lost."),this.close()}onConnectionShutdown_(e){this.log_("Connection shutdown command received. Shutting down..."),this.onKill_&&(this.onKill_(e),this.onKill_=null),this.onDisconnect_=null,this.close()}sendData_(e){if(this.state_!==1)throw"Connection is not connected";this.tx_.send(e)}close(){this.state_!==2&&(this.log_("Closing realtime connection."),this.state_=2,this.closeConnections_(),this.onDisconnect_&&(this.onDisconnect_(),this.onDisconnect_=null))}closeConnections_(){this.log_("Shutting down all connections"),this.conn_&&(this.conn_.close(),this.conn_=null),this.secondaryConn_&&(this.secondaryConn_.close(),this.secondaryConn_=null),this.healthyTimeout_&&(clearTimeout(this.healthyTimeout_),this.healthyTimeout_=null)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class $R{put(e,t,r,s){}merge(e,t,r,s){}refreshAuthToken(e){}refreshAppCheckToken(e){}onDisconnectPut(e,t,r){}onDisconnectMerge(e,t,r){}onDisconnectCancel(e,t){}reportStats(e){}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class WR{constructor(e){this.allowedEvents_=e,this.listeners_={},le(Array.isArray(e)&&e.length>0,"Requires a non-empty array")}trigger(e,...t){if(Array.isArray(this.listeners_[e])){const r=[...this.listeners_[e]];for(let s=0;s<r.length;s++)r[s].callback.apply(r[s].context,t)}}on(e,t,r){this.validateEventType_(e),this.listeners_[e]=this.listeners_[e]||[],this.listeners_[e].push({callback:t,context:r});const s=this.getInitialEvent(e);s&&t.apply(r,s)}off(e,t,r){this.validateEventType_(e);const s=this.listeners_[e]||[];for(let o=0;o<s.length;o++)if(s[o].callback===t&&(!r||r===s[o].context)){s.splice(o,1);return}}validateEventType_(e){le(this.allowedEvents_.find(t=>t===e),"Unknown event: "+e)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class qf extends WR{static getInstance(){return new qf}constructor(){super(["online"]),this.online_=!0,typeof window<"u"&&typeof window.addEventListener<"u"&&!L_()&&(window.addEventListener("online",()=>{this.online_||(this.online_=!0,this.trigger("online",!0))},!1),window.addEventListener("offline",()=>{this.online_&&(this.online_=!1,this.trigger("online",!1))},!1))}getInitialEvent(e){return le(e==="online","Unknown event type: "+e),[this.online_]}currentlyOnline(){return this.online_}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const gC=32,yC=768;class dt{constructor(e,t){if(t===void 0){this.pieces_=e.split("/");let r=0;for(let s=0;s<this.pieces_.length;s++)this.pieces_[s].length>0&&(this.pieces_[r]=this.pieces_[s],r++);this.pieces_.length=r,this.pieceNum_=0}else this.pieces_=e,this.pieceNum_=t}toString(){let e="";for(let t=this.pieceNum_;t<this.pieces_.length;t++)this.pieces_[t]!==""&&(e+="/"+this.pieces_[t]);return e||"/"}}function at(){return new dt("")}function He(n){return n.pieceNum_>=n.pieces_.length?null:n.pieces_[n.pieceNum_]}function mo(n){return n.pieces_.length-n.pieceNum_}function ft(n){let e=n.pieceNum_;return e<n.pieces_.length&&e++,new dt(n.pieces_,e)}function Gv(n){return n.pieceNum_<n.pieces_.length?n.pieces_[n.pieces_.length-1]:null}function FF(n){let e="";for(let t=n.pieceNum_;t<n.pieces_.length;t++)n.pieces_[t]!==""&&(e+="/"+encodeURIComponent(String(n.pieces_[t])));return e||"/"}function Ku(n,e=0){return n.pieces_.slice(n.pieceNum_+e)}function HR(n){if(n.pieceNum_>=n.pieces_.length)return null;const e=[];for(let t=n.pieceNum_;t<n.pieces_.length-1;t++)e.push(n.pieces_[t]);return new dt(e,0)}function Mt(n,e){const t=[];for(let r=n.pieceNum_;r<n.pieces_.length;r++)t.push(n.pieces_[r]);if(e instanceof dt)for(let r=e.pieceNum_;r<e.pieces_.length;r++)t.push(e.pieces_[r]);else{const r=e.split("/");for(let s=0;s<r.length;s++)r[s].length>0&&t.push(r[s])}return new dt(t,0)}function Ge(n){return n.pieceNum_>=n.pieces_.length}function Fn(n,e){const t=He(n),r=He(e);if(t===null)return e;if(t===r)return Fn(ft(n),ft(e));throw new Error("INTERNAL ERROR: innerPath ("+e+") is not within outerPath ("+n+")")}function UF(n,e){const t=Ku(n,0),r=Ku(e,0);for(let s=0;s<t.length&&s<r.length;s++){const o=wa(t[s],r[s]);if(o!==0)return o}return t.length===r.length?0:t.length<r.length?-1:1}function Kv(n,e){if(mo(n)!==mo(e))return!1;for(let t=n.pieceNum_,r=e.pieceNum_;t<=n.pieces_.length;t++,r++)if(n.pieces_[t]!==e.pieces_[r])return!1;return!0}function mr(n,e){let t=n.pieceNum_,r=e.pieceNum_;if(mo(n)>mo(e))return!1;for(;t<n.pieces_.length;){if(n.pieces_[t]!==e.pieces_[r])return!1;++t,++r}return!0}class zF{constructor(e,t){this.errorPrefix_=t,this.parts_=Ku(e,0),this.byteLength_=Math.max(1,this.parts_.length);for(let r=0;r<this.parts_.length;r++)this.byteLength_+=wp(this.parts_[r]);qR(this)}}function BF(n,e){n.parts_.length>0&&(n.byteLength_+=1),n.parts_.push(e),n.byteLength_+=wp(e),qR(n)}function $F(n){const e=n.parts_.pop();n.byteLength_-=wp(e),n.parts_.length>0&&(n.byteLength_-=1)}function qR(n){if(n.byteLength_>yC)throw new Error(n.errorPrefix_+"has a key path longer than "+yC+" bytes ("+n.byteLength_+").");if(n.parts_.length>gC)throw new Error(n.errorPrefix_+"path specified exceeds the maximum depth that can be written ("+gC+") or object contains a cycle "+ea(n))}function ea(n){return n.parts_.length===0?"":"in property '"+n.parts_.join(".")+"'"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Qv extends WR{static getInstance(){return new Qv}constructor(){super(["visible"]);let e,t;typeof document<"u"&&typeof document.addEventListener<"u"&&(typeof document.hidden<"u"?(t="visibilitychange",e="hidden"):typeof document.mozHidden<"u"?(t="mozvisibilitychange",e="mozHidden"):typeof document.msHidden<"u"?(t="msvisibilitychange",e="msHidden"):typeof document.webkitHidden<"u"&&(t="webkitvisibilitychange",e="webkitHidden")),this.visible_=!0,t&&document.addEventListener(t,()=>{const r=!document[e];r!==this.visible_&&(this.visible_=r,this.trigger("visible",r))},!1)}getInitialEvent(e){return le(e==="visible","Unknown event type: "+e),[this.visible_]}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const uu=1e3,WF=300*1e3,_C=30*1e3,HF=1.3,qF=3e4,GF="server_kill",vC=3;class Ys extends $R{constructor(e,t,r,s,o,l,u,h){if(super(),this.repoInfo_=e,this.applicationId_=t,this.onDataUpdate_=r,this.onConnectStatus_=s,this.onServerInfoUpdate_=o,this.authTokenProvider_=l,this.appCheckTokenProvider_=u,this.authOverride_=h,this.id=Ys.nextPersistentConnectionId_++,this.log_=vd("p:"+this.id+":"),this.interruptReasons_={},this.listens=new Map,this.outstandingPuts_=[],this.outstandingGets_=[],this.outstandingPutCount_=0,this.outstandingGetCount_=0,this.onDisconnectRequestQueue_=[],this.connected_=!1,this.reconnectDelay_=uu,this.maxReconnectDelay_=WF,this.securityDebugCallback_=null,this.lastSessionId=null,this.establishConnectionTimer_=null,this.visible_=!1,this.requestCBHash_={},this.requestNumber_=0,this.realtime_=null,this.authToken_=null,this.appCheckToken_=null,this.forceTokenRefresh_=!1,this.invalidAuthTokenCount_=0,this.invalidAppCheckTokenCount_=0,this.firstConnection_=!0,this.lastConnectionAttemptTime_=null,this.lastConnectionEstablishedTime_=null,h)throw new Error("Auth override specified in options, but not supported on non Node.js platforms");Qv.getInstance().on("visible",this.onVisible_,this),e.host.indexOf("fblocal")===-1&&qf.getInstance().on("online",this.onOnline_,this)}sendRequest(e,t,r){const s=++this.requestNumber_,o={r:s,a:e,b:t};this.log_(en(o)),le(this.connected_,"sendRequest call when we're not connected not allowed."),this.realtime_.sendRequest(o),r&&(this.requestCBHash_[s]=r)}get(e){this.initConnection_();const t=new Hs,s={action:"g",request:{p:e._path.toString(),q:e._queryObject},onComplete:l=>{const u=l.d;l.s==="ok"?t.resolve(u):t.reject(u)}};this.outstandingGets_.push(s),this.outstandingGetCount_++;const o=this.outstandingGets_.length-1;return this.connected_&&this.sendGet_(o),t.promise}listen(e,t,r,s){this.initConnection_();const o=e._queryIdentifier,l=e._path.toString();this.log_("Listen called for "+l+" "+o),this.listens.has(l)||this.listens.set(l,new Map),le(e._queryParams.isDefault()||!e._queryParams.loadsAllData(),"listen() called for non-default but complete query"),le(!this.listens.get(l).has(o),"listen() called twice for same path/queryId.");const u={onComplete:s,hashFn:t,query:e,tag:r};this.listens.get(l).set(o,u),this.connected_&&this.sendListen_(u)}sendGet_(e){const t=this.outstandingGets_[e];this.sendRequest("g",t.request,r=>{delete this.outstandingGets_[e],this.outstandingGetCount_--,this.outstandingGetCount_===0&&(this.outstandingGets_=[]),t.onComplete&&t.onComplete(r)})}sendListen_(e){const t=e.query,r=t._path.toString(),s=t._queryIdentifier;this.log_("Listen on "+r+" for "+s);const o={p:r},l="q";e.tag&&(o.q=t._queryObject,o.t=e.tag),o.h=e.hashFn(),this.sendRequest(l,o,u=>{const h=u.d,p=u.s;Ys.warnOnListenWarnings_(h,t),(this.listens.get(r)&&this.listens.get(r).get(s))===e&&(this.log_("listen response",u),p!=="ok"&&this.removeListen_(r,s),e.onComplete&&e.onComplete(p,h))})}static warnOnListenWarnings_(e,t){if(e&&typeof e=="object"&&Es(e,"w")){const r=Ll(e,"w");if(Array.isArray(r)&&~r.indexOf("no_index")){const s='".indexOn": "'+t._queryParams.getIndex().toString()+'"',o=t._path.toString();zn(`Using an unspecified index. Your data will be downloaded and filtered on the client. Consider adding ${s} at ${o} to your security rules for better performance.`)}}}refreshAuthToken(e){this.authToken_=e,this.log_("Auth token refreshed"),this.authToken_?this.tryAuth():this.connected_&&this.sendRequest("unauth",{},()=>{}),this.reduceReconnectDelayIfAdminCredential_(e)}reduceReconnectDelayIfAdminCredential_(e){(e&&e.length===40||JP(e))&&(this.log_("Admin auth credential detected.  Reducing max reconnect time."),this.maxReconnectDelay_=_C)}refreshAppCheckToken(e){this.appCheckToken_=e,this.log_("App check token refreshed"),this.appCheckToken_?this.tryAppCheck():this.connected_&&this.sendRequest("unappeck",{},()=>{})}tryAuth(){if(this.connected_&&this.authToken_){const e=this.authToken_,t=XP(e)?"auth":"gauth",r={cred:e};this.authOverride_===null?r.noauth=!0:typeof this.authOverride_=="object"&&(r.authvar=this.authOverride_),this.sendRequest(t,r,s=>{const o=s.s,l=s.d||"error";this.authToken_===e&&(o==="ok"?this.invalidAuthTokenCount_=0:this.onAuthRevoked_(o,l))})}}tryAppCheck(){this.connected_&&this.appCheckToken_&&this.sendRequest("appcheck",{token:this.appCheckToken_},e=>{const t=e.s,r=e.d||"error";t==="ok"?this.invalidAppCheckTokenCount_=0:this.onAppCheckRevoked_(t,r)})}unlisten(e,t){const r=e._path.toString(),s=e._queryIdentifier;this.log_("Unlisten called for "+r+" "+s),le(e._queryParams.isDefault()||!e._queryParams.loadsAllData(),"unlisten() called for non-default but complete query"),this.removeListen_(r,s)&&this.connected_&&this.sendUnlisten_(r,s,e._queryObject,t)}sendUnlisten_(e,t,r,s){this.log_("Unlisten on "+e+" for "+t);const o={p:e},l="n";s&&(o.q=r,o.t=s),this.sendRequest(l,o)}onDisconnectPut(e,t,r){this.initConnection_(),this.connected_?this.sendOnDisconnect_("o",e,t,r):this.onDisconnectRequestQueue_.push({pathString:e,action:"o",data:t,onComplete:r})}onDisconnectMerge(e,t,r){this.initConnection_(),this.connected_?this.sendOnDisconnect_("om",e,t,r):this.onDisconnectRequestQueue_.push({pathString:e,action:"om",data:t,onComplete:r})}onDisconnectCancel(e,t){this.initConnection_(),this.connected_?this.sendOnDisconnect_("oc",e,null,t):this.onDisconnectRequestQueue_.push({pathString:e,action:"oc",data:null,onComplete:t})}sendOnDisconnect_(e,t,r,s){const o={p:t,d:r};this.log_("onDisconnect "+e,o),this.sendRequest(e,o,l=>{s&&setTimeout(()=>{s(l.s,l.d)},Math.floor(0))})}put(e,t,r,s){this.putInternal("p",e,t,r,s)}merge(e,t,r,s){this.putInternal("m",e,t,r,s)}putInternal(e,t,r,s,o){this.initConnection_();const l={p:t,d:r};o!==void 0&&(l.h=o),this.outstandingPuts_.push({action:e,request:l,onComplete:s}),this.outstandingPutCount_++;const u=this.outstandingPuts_.length-1;this.connected_?this.sendPut_(u):this.log_("Buffering put: "+t)}sendPut_(e){const t=this.outstandingPuts_[e].action,r=this.outstandingPuts_[e].request,s=this.outstandingPuts_[e].onComplete;this.outstandingPuts_[e].queued=this.connected_,this.sendRequest(t,r,o=>{this.log_(t+" response",o),delete this.outstandingPuts_[e],this.outstandingPutCount_--,this.outstandingPutCount_===0&&(this.outstandingPuts_=[]),s&&s(o.s,o.d)})}reportStats(e){if(this.connected_){const t={c:e};this.log_("reportStats",t),this.sendRequest("s",t,r=>{if(r.s!=="ok"){const o=r.d;this.log_("reportStats","Error sending stats: "+o)}})}}onDataMessage_(e){if("r"in e){this.log_("from server: "+en(e));const t=e.r,r=this.requestCBHash_[t];r&&(delete this.requestCBHash_[t],r(e.b))}else{if("error"in e)throw"A server-side error has occurred: "+e.error;"a"in e&&this.onDataPush_(e.a,e.b)}}onDataPush_(e,t){this.log_("handleServerMessage",e,t),e==="d"?this.onDataUpdate_(t.p,t.d,!1,t.t):e==="m"?this.onDataUpdate_(t.p,t.d,!0,t.t):e==="c"?this.onListenRevoked_(t.p,t.q):e==="ac"?this.onAuthRevoked_(t.s,t.d):e==="apc"?this.onAppCheckRevoked_(t.s,t.d):e==="sd"?this.onSecurityDebugPacket_(t):s_("Unrecognized action received from server: "+en(e)+`
Are you using the latest client?`)}onReady_(e,t){this.log_("connection ready"),this.connected_=!0,this.lastConnectionEstablishedTime_=new Date().getTime(),this.handleTimestamp_(e),this.lastSessionId=t,this.firstConnection_&&this.sendConnectStats_(),this.restoreState_(),this.firstConnection_=!1,this.onConnectStatus_(!0)}scheduleConnect_(e){le(!this.realtime_,"Scheduling a connect when we're already connected/ing?"),this.establishConnectionTimer_&&clearTimeout(this.establishConnectionTimer_),this.establishConnectionTimer_=setTimeout(()=>{this.establishConnectionTimer_=null,this.establishConnection_()},Math.floor(e))}initConnection_(){!this.realtime_&&this.firstConnection_&&this.scheduleConnect_(0)}onVisible_(e){e&&!this.visible_&&this.reconnectDelay_===this.maxReconnectDelay_&&(this.log_("Window became visible.  Reducing delay."),this.reconnectDelay_=uu,this.realtime_||this.scheduleConnect_(0)),this.visible_=e}onOnline_(e){e?(this.log_("Browser went online."),this.reconnectDelay_=uu,this.realtime_||this.scheduleConnect_(0)):(this.log_("Browser went offline.  Killing connection."),this.realtime_&&this.realtime_.close())}onRealtimeDisconnect_(){if(this.log_("data client disconnected"),this.connected_=!1,this.realtime_=null,this.cancelSentTransactions_(),this.requestCBHash_={},this.shouldReconnect_()){this.visible_?this.lastConnectionEstablishedTime_&&(new Date().getTime()-this.lastConnectionEstablishedTime_>qF&&(this.reconnectDelay_=uu),this.lastConnectionEstablishedTime_=null):(this.log_("Window isn't visible.  Delaying reconnect."),this.reconnectDelay_=this.maxReconnectDelay_,this.lastConnectionAttemptTime_=new Date().getTime());const e=Math.max(0,new Date().getTime()-this.lastConnectionAttemptTime_);let t=Math.max(0,this.reconnectDelay_-e);t=Math.random()*t,this.log_("Trying to reconnect in "+t+"ms"),this.scheduleConnect_(t),this.reconnectDelay_=Math.min(this.maxReconnectDelay_,this.reconnectDelay_*HF)}this.onConnectStatus_(!1)}async establishConnection_(){if(this.shouldReconnect_()){this.log_("Making a connection attempt"),this.lastConnectionAttemptTime_=new Date().getTime(),this.lastConnectionEstablishedTime_=null;const e=this.onDataMessage_.bind(this),t=this.onReady_.bind(this),r=this.onRealtimeDisconnect_.bind(this),s=this.id+":"+Ys.nextConnectionId_++,o=this.lastSessionId;let l=!1,u=null;const h=function(){u?u.close():(l=!0,r())},p=function(_){le(u,"sendRequest call when we're not connected not allowed."),u.sendRequest(_)};this.realtime_={close:h,sendRequest:p};const g=this.forceTokenRefresh_;this.forceTokenRefresh_=!1;try{const[_,v]=await Promise.all([this.authTokenProvider_.getToken(g),this.appCheckTokenProvider_.getToken(g)]);l?an("getToken() completed but was canceled"):(an("getToken() completed. Creating connection."),this.authToken_=_&&_.accessToken,this.appCheckToken_=v&&v.token,u=new VF(s,this.repoInfo_,this.applicationId_,this.appCheckToken_,this.authToken_,e,t,r,T=>{zn(T+" ("+this.repoInfo_.toString()+")"),this.interrupt(GF)},o))}catch(_){this.log_("Failed to get token: "+_),l||(this.repoInfo_.nodeAdmin&&zn(_),h())}}}interrupt(e){an("Interrupting connection for reason: "+e),this.interruptReasons_[e]=!0,this.realtime_?this.realtime_.close():(this.establishConnectionTimer_&&(clearTimeout(this.establishConnectionTimer_),this.establishConnectionTimer_=null),this.connected_&&this.onRealtimeDisconnect_())}resume(e){an("Resuming connection for reason: "+e),delete this.interruptReasons_[e],Cf(this.interruptReasons_)&&(this.reconnectDelay_=uu,this.realtime_||this.scheduleConnect_(0))}handleTimestamp_(e){const t=e-new Date().getTime();this.onServerInfoUpdate_({serverTimeOffset:t})}cancelSentTransactions_(){for(let e=0;e<this.outstandingPuts_.length;e++){const t=this.outstandingPuts_[e];t&&"h"in t.request&&t.queued&&(t.onComplete&&t.onComplete("disconnect"),delete this.outstandingPuts_[e],this.outstandingPutCount_--)}this.outstandingPutCount_===0&&(this.outstandingPuts_=[])}onListenRevoked_(e,t){let r;t?r=t.map(o=>$v(o)).join("$"):r="default";const s=this.removeListen_(e,r);s&&s.onComplete&&s.onComplete("permission_denied")}removeListen_(e,t){const r=new dt(e).toString();let s;if(this.listens.has(r)){const o=this.listens.get(r);s=o.get(t),o.delete(t),o.size===0&&this.listens.delete(r)}else s=void 0;return s}onAuthRevoked_(e,t){an("Auth token revoked: "+e+"/"+t),this.authToken_=null,this.forceTokenRefresh_=!0,this.realtime_.close(),(e==="invalid_token"||e==="permission_denied")&&(this.invalidAuthTokenCount_++,this.invalidAuthTokenCount_>=vC&&(this.reconnectDelay_=_C,this.authTokenProvider_.notifyForInvalidToken()))}onAppCheckRevoked_(e,t){an("App check token revoked: "+e+"/"+t),this.appCheckToken_=null,this.forceTokenRefresh_=!0,(e==="invalid_token"||e==="permission_denied")&&(this.invalidAppCheckTokenCount_++,this.invalidAppCheckTokenCount_>=vC&&this.appCheckTokenProvider_.notifyForInvalidToken())}onSecurityDebugPacket_(e){this.securityDebugCallback_?this.securityDebugCallback_(e):"msg"in e&&console.log("FIREBASE: "+e.msg.replace(`
`,`
FIREBASE: `))}restoreState_(){this.tryAuth(),this.tryAppCheck();for(const e of this.listens.values())for(const t of e.values())this.sendListen_(t);for(let e=0;e<this.outstandingPuts_.length;e++)this.outstandingPuts_[e]&&this.sendPut_(e);for(;this.onDisconnectRequestQueue_.length;){const e=this.onDisconnectRequestQueue_.shift();this.sendOnDisconnect_(e.action,e.pathString,e.data,e.onComplete)}for(let e=0;e<this.outstandingGets_.length;e++)this.outstandingGets_[e]&&this.sendGet_(e)}sendConnectStats_(){const e={};let t="js";e["sdk."+t+"."+xR.replace(/\./g,"-")]=1,L_()?e["framework.cordova"]=1:zS()&&(e["framework.reactnative"]=1),this.reportStats(e)}shouldReconnect_(){const e=qf.getInstance().currentlyOnline();return Cf(this.interruptReasons_)&&e}}Ys.nextPersistentConnectionId_=0;Ys.nextConnectionId_=0;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ke{constructor(e,t){this.name=e,this.node=t}static Wrap(e,t){return new Ke(e,t)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Yp{getCompare(){return this.compare.bind(this)}indexedValueChanged(e,t){const r=new Ke(Hl,e),s=new Ke(Hl,t);return this.compare(r,s)!==0}minPost(){return Ke.MIN}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let Yh;class GR extends Yp{static get __EMPTY_NODE(){return Yh}static set __EMPTY_NODE(e){Yh=e}compare(e,t){return wa(e.name,t.name)}isDefinedOn(e){throw Zl("KeyIndex.isDefinedOn not expected to be called.")}indexedValueChanged(e,t){return!1}minPost(){return Ke.MIN}maxPost(){return new Ke(da,Yh)}makePost(e,t){return le(typeof e=="string","KeyIndex indexValue must always be a string."),new Ke(e,Yh)}toString(){return".key"}}const Nl=new GR;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Xh{constructor(e,t,r,s,o=null){this.isReverse_=s,this.resultGenerator_=o,this.nodeStack_=[];let l=1;for(;!e.isEmpty();)if(e=e,l=t?r(e.key,t):1,s&&(l*=-1),l<0)this.isReverse_?e=e.left:e=e.right;else if(l===0){this.nodeStack_.push(e);break}else this.nodeStack_.push(e),this.isReverse_?e=e.right:e=e.left}getNext(){if(this.nodeStack_.length===0)return null;let e=this.nodeStack_.pop(),t;if(this.resultGenerator_?t=this.resultGenerator_(e.key,e.value):t={key:e.key,value:e.value},this.isReverse_)for(e=e.left;!e.isEmpty();)this.nodeStack_.push(e),e=e.right;else for(e=e.right;!e.isEmpty();)this.nodeStack_.push(e),e=e.left;return t}hasNext(){return this.nodeStack_.length>0}peek(){if(this.nodeStack_.length===0)return null;const e=this.nodeStack_[this.nodeStack_.length-1];return this.resultGenerator_?this.resultGenerator_(e.key,e.value):{key:e.key,value:e.value}}}class Zt{constructor(e,t,r,s,o){this.key=e,this.value=t,this.color=r??Zt.RED,this.left=s??Un.EMPTY_NODE,this.right=o??Un.EMPTY_NODE}copy(e,t,r,s,o){return new Zt(e??this.key,t??this.value,r??this.color,s??this.left,o??this.right)}count(){return this.left.count()+1+this.right.count()}isEmpty(){return!1}inorderTraversal(e){return this.left.inorderTraversal(e)||!!e(this.key,this.value)||this.right.inorderTraversal(e)}reverseTraversal(e){return this.right.reverseTraversal(e)||e(this.key,this.value)||this.left.reverseTraversal(e)}min_(){return this.left.isEmpty()?this:this.left.min_()}minKey(){return this.min_().key}maxKey(){return this.right.isEmpty()?this.key:this.right.maxKey()}insert(e,t,r){let s=this;const o=r(e,s.key);return o<0?s=s.copy(null,null,null,s.left.insert(e,t,r),null):o===0?s=s.copy(null,t,null,null,null):s=s.copy(null,null,null,null,s.right.insert(e,t,r)),s.fixUp_()}removeMin_(){if(this.left.isEmpty())return Un.EMPTY_NODE;let e=this;return!e.left.isRed_()&&!e.left.left.isRed_()&&(e=e.moveRedLeft_()),e=e.copy(null,null,null,e.left.removeMin_(),null),e.fixUp_()}remove(e,t){let r,s;if(r=this,t(e,r.key)<0)!r.left.isEmpty()&&!r.left.isRed_()&&!r.left.left.isRed_()&&(r=r.moveRedLeft_()),r=r.copy(null,null,null,r.left.remove(e,t),null);else{if(r.left.isRed_()&&(r=r.rotateRight_()),!r.right.isEmpty()&&!r.right.isRed_()&&!r.right.left.isRed_()&&(r=r.moveRedRight_()),t(e,r.key)===0){if(r.right.isEmpty())return Un.EMPTY_NODE;s=r.right.min_(),r=r.copy(s.key,s.value,null,null,r.right.removeMin_())}r=r.copy(null,null,null,null,r.right.remove(e,t))}return r.fixUp_()}isRed_(){return this.color}fixUp_(){let e=this;return e.right.isRed_()&&!e.left.isRed_()&&(e=e.rotateLeft_()),e.left.isRed_()&&e.left.left.isRed_()&&(e=e.rotateRight_()),e.left.isRed_()&&e.right.isRed_()&&(e=e.colorFlip_()),e}moveRedLeft_(){let e=this.colorFlip_();return e.right.left.isRed_()&&(e=e.copy(null,null,null,null,e.right.rotateRight_()),e=e.rotateLeft_(),e=e.colorFlip_()),e}moveRedRight_(){let e=this.colorFlip_();return e.left.left.isRed_()&&(e=e.rotateRight_(),e=e.colorFlip_()),e}rotateLeft_(){const e=this.copy(null,null,Zt.RED,null,this.right.left);return this.right.copy(null,null,this.color,e,null)}rotateRight_(){const e=this.copy(null,null,Zt.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,e)}colorFlip_(){const e=this.left.copy(null,null,!this.left.color,null,null),t=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,e,t)}checkMaxDepth_(){const e=this.check_();return Math.pow(2,e)<=this.count()+1}check_(){if(this.isRed_()&&this.left.isRed_())throw new Error("Red node has red child("+this.key+","+this.value+")");if(this.right.isRed_())throw new Error("Right child of ("+this.key+","+this.value+") is red");const e=this.left.check_();if(e!==this.right.check_())throw new Error("Black depths differ");return e+(this.isRed_()?0:1)}}Zt.RED=!0;Zt.BLACK=!1;class KF{copy(e,t,r,s,o){return this}insert(e,t,r){return new Zt(e,t,null)}remove(e,t){return this}count(){return 0}isEmpty(){return!0}inorderTraversal(e){return!1}reverseTraversal(e){return!1}minKey(){return null}maxKey(){return null}check_(){return 0}isRed_(){return!1}}class Un{constructor(e,t=Un.EMPTY_NODE){this.comparator_=e,this.root_=t}insert(e,t){return new Un(this.comparator_,this.root_.insert(e,t,this.comparator_).copy(null,null,Zt.BLACK,null,null))}remove(e){return new Un(this.comparator_,this.root_.remove(e,this.comparator_).copy(null,null,Zt.BLACK,null,null))}get(e){let t,r=this.root_;for(;!r.isEmpty();){if(t=this.comparator_(e,r.key),t===0)return r.value;t<0?r=r.left:t>0&&(r=r.right)}return null}getPredecessorKey(e){let t,r=this.root_,s=null;for(;!r.isEmpty();)if(t=this.comparator_(e,r.key),t===0){if(r.left.isEmpty())return s?s.key:null;for(r=r.left;!r.right.isEmpty();)r=r.right;return r.key}else t<0?r=r.left:t>0&&(s=r,r=r.right);throw new Error("Attempted to find predecessor key for a nonexistent key.  What gives?")}isEmpty(){return this.root_.isEmpty()}count(){return this.root_.count()}minKey(){return this.root_.minKey()}maxKey(){return this.root_.maxKey()}inorderTraversal(e){return this.root_.inorderTraversal(e)}reverseTraversal(e){return this.root_.reverseTraversal(e)}getIterator(e){return new Xh(this.root_,null,this.comparator_,!1,e)}getIteratorFrom(e,t){return new Xh(this.root_,e,this.comparator_,!1,t)}getReverseIteratorFrom(e,t){return new Xh(this.root_,e,this.comparator_,!0,t)}getReverseIterator(e){return new Xh(this.root_,null,this.comparator_,!0,e)}}Un.EMPTY_NODE=new KF;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function QF(n,e){return wa(n.name,e.name)}function Yv(n,e){return wa(n,e)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let o_;function YF(n){o_=n}const KR=function(n){return typeof n=="number"?"number:"+IR(n):"string:"+n},QR=function(n){if(n.isLeafNode()){const e=n.val();le(typeof e=="string"||typeof e=="number"||typeof e=="object"&&Es(e,".sv"),"Priority must be a string or number.")}else le(n===o_||n.isEmpty(),"priority of unexpected type.");le(n===o_||n.getPriority().isEmpty(),"Priority nodes can't have a priority of their own.")};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let wC;class Xt{static set __childrenNodeConstructor(e){wC=e}static get __childrenNodeConstructor(){return wC}constructor(e,t=Xt.__childrenNodeConstructor.EMPTY_NODE){this.value_=e,this.priorityNode_=t,this.lazyHash_=null,le(this.value_!==void 0&&this.value_!==null,"LeafNode shouldn't be created with null/undefined value."),QR(this.priorityNode_)}isLeafNode(){return!0}getPriority(){return this.priorityNode_}updatePriority(e){return new Xt(this.value_,e)}getImmediateChild(e){return e===".priority"?this.priorityNode_:Xt.__childrenNodeConstructor.EMPTY_NODE}getChild(e){return Ge(e)?this:He(e)===".priority"?this.priorityNode_:Xt.__childrenNodeConstructor.EMPTY_NODE}hasChild(){return!1}getPredecessorChildName(e,t){return null}updateImmediateChild(e,t){return e===".priority"?this.updatePriority(t):t.isEmpty()&&e!==".priority"?this:Xt.__childrenNodeConstructor.EMPTY_NODE.updateImmediateChild(e,t).updatePriority(this.priorityNode_)}updateChild(e,t){const r=He(e);return r===null?t:t.isEmpty()&&r!==".priority"?this:(le(r!==".priority"||mo(e)===1,".priority must be the last token in a path"),this.updateImmediateChild(r,Xt.__childrenNodeConstructor.EMPTY_NODE.updateChild(ft(e),t)))}isEmpty(){return!1}numChildren(){return 0}forEachChild(e,t){return!1}val(e){return e&&!this.getPriority().isEmpty()?{".value":this.getValue(),".priority":this.getPriority().val()}:this.getValue()}hash(){if(this.lazyHash_===null){let e="";this.priorityNode_.isEmpty()||(e+="priority:"+KR(this.priorityNode_.val())+":");const t=typeof this.value_;e+=t+":",t==="number"?e+=IR(this.value_):e+=this.value_,this.lazyHash_=CR(e)}return this.lazyHash_}getValue(){return this.value_}compareTo(e){return e===Xt.__childrenNodeConstructor.EMPTY_NODE?1:e instanceof Xt.__childrenNodeConstructor?-1:(le(e.isLeafNode(),"Unknown node type"),this.compareToLeafNode_(e))}compareToLeafNode_(e){const t=typeof e.value_,r=typeof this.value_,s=Xt.VALUE_TYPE_ORDER.indexOf(t),o=Xt.VALUE_TYPE_ORDER.indexOf(r);return le(s>=0,"Unknown leaf type: "+t),le(o>=0,"Unknown leaf type: "+r),s===o?r==="object"?0:this.value_<e.value_?-1:this.value_===e.value_?0:1:o-s}withIndex(){return this}isIndexed(){return!0}equals(e){if(e===this)return!0;if(e.isLeafNode()){const t=e;return this.value_===t.value_&&this.priorityNode_.equals(t.priorityNode_)}else return!1}}Xt.VALUE_TYPE_ORDER=["object","boolean","number","string"];/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let YR,XR;function XF(n){YR=n}function JF(n){XR=n}class ZF extends Yp{compare(e,t){const r=e.node.getPriority(),s=t.node.getPriority(),o=r.compareTo(s);return o===0?wa(e.name,t.name):o}isDefinedOn(e){return!e.getPriority().isEmpty()}indexedValueChanged(e,t){return!e.getPriority().equals(t.getPriority())}minPost(){return Ke.MIN}maxPost(){return new Ke(da,new Xt("[PRIORITY-POST]",XR))}makePost(e,t){const r=YR(e);return new Ke(t,new Xt("[PRIORITY-POST]",r))}toString(){return".priority"}}const It=new ZF;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const eU=Math.log(2);class tU{constructor(e){const t=o=>parseInt(Math.log(o)/eU,10),r=o=>parseInt(Array(o+1).join("1"),2);this.count=t(e+1),this.current_=this.count-1;const s=r(this.count);this.bits_=e+1&s}nextBitIsOne(){const e=!(this.bits_&1<<this.current_);return this.current_--,e}}const Gf=function(n,e,t,r){n.sort(e);const s=function(h,p){const g=p-h;let _,v;if(g===0)return null;if(g===1)return _=n[h],v=t?t(_):_,new Zt(v,_.node,Zt.BLACK,null,null);{const T=parseInt(g/2,10)+h,A=s(h,T),I=s(T+1,p);return _=n[T],v=t?t(_):_,new Zt(v,_.node,Zt.BLACK,A,I)}},o=function(h){let p=null,g=null,_=n.length;const v=function(A,I){const b=_-A,j=_;_-=A;const U=s(b+1,j),$=n[b],G=t?t($):$;T(new Zt(G,$.node,I,null,U))},T=function(A){p?(p.left=A,p=A):(g=A,p=A)};for(let A=0;A<h.count;++A){const I=h.nextBitIsOne(),b=Math.pow(2,h.count-(A+1));I?v(b,Zt.BLACK):(v(b,Zt.BLACK),v(b,Zt.RED))}return g},l=new tU(n.length),u=o(l);return new Un(r||e,u)};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let hy;const ml={};class Ks{static get Default(){return le(ml&&It,"ChildrenNode.ts has not been loaded"),hy=hy||new Ks({".priority":ml},{".priority":It}),hy}constructor(e,t){this.indexes_=e,this.indexSet_=t}get(e){const t=Ll(this.indexes_,e);if(!t)throw new Error("No index defined for "+e);return t instanceof Un?t:null}hasIndex(e){return Es(this.indexSet_,e.toString())}addIndex(e,t){le(e!==Nl,"KeyIndex always exists and isn't meant to be added to the IndexMap.");const r=[];let s=!1;const o=t.getIterator(Ke.Wrap);let l=o.getNext();for(;l;)s=s||e.isDefinedOn(l.node),r.push(l),l=o.getNext();let u;s?u=Gf(r,e.getCompare()):u=ml;const h=e.toString(),p={...this.indexSet_};p[h]=e;const g={...this.indexes_};return g[h]=u,new Ks(g,p)}addToIndexes(e,t){const r=Sf(this.indexes_,(s,o)=>{const l=Ll(this.indexSet_,o);if(le(l,"Missing index implementation for "+o),s===ml)if(l.isDefinedOn(e.node)){const u=[],h=t.getIterator(Ke.Wrap);let p=h.getNext();for(;p;)p.name!==e.name&&u.push(p),p=h.getNext();return u.push(e),Gf(u,l.getCompare())}else return ml;else{const u=t.get(e.name);let h=s;return u&&(h=h.remove(new Ke(e.name,u))),h.insert(e,e.node)}});return new Ks(r,this.indexSet_)}removeFromIndexes(e,t){const r=Sf(this.indexes_,s=>{if(s===ml)return s;{const o=t.get(e.name);return o?s.remove(new Ke(e.name,o)):s}});return new Ks(r,this.indexSet_)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let du;class Me{static get EMPTY_NODE(){return du||(du=new Me(new Un(Yv),null,Ks.Default))}constructor(e,t,r){this.children_=e,this.priorityNode_=t,this.indexMap_=r,this.lazyHash_=null,this.priorityNode_&&QR(this.priorityNode_),this.children_.isEmpty()&&le(!this.priorityNode_||this.priorityNode_.isEmpty(),"An empty node cannot have a priority")}isLeafNode(){return!1}getPriority(){return this.priorityNode_||du}updatePriority(e){return this.children_.isEmpty()?this:new Me(this.children_,e,this.indexMap_)}getImmediateChild(e){if(e===".priority")return this.getPriority();{const t=this.children_.get(e);return t===null?du:t}}getChild(e){const t=He(e);return t===null?this:this.getImmediateChild(t).getChild(ft(e))}hasChild(e){return this.children_.get(e)!==null}updateImmediateChild(e,t){if(le(t,"We should always be passing snapshot nodes"),e===".priority")return this.updatePriority(t);{const r=new Ke(e,t);let s,o;t.isEmpty()?(s=this.children_.remove(e),o=this.indexMap_.removeFromIndexes(r,this.children_)):(s=this.children_.insert(e,t),o=this.indexMap_.addToIndexes(r,this.children_));const l=s.isEmpty()?du:this.priorityNode_;return new Me(s,l,o)}}updateChild(e,t){const r=He(e);if(r===null)return t;{le(He(e)!==".priority"||mo(e)===1,".priority must be the last token in a path");const s=this.getImmediateChild(r).updateChild(ft(e),t);return this.updateImmediateChild(r,s)}}isEmpty(){return this.children_.isEmpty()}numChildren(){return this.children_.count()}val(e){if(this.isEmpty())return null;const t={};let r=0,s=0,o=!0;if(this.forEachChild(It,(l,u)=>{t[l]=u.val(e),r++,o&&Me.INTEGER_REGEXP_.test(l)?s=Math.max(s,Number(l)):o=!1}),!e&&o&&s<2*r){const l=[];for(const u in t)l[u]=t[u];return l}else return e&&!this.getPriority().isEmpty()&&(t[".priority"]=this.getPriority().val()),t}hash(){if(this.lazyHash_===null){let e="";this.getPriority().isEmpty()||(e+="priority:"+KR(this.getPriority().val())+":"),this.forEachChild(It,(t,r)=>{const s=r.hash();s!==""&&(e+=":"+t+":"+s)}),this.lazyHash_=e===""?"":CR(e)}return this.lazyHash_}getPredecessorChildName(e,t,r){const s=this.resolveIndex_(r);if(s){const o=s.getPredecessorKey(new Ke(e,t));return o?o.name:null}else return this.children_.getPredecessorKey(e)}getFirstChildName(e){const t=this.resolveIndex_(e);if(t){const r=t.minKey();return r&&r.name}else return this.children_.minKey()}getFirstChild(e){const t=this.getFirstChildName(e);return t?new Ke(t,this.children_.get(t)):null}getLastChildName(e){const t=this.resolveIndex_(e);if(t){const r=t.maxKey();return r&&r.name}else return this.children_.maxKey()}getLastChild(e){const t=this.getLastChildName(e);return t?new Ke(t,this.children_.get(t)):null}forEachChild(e,t){const r=this.resolveIndex_(e);return r?r.inorderTraversal(s=>t(s.name,s.node)):this.children_.inorderTraversal(t)}getIterator(e){return this.getIteratorFrom(e.minPost(),e)}getIteratorFrom(e,t){const r=this.resolveIndex_(t);if(r)return r.getIteratorFrom(e,s=>s);{const s=this.children_.getIteratorFrom(e.name,Ke.Wrap);let o=s.peek();for(;o!=null&&t.compare(o,e)<0;)s.getNext(),o=s.peek();return s}}getReverseIterator(e){return this.getReverseIteratorFrom(e.maxPost(),e)}getReverseIteratorFrom(e,t){const r=this.resolveIndex_(t);if(r)return r.getReverseIteratorFrom(e,s=>s);{const s=this.children_.getReverseIteratorFrom(e.name,Ke.Wrap);let o=s.peek();for(;o!=null&&t.compare(o,e)>0;)s.getNext(),o=s.peek();return s}}compareTo(e){return this.isEmpty()?e.isEmpty()?0:-1:e.isLeafNode()||e.isEmpty()?1:e===wd?-1:0}withIndex(e){if(e===Nl||this.indexMap_.hasIndex(e))return this;{const t=this.indexMap_.addIndex(e,this.children_);return new Me(this.children_,this.priorityNode_,t)}}isIndexed(e){return e===Nl||this.indexMap_.hasIndex(e)}equals(e){if(e===this)return!0;if(e.isLeafNode())return!1;{const t=e;if(this.getPriority().equals(t.getPriority()))if(this.children_.count()===t.children_.count()){const r=this.getIterator(It),s=t.getIterator(It);let o=r.getNext(),l=s.getNext();for(;o&&l;){if(o.name!==l.name||!o.node.equals(l.node))return!1;o=r.getNext(),l=s.getNext()}return o===null&&l===null}else return!1;else return!1}}resolveIndex_(e){return e===Nl?null:this.indexMap_.get(e.toString())}}Me.INTEGER_REGEXP_=/^(0|[1-9]\d*)$/;class nU extends Me{constructor(){super(new Un(Yv),Me.EMPTY_NODE,Ks.Default)}compareTo(e){return e===this?0:1}equals(e){return e===this}getPriority(){return this}getImmediateChild(e){return Me.EMPTY_NODE}isEmpty(){return!1}}const wd=new nU;Object.defineProperties(Ke,{MIN:{value:new Ke(Hl,Me.EMPTY_NODE)},MAX:{value:new Ke(da,wd)}});GR.__EMPTY_NODE=Me.EMPTY_NODE;Xt.__childrenNodeConstructor=Me;YF(wd);JF(wd);/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const rU=!0;function Ut(n,e=null){if(n===null)return Me.EMPTY_NODE;if(typeof n=="object"&&".priority"in n&&(e=n[".priority"]),le(e===null||typeof e=="string"||typeof e=="number"||typeof e=="object"&&".sv"in e,"Invalid priority type found: "+typeof e),typeof n=="object"&&".value"in n&&n[".value"]!==null&&(n=n[".value"]),typeof n!="object"||".sv"in n){const t=n;return new Xt(t,Ut(e))}if(!(n instanceof Array)&&rU){const t=[];let r=!1;if(xn(n,(l,u)=>{if(l.substring(0,1)!=="."){const h=Ut(u);h.isEmpty()||(r=r||!h.getPriority().isEmpty(),t.push(new Ke(l,h)))}}),t.length===0)return Me.EMPTY_NODE;const o=Gf(t,QF,l=>l.name,Yv);if(r){const l=Gf(t,It.getCompare());return new Me(o,Ut(e),new Ks({".priority":l},{".priority":It}))}else return new Me(o,Ut(e),Ks.Default)}else{let t=Me.EMPTY_NODE;return xn(n,(r,s)=>{if(Es(n,r)&&r.substring(0,1)!=="."){const o=Ut(s);(o.isLeafNode()||!o.isEmpty())&&(t=t.updateImmediateChild(r,o))}}),t.updatePriority(Ut(e))}}XF(Ut);/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class sU extends Yp{constructor(e){super(),this.indexPath_=e,le(!Ge(e)&&He(e)!==".priority","Can't create PathIndex with empty path or .priority key")}extractChild(e){return e.getChild(this.indexPath_)}isDefinedOn(e){return!e.getChild(this.indexPath_).isEmpty()}compare(e,t){const r=this.extractChild(e.node),s=this.extractChild(t.node),o=r.compareTo(s);return o===0?wa(e.name,t.name):o}makePost(e,t){const r=Ut(e),s=Me.EMPTY_NODE.updateChild(this.indexPath_,r);return new Ke(t,s)}maxPost(){const e=Me.EMPTY_NODE.updateChild(this.indexPath_,wd);return new Ke(da,e)}toString(){return Ku(this.indexPath_,0).join("/")}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class iU extends Yp{compare(e,t){const r=e.node.compareTo(t.node);return r===0?wa(e.name,t.name):r}isDefinedOn(e){return!0}indexedValueChanged(e,t){return!e.equals(t)}minPost(){return Ke.MIN}maxPost(){return Ke.MAX}makePost(e,t){const r=Ut(e);return new Ke(t,r)}toString(){return".value"}}const oU=new iU;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function JR(n){return{type:"value",snapshotNode:n}}function ql(n,e){return{type:"child_added",snapshotNode:e,childName:n}}function Qu(n,e){return{type:"child_removed",snapshotNode:e,childName:n}}function Yu(n,e,t){return{type:"child_changed",snapshotNode:e,childName:n,oldSnap:t}}function aU(n,e){return{type:"child_moved",snapshotNode:e,childName:n}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Xv{constructor(e){this.index_=e}updateChild(e,t,r,s,o,l){le(e.isIndexed(this.index_),"A node must be indexed if only a child is updated");const u=e.getImmediateChild(t);return u.getChild(s).equals(r.getChild(s))&&u.isEmpty()===r.isEmpty()||(l!=null&&(r.isEmpty()?e.hasChild(t)?l.trackChildChange(Qu(t,u)):le(e.isLeafNode(),"A child remove without an old child only makes sense on a leaf node"):u.isEmpty()?l.trackChildChange(ql(t,r)):l.trackChildChange(Yu(t,r,u))),e.isLeafNode()&&r.isEmpty())?e:e.updateImmediateChild(t,r).withIndex(this.index_)}updateFullNode(e,t,r){return r!=null&&(e.isLeafNode()||e.forEachChild(It,(s,o)=>{t.hasChild(s)||r.trackChildChange(Qu(s,o))}),t.isLeafNode()||t.forEachChild(It,(s,o)=>{if(e.hasChild(s)){const l=e.getImmediateChild(s);l.equals(o)||r.trackChildChange(Yu(s,o,l))}else r.trackChildChange(ql(s,o))})),t.withIndex(this.index_)}updatePriority(e,t){return e.isEmpty()?Me.EMPTY_NODE:e.updatePriority(t)}filtersNodes(){return!1}getIndexedFilter(){return this}getIndex(){return this.index_}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Xu{constructor(e){this.indexedFilter_=new Xv(e.getIndex()),this.index_=e.getIndex(),this.startPost_=Xu.getStartPost_(e),this.endPost_=Xu.getEndPost_(e),this.startIsInclusive_=!e.startAfterSet_,this.endIsInclusive_=!e.endBeforeSet_}getStartPost(){return this.startPost_}getEndPost(){return this.endPost_}matches(e){const t=this.startIsInclusive_?this.index_.compare(this.getStartPost(),e)<=0:this.index_.compare(this.getStartPost(),e)<0,r=this.endIsInclusive_?this.index_.compare(e,this.getEndPost())<=0:this.index_.compare(e,this.getEndPost())<0;return t&&r}updateChild(e,t,r,s,o,l){return this.matches(new Ke(t,r))||(r=Me.EMPTY_NODE),this.indexedFilter_.updateChild(e,t,r,s,o,l)}updateFullNode(e,t,r){t.isLeafNode()&&(t=Me.EMPTY_NODE);let s=t.withIndex(this.index_);s=s.updatePriority(Me.EMPTY_NODE);const o=this;return t.forEachChild(It,(l,u)=>{o.matches(new Ke(l,u))||(s=s.updateImmediateChild(l,Me.EMPTY_NODE))}),this.indexedFilter_.updateFullNode(e,s,r)}updatePriority(e,t){return e}filtersNodes(){return!0}getIndexedFilter(){return this.indexedFilter_}getIndex(){return this.index_}static getStartPost_(e){if(e.hasStart()){const t=e.getIndexStartName();return e.getIndex().makePost(e.getIndexStartValue(),t)}else return e.getIndex().minPost()}static getEndPost_(e){if(e.hasEnd()){const t=e.getIndexEndName();return e.getIndex().makePost(e.getIndexEndValue(),t)}else return e.getIndex().maxPost()}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class lU{constructor(e){this.withinDirectionalStart=t=>this.reverse_?this.withinEndPost(t):this.withinStartPost(t),this.withinDirectionalEnd=t=>this.reverse_?this.withinStartPost(t):this.withinEndPost(t),this.withinStartPost=t=>{const r=this.index_.compare(this.rangedFilter_.getStartPost(),t);return this.startIsInclusive_?r<=0:r<0},this.withinEndPost=t=>{const r=this.index_.compare(t,this.rangedFilter_.getEndPost());return this.endIsInclusive_?r<=0:r<0},this.rangedFilter_=new Xu(e),this.index_=e.getIndex(),this.limit_=e.getLimit(),this.reverse_=!e.isViewFromLeft(),this.startIsInclusive_=!e.startAfterSet_,this.endIsInclusive_=!e.endBeforeSet_}updateChild(e,t,r,s,o,l){return this.rangedFilter_.matches(new Ke(t,r))||(r=Me.EMPTY_NODE),e.getImmediateChild(t).equals(r)?e:e.numChildren()<this.limit_?this.rangedFilter_.getIndexedFilter().updateChild(e,t,r,s,o,l):this.fullLimitUpdateChild_(e,t,r,o,l)}updateFullNode(e,t,r){let s;if(t.isLeafNode()||t.isEmpty())s=Me.EMPTY_NODE.withIndex(this.index_);else if(this.limit_*2<t.numChildren()&&t.isIndexed(this.index_)){s=Me.EMPTY_NODE.withIndex(this.index_);let o;this.reverse_?o=t.getReverseIteratorFrom(this.rangedFilter_.getEndPost(),this.index_):o=t.getIteratorFrom(this.rangedFilter_.getStartPost(),this.index_);let l=0;for(;o.hasNext()&&l<this.limit_;){const u=o.getNext();if(this.withinDirectionalStart(u))if(this.withinDirectionalEnd(u))s=s.updateImmediateChild(u.name,u.node),l++;else break;else continue}}else{s=t.withIndex(this.index_),s=s.updatePriority(Me.EMPTY_NODE);let o;this.reverse_?o=s.getReverseIterator(this.index_):o=s.getIterator(this.index_);let l=0;for(;o.hasNext();){const u=o.getNext();l<this.limit_&&this.withinDirectionalStart(u)&&this.withinDirectionalEnd(u)?l++:s=s.updateImmediateChild(u.name,Me.EMPTY_NODE)}}return this.rangedFilter_.getIndexedFilter().updateFullNode(e,s,r)}updatePriority(e,t){return e}filtersNodes(){return!0}getIndexedFilter(){return this.rangedFilter_.getIndexedFilter()}getIndex(){return this.index_}fullLimitUpdateChild_(e,t,r,s,o){let l;if(this.reverse_){const _=this.index_.getCompare();l=(v,T)=>_(T,v)}else l=this.index_.getCompare();const u=e;le(u.numChildren()===this.limit_,"");const h=new Ke(t,r),p=this.reverse_?u.getFirstChild(this.index_):u.getLastChild(this.index_),g=this.rangedFilter_.matches(h);if(u.hasChild(t)){const _=u.getImmediateChild(t);let v=s.getChildAfterChild(this.index_,p,this.reverse_);for(;v!=null&&(v.name===t||u.hasChild(v.name));)v=s.getChildAfterChild(this.index_,v,this.reverse_);const T=v==null?1:l(v,h);if(g&&!r.isEmpty()&&T>=0)return o?.trackChildChange(Yu(t,r,_)),u.updateImmediateChild(t,r);{o?.trackChildChange(Qu(t,_));const I=u.updateImmediateChild(t,Me.EMPTY_NODE);return v!=null&&this.rangedFilter_.matches(v)?(o?.trackChildChange(ql(v.name,v.node)),I.updateImmediateChild(v.name,v.node)):I}}else return r.isEmpty()?e:g&&l(p,h)>=0?(o!=null&&(o.trackChildChange(Qu(p.name,p.node)),o.trackChildChange(ql(t,r))),u.updateImmediateChild(t,r).updateImmediateChild(p.name,Me.EMPTY_NODE)):e}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Jv{constructor(){this.limitSet_=!1,this.startSet_=!1,this.startNameSet_=!1,this.startAfterSet_=!1,this.endSet_=!1,this.endNameSet_=!1,this.endBeforeSet_=!1,this.limit_=0,this.viewFrom_="",this.indexStartValue_=null,this.indexStartName_="",this.indexEndValue_=null,this.indexEndName_="",this.index_=It}hasStart(){return this.startSet_}isViewFromLeft(){return this.viewFrom_===""?this.startSet_:this.viewFrom_==="l"}getIndexStartValue(){return le(this.startSet_,"Only valid if start has been set"),this.indexStartValue_}getIndexStartName(){return le(this.startSet_,"Only valid if start has been set"),this.startNameSet_?this.indexStartName_:Hl}hasEnd(){return this.endSet_}getIndexEndValue(){return le(this.endSet_,"Only valid if end has been set"),this.indexEndValue_}getIndexEndName(){return le(this.endSet_,"Only valid if end has been set"),this.endNameSet_?this.indexEndName_:da}hasLimit(){return this.limitSet_}hasAnchoredLimit(){return this.limitSet_&&this.viewFrom_!==""}getLimit(){return le(this.limitSet_,"Only valid if limit has been set"),this.limit_}getIndex(){return this.index_}loadsAllData(){return!(this.startSet_||this.endSet_||this.limitSet_)}isDefault(){return this.loadsAllData()&&this.index_===It}copy(){const e=new Jv;return e.limitSet_=this.limitSet_,e.limit_=this.limit_,e.startSet_=this.startSet_,e.startAfterSet_=this.startAfterSet_,e.indexStartValue_=this.indexStartValue_,e.startNameSet_=this.startNameSet_,e.indexStartName_=this.indexStartName_,e.endSet_=this.endSet_,e.endBeforeSet_=this.endBeforeSet_,e.indexEndValue_=this.indexEndValue_,e.endNameSet_=this.endNameSet_,e.indexEndName_=this.indexEndName_,e.index_=this.index_,e.viewFrom_=this.viewFrom_,e}}function cU(n){return n.loadsAllData()?new Xv(n.getIndex()):n.hasLimit()?new lU(n):new Xu(n)}function EC(n){const e={};if(n.isDefault())return e;let t;if(n.index_===It?t="$priority":n.index_===oU?t="$value":n.index_===Nl?t="$key":(le(n.index_ instanceof sU,"Unrecognized index type!"),t=n.index_.toString()),e.orderBy=en(t),n.startSet_){const r=n.startAfterSet_?"startAfter":"startAt";e[r]=en(n.indexStartValue_),n.startNameSet_&&(e[r]+=","+en(n.indexStartName_))}if(n.endSet_){const r=n.endBeforeSet_?"endBefore":"endAt";e[r]=en(n.indexEndValue_),n.endNameSet_&&(e[r]+=","+en(n.indexEndName_))}return n.limitSet_&&(n.isViewFromLeft()?e.limitToFirst=n.limit_:e.limitToLast=n.limit_),e}function xC(n){const e={};if(n.startSet_&&(e.sp=n.indexStartValue_,n.startNameSet_&&(e.sn=n.indexStartName_),e.sin=!n.startAfterSet_),n.endSet_&&(e.ep=n.indexEndValue_,n.endNameSet_&&(e.en=n.indexEndName_),e.ein=!n.endBeforeSet_),n.limitSet_){e.l=n.limit_;let t=n.viewFrom_;t===""&&(n.isViewFromLeft()?t="l":t="r"),e.vf=t}return n.index_!==It&&(e.i=n.index_.toString()),e}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Kf extends $R{reportStats(e){throw new Error("Method not implemented.")}static getListenId_(e,t){return t!==void 0?"tag$"+t:(le(e._queryParams.isDefault(),"should have a tag if it's not a default query."),e._path.toString())}constructor(e,t,r,s){super(),this.repoInfo_=e,this.onDataUpdate_=t,this.authTokenProvider_=r,this.appCheckTokenProvider_=s,this.log_=vd("p:rest:"),this.listens_={}}listen(e,t,r,s){const o=e._path.toString();this.log_("Listen called for "+o+" "+e._queryIdentifier);const l=Kf.getListenId_(e,r),u={};this.listens_[l]=u;const h=EC(e._queryParams);this.restRequest_(o+".json",h,(p,g)=>{let _=g;if(p===404&&(_=null,p=null),p===null&&this.onDataUpdate_(o,_,!1,r),Ll(this.listens_,l)===u){let v;p?p===401?v="permission_denied":v="rest_error:"+p:v="ok",s(v,null)}})}unlisten(e,t){const r=Kf.getListenId_(e,t);delete this.listens_[r]}get(e){const t=EC(e._queryParams),r=e._path.toString(),s=new Hs;return this.restRequest_(r+".json",t,(o,l)=>{let u=l;o===404&&(u=null,o=null),o===null?(this.onDataUpdate_(r,u,!1,null),s.resolve(u)):s.reject(new Error(u))}),s.promise}refreshAuthToken(e){}restRequest_(e,t={},r){return t.format="export",Promise.all([this.authTokenProvider_.getToken(!1),this.appCheckTokenProvider_.getToken(!1)]).then(([s,o])=>{s&&s.accessToken&&(t.auth=s.accessToken),o&&o.token&&(t.ac=o.token);const l=(this.repoInfo_.secure?"https://":"http://")+this.repoInfo_.host+e+"?ns="+this.repoInfo_.namespace+ec(t);this.log_("Sending REST request for "+l);const u=new XMLHttpRequest;u.onreadystatechange=()=>{if(r&&u.readyState===4){this.log_("REST Response for "+l+" received. status:",u.status,"response:",u.responseText);let h=null;if(u.status>=200&&u.status<300){try{h=Mu(u.responseText)}catch{zn("Failed to parse JSON response for "+l+": "+u.responseText)}r(null,h)}else u.status!==401&&u.status!==404&&zn("Got unsuccessful REST response for "+l+" Status: "+u.status),r(u.status);r=null}},u.open("GET",l,!0),u.send()})}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class uU{constructor(){this.rootNode_=Me.EMPTY_NODE}getNode(e){return this.rootNode_.getChild(e)}updateSnapshot(e,t){this.rootNode_=this.rootNode_.updateChild(e,t)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Qf(){return{value:null,children:new Map}}function lc(n,e,t){if(Ge(e))n.value=t,n.children.clear();else if(n.value!==null)n.value=n.value.updateChild(e,t);else{const r=He(e);n.children.has(r)||n.children.set(r,Qf());const s=n.children.get(r);e=ft(e),lc(s,e,t)}}function a_(n,e){if(Ge(e))return n.value=null,n.children.clear(),!0;if(n.value!==null){if(n.value.isLeafNode())return!1;{const t=n.value;return n.value=null,t.forEachChild(It,(r,s)=>{lc(n,new dt(r),s)}),a_(n,e)}}else if(n.children.size>0){const t=He(e);return e=ft(e),n.children.has(t)&&a_(n.children.get(t),e)&&n.children.delete(t),n.children.size===0}else return!0}function l_(n,e,t){n.value!==null?t(e,n.value):dU(n,(r,s)=>{const o=new dt(e.toString()+"/"+r);l_(s,o,t)})}function dU(n,e){n.children.forEach((t,r)=>{e(r,t)})}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class hU{constructor(e){this.collection_=e,this.last_=null}get(){const e=this.collection_.get(),t={...e};return this.last_&&xn(this.last_,(r,s)=>{t[r]=t[r]-s}),this.last_=e,t}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const TC=10*1e3,fU=30*1e3,pU=300*1e3;class mU{constructor(e,t){this.server_=t,this.statsToReport_={},this.statsListener_=new hU(e);const r=TC+(fU-TC)*Math.random();Nu(this.reportStats_.bind(this),Math.floor(r))}reportStats_(){const e=this.statsListener_.get(),t={};let r=!1;xn(e,(s,o)=>{o>0&&Es(this.statsToReport_,s)&&(t[s]=o,r=!0)}),r&&this.server_.reportStats(t),Nu(this.reportStats_.bind(this),Math.floor(Math.random()*2*pU))}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var Nr;(function(n){n[n.OVERWRITE=0]="OVERWRITE",n[n.MERGE=1]="MERGE",n[n.ACK_USER_WRITE=2]="ACK_USER_WRITE",n[n.LISTEN_COMPLETE=3]="LISTEN_COMPLETE"})(Nr||(Nr={}));function ZR(){return{fromUser:!0,fromServer:!1,queryId:null,tagged:!1}}function Zv(){return{fromUser:!1,fromServer:!0,queryId:null,tagged:!1}}function ew(n){return{fromUser:!1,fromServer:!0,queryId:n,tagged:!0}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Yf{constructor(e,t,r){this.path=e,this.affectedTree=t,this.revert=r,this.type=Nr.ACK_USER_WRITE,this.source=ZR()}operationForChild(e){if(Ge(this.path)){if(this.affectedTree.value!=null)return le(this.affectedTree.children.isEmpty(),"affectedTree should not have overlapping affected paths."),this;{const t=this.affectedTree.subtree(new dt(e));return new Yf(at(),t,this.revert)}}else return le(He(this.path)===e,"operationForChild called for unrelated child."),new Yf(ft(this.path),this.affectedTree,this.revert)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ju{constructor(e,t){this.source=e,this.path=t,this.type=Nr.LISTEN_COMPLETE}operationForChild(e){return Ge(this.path)?new Ju(this.source,at()):new Ju(this.source,ft(this.path))}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ha{constructor(e,t,r){this.source=e,this.path=t,this.snap=r,this.type=Nr.OVERWRITE}operationForChild(e){return Ge(this.path)?new ha(this.source,at(),this.snap.getImmediateChild(e)):new ha(this.source,ft(this.path),this.snap)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Zu{constructor(e,t,r){this.source=e,this.path=t,this.children=r,this.type=Nr.MERGE}operationForChild(e){if(Ge(this.path)){const t=this.children.subtree(new dt(e));return t.isEmpty()?null:t.value?new ha(this.source,at(),t.value):new Zu(this.source,at(),t)}else return le(He(this.path)===e,"Can't get a merge for a child not on the path of the operation"),new Zu(this.source,ft(this.path),this.children)}toString(){return"Operation("+this.path+": "+this.source.toString()+" merge: "+this.children.toString()+")"}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class fa{constructor(e,t,r){this.node_=e,this.fullyInitialized_=t,this.filtered_=r}isFullyInitialized(){return this.fullyInitialized_}isFiltered(){return this.filtered_}isCompleteForPath(e){if(Ge(e))return this.isFullyInitialized()&&!this.filtered_;const t=He(e);return this.isCompleteForChild(t)}isCompleteForChild(e){return this.isFullyInitialized()&&!this.filtered_||this.node_.hasChild(e)}getNode(){return this.node_}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class gU{constructor(e){this.query_=e,this.index_=this.query_._queryParams.getIndex()}}function yU(n,e,t,r){const s=[],o=[];return e.forEach(l=>{l.type==="child_changed"&&n.index_.indexedValueChanged(l.oldSnap,l.snapshotNode)&&o.push(aU(l.childName,l.snapshotNode))}),hu(n,s,"child_removed",e,r,t),hu(n,s,"child_added",e,r,t),hu(n,s,"child_moved",o,r,t),hu(n,s,"child_changed",e,r,t),hu(n,s,"value",e,r,t),s}function hu(n,e,t,r,s,o){const l=r.filter(u=>u.type===t);l.sort((u,h)=>vU(n,u,h)),l.forEach(u=>{const h=_U(n,u,o);s.forEach(p=>{p.respondsTo(u.type)&&e.push(p.createEvent(h,n.query_))})})}function _U(n,e,t){return e.type==="value"||e.type==="child_removed"||(e.prevName=t.getPredecessorChildName(e.childName,e.snapshotNode,n.index_)),e}function vU(n,e,t){if(e.childName==null||t.childName==null)throw Zl("Should only compare child_ events.");const r=new Ke(e.childName,e.snapshotNode),s=new Ke(t.childName,t.snapshotNode);return n.index_.compare(r,s)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Xp(n,e){return{eventCache:n,serverCache:e}}function Pu(n,e,t,r){return Xp(new fa(e,t,r),n.serverCache)}function eA(n,e,t,r){return Xp(n.eventCache,new fa(e,t,r))}function c_(n){return n.eventCache.isFullyInitialized()?n.eventCache.getNode():null}function pa(n){return n.serverCache.isFullyInitialized()?n.serverCache.getNode():null}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let fy;const wU=()=>(fy||(fy=new Un(sF)),fy);class vt{static fromObject(e){let t=new vt(null);return xn(e,(r,s)=>{t=t.set(new dt(r),s)}),t}constructor(e,t=wU()){this.value=e,this.children=t}isEmpty(){return this.value===null&&this.children.isEmpty()}findRootMostMatchingPathAndValue(e,t){if(this.value!=null&&t(this.value))return{path:at(),value:this.value};if(Ge(e))return null;{const r=He(e),s=this.children.get(r);if(s!==null){const o=s.findRootMostMatchingPathAndValue(ft(e),t);return o!=null?{path:Mt(new dt(r),o.path),value:o.value}:null}else return null}}findRootMostValueAndPath(e){return this.findRootMostMatchingPathAndValue(e,()=>!0)}subtree(e){if(Ge(e))return this;{const t=He(e),r=this.children.get(t);return r!==null?r.subtree(ft(e)):new vt(null)}}set(e,t){if(Ge(e))return new vt(t,this.children);{const r=He(e),o=(this.children.get(r)||new vt(null)).set(ft(e),t),l=this.children.insert(r,o);return new vt(this.value,l)}}remove(e){if(Ge(e))return this.children.isEmpty()?new vt(null):new vt(null,this.children);{const t=He(e),r=this.children.get(t);if(r){const s=r.remove(ft(e));let o;return s.isEmpty()?o=this.children.remove(t):o=this.children.insert(t,s),this.value===null&&o.isEmpty()?new vt(null):new vt(this.value,o)}else return this}}get(e){if(Ge(e))return this.value;{const t=He(e),r=this.children.get(t);return r?r.get(ft(e)):null}}setTree(e,t){if(Ge(e))return t;{const r=He(e),o=(this.children.get(r)||new vt(null)).setTree(ft(e),t);let l;return o.isEmpty()?l=this.children.remove(r):l=this.children.insert(r,o),new vt(this.value,l)}}fold(e){return this.fold_(at(),e)}fold_(e,t){const r={};return this.children.inorderTraversal((s,o)=>{r[s]=o.fold_(Mt(e,s),t)}),t(e,this.value,r)}findOnPath(e,t){return this.findOnPath_(e,at(),t)}findOnPath_(e,t,r){const s=this.value?r(t,this.value):!1;if(s)return s;if(Ge(e))return null;{const o=He(e),l=this.children.get(o);return l?l.findOnPath_(ft(e),Mt(t,o),r):null}}foreachOnPath(e,t){return this.foreachOnPath_(e,at(),t)}foreachOnPath_(e,t,r){if(Ge(e))return this;{this.value&&r(t,this.value);const s=He(e),o=this.children.get(s);return o?o.foreachOnPath_(ft(e),Mt(t,s),r):new vt(null)}}foreach(e){this.foreach_(at(),e)}foreach_(e,t){this.children.inorderTraversal((r,s)=>{s.foreach_(Mt(e,r),t)}),this.value&&t(e,this.value)}foreachChild(e){this.children.inorderTraversal((t,r)=>{r.value&&e(t,r.value)})}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Or{constructor(e){this.writeTree_=e}static empty(){return new Or(new vt(null))}}function Du(n,e,t){if(Ge(e))return new Or(new vt(t));{const r=n.writeTree_.findRootMostValueAndPath(e);if(r!=null){const s=r.path;let o=r.value;const l=Fn(s,e);return o=o.updateChild(l,t),new Or(n.writeTree_.set(s,o))}else{const s=new vt(t),o=n.writeTree_.setTree(e,s);return new Or(o)}}}function CC(n,e,t){let r=n;return xn(t,(s,o)=>{r=Du(r,Mt(e,s),o)}),r}function SC(n,e){if(Ge(e))return Or.empty();{const t=n.writeTree_.setTree(e,new vt(null));return new Or(t)}}function u_(n,e){return Ea(n,e)!=null}function Ea(n,e){const t=n.writeTree_.findRootMostValueAndPath(e);return t!=null?n.writeTree_.get(t.path).getChild(Fn(t.path,e)):null}function IC(n){const e=[],t=n.writeTree_.value;return t!=null?t.isLeafNode()||t.forEachChild(It,(r,s)=>{e.push(new Ke(r,s))}):n.writeTree_.children.inorderTraversal((r,s)=>{s.value!=null&&e.push(new Ke(r,s.value))}),e}function ro(n,e){if(Ge(e))return n;{const t=Ea(n,e);return t!=null?new Or(new vt(t)):new Or(n.writeTree_.subtree(e))}}function d_(n){return n.writeTree_.isEmpty()}function Gl(n,e){return tA(at(),n.writeTree_,e)}function tA(n,e,t){if(e.value!=null)return t.updateChild(n,e.value);{let r=null;return e.children.inorderTraversal((s,o)=>{s===".priority"?(le(o.value!==null,"Priority writes must always be leaf nodes"),r=o.value):t=tA(Mt(n,s),o,t)}),!t.getChild(n).isEmpty()&&r!==null&&(t=t.updateChild(Mt(n,".priority"),r)),t}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function tw(n,e){return iA(e,n)}function EU(n,e,t,r,s){le(r>n.lastWriteId,"Stacking an older write on top of newer ones"),s===void 0&&(s=!0),n.allWrites.push({path:e,snap:t,writeId:r,visible:s}),s&&(n.visibleWrites=Du(n.visibleWrites,e,t)),n.lastWriteId=r}function xU(n,e){for(let t=0;t<n.allWrites.length;t++){const r=n.allWrites[t];if(r.writeId===e)return r}return null}function TU(n,e){const t=n.allWrites.findIndex(u=>u.writeId===e);le(t>=0,"removeWrite called with nonexistent writeId.");const r=n.allWrites[t];n.allWrites.splice(t,1);let s=r.visible,o=!1,l=n.allWrites.length-1;for(;s&&l>=0;){const u=n.allWrites[l];u.visible&&(l>=t&&CU(u,r.path)?s=!1:mr(r.path,u.path)&&(o=!0)),l--}if(s){if(o)return SU(n),!0;if(r.snap)n.visibleWrites=SC(n.visibleWrites,r.path);else{const u=r.children;xn(u,h=>{n.visibleWrites=SC(n.visibleWrites,Mt(r.path,h))})}return!0}else return!1}function CU(n,e){if(n.snap)return mr(n.path,e);for(const t in n.children)if(n.children.hasOwnProperty(t)&&mr(Mt(n.path,t),e))return!0;return!1}function SU(n){n.visibleWrites=nA(n.allWrites,IU,at()),n.allWrites.length>0?n.lastWriteId=n.allWrites[n.allWrites.length-1].writeId:n.lastWriteId=-1}function IU(n){return n.visible}function nA(n,e,t){let r=Or.empty();for(let s=0;s<n.length;++s){const o=n[s];if(e(o)){const l=o.path;let u;if(o.snap)mr(t,l)?(u=Fn(t,l),r=Du(r,u,o.snap)):mr(l,t)&&(u=Fn(l,t),r=Du(r,at(),o.snap.getChild(u)));else if(o.children){if(mr(t,l))u=Fn(t,l),r=CC(r,u,o.children);else if(mr(l,t))if(u=Fn(l,t),Ge(u))r=CC(r,at(),o.children);else{const h=Ll(o.children,He(u));if(h){const p=h.getChild(ft(u));r=Du(r,at(),p)}}}else throw Zl("WriteRecord should have .snap or .children")}}return r}function rA(n,e,t,r,s){if(!r&&!s){const o=Ea(n.visibleWrites,e);if(o!=null)return o;{const l=ro(n.visibleWrites,e);if(d_(l))return t;if(t==null&&!u_(l,at()))return null;{const u=t||Me.EMPTY_NODE;return Gl(l,u)}}}else{const o=ro(n.visibleWrites,e);if(!s&&d_(o))return t;if(!s&&t==null&&!u_(o,at()))return null;{const l=function(p){return(p.visible||s)&&(!r||!~r.indexOf(p.writeId))&&(mr(p.path,e)||mr(e,p.path))},u=nA(n.allWrites,l,e),h=t||Me.EMPTY_NODE;return Gl(u,h)}}}function bU(n,e,t){let r=Me.EMPTY_NODE;const s=Ea(n.visibleWrites,e);if(s)return s.isLeafNode()||s.forEachChild(It,(o,l)=>{r=r.updateImmediateChild(o,l)}),r;if(t){const o=ro(n.visibleWrites,e);return t.forEachChild(It,(l,u)=>{const h=Gl(ro(o,new dt(l)),u);r=r.updateImmediateChild(l,h)}),IC(o).forEach(l=>{r=r.updateImmediateChild(l.name,l.node)}),r}else{const o=ro(n.visibleWrites,e);return IC(o).forEach(l=>{r=r.updateImmediateChild(l.name,l.node)}),r}}function RU(n,e,t,r,s){le(r||s,"Either existingEventSnap or existingServerSnap must exist");const o=Mt(e,t);if(u_(n.visibleWrites,o))return null;{const l=ro(n.visibleWrites,o);return d_(l)?s.getChild(t):Gl(l,s.getChild(t))}}function AU(n,e,t,r){const s=Mt(e,t),o=Ea(n.visibleWrites,s);if(o!=null)return o;if(r.isCompleteForChild(t)){const l=ro(n.visibleWrites,s);return Gl(l,r.getNode().getImmediateChild(t))}else return null}function kU(n,e){return Ea(n.visibleWrites,e)}function NU(n,e,t,r,s,o,l){let u;const h=ro(n.visibleWrites,e),p=Ea(h,at());if(p!=null)u=p;else if(t!=null)u=Gl(h,t);else return[];if(u=u.withIndex(l),!u.isEmpty()&&!u.isLeafNode()){const g=[],_=l.getCompare(),v=o?u.getReverseIteratorFrom(r,l):u.getIteratorFrom(r,l);let T=v.getNext();for(;T&&g.length<s;)_(T,r)!==0&&g.push(T),T=v.getNext();return g}else return[]}function PU(){return{visibleWrites:Or.empty(),allWrites:[],lastWriteId:-1}}function Xf(n,e,t,r){return rA(n.writeTree,n.treePath,e,t,r)}function nw(n,e){return bU(n.writeTree,n.treePath,e)}function bC(n,e,t,r){return RU(n.writeTree,n.treePath,e,t,r)}function Jf(n,e){return kU(n.writeTree,Mt(n.treePath,e))}function DU(n,e,t,r,s,o){return NU(n.writeTree,n.treePath,e,t,r,s,o)}function rw(n,e,t){return AU(n.writeTree,n.treePath,e,t)}function sA(n,e){return iA(Mt(n.treePath,e),n.writeTree)}function iA(n,e){return{treePath:n,writeTree:e}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class OU{constructor(){this.changeMap=new Map}trackChildChange(e){const t=e.type,r=e.childName;le(t==="child_added"||t==="child_changed"||t==="child_removed","Only child changes supported for tracking"),le(r!==".priority","Only non-priority child changes can be tracked.");const s=this.changeMap.get(r);if(s){const o=s.type;if(t==="child_added"&&o==="child_removed")this.changeMap.set(r,Yu(r,e.snapshotNode,s.snapshotNode));else if(t==="child_removed"&&o==="child_added")this.changeMap.delete(r);else if(t==="child_removed"&&o==="child_changed")this.changeMap.set(r,Qu(r,s.oldSnap));else if(t==="child_changed"&&o==="child_added")this.changeMap.set(r,ql(r,e.snapshotNode));else if(t==="child_changed"&&o==="child_changed")this.changeMap.set(r,Yu(r,e.snapshotNode,s.oldSnap));else throw Zl("Illegal combination of changes: "+e+" occurred after "+s)}else this.changeMap.set(r,e)}getChanges(){return Array.from(this.changeMap.values())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class MU{getCompleteChild(e){return null}getChildAfterChild(e,t,r){return null}}const oA=new MU;class sw{constructor(e,t,r=null){this.writes_=e,this.viewCache_=t,this.optCompleteServerCache_=r}getCompleteChild(e){const t=this.viewCache_.eventCache;if(t.isCompleteForChild(e))return t.getNode().getImmediateChild(e);{const r=this.optCompleteServerCache_!=null?new fa(this.optCompleteServerCache_,!0,!1):this.viewCache_.serverCache;return rw(this.writes_,e,r)}}getChildAfterChild(e,t,r){const s=this.optCompleteServerCache_!=null?this.optCompleteServerCache_:pa(this.viewCache_),o=DU(this.writes_,s,t,1,r,e);return o.length===0?null:o[0]}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function LU(n){return{filter:n}}function jU(n,e){le(e.eventCache.getNode().isIndexed(n.filter.getIndex()),"Event snap not indexed"),le(e.serverCache.getNode().isIndexed(n.filter.getIndex()),"Server snap not indexed")}function VU(n,e,t,r,s){const o=new OU;let l,u;if(t.type===Nr.OVERWRITE){const p=t;p.source.fromUser?l=h_(n,e,p.path,p.snap,r,s,o):(le(p.source.fromServer,"Unknown source."),u=p.source.tagged||e.serverCache.isFiltered()&&!Ge(p.path),l=Zf(n,e,p.path,p.snap,r,s,u,o))}else if(t.type===Nr.MERGE){const p=t;p.source.fromUser?l=UU(n,e,p.path,p.children,r,s,o):(le(p.source.fromServer,"Unknown source."),u=p.source.tagged||e.serverCache.isFiltered(),l=f_(n,e,p.path,p.children,r,s,u,o))}else if(t.type===Nr.ACK_USER_WRITE){const p=t;p.revert?l=$U(n,e,p.path,r,s,o):l=zU(n,e,p.path,p.affectedTree,r,s,o)}else if(t.type===Nr.LISTEN_COMPLETE)l=BU(n,e,t.path,r,o);else throw Zl("Unknown operation type: "+t.type);const h=o.getChanges();return FU(e,l,h),{viewCache:l,changes:h}}function FU(n,e,t){const r=e.eventCache;if(r.isFullyInitialized()){const s=r.getNode().isLeafNode()||r.getNode().isEmpty(),o=c_(n);(t.length>0||!n.eventCache.isFullyInitialized()||s&&!r.getNode().equals(o)||!r.getNode().getPriority().equals(o.getPriority()))&&t.push(JR(c_(e)))}}function aA(n,e,t,r,s,o){const l=e.eventCache;if(Jf(r,t)!=null)return e;{let u,h;if(Ge(t))if(le(e.serverCache.isFullyInitialized(),"If change path is empty, we must have complete server data"),e.serverCache.isFiltered()){const p=pa(e),g=p instanceof Me?p:Me.EMPTY_NODE,_=nw(r,g);u=n.filter.updateFullNode(e.eventCache.getNode(),_,o)}else{const p=Xf(r,pa(e));u=n.filter.updateFullNode(e.eventCache.getNode(),p,o)}else{const p=He(t);if(p===".priority"){le(mo(t)===1,"Can't have a priority with additional path components");const g=l.getNode();h=e.serverCache.getNode();const _=bC(r,t,g,h);_!=null?u=n.filter.updatePriority(g,_):u=l.getNode()}else{const g=ft(t);let _;if(l.isCompleteForChild(p)){h=e.serverCache.getNode();const v=bC(r,t,l.getNode(),h);v!=null?_=l.getNode().getImmediateChild(p).updateChild(g,v):_=l.getNode().getImmediateChild(p)}else _=rw(r,p,e.serverCache);_!=null?u=n.filter.updateChild(l.getNode(),p,_,g,s,o):u=l.getNode()}}return Pu(e,u,l.isFullyInitialized()||Ge(t),n.filter.filtersNodes())}}function Zf(n,e,t,r,s,o,l,u){const h=e.serverCache;let p;const g=l?n.filter:n.filter.getIndexedFilter();if(Ge(t))p=g.updateFullNode(h.getNode(),r,null);else if(g.filtersNodes()&&!h.isFiltered()){const T=h.getNode().updateChild(t,r);p=g.updateFullNode(h.getNode(),T,null)}else{const T=He(t);if(!h.isCompleteForPath(t)&&mo(t)>1)return e;const A=ft(t),b=h.getNode().getImmediateChild(T).updateChild(A,r);T===".priority"?p=g.updatePriority(h.getNode(),b):p=g.updateChild(h.getNode(),T,b,A,oA,null)}const _=eA(e,p,h.isFullyInitialized()||Ge(t),g.filtersNodes()),v=new sw(s,_,o);return aA(n,_,t,s,v,u)}function h_(n,e,t,r,s,o,l){const u=e.eventCache;let h,p;const g=new sw(s,e,o);if(Ge(t))p=n.filter.updateFullNode(e.eventCache.getNode(),r,l),h=Pu(e,p,!0,n.filter.filtersNodes());else{const _=He(t);if(_===".priority")p=n.filter.updatePriority(e.eventCache.getNode(),r),h=Pu(e,p,u.isFullyInitialized(),u.isFiltered());else{const v=ft(t),T=u.getNode().getImmediateChild(_);let A;if(Ge(v))A=r;else{const I=g.getCompleteChild(_);I!=null?Gv(v)===".priority"&&I.getChild(HR(v)).isEmpty()?A=I:A=I.updateChild(v,r):A=Me.EMPTY_NODE}if(T.equals(A))h=e;else{const I=n.filter.updateChild(u.getNode(),_,A,v,g,l);h=Pu(e,I,u.isFullyInitialized(),n.filter.filtersNodes())}}}return h}function RC(n,e){return n.eventCache.isCompleteForChild(e)}function UU(n,e,t,r,s,o,l){let u=e;return r.foreach((h,p)=>{const g=Mt(t,h);RC(e,He(g))&&(u=h_(n,u,g,p,s,o,l))}),r.foreach((h,p)=>{const g=Mt(t,h);RC(e,He(g))||(u=h_(n,u,g,p,s,o,l))}),u}function AC(n,e,t){return t.foreach((r,s)=>{e=e.updateChild(r,s)}),e}function f_(n,e,t,r,s,o,l,u){if(e.serverCache.getNode().isEmpty()&&!e.serverCache.isFullyInitialized())return e;let h=e,p;Ge(t)?p=r:p=new vt(null).setTree(t,r);const g=e.serverCache.getNode();return p.children.inorderTraversal((_,v)=>{if(g.hasChild(_)){const T=e.serverCache.getNode().getImmediateChild(_),A=AC(n,T,v);h=Zf(n,h,new dt(_),A,s,o,l,u)}}),p.children.inorderTraversal((_,v)=>{const T=!e.serverCache.isCompleteForChild(_)&&v.value===null;if(!g.hasChild(_)&&!T){const A=e.serverCache.getNode().getImmediateChild(_),I=AC(n,A,v);h=Zf(n,h,new dt(_),I,s,o,l,u)}}),h}function zU(n,e,t,r,s,o,l){if(Jf(s,t)!=null)return e;const u=e.serverCache.isFiltered(),h=e.serverCache;if(r.value!=null){if(Ge(t)&&h.isFullyInitialized()||h.isCompleteForPath(t))return Zf(n,e,t,h.getNode().getChild(t),s,o,u,l);if(Ge(t)){let p=new vt(null);return h.getNode().forEachChild(Nl,(g,_)=>{p=p.set(new dt(g),_)}),f_(n,e,t,p,s,o,u,l)}else return e}else{let p=new vt(null);return r.foreach((g,_)=>{const v=Mt(t,g);h.isCompleteForPath(v)&&(p=p.set(g,h.getNode().getChild(v)))}),f_(n,e,t,p,s,o,u,l)}}function BU(n,e,t,r,s){const o=e.serverCache,l=eA(e,o.getNode(),o.isFullyInitialized()||Ge(t),o.isFiltered());return aA(n,l,t,r,oA,s)}function $U(n,e,t,r,s,o){let l;if(Jf(r,t)!=null)return e;{const u=new sw(r,e,s),h=e.eventCache.getNode();let p;if(Ge(t)||He(t)===".priority"){let g;if(e.serverCache.isFullyInitialized())g=Xf(r,pa(e));else{const _=e.serverCache.getNode();le(_ instanceof Me,"serverChildren would be complete if leaf node"),g=nw(r,_)}g=g,p=n.filter.updateFullNode(h,g,o)}else{const g=He(t);let _=rw(r,g,e.serverCache);_==null&&e.serverCache.isCompleteForChild(g)&&(_=h.getImmediateChild(g)),_!=null?p=n.filter.updateChild(h,g,_,ft(t),u,o):e.eventCache.getNode().hasChild(g)?p=n.filter.updateChild(h,g,Me.EMPTY_NODE,ft(t),u,o):p=h,p.isEmpty()&&e.serverCache.isFullyInitialized()&&(l=Xf(r,pa(e)),l.isLeafNode()&&(p=n.filter.updateFullNode(p,l,o)))}return l=e.serverCache.isFullyInitialized()||Jf(r,at())!=null,Pu(e,p,l,n.filter.filtersNodes())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class WU{constructor(e,t){this.query_=e,this.eventRegistrations_=[];const r=this.query_._queryParams,s=new Xv(r.getIndex()),o=cU(r);this.processor_=LU(o);const l=t.serverCache,u=t.eventCache,h=s.updateFullNode(Me.EMPTY_NODE,l.getNode(),null),p=o.updateFullNode(Me.EMPTY_NODE,u.getNode(),null),g=new fa(h,l.isFullyInitialized(),s.filtersNodes()),_=new fa(p,u.isFullyInitialized(),o.filtersNodes());this.viewCache_=Xp(_,g),this.eventGenerator_=new gU(this.query_)}get query(){return this.query_}}function HU(n){return n.viewCache_.serverCache.getNode()}function qU(n,e){const t=pa(n.viewCache_);return t&&(n.query._queryParams.loadsAllData()||!Ge(e)&&!t.getImmediateChild(He(e)).isEmpty())?t.getChild(e):null}function kC(n){return n.eventRegistrations_.length===0}function GU(n,e){n.eventRegistrations_.push(e)}function NC(n,e,t){const r=[];if(t){le(e==null,"A cancel should cancel all event registrations.");const s=n.query._path;n.eventRegistrations_.forEach(o=>{const l=o.createCancelEvent(t,s);l&&r.push(l)})}if(e){let s=[];for(let o=0;o<n.eventRegistrations_.length;++o){const l=n.eventRegistrations_[o];if(!l.matches(e))s.push(l);else if(e.hasAnyCallback()){s=s.concat(n.eventRegistrations_.slice(o+1));break}}n.eventRegistrations_=s}else n.eventRegistrations_=[];return r}function PC(n,e,t,r){e.type===Nr.MERGE&&e.source.queryId!==null&&(le(pa(n.viewCache_),"We should always have a full cache before handling merges"),le(c_(n.viewCache_),"Missing event cache, even though we have a server cache"));const s=n.viewCache_,o=VU(n.processor_,s,e,t,r);return jU(n.processor_,o.viewCache),le(o.viewCache.serverCache.isFullyInitialized()||!s.serverCache.isFullyInitialized(),"Once a server snap is complete, it should never go back"),n.viewCache_=o.viewCache,lA(n,o.changes,o.viewCache.eventCache.getNode(),null)}function KU(n,e){const t=n.viewCache_.eventCache,r=[];return t.getNode().isLeafNode()||t.getNode().forEachChild(It,(o,l)=>{r.push(ql(o,l))}),t.isFullyInitialized()&&r.push(JR(t.getNode())),lA(n,r,t.getNode(),e)}function lA(n,e,t,r){const s=r?[r]:n.eventRegistrations_;return yU(n.eventGenerator_,e,t,s)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let ep;class QU{constructor(){this.views=new Map}}function YU(n){le(!ep,"__referenceConstructor has already been defined"),ep=n}function XU(){return le(ep,"Reference.ts has not been loaded"),ep}function JU(n){return n.views.size===0}function iw(n,e,t,r){const s=e.source.queryId;if(s!==null){const o=n.views.get(s);return le(o!=null,"SyncTree gave us an op for an invalid query."),PC(o,e,t,r)}else{let o=[];for(const l of n.views.values())o=o.concat(PC(l,e,t,r));return o}}function ZU(n,e,t,r,s){const o=e._queryIdentifier,l=n.views.get(o);if(!l){let u=Xf(t,s?r:null),h=!1;u?h=!0:r instanceof Me?(u=nw(t,r),h=!1):(u=Me.EMPTY_NODE,h=!1);const p=Xp(new fa(u,h,!1),new fa(r,s,!1));return new WU(e,p)}return l}function e3(n,e,t,r,s,o){const l=ZU(n,e,r,s,o);return n.views.has(e._queryIdentifier)||n.views.set(e._queryIdentifier,l),GU(l,t),KU(l,t)}function t3(n,e,t,r){const s=e._queryIdentifier,o=[];let l=[];const u=go(n);if(s==="default")for(const[h,p]of n.views.entries())l=l.concat(NC(p,t,r)),kC(p)&&(n.views.delete(h),p.query._queryParams.loadsAllData()||o.push(p.query));else{const h=n.views.get(s);h&&(l=l.concat(NC(h,t,r)),kC(h)&&(n.views.delete(s),h.query._queryParams.loadsAllData()||o.push(h.query)))}return u&&!go(n)&&o.push(new(XU())(e._repo,e._path)),{removed:o,events:l}}function cA(n){const e=[];for(const t of n.views.values())t.query._queryParams.loadsAllData()||e.push(t);return e}function Pl(n,e){let t=null;for(const r of n.views.values())t=t||qU(r,e);return t}function uA(n,e){if(e._queryParams.loadsAllData())return Jp(n);{const r=e._queryIdentifier;return n.views.get(r)}}function dA(n,e){return uA(n,e)!=null}function go(n){return Jp(n)!=null}function Jp(n){for(const e of n.views.values())if(e.query._queryParams.loadsAllData())return e;return null}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let tp;function n3(n){le(!tp,"__referenceConstructor has already been defined"),tp=n}function r3(){return le(tp,"Reference.ts has not been loaded"),tp}let s3=1;class DC{constructor(e){this.listenProvider_=e,this.syncPointTree_=new vt(null),this.pendingWriteTree_=PU(),this.tagToQueryMap=new Map,this.queryToTagMap=new Map}}function hA(n,e,t,r,s){return EU(n.pendingWriteTree_,e,t,r,s),s?Ed(n,new ha(ZR(),e,t)):[]}function ra(n,e,t=!1){const r=xU(n.pendingWriteTree_,e);if(TU(n.pendingWriteTree_,e)){let o=new vt(null);return r.snap!=null?o=o.set(at(),!0):xn(r.children,l=>{o=o.set(new dt(l),!0)}),Ed(n,new Yf(r.path,o,t))}else return[]}function Zp(n,e,t){return Ed(n,new ha(Zv(),e,t))}function i3(n,e,t){const r=vt.fromObject(t);return Ed(n,new Zu(Zv(),e,r))}function o3(n,e){return Ed(n,new Ju(Zv(),e))}function a3(n,e,t){const r=aw(n,t);if(r){const s=lw(r),o=s.path,l=s.queryId,u=Fn(o,e),h=new Ju(ew(l),u);return cw(n,o,h)}else return[]}function p_(n,e,t,r,s=!1){const o=e._path,l=n.syncPointTree_.get(o);let u=[];if(l&&(e._queryIdentifier==="default"||dA(l,e))){const h=t3(l,e,t,r);JU(l)&&(n.syncPointTree_=n.syncPointTree_.remove(o));const p=h.removed;if(u=h.events,!s){const g=p.findIndex(v=>v._queryParams.loadsAllData())!==-1,_=n.syncPointTree_.findOnPath(o,(v,T)=>go(T));if(g&&!_){const v=n.syncPointTree_.subtree(o);if(!v.isEmpty()){const T=u3(v);for(let A=0;A<T.length;++A){const I=T[A],b=I.query,j=mA(n,I);n.listenProvider_.startListening(Ou(b),np(n,b),j.hashFn,j.onComplete)}}}!_&&p.length>0&&!r&&(g?n.listenProvider_.stopListening(Ou(e),null):p.forEach(v=>{const T=n.queryToTagMap.get(em(v));n.listenProvider_.stopListening(Ou(v),T)}))}d3(n,p)}return u}function l3(n,e,t,r){const s=aw(n,r);if(s!=null){const o=lw(s),l=o.path,u=o.queryId,h=Fn(l,e),p=new ha(ew(u),h,t);return cw(n,l,p)}else return[]}function c3(n,e,t,r){const s=aw(n,r);if(s){const o=lw(s),l=o.path,u=o.queryId,h=Fn(l,e),p=vt.fromObject(t),g=new Zu(ew(u),h,p);return cw(n,l,g)}else return[]}function OC(n,e,t,r=!1){const s=e._path;let o=null,l=!1;n.syncPointTree_.foreachOnPath(s,(v,T)=>{const A=Fn(v,s);o=o||Pl(T,A),l=l||go(T)});let u=n.syncPointTree_.get(s);u?(l=l||go(u),o=o||Pl(u,at())):(u=new QU,n.syncPointTree_=n.syncPointTree_.set(s,u));let h;o!=null?h=!0:(h=!1,o=Me.EMPTY_NODE,n.syncPointTree_.subtree(s).foreachChild((T,A)=>{const I=Pl(A,at());I&&(o=o.updateImmediateChild(T,I))}));const p=dA(u,e);if(!p&&!e._queryParams.loadsAllData()){const v=em(e);le(!n.queryToTagMap.has(v),"View does not exist, but we have a tag");const T=h3();n.queryToTagMap.set(v,T),n.tagToQueryMap.set(T,v)}const g=tw(n.pendingWriteTree_,s);let _=e3(u,e,t,g,o,h);if(!p&&!l&&!r){const v=uA(u,e);_=_.concat(f3(n,e,v))}return _}function ow(n,e,t){const s=n.pendingWriteTree_,o=n.syncPointTree_.findOnPath(e,(l,u)=>{const h=Fn(l,e),p=Pl(u,h);if(p)return p});return rA(s,e,o,t,!0)}function Ed(n,e){return fA(e,n.syncPointTree_,null,tw(n.pendingWriteTree_,at()))}function fA(n,e,t,r){if(Ge(n.path))return pA(n,e,t,r);{const s=e.get(at());t==null&&s!=null&&(t=Pl(s,at()));let o=[];const l=He(n.path),u=n.operationForChild(l),h=e.children.get(l);if(h&&u){const p=t?t.getImmediateChild(l):null,g=sA(r,l);o=o.concat(fA(u,h,p,g))}return s&&(o=o.concat(iw(s,n,r,t))),o}}function pA(n,e,t,r){const s=e.get(at());t==null&&s!=null&&(t=Pl(s,at()));let o=[];return e.children.inorderTraversal((l,u)=>{const h=t?t.getImmediateChild(l):null,p=sA(r,l),g=n.operationForChild(l);g&&(o=o.concat(pA(g,u,h,p)))}),s&&(o=o.concat(iw(s,n,r,t))),o}function mA(n,e){const t=e.query,r=np(n,t);return{hashFn:()=>(HU(e)||Me.EMPTY_NODE).hash(),onComplete:s=>{if(s==="ok")return r?a3(n,t._path,r):o3(n,t._path);{const o=aF(s,t);return p_(n,t,null,o)}}}}function np(n,e){const t=em(e);return n.queryToTagMap.get(t)}function em(n){return n._path.toString()+"$"+n._queryIdentifier}function aw(n,e){return n.tagToQueryMap.get(e)}function lw(n){const e=n.indexOf("$");return le(e!==-1&&e<n.length-1,"Bad queryKey."),{queryId:n.substr(e+1),path:new dt(n.substr(0,e))}}function cw(n,e,t){const r=n.syncPointTree_.get(e);le(r,"Missing sync point for query tag that we're tracking");const s=tw(n.pendingWriteTree_,e);return iw(r,t,s,null)}function u3(n){return n.fold((e,t,r)=>{if(t&&go(t))return[Jp(t)];{let s=[];return t&&(s=cA(t)),xn(r,(o,l)=>{s=s.concat(l)}),s}})}function Ou(n){return n._queryParams.loadsAllData()&&!n._queryParams.isDefault()?new(r3())(n._repo,n._path):n}function d3(n,e){for(let t=0;t<e.length;++t){const r=e[t];if(!r._queryParams.loadsAllData()){const s=em(r),o=n.queryToTagMap.get(s);n.queryToTagMap.delete(s),n.tagToQueryMap.delete(o)}}}function h3(){return s3++}function f3(n,e,t){const r=e._path,s=np(n,e),o=mA(n,t),l=n.listenProvider_.startListening(Ou(e),s,o.hashFn,o.onComplete),u=n.syncPointTree_.subtree(r);if(s)le(!go(u.value),"If we're adding a query, it shouldn't be shadowed");else{const h=u.fold((p,g,_)=>{if(!Ge(p)&&g&&go(g))return[Jp(g).query];{let v=[];return g&&(v=v.concat(cA(g).map(T=>T.query))),xn(_,(T,A)=>{v=v.concat(A)}),v}});for(let p=0;p<h.length;++p){const g=h[p];n.listenProvider_.stopListening(Ou(g),np(n,g))}}return l}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class uw{constructor(e){this.node_=e}getImmediateChild(e){const t=this.node_.getImmediateChild(e);return new uw(t)}node(){return this.node_}}class dw{constructor(e,t){this.syncTree_=e,this.path_=t}getImmediateChild(e){const t=Mt(this.path_,e);return new dw(this.syncTree_,t)}node(){return ow(this.syncTree_,this.path_)}}const p3=function(n){return n=n||{},n.timestamp=n.timestamp||new Date().getTime(),n},MC=function(n,e,t){if(!n||typeof n!="object")return n;if(le(".sv"in n,"Unexpected leaf node or priority contents"),typeof n[".sv"]=="string")return m3(n[".sv"],e,t);if(typeof n[".sv"]=="object")return g3(n[".sv"],e);le(!1,"Unexpected server value: "+JSON.stringify(n,null,2))},m3=function(n,e,t){switch(n){case"timestamp":return t.timestamp;default:le(!1,"Unexpected server value: "+n)}},g3=function(n,e,t){n.hasOwnProperty("increment")||le(!1,"Unexpected server value: "+JSON.stringify(n,null,2));const r=n.increment;typeof r!="number"&&le(!1,"Unexpected increment value: "+r);const s=e.node();if(le(s!==null&&typeof s<"u","Expected ChildrenNode.EMPTY_NODE for nulls"),!s.isLeafNode())return r;const l=s.getValue();return typeof l!="number"?r:l+r},y3=function(n,e,t,r){return hw(e,new dw(t,n),r)},gA=function(n,e,t){return hw(n,new uw(e),t)};function hw(n,e,t){const r=n.getPriority().val(),s=MC(r,e.getImmediateChild(".priority"),t);let o;if(n.isLeafNode()){const l=n,u=MC(l.getValue(),e,t);return u!==l.getValue()||s!==l.getPriority().val()?new Xt(u,Ut(s)):n}else{const l=n;return o=l,s!==l.getPriority().val()&&(o=o.updatePriority(new Xt(s))),l.forEachChild(It,(u,h)=>{const p=hw(h,e.getImmediateChild(u),t);p!==h&&(o=o.updateImmediateChild(u,p))}),o}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class fw{constructor(e="",t=null,r={children:{},childCount:0}){this.name=e,this.parent=t,this.node=r}}function pw(n,e){let t=e instanceof dt?e:new dt(e),r=n,s=He(t);for(;s!==null;){const o=Ll(r.node.children,s)||{children:{},childCount:0};r=new fw(s,r,o),t=ft(t),s=He(t)}return r}function cc(n){return n.node.value}function yA(n,e){n.node.value=e,m_(n)}function _A(n){return n.node.childCount>0}function _3(n){return cc(n)===void 0&&!_A(n)}function tm(n,e){xn(n.node.children,(t,r)=>{e(new fw(t,n,r))})}function vA(n,e,t,r){t&&e(n),tm(n,s=>{vA(s,e,!0)})}function v3(n,e,t){let r=n.parent;for(;r!==null;){if(e(r))return!0;r=r.parent}return!1}function xd(n){return new dt(n.parent===null?n.name:xd(n.parent)+"/"+n.name)}function m_(n){n.parent!==null&&w3(n.parent,n.name,n)}function w3(n,e,t){const r=_3(t),s=Es(n.node.children,e);r&&s?(delete n.node.children[e],n.node.childCount--,m_(n)):!r&&!s&&(n.node.children[e]=t.node,n.node.childCount++,m_(n))}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const E3=/[\[\].#$\/\u0000-\u001F\u007F]/,x3=/[\[\].#$\u0000-\u001F\u007F]/,py=10*1024*1024,mw=function(n){return typeof n=="string"&&n.length!==0&&!E3.test(n)},wA=function(n){return typeof n=="string"&&n.length!==0&&!x3.test(n)},T3=function(n){return n&&(n=n.replace(/^\/*\.info(\/|$)/,"/")),wA(n)},EA=function(n){return n===null||typeof n=="string"||typeof n=="number"&&!Qp(n)||n&&typeof n=="object"&&Es(n,".sv")},g_=function(n,e,t,r){nm(jl(n,"value"),e,t)},nm=function(n,e,t){const r=t instanceof dt?new zF(t,n):t;if(e===void 0)throw new Error(n+"contains undefined "+ea(r));if(typeof e=="function")throw new Error(n+"contains a function "+ea(r)+" with contents = "+e.toString());if(Qp(e))throw new Error(n+"contains "+e.toString()+" "+ea(r));if(typeof e=="string"&&e.length>py/3&&wp(e)>py)throw new Error(n+"contains a string greater than "+py+" utf8 bytes "+ea(r)+" ('"+e.substring(0,50)+"...')");if(e&&typeof e=="object"){let s=!1,o=!1;if(xn(e,(l,u)=>{if(l===".value")s=!0;else if(l!==".priority"&&l!==".sv"&&(o=!0,!mw(l)))throw new Error(n+" contains an invalid key ("+l+") "+ea(r)+`.  Keys must be non-empty strings and can't contain ".", "#", "$", "/", "[", or "]"`);BF(r,l),nm(n,u,r),$F(r)}),s&&o)throw new Error(n+' contains ".value" child '+ea(r)+" in addition to actual children.")}},C3=function(n,e){let t,r;for(t=0;t<e.length;t++){r=e[t];const o=Ku(r);for(let l=0;l<o.length;l++)if(!(o[l]===".priority"&&l===o.length-1)){if(!mw(o[l]))throw new Error(n+"contains an invalid key ("+o[l]+") in path "+r.toString()+`. Keys must be non-empty strings and can't contain ".", "#", "$", "/", "[", or "]"`)}}e.sort(UF);let s=null;for(t=0;t<e.length;t++){if(r=e[t],s!==null&&mr(s,r))throw new Error(n+"contains a path "+s.toString()+" that is ancestor of another path "+r.toString());s=r}},S3=function(n,e,t,r){const s=jl(n,"values");if(!(e&&typeof e=="object")||Array.isArray(e))throw new Error(s+" must be an object containing the children to replace.");const o=[];xn(e,(l,u)=>{const h=new dt(l);if(nm(s,u,Mt(t,h)),Gv(h)===".priority"&&!EA(u))throw new Error(s+"contains an invalid value for '"+h.toString()+"', which must be a valid Firebase priority (a string, finite number, server value, or null).");o.push(h)}),C3(s,o)},I3=function(n,e,t){if(Qp(e))throw new Error(jl(n,"priority")+"is "+e.toString()+", but must be a valid Firebase priority (a string, finite number, server value, or null).");if(!EA(e))throw new Error(jl(n,"priority")+"must be a valid Firebase priority (a string, finite number, server value, or null).")},xA=function(n,e,t,r){if(!wA(t))throw new Error(jl(n,e)+'was an invalid path = "'+t+`". Paths must be non-empty strings and can't contain ".", "#", "$", "[", or "]"`)},b3=function(n,e,t,r){t&&(t=t.replace(/^\/*\.info(\/|$)/,"/")),xA(n,e,t)},wu=function(n,e){if(He(e)===".info")throw new Error(n+" failed = Can't modify data under /.info/")},R3=function(n,e){const t=e.path.toString();if(typeof e.repoInfo.host!="string"||e.repoInfo.host.length===0||!mw(e.repoInfo.namespace)&&e.repoInfo.host.split(":")[0]!=="localhost"||t.length!==0&&!T3(t))throw new Error(jl(n,"url")+`must be a valid firebase URL and the path can't contain ".", "#", "$", "[", or "]".`)};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class A3{constructor(){this.eventLists_=[],this.recursionDepth_=0}}function gw(n,e){let t=null;for(let r=0;r<e.length;r++){const s=e[r],o=s.getPath();t!==null&&!Kv(o,t.path)&&(n.eventLists_.push(t),t=null),t===null&&(t={events:[],path:o}),t.events.push(s)}t&&n.eventLists_.push(t)}function TA(n,e,t){gw(n,t),CA(n,r=>Kv(r,e))}function si(n,e,t){gw(n,t),CA(n,r=>mr(r,e)||mr(e,r))}function CA(n,e){n.recursionDepth_++;let t=!0;for(let r=0;r<n.eventLists_.length;r++){const s=n.eventLists_[r];if(s){const o=s.path;e(o)?(k3(n.eventLists_[r]),n.eventLists_[r]=null):t=!1}}t&&(n.eventLists_=[]),n.recursionDepth_--}function k3(n){for(let e=0;e<n.events.length;e++){const t=n.events[e];if(t!==null){n.events[e]=null;const r=t.getEventRunner();ku&&an("event: "+t.toString()),ac(r)}}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const N3="repo_interrupt",P3=25;class D3{constructor(e,t,r,s){this.repoInfo_=e,this.forceRestClient_=t,this.authTokenProvider_=r,this.appCheckProvider_=s,this.dataUpdateCount=0,this.statsListener_=null,this.eventQueue_=new A3,this.nextWriteId_=1,this.interceptServerDataCallback_=null,this.onDisconnect_=Qf(),this.transactionQueueTree_=new fw,this.persistentConnection_=null,this.key=this.repoInfo_.toURLString()}toString(){return(this.repoInfo_.secure?"https://":"http://")+this.repoInfo_.host}}function O3(n,e,t){if(n.stats_=Hv(n.repoInfo_),n.forceRestClient_||dF())n.server_=new Kf(n.repoInfo_,(r,s,o,l)=>{LC(n,r,s,o,l)},n.authTokenProvider_,n.appCheckProvider_),setTimeout(()=>jC(n,!0),0);else{if(typeof t<"u"&&t!==null){if(typeof t!="object")throw new Error("Only objects are supported for option databaseAuthVariableOverride");try{en(t)}catch(r){throw new Error("Invalid authOverride provided: "+r)}}n.persistentConnection_=new Ys(n.repoInfo_,e,(r,s,o,l)=>{LC(n,r,s,o,l)},r=>{jC(n,r)},r=>{L3(n,r)},n.authTokenProvider_,n.appCheckProvider_,t),n.server_=n.persistentConnection_}n.authTokenProvider_.addTokenChangeListener(r=>{n.server_.refreshAuthToken(r)}),n.appCheckProvider_.addTokenChangeListener(r=>{n.server_.refreshAppCheckToken(r.token)}),n.statsReporter_=gF(n.repoInfo_,()=>new mU(n.stats_,n.server_)),n.infoData_=new uU,n.infoSyncTree_=new DC({startListening:(r,s,o,l)=>{let u=[];const h=n.infoData_.getNode(r._path);return h.isEmpty()||(u=Zp(n.infoSyncTree_,r._path,h),setTimeout(()=>{l("ok")},0)),u},stopListening:()=>{}}),_w(n,"connected",!1),n.serverSyncTree_=new DC({startListening:(r,s,o,l)=>(n.server_.listen(r,o,s,(u,h)=>{const p=l(u,h);si(n.eventQueue_,r._path,p)}),[]),stopListening:(r,s)=>{n.server_.unlisten(r,s)}})}function M3(n){const t=n.infoData_.getNode(new dt(".info/serverTimeOffset")).val()||0;return new Date().getTime()+t}function yw(n){return p3({timestamp:M3(n)})}function LC(n,e,t,r,s){n.dataUpdateCount++;const o=new dt(e);t=n.interceptServerDataCallback_?n.interceptServerDataCallback_(e,t):t;let l=[];if(s)if(r){const h=Sf(t,p=>Ut(p));l=c3(n.serverSyncTree_,o,h,s)}else{const h=Ut(t);l=l3(n.serverSyncTree_,o,h,s)}else if(r){const h=Sf(t,p=>Ut(p));l=i3(n.serverSyncTree_,o,h)}else{const h=Ut(t);l=Zp(n.serverSyncTree_,o,h)}let u=o;l.length>0&&(u=rm(n,o)),si(n.eventQueue_,u,l)}function jC(n,e){_w(n,"connected",e),e===!1&&V3(n)}function L3(n,e){xn(e,(t,r)=>{_w(n,t,r)})}function _w(n,e,t){const r=new dt("/.info/"+e),s=Ut(t);n.infoData_.updateSnapshot(r,s);const o=Zp(n.infoSyncTree_,r,s);si(n.eventQueue_,r,o)}function SA(n){return n.nextWriteId_++}function j3(n,e,t,r,s){vw(n,"set",{path:e.toString(),value:t,priority:r});const o=yw(n),l=Ut(t,r),u=ow(n.serverSyncTree_,e),h=gA(l,u,o),p=SA(n),g=hA(n.serverSyncTree_,e,h,p,!0);gw(n.eventQueue_,g),n.server_.put(e.toString(),l.val(!0),(v,T)=>{const A=v==="ok";A||zn("set at "+e+" failed: "+v);const I=ra(n.serverSyncTree_,p,!A);si(n.eventQueue_,e,I),Kl(n,s,v,T)});const _=kA(n,e);rm(n,_),si(n.eventQueue_,_,[])}function V3(n){vw(n,"onDisconnectEvents");const e=yw(n),t=Qf();l_(n.onDisconnect_,at(),(s,o)=>{const l=y3(s,o,n.serverSyncTree_,e);lc(t,s,l)});let r=[];l_(t,at(),(s,o)=>{r=r.concat(Zp(n.serverSyncTree_,s,o));const l=kA(n,s);rm(n,l)}),n.onDisconnect_=Qf(),si(n.eventQueue_,at(),r)}function F3(n,e,t){n.server_.onDisconnectCancel(e.toString(),(r,s)=>{r==="ok"&&a_(n.onDisconnect_,e),Kl(n,t,r,s)})}function VC(n,e,t,r){const s=Ut(t);n.server_.onDisconnectPut(e.toString(),s.val(!0),(o,l)=>{o==="ok"&&lc(n.onDisconnect_,e,s),Kl(n,r,o,l)})}function U3(n,e,t,r,s){const o=Ut(t,r);n.server_.onDisconnectPut(e.toString(),o.val(!0),(l,u)=>{l==="ok"&&lc(n.onDisconnect_,e,o),Kl(n,s,l,u)})}function z3(n,e,t,r){if(Cf(t)){an("onDisconnect().update() called with empty data.  Don't do anything."),Kl(n,r,"ok",void 0);return}n.server_.onDisconnectMerge(e.toString(),t,(s,o)=>{s==="ok"&&xn(t,(l,u)=>{const h=Ut(u);lc(n.onDisconnect_,Mt(e,l),h)}),Kl(n,r,s,o)})}function B3(n,e,t){let r;He(e._path)===".info"?r=OC(n.infoSyncTree_,e,t):r=OC(n.serverSyncTree_,e,t),TA(n.eventQueue_,e._path,r)}function $3(n,e,t){let r;He(e._path)===".info"?r=p_(n.infoSyncTree_,e,t):r=p_(n.serverSyncTree_,e,t),TA(n.eventQueue_,e._path,r)}function W3(n){n.persistentConnection_&&n.persistentConnection_.interrupt(N3)}function vw(n,...e){let t="";n.persistentConnection_&&(t=n.persistentConnection_.id+":"),an(t,...e)}function Kl(n,e,t,r){e&&ac(()=>{if(t==="ok")e(null);else{const s=(t||"error").toUpperCase();let o=s;r&&(o+=": "+r);const l=new Error(o);l.code=s,e(l)}})}function IA(n,e,t){return ow(n.serverSyncTree_,e,t)||Me.EMPTY_NODE}function ww(n,e=n.transactionQueueTree_){if(e||sm(n,e),cc(e)){const t=RA(n,e);le(t.length>0,"Sending zero length transaction queue"),t.every(s=>s.status===0)&&H3(n,xd(e),t)}else _A(e)&&tm(e,t=>{ww(n,t)})}function H3(n,e,t){const r=t.map(p=>p.currentWriteId),s=IA(n,e,r);let o=s;const l=s.hash();for(let p=0;p<t.length;p++){const g=t[p];le(g.status===0,"tryToSendTransactionQueue_: items in queue should all be run."),g.status=1,g.retryCount++;const _=Fn(e,g.path);o=o.updateChild(_,g.currentOutputSnapshotRaw)}const u=o.val(!0),h=e;n.server_.put(h.toString(),u,p=>{vw(n,"transaction put response",{path:h.toString(),status:p});let g=[];if(p==="ok"){const _=[];for(let v=0;v<t.length;v++)t[v].status=2,g=g.concat(ra(n.serverSyncTree_,t[v].currentWriteId)),t[v].onComplete&&_.push(()=>t[v].onComplete(null,!0,t[v].currentOutputSnapshotResolved)),t[v].unwatcher();sm(n,pw(n.transactionQueueTree_,e)),ww(n,n.transactionQueueTree_),si(n.eventQueue_,e,g);for(let v=0;v<_.length;v++)ac(_[v])}else{if(p==="datastale")for(let _=0;_<t.length;_++)t[_].status===3?t[_].status=4:t[_].status=0;else{zn("transaction at "+h.toString()+" failed: "+p);for(let _=0;_<t.length;_++)t[_].status=4,t[_].abortReason=p}rm(n,e)}},l)}function rm(n,e){const t=bA(n,e),r=xd(t),s=RA(n,t);return q3(n,s,r),r}function q3(n,e,t){if(e.length===0)return;const r=[];let s=[];const l=e.filter(u=>u.status===0).map(u=>u.currentWriteId);for(let u=0;u<e.length;u++){const h=e[u],p=Fn(t,h.path);let g=!1,_;if(le(p!==null,"rerunTransactionsUnderNode_: relativePath should not be null."),h.status===4)g=!0,_=h.abortReason,s=s.concat(ra(n.serverSyncTree_,h.currentWriteId,!0));else if(h.status===0)if(h.retryCount>=P3)g=!0,_="maxretry",s=s.concat(ra(n.serverSyncTree_,h.currentWriteId,!0));else{const v=IA(n,h.path,l);h.currentInputSnapshot=v;const T=e[u].update(v.val());if(T!==void 0){nm("transaction failed: Data returned ",T,h.path);let A=Ut(T);typeof T=="object"&&T!=null&&Es(T,".priority")||(A=A.updatePriority(v.getPriority()));const b=h.currentWriteId,j=yw(n),U=gA(A,v,j);h.currentOutputSnapshotRaw=A,h.currentOutputSnapshotResolved=U,h.currentWriteId=SA(n),l.splice(l.indexOf(b),1),s=s.concat(hA(n.serverSyncTree_,h.path,U,h.currentWriteId,h.applyLocally)),s=s.concat(ra(n.serverSyncTree_,b,!0))}else g=!0,_="nodata",s=s.concat(ra(n.serverSyncTree_,h.currentWriteId,!0))}si(n.eventQueue_,t,s),s=[],g&&(e[u].status=2,(function(v){setTimeout(v,Math.floor(0))})(e[u].unwatcher),e[u].onComplete&&(_==="nodata"?r.push(()=>e[u].onComplete(null,!1,e[u].currentInputSnapshot)):r.push(()=>e[u].onComplete(new Error(_),!1,null))))}sm(n,n.transactionQueueTree_);for(let u=0;u<r.length;u++)ac(r[u]);ww(n,n.transactionQueueTree_)}function bA(n,e){let t,r=n.transactionQueueTree_;for(t=He(e);t!==null&&cc(r)===void 0;)r=pw(r,t),e=ft(e),t=He(e);return r}function RA(n,e){const t=[];return AA(n,e,t),t.sort((r,s)=>r.order-s.order),t}function AA(n,e,t){const r=cc(e);if(r)for(let s=0;s<r.length;s++)t.push(r[s]);tm(e,s=>{AA(n,s,t)})}function sm(n,e){const t=cc(e);if(t){let r=0;for(let s=0;s<t.length;s++)t[s].status!==2&&(t[r]=t[s],r++);t.length=r,yA(e,t.length>0?t:void 0)}tm(e,r=>{sm(n,r)})}function kA(n,e){const t=xd(bA(n,e)),r=pw(n.transactionQueueTree_,e);return v3(r,s=>{my(n,s)}),my(n,r),vA(r,s=>{my(n,s)}),t}function my(n,e){const t=cc(e);if(t){const r=[];let s=[],o=-1;for(let l=0;l<t.length;l++)t[l].status===3||(t[l].status===1?(le(o===l-1,"All SENT items should be at beginning of queue."),o=l,t[l].status=3,t[l].abortReason="set"):(le(t[l].status===0,"Unexpected transaction status in abort"),t[l].unwatcher(),s=s.concat(ra(n.serverSyncTree_,t[l].currentWriteId,!0)),t[l].onComplete&&r.push(t[l].onComplete.bind(null,new Error("set"),!1,null))));o===-1?yA(e,void 0):t.length=o+1,si(n.eventQueue_,xd(e),s);for(let l=0;l<r.length;l++)ac(r[l])}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function G3(n){let e="";const t=n.split("/");for(let r=0;r<t.length;r++)if(t[r].length>0){let s=t[r];try{s=decodeURIComponent(s.replace(/\+/g," "))}catch{}e+="/"+s}return e}function K3(n){const e={};n.charAt(0)==="?"&&(n=n.substring(1));for(const t of n.split("&")){if(t.length===0)continue;const r=t.split("=");r.length===2?e[decodeURIComponent(r[0])]=decodeURIComponent(r[1]):zn(`Invalid query segment '${t}' in query '${n}'`)}return e}const FC=function(n,e){const t=Q3(n),r=t.namespace;t.domain==="firebase.com"&&ri(t.host+" is no longer supported. Please use <YOUR FIREBASE>.firebaseio.com instead"),(!r||r==="undefined")&&t.domain!=="localhost"&&ri("Cannot parse Firebase url. Please use https://<YOUR FIREBASE>.firebaseio.com"),t.secure||nF();const s=t.scheme==="ws"||t.scheme==="wss";return{repoInfo:new LR(t.host,t.secure,r,s,e,"",r!==t.subdomain),path:new dt(t.pathString)}},Q3=function(n){let e="",t="",r="",s="",o="",l=!0,u="https",h=443;if(typeof n=="string"){let p=n.indexOf("//");p>=0&&(u=n.substring(0,p-1),n=n.substring(p+2));let g=n.indexOf("/");g===-1&&(g=n.length);let _=n.indexOf("?");_===-1&&(_=n.length),e=n.substring(0,Math.min(g,_)),g<_&&(s=G3(n.substring(g,_)));const v=K3(n.substring(Math.min(n.length,_)));p=e.indexOf(":"),p>=0?(l=u==="https"||u==="wss",h=parseInt(e.substring(p+1),10)):p=e.length;const T=e.slice(0,p);if(T.toLowerCase()==="localhost")t="localhost";else if(T.split(".").length<=2)t=T;else{const A=e.indexOf(".");r=e.substring(0,A).toLowerCase(),t=e.substring(A+1),o=r}"ns"in v&&(o=v.ns)}return{host:e,port:h,domain:t,subdomain:r,secure:l,scheme:u,pathString:s,namespace:o}};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Y3{constructor(e,t,r,s){this.eventType=e,this.eventRegistration=t,this.snapshot=r,this.prevName=s}getPath(){const e=this.snapshot.ref;return this.eventType==="value"?e._path:e.parent._path}getEventType(){return this.eventType}getEventRunner(){return this.eventRegistration.getEventRunner(this)}toString(){return this.getPath().toString()+":"+this.eventType+":"+en(this.snapshot.exportVal())}}class X3{constructor(e,t,r){this.eventRegistration=e,this.error=t,this.path=r}getPath(){return this.path}getEventType(){return"cancel"}getEventRunner(){return this.eventRegistration.getEventRunner(this)}toString(){return this.path.toString()+":cancel"}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class J3{constructor(e,t){this.snapshotCallback=e,this.cancelCallback=t}onValue(e,t){this.snapshotCallback.call(null,e,t)}onCancel(e){return le(this.hasCancelCallback,"Raising a cancel event on a listener with no cancel callback"),this.cancelCallback.call(null,e)}get hasCancelCallback(){return!!this.cancelCallback}matches(e){return this.snapshotCallback===e.snapshotCallback||this.snapshotCallback.userCallback!==void 0&&this.snapshotCallback.userCallback===e.snapshotCallback.userCallback&&this.snapshotCallback.context===e.snapshotCallback.context}}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Z3{constructor(e,t){this._repo=e,this._path=t}cancel(){const e=new Hs;return F3(this._repo,this._path,e.wrapCallback(()=>{})),e.promise}remove(){wu("OnDisconnect.remove",this._path);const e=new Hs;return VC(this._repo,this._path,null,e.wrapCallback(()=>{})),e.promise}set(e){wu("OnDisconnect.set",this._path),g_("OnDisconnect.set",e,this._path);const t=new Hs;return VC(this._repo,this._path,e,t.wrapCallback(()=>{})),t.promise}setWithPriority(e,t){wu("OnDisconnect.setWithPriority",this._path),g_("OnDisconnect.setWithPriority",e,this._path),I3("OnDisconnect.setWithPriority",t);const r=new Hs;return U3(this._repo,this._path,e,t,r.wrapCallback(()=>{})),r.promise}update(e){wu("OnDisconnect.update",this._path),S3("OnDisconnect.update",e,this._path);const t=new Hs;return z3(this._repo,this._path,e,t.wrapCallback(()=>{})),t.promise}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ew{constructor(e,t,r,s){this._repo=e,this._path=t,this._queryParams=r,this._orderByCalled=s}get key(){return Ge(this._path)?null:Gv(this._path)}get ref(){return new So(this._repo,this._path)}get _queryIdentifier(){const e=xC(this._queryParams),t=$v(e);return t==="{}"?"default":t}get _queryObject(){return xC(this._queryParams)}isEqual(e){if(e=ut(e),!(e instanceof Ew))return!1;const t=this._repo===e._repo,r=Kv(this._path,e._path),s=this._queryIdentifier===e._queryIdentifier;return t&&r&&s}toJSON(){return this.toString()}toString(){return this._repo.toString()+FF(this._path)}}class So extends Ew{constructor(e,t){super(e,t,new Jv,!1)}get parent(){const e=HR(this._path);return e===null?null:new So(this._repo,e)}get root(){let e=this;for(;e.parent!==null;)e=e.parent;return e}}class rp{constructor(e,t,r){this._node=e,this.ref=t,this._index=r}get priority(){return this._node.getPriority().val()}get key(){return this.ref.key}get size(){return this._node.numChildren()}child(e){const t=new dt(e),r=__(this.ref,e);return new rp(this._node.getChild(t),r,It)}exists(){return!this._node.isEmpty()}exportVal(){return this._node.val(!0)}forEach(e){return this._node.isLeafNode()?!1:!!this._node.forEachChild(this._index,(r,s)=>e(new rp(s,__(this.ref,r),It)))}hasChild(e){const t=new dt(e);return!this._node.getChild(t).isEmpty()}hasChildren(){return this._node.isLeafNode()?!1:!this._node.isEmpty()}toJSON(){return this.exportVal()}val(){return this._node.val()}}function y_(n,e){return n=ut(n),n._checkNotDeleted("ref"),e!==void 0?__(n._root,e):n._root}function __(n,e){return n=ut(n),He(n._path)===null?b3("child","path",e):xA("child","path",e),new So(n._repo,Mt(n._path,e))}function e6(n){return n=ut(n),new Z3(n._repo,n._path)}function t6(n,e){n=ut(n),wu("set",n._path),g_("set",e,n._path);const t=new Hs;return j3(n._repo,n._path,e,null,t.wrapCallback(()=>{})),t.promise}class xw{constructor(e){this.callbackContext=e}respondsTo(e){return e==="value"}createEvent(e,t){const r=t._queryParams.getIndex();return new Y3("value",this,new rp(e.snapshotNode,new So(t._repo,t._path),r))}getEventRunner(e){return e.getEventType()==="cancel"?()=>this.callbackContext.onCancel(e.error):()=>this.callbackContext.onValue(e.snapshot,null)}createCancelEvent(e,t){return this.callbackContext.hasCancelCallback?new X3(this,e,t):null}matches(e){return e instanceof xw?!e.callbackContext||!this.callbackContext?!0:e.callbackContext.matches(this.callbackContext):!1}hasAnyCallback(){return this.callbackContext!==null}}function n6(n,e,t,r,s){const o=new J3(t,void 0),l=new xw(o);return B3(n._repo,n,l),()=>$3(n._repo,n,l)}function NA(n,e,t,r){return n6(n,"value",e)}YU(So);n3(So);/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const r6="FIREBASE_DATABASE_EMULATOR_HOST",v_={};let s6=!1;function i6(n,e,t,r){const s=e.lastIndexOf(":"),o=e.substring(0,s),l=vs(o);n.repoInfo_=new LR(e,l,n.repoInfo_.namespace,n.repoInfo_.webSocketOnly,n.repoInfo_.nodeAdmin,n.repoInfo_.persistenceKey,n.repoInfo_.includeNamespaceInQueryParams,!0,t),r&&(n.authTokenProvider_=r)}function o6(n,e,t,r,s){let o=r||n.options.databaseURL;o===void 0&&(n.options.projectId||ri("Can't determine Firebase Database URL. Be sure to include  a Project ID when calling firebase.initializeApp()."),an("Using default host for project ",n.options.projectId),o=`${n.options.projectId}-default-rtdb.firebaseio.com`);let l=FC(o,s),u=l.repoInfo,h;typeof process<"u"&&sC&&(h=sC[r6]),h?(o=`http://${h}?ns=${u.namespace}`,l=FC(o,s),u=l.repoInfo):l.repoInfo.secure;const p=new fF(n.name,n.options,e);R3("Invalid Firebase Database URL",l),Ge(l.path)||ri("Database URL must point to the root of a Firebase Database (not including a child path).");const g=l6(u,n,p,new hF(n,t));return new c6(g,n)}function a6(n,e){const t=v_[e];(!t||t[n.key]!==n)&&ri(`Database ${e}(${n.repoInfo_}) has already been deleted.`),W3(n),delete t[n.key]}function l6(n,e,t,r){let s=v_[e.name];s||(s={},v_[e.name]=s);let o=s[n.toURLString()];return o&&ri("Database initialized multiple times. Please make sure the format of the database URL matches with each database() call."),o=new D3(n,s6,t,r),s[n.toURLString()]=o,o}class c6{constructor(e,t){this._repoInternal=e,this.app=t,this.type="database",this._instanceStarted=!1}get _repo(){return this._instanceStarted||(O3(this._repoInternal,this.app.options.appId,this.app.options.databaseAuthVariableOverride),this._instanceStarted=!0),this._repoInternal}get _root(){return this._rootInternal||(this._rootInternal=new So(this._repo,at())),this._rootInternal}_delete(){return this._rootInternal!==null&&(a6(this._repo,this.app.name),this._repoInternal=null,this._rootInternal=null),Promise.resolve()}_checkNotDeleted(e){this._rootInternal===null&&ri("Cannot call "+e+" on a deleted database.")}}function u6(n=xp(),e){const t=od(n,"database").getImmediate({identifier:e});if(!t._instanceStarted){const r=O_("database");r&&d6(t,...r)}return t}function d6(n,e,t,r={}){n=ut(n),n._checkNotDeleted("useEmulator");const s=`${e}:${t}`,o=n._repoInternal;if(n._instanceStarted){if(s===n._repoInternal.repoInfo_.host&&io(r,o.repoInfo_.emulatorOptions))return;ri("connectDatabaseEmulator() cannot initialize or alter the emulator configuration after the database instance has started.")}let l;if(o.repoInfo_.nodeAdmin)r.mockUserToken&&ri('mockUserToken is not supported by the Admin SDK. For client access with mock users, please use the "firebase" package instead of "firebase-admin".'),l=new yf(yf.OWNER);else if(r.mockUserToken){const u=typeof r.mockUserToken=="string"?r.mockUserToken:M_(r.mockUserToken,n.app.options.projectId);l=new yf(u)}vs(e)&&(_p(e),vp("Database",!0)),i6(o,s,r,l)}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function h6(n){YV(vo),oo(new Xs("database",(e,{instanceIdentifier:t})=>{const r=e.getProvider("app").getImmediate(),s=e.getProvider("auth-internal"),o=e.getProvider("app-check-internal");return o6(r,s,o,t)},"PUBLIC").setMultipleInstances(!0)),gr(iC,oC,n),gr(iC,oC,"esm2020")}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const f6={".sv":"timestamp"};function UC(){return f6}Ys.prototype.simpleListen=function(n,e){this.sendRequest("q",{p:n},e)};Ys.prototype.echo=function(n,e){this.sendRequest("echo",{d:n},e)};h6();const p6={apiKey:"AIzaSyD3LkYqJE5Y_TR6A6UnajL304eyL4zO2lM",authDomain:"darklight-chat.firebaseapp.com",projectId:"darklight-chat",storageBucket:"darklight-chat.appspot.com",messagingSenderId:"425772939802",appId:"1:425772939802:web:5ba327426570f1b0d82fa3",databaseURL:"https://darklight-chat-default-rtdb.firebaseio.com"},im=HS(p6),sp=bM(im),hn=Ij(im),Tw=qV(im),w_=u6(im),PA=async(n,e)=>{if(!n)return;const t=li(hn,"users",n.uid);try{if(!(await yd(t)).exists()){const{displayName:s,username:o}=e,l=new Date;await Nv(t,{displayName:s,username:o.toLowerCase(),email:n.email,createdAt:l,avatar:"https://firebasestorage.googleapis.com/v0/b/darklight-chat.appspot.com/o/profile-pictures%2Fdefault_avatar.png?alt=media&token=0default-avatar-token",bio:`مرحباً! أنا ${s} في Dark*Chat`,postsCount:0,followersCount:0,followingCount:0,isGuest:e.isGuest||!1,...e})}return t}catch(r){throw console.error("Error in createUserDocument:",r),r}},m6=async(n,e,t)=>{const r=`${n.toLowerCase()}@darkchat.app`,{user:s}=await dO(om,r,t);return await PA(s,{username:n,displayName:e}),s},g6=async(n,e)=>{const t=`${n.toLowerCase()}@darkchat.app`,{user:r}=await hO(om,t,e);return r},y6=async()=>{const{user:n}=await aO(om),t=`Anonymous${Math.floor(Math.random()*9e5)+1e5}`;return await PA(n,{username:t.toLowerCase(),displayName:t,isGuest:!0}),n},zC=()=>gO(om),_6=n=>mO(sp,n),om=sp,_f=async n=>{if(!n)return null;const e=li(hn,"users",n),t=await yd(e);return t.exists()?{uid:n,...t.data()}:null},v6=async n=>{try{const e=await yd(li(hn,"users",n));return e.exists()?{id:e.id,...e.data()}:null}catch{throw new Error("فشل في تحميل الملف الشخصي")}},w6=async(n,e)=>{try{const t=li(hn,"users",n);await Kp(t,e)}catch(t){throw console.error("Error updating user profile: ",t),new Error("فشل في تحديث الملف الشخصي")}},E6=async n=>{try{return(await Pv(ys(hn,"posts"),{...n,timestamp:no(),createdAt:new Date().toISOString()})).id}catch{throw new Error("فشل في إنشاء المنشور")}},BC=async(n,e)=>{try{await Kp(li(hn,"posts",n),e)}catch{throw new Error("فشل في تحديث المنشور")}},x6=async(n,e)=>{try{const t=li(ys(hn,"stories"),n),r=await yd(t),s={...e,id:Date.now().toString(),timestamp:no(),viewedBy:[]};if(r.exists()){const o=r.data().stories||[];await Kp(t,{stories:[...o,s],updatedAt:no()})}else await Nv(t,{userId:n,stories:[s],updatedAt:no()});return s.id}catch(t){throw console.error("Error creating story: ",t),new Error("فشل في إنشاء الستوري")}},E_=async()=>{try{const n=new Date(Date.now()-864e5),e=Wl(ys(hn,"stories"),Ru("updatedAt",">=",n),Gp("updatedAt","desc"));return(await kv(e)).docs.map(s=>{const o=s.data(),l=o.stories.filter(u=>u.timestamp.toDate()>n);return{userId:s.id,...o,stories:l}}).filter(s=>s.stories.length>0)}catch(n){throw console.error("Error getting stories: ",n),new Error("فشل في تحميل الستوريز")}},T6=async(n,e)=>{const t=[n,e].sort(),r=t.join("_"),s=li(hn,"chats",r);return(await yd(s)).exists()||await Nv(s,{participants:t,createdAt:no(),lastMessage:null}),r},$C=async(n,e)=>{try{const t=ys(hn,"chats",n,"messages"),r=await Pv(t,{...e,timestamp:no()});return await Kp(li(hn,"chats",n),{lastMessage:{text:e.content,senderId:e.senderId,timestamp:no()}}),r.id}catch(t){throw console.error("Error sending message: ",t),new Error("فشل في إرسال الرسالة")}},C6=(n,e)=>{const t=Wl(ys(hn,"chats"),Ru("participants","array-contains",n));return Dv(t,async r=>{const s=r.docs.map(async l=>{const u=l.data(),h=u.participants.find(p=>p!==n);if(h){const p=await v6(h),g=ys(hn,"chats",l.id,"messages"),_=Wl(g,Ru("senderId","!=",n),Ru("isRead","==",!1)),T=(await kv(_)).size;return{id:l.id,...u,otherUser:p,unreadCount:T}}return null}),o=(await Promise.all(s)).filter(l=>l!==null).sort((l,u)=>{const h=l.lastMessage?.timestamp?.toDate()||l.createdAt?.toDate()||0;return(u.lastMessage?.timestamp?.toDate()||u.createdAt?.toDate()||0)-h});e(o)})},S6=async n=>{try{return(await Pv(ys(hn,"comments"),{...n,timestamp:no(),createdAt:new Date().toISOString()})).id}catch{throw new Error("فشل في إضافة التعليق")}},WC=async n=>{try{const e=Wl(ys(hn,"comments"),Ru("postId","==",n),Gp("timestamp","asc"));return(await kv(e)).docs.map(r=>({id:r.id,...r.data()}))}catch{throw new Error("فشل في تحميل التعليقات")}},I6=(n,e)=>{const t=ys(hn,"chats",n,"messages"),r=Wl(t,Gp("timestamp","asc"));return Dv(r,s=>{const o=s.docs.map(l=>{const u=l.data();return{id:l.id,...u,timestamp:u.timestamp?.toDate?u.timestamp.toDate().getTime():Date.now()}});e(o)})},b6=n=>{const e=Wl(ys(hn,"posts"),Gp("timestamp","desc"),Lj(50));return Dv(e,t=>{const r=t.docs.map(s=>({id:s.id,...s.data()}));n(r)})},R6=async(n,e)=>{try{const t=Bv(Tw,`profile-pictures/${n}/${e.name}`),r=await Uv(t,e);return await zv(r.ref)}catch(t){throw console.error("Error uploading avatar: ",t),new Error("فشل في رفع الصورة الرمزية")}},A6=async(n,e)=>{try{const t=Bv(Tw,`post-images/${n}/${Date.now()}_${e.name}`),r=await Uv(t,e);return await zv(r.ref)}catch(t){throw console.error("Error uploading post image: ",t),new Error("فشل في رفع صورة المنشور")}},k6=async(n,e)=>{try{const t=Bv(Tw,`story-images/${e}/${Date.now()}_${n.name}`),r=await Uv(t,n);return await zv(r.ref)}catch(t){throw console.error("Error uploading story image:",t),new Error("Failed to upload story image.")}},N6=n=>{const e=y_(w_,"/status/"+n),t={state:"offline",last_changed:UC()},r={state:"online",last_changed:UC()};NA(y_(w_,".info/connected"),s=>{s.val()!==!1&&e6(e).set(t).then(()=>{t6(e,r)})})};/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const P6=n=>n.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase(),D6=n=>n.replace(/^([A-Z])|[\s-_]+(\w)/g,(e,t,r)=>r?r.toUpperCase():t.toLowerCase()),HC=n=>{const e=D6(n);return e.charAt(0).toUpperCase()+e.slice(1)},DA=(...n)=>n.filter((e,t,r)=>!!e&&e.trim()!==""&&r.indexOf(e)===t).join(" ").trim();/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */var O6={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const M6=C.forwardRef(({color:n="currentColor",size:e=24,strokeWidth:t=2,absoluteStrokeWidth:r,className:s="",children:o,iconNode:l,...u},h)=>C.createElement("svg",{ref:h,...O6,width:e,height:e,stroke:n,strokeWidth:r?Number(t)*24/Number(e):t,className:DA("lucide",s),...u},[...l.map(([p,g])=>C.createElement(p,g)),...Array.isArray(o)?o:[o]]));/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const tt=(n,e)=>{const t=C.forwardRef(({className:r,...s},o)=>C.createElement(M6,{ref:o,iconNode:e,className:DA(`lucide-${P6(HC(n))}`,`lucide-${n}`,r),...s}));return t.displayName=HC(n),t};/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const L6=[["path",{d:"m12 19-7-7 7-7",key:"1l729n"}],["path",{d:"M19 12H5",key:"x3x0zl"}]],qC=tt("arrow-left",L6);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const j6=[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"m12 5 7 7-7 7",key:"xquz4c"}]],x_=tt("arrow-right",j6);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const V6=[["path",{d:"M14.5 4h-5L7 7H4a2 2 0 0 0-2 2v9a2 2 0 0 0 2 2h16a2 2 0 0 0 2-2V9a2 2 0 0 0-2-2h-3l-2.5-3z",key:"1tc9qg"}],["circle",{cx:"12",cy:"13",r:"3",key:"1vg3eu"}]],OA=tt("camera",V6);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const F6=[["path",{d:"M20 6 9 17l-5-5",key:"1gmf2c"}]],U6=tt("check",F6);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const z6=[["path",{d:"m15 18-6-6 6-6",key:"1wnfg3"}]],B6=tt("chevron-left",z6);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const $6=[["path",{d:"m9 18 6-6-6-6",key:"mthhwq"}]],W6=tt("chevron-right",$6);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const H6=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["polyline",{points:"12 6 12 12 16 14",key:"68esgv"}]],q6=tt("clock",H6);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const G6=[["polyline",{points:"16 18 22 12 16 6",key:"z7tu5w"}],["polyline",{points:"8 6 2 12 8 18",key:"1eg1df"}]],K6=tt("code",G6);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Q6=[["circle",{cx:"12",cy:"12",r:"1",key:"41hilf"}],["circle",{cx:"12",cy:"5",r:"1",key:"gxeob9"}],["circle",{cx:"12",cy:"19",r:"1",key:"lyex9k"}]],Y6=tt("ellipsis-vertical",Q6);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const X6=[["circle",{cx:"12",cy:"12",r:"1",key:"41hilf"}],["circle",{cx:"19",cy:"12",r:"1",key:"1wjl8i"}],["circle",{cx:"5",cy:"12",r:"1",key:"1pcz8c"}]],Cw=tt("ellipsis",X6);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const J6=[["path",{d:"M15 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7Z",key:"1rqfz7"}],["path",{d:"M14 2v4a2 2 0 0 0 2 2h4",key:"tnqrlb"}],["path",{d:"M10 9H8",key:"b1mrlr"}],["path",{d:"M16 13H8",key:"t4e002"}],["path",{d:"M16 17H8",key:"z1uh3a"}]],Z6=tt("file-text",J6);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const e5=[["path",{d:"M9 10h.01",key:"qbtxuw"}],["path",{d:"M15 10h.01",key:"1qmjsl"}],["path",{d:"M12 2a8 8 0 0 0-8 8v12l3-3 2.5 2.5L12 19l2.5 2.5L17 19l3 3V10a8 8 0 0 0-8-8z",key:"uwwb07"}]],t5=tt("ghost",e5);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const n5=[["path",{d:"M19 14c1.49-1.46 3-3.21 3-5.5A5.5 5.5 0 0 0 16.5 3c-1.76 0-3 .5-4.5 2-1.5-1.5-2.74-2-4.5-2A5.5 5.5 0 0 0 2 8.5c0 2.3 1.5 4.05 3 5.5l7 7Z",key:"c3ymky"}]],Ql=tt("heart",n5);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const r5=[["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",ry:"2",key:"1m3agn"}],["circle",{cx:"9",cy:"9",r:"2",key:"af1f0g"}],["path",{d:"m21 15-3.086-3.086a2 2 0 0 0-2.828 0L6 21",key:"1xmnt7"}]],MA=tt("image",r5);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const s5=[["path",{d:"M21 12a9 9 0 1 1-6.219-8.56",key:"13zald"}]],i5=tt("loader-circle",s5);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const o5=[["path",{d:"M15 3h4a2 2 0 0 1 2 2v14a2 2 0 0 1-2 2h-4",key:"u53s6r"}],["polyline",{points:"10 17 15 12 10 7",key:"1ail0h"}],["line",{x1:"15",x2:"3",y1:"12",y2:"12",key:"v6grx8"}]],a5=tt("log-in",o5);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const l5=[["path",{d:"M7.9 20A9 9 0 1 0 4 16.1L2 22Z",key:"vv11sd"}]],ed=tt("message-circle",l5);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const c5=[["path",{d:"M22 16.92v3a2 2 0 0 1-2.18 2 19.79 19.79 0 0 1-8.63-3.07 19.5 19.5 0 0 1-6-6 19.79 19.79 0 0 1-3.07-8.67A2 2 0 0 1 4.11 2h3a2 2 0 0 1 2 1.72 12.84 12.84 0 0 0 .7 2.81 2 2 0 0 1-.45 2.11L8.09 9.91a16 16 0 0 0 6 6l1.27-1.27a2 2 0 0 1 2.11-.45 12.84 12.84 0 0 0 2.81.7A2 2 0 0 1 22 16.92z",key:"foiqr5"}]],u5=tt("phone",c5);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const d5=[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"M12 5v14",key:"s699le"}]],ip=tt("plus",d5);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const h5=[["polyline",{points:"9 17 4 12 9 7",key:"hvgpf2"}],["path",{d:"M20 18v-2a4 4 0 0 0-4-4H4",key:"5vmcpk"}]],f5=tt("reply",h5);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const p5=[["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}],["path",{d:"m21 21-4.3-4.3",key:"1qie3q"}]],op=tt("search",p5);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const m5=[["path",{d:"M14.536 21.686a.5.5 0 0 0 .937-.024l6.5-19a.496.496 0 0 0-.635-.635l-19 6.5a.5.5 0 0 0-.024.937l7.93 3.18a2 2 0 0 1 1.112 1.11z",key:"1ffxy3"}],["path",{d:"m21.854 2.147-10.94 10.939",key:"12cjpa"}]],ma=tt("send",m5);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const g5=[["path",{d:"M12.22 2h-.44a2 2 0 0 0-2 2v.18a2 2 0 0 1-1 1.73l-.43.25a2 2 0 0 1-2 0l-.15-.08a2 2 0 0 0-2.73.73l-.22.38a2 2 0 0 0 .73 2.73l.15.1a2 2 0 0 1 1 1.72v.51a2 2 0 0 1-1 1.74l-.15.09a2 2 0 0 0-.73 2.73l.22.38a2 2 0 0 0 2.73.73l.15-.08a2 2 0 0 1 2 0l.43.25a2 2 0 0 1 1 1.73V20a2 2 0 0 0 2 2h.44a2 2 0 0 0 2-2v-.18a2 2 0 0 1 1-1.73l.43-.25a2 2 0 0 1 2 0l.15.08a2 2 0 0 0 2.73-.73l.22-.39a2 2 0 0 0-.73-2.73l-.15-.08a2 2 0 0 1-1-1.74v-.5a2 2 0 0 1 1-1.74l.15-.09a2 2 0 0 0 .73-2.73l-.22-.38a2 2 0 0 0-2.73-.73l-.15.08a2 2 0 0 1-2 0l-.43-.25a2 2 0 0 1-1-1.73V4a2 2 0 0 0-2-2z",key:"1qme2f"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]],y5=tt("settings",g5);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const _5=[["path",{d:"M4 12v8a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2v-8",key:"1b2hhj"}],["polyline",{points:"16 6 12 2 8 6",key:"m901s6"}],["line",{x1:"12",x2:"12",y1:"2",y2:"15",key:"1p0rca"}]],Sw=tt("share",_5);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const v5=[["path",{d:"M20 13c0 5-3.5 7.5-7.66 8.95a1 1 0 0 1-.67-.01C7.5 20.5 4 18 4 13V6a1 1 0 0 1 1-1c2 0 4.5-1.2 6.24-2.72a1.17 1.17 0 0 1 1.52 0C14.51 3.81 17 5 19 5a1 1 0 0 1 1 1z",key:"oel41y"}]],GC=tt("shield",v5);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const w5=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M8 14s1.5 2 4 2 4-2 4-2",key:"1y1vjs"}],["line",{x1:"9",x2:"9.01",y1:"9",y2:"9",key:"yxxnd0"}],["line",{x1:"15",x2:"15.01",y1:"9",y2:"9",key:"1p4y9e"}]],LA=tt("smile",w5);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const E5=[["path",{d:"M12 3H5a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7",key:"1m0v6g"}],["path",{d:"M18.375 2.625a1 1 0 0 1 3 3l-9.013 9.014a2 2 0 0 1-.853.505l-2.873.84a.5.5 0 0 1-.62-.62l.84-2.873a2 2 0 0 1 .506-.852z",key:"ohrbg2"}]],jA=tt("square-pen",E5);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const x5=[["polyline",{points:"22 7 13.5 15.5 8.5 10.5 2 17",key:"126l90"}],["polyline",{points:"16 7 22 7 22 13",key:"kwv8wd"}]],KC=tt("trending-up",x5);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const T5=[["polyline",{points:"4 7 4 4 20 4 20 7",key:"1nosan"}],["line",{x1:"9",x2:"15",y1:"20",y2:"20",key:"swin9y"}],["line",{x1:"12",x2:"12",y1:"4",y2:"20",key:"1tx1rr"}]],C5=tt("type",T5);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const S5=[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}],["line",{x1:"19",x2:"19",y1:"8",y2:"14",key:"1bvyxn"}],["line",{x1:"22",x2:"16",y1:"11",y2:"11",key:"1shjgl"}]],Iw=tt("user-plus",S5);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const I5=[["path",{d:"M19 21v-2a4 4 0 0 0-4-4H9a4 4 0 0 0-4 4v2",key:"975kel"}],["circle",{cx:"12",cy:"7",r:"4",key:"17ys0d"}]],b5=tt("user",I5);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const R5=[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}],["path",{d:"M22 21v-2a4 4 0 0 0-3-3.87",key:"kshegd"}],["path",{d:"M16 3.13a4 4 0 0 1 0 7.75",key:"1da9ce"}]],VA=tt("users",R5);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const A5=[["path",{d:"m16 13 5.223 3.482a.5.5 0 0 0 .777-.416V7.87a.5.5 0 0 0-.752-.432L16 10.5",key:"ftymec"}],["rect",{x:"2",y:"6",width:"14",height:"12",rx:"2",key:"158x01"}]],k5=tt("video",A5);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const N5=[["path",{d:"M18 6 6 18",key:"1bl5f8"}],["path",{d:"m6 6 12 12",key:"d8bk6v"}]],xa=tt("x",N5);function QC(n,e){if(typeof n=="function")return n(e);n!=null&&(n.current=e)}function am(...n){return e=>{let t=!1;const r=n.map(s=>{const o=QC(s,e);return!t&&typeof o=="function"&&(t=!0),o});if(t)return()=>{for(let s=0;s<r.length;s++){const o=r[s];typeof o=="function"?o():QC(n[s],null)}}}}function Et(...n){return C.useCallback(am(...n),n)}function Yl(n){const e=P5(n),t=C.forwardRef((r,s)=>{const{children:o,...l}=r,u=C.Children.toArray(o),h=u.find(O5);if(h){const p=h.props.children,g=u.map(_=>_===h?C.Children.count(p)>1?C.Children.only(null):C.isValidElement(p)?p.props.children:null:_);return m.jsx(e,{...l,ref:s,children:C.isValidElement(p)?C.cloneElement(p,void 0,g):null})}return m.jsx(e,{...l,ref:s,children:o})});return t.displayName=`${n}.Slot`,t}var FA=Yl("Slot");function P5(n){const e=C.forwardRef((t,r)=>{const{children:s,...o}=t;if(C.isValidElement(s)){const l=L5(s),u=M5(o,s.props);return s.type!==C.Fragment&&(u.ref=r?am(r,l):l),C.cloneElement(s,u)}return C.Children.count(s)>1?C.Children.only(null):null});return e.displayName=`${n}.SlotClone`,e}var D5=Symbol("radix.slottable");function O5(n){return C.isValidElement(n)&&typeof n.type=="function"&&"__radixId"in n.type&&n.type.__radixId===D5}function M5(n,e){const t={...e};for(const r in e){const s=n[r],o=e[r];/^on[A-Z]/.test(r)?s&&o?t[r]=(...u)=>{const h=o(...u);return s(...u),h}:s&&(t[r]=s):r==="style"?t[r]={...s,...o}:r==="className"&&(t[r]=[s,o].filter(Boolean).join(" "))}return{...n,...t}}function L5(n){let e=Object.getOwnPropertyDescriptor(n.props,"ref")?.get,t=e&&"isReactWarning"in e&&e.isReactWarning;return t?n.ref:(e=Object.getOwnPropertyDescriptor(n,"ref")?.get,t=e&&"isReactWarning"in e&&e.isReactWarning,t?n.props.ref:n.props.ref||n.ref)}function UA(n){var e,t,r="";if(typeof n=="string"||typeof n=="number")r+=n;else if(typeof n=="object")if(Array.isArray(n)){var s=n.length;for(e=0;e<s;e++)n[e]&&(t=UA(n[e]))&&(r&&(r+=" "),r+=t)}else for(t in n)n[t]&&(r&&(r+=" "),r+=t);return r}function zA(){for(var n,e,t=0,r="",s=arguments.length;t<s;t++)(n=arguments[t])&&(e=UA(n))&&(r&&(r+=" "),r+=e);return r}const YC=n=>typeof n=="boolean"?`${n}`:n===0?"0":n,XC=zA,BA=(n,e)=>t=>{var r;if(e?.variants==null)return XC(n,t?.class,t?.className);const{variants:s,defaultVariants:o}=e,l=Object.keys(s).map(p=>{const g=t?.[p],_=o?.[p];if(g===null)return null;const v=YC(g)||YC(_);return s[p][v]}),u=t&&Object.entries(t).reduce((p,g)=>{let[_,v]=g;return v===void 0||(p[_]=v),p},{}),h=e==null||(r=e.compoundVariants)===null||r===void 0?void 0:r.reduce((p,g)=>{let{class:_,className:v,...T}=g;return Object.entries(T).every(A=>{let[I,b]=A;return Array.isArray(b)?b.includes({...o,...u}[I]):{...o,...u}[I]===b})?[...p,_,v]:p},[]);return XC(n,l,h,t?.class,t?.className)},bw="-",j5=n=>{const e=F5(n),{conflictingClassGroups:t,conflictingClassGroupModifiers:r}=n;return{getClassGroupId:l=>{const u=l.split(bw);return u[0]===""&&u.length!==1&&u.shift(),$A(u,e)||V5(l)},getConflictingClassGroupIds:(l,u)=>{const h=t[l]||[];return u&&r[l]?[...h,...r[l]]:h}}},$A=(n,e)=>{if(n.length===0)return e.classGroupId;const t=n[0],r=e.nextPart.get(t),s=r?$A(n.slice(1),r):void 0;if(s)return s;if(e.validators.length===0)return;const o=n.join(bw);return e.validators.find(({validator:l})=>l(o))?.classGroupId},JC=/^\[(.+)\]$/,V5=n=>{if(JC.test(n)){const e=JC.exec(n)[1],t=e?.substring(0,e.indexOf(":"));if(t)return"arbitrary.."+t}},F5=n=>{const{theme:e,classGroups:t}=n,r={nextPart:new Map,validators:[]};for(const s in t)T_(t[s],r,s,e);return r},T_=(n,e,t,r)=>{n.forEach(s=>{if(typeof s=="string"){const o=s===""?e:ZC(e,s);o.classGroupId=t;return}if(typeof s=="function"){if(U5(s)){T_(s(r),e,t,r);return}e.validators.push({validator:s,classGroupId:t});return}Object.entries(s).forEach(([o,l])=>{T_(l,ZC(e,o),t,r)})})},ZC=(n,e)=>{let t=n;return e.split(bw).forEach(r=>{t.nextPart.has(r)||t.nextPart.set(r,{nextPart:new Map,validators:[]}),t=t.nextPart.get(r)}),t},U5=n=>n.isThemeGetter,z5=n=>{if(n<1)return{get:()=>{},set:()=>{}};let e=0,t=new Map,r=new Map;const s=(o,l)=>{t.set(o,l),e++,e>n&&(e=0,r=t,t=new Map)};return{get(o){let l=t.get(o);if(l!==void 0)return l;if((l=r.get(o))!==void 0)return s(o,l),l},set(o,l){t.has(o)?t.set(o,l):s(o,l)}}},C_="!",S_=":",B5=S_.length,$5=n=>{const{prefix:e,experimentalParseClassName:t}=n;let r=s=>{const o=[];let l=0,u=0,h=0,p;for(let A=0;A<s.length;A++){let I=s[A];if(l===0&&u===0){if(I===S_){o.push(s.slice(h,A)),h=A+B5;continue}if(I==="/"){p=A;continue}}I==="["?l++:I==="]"?l--:I==="("?u++:I===")"&&u--}const g=o.length===0?s:s.substring(h),_=W5(g),v=_!==g,T=p&&p>h?p-h:void 0;return{modifiers:o,hasImportantModifier:v,baseClassName:_,maybePostfixModifierPosition:T}};if(e){const s=e+S_,o=r;r=l=>l.startsWith(s)?o(l.substring(s.length)):{isExternal:!0,modifiers:[],hasImportantModifier:!1,baseClassName:l,maybePostfixModifierPosition:void 0}}if(t){const s=r;r=o=>t({className:o,parseClassName:s})}return r},W5=n=>n.endsWith(C_)?n.substring(0,n.length-1):n.startsWith(C_)?n.substring(1):n,H5=n=>{const e=Object.fromEntries(n.orderSensitiveModifiers.map(r=>[r,!0]));return r=>{if(r.length<=1)return r;const s=[];let o=[];return r.forEach(l=>{l[0]==="["||e[l]?(s.push(...o.sort(),l),o=[]):o.push(l)}),s.push(...o.sort()),s}},q5=n=>({cache:z5(n.cacheSize),parseClassName:$5(n),sortModifiers:H5(n),...j5(n)}),G5=/\s+/,K5=(n,e)=>{const{parseClassName:t,getClassGroupId:r,getConflictingClassGroupIds:s,sortModifiers:o}=e,l=[],u=n.trim().split(G5);let h="";for(let p=u.length-1;p>=0;p-=1){const g=u[p],{isExternal:_,modifiers:v,hasImportantModifier:T,baseClassName:A,maybePostfixModifierPosition:I}=t(g);if(_){h=g+(h.length>0?" "+h:h);continue}let b=!!I,j=r(b?A.substring(0,I):A);if(!j){if(!b){h=g+(h.length>0?" "+h:h);continue}if(j=r(A),!j){h=g+(h.length>0?" "+h:h);continue}b=!1}const U=o(v).join(":"),$=T?U+C_:U,G=$+j;if(l.includes(G))continue;l.push(G);const X=s(j,b);for(let ne=0;ne<X.length;++ne){const P=X[ne];l.push($+P)}h=g+(h.length>0?" "+h:h)}return h};function Q5(){let n=0,e,t,r="";for(;n<arguments.length;)(e=arguments[n++])&&(t=WA(e))&&(r&&(r+=" "),r+=t);return r}const WA=n=>{if(typeof n=="string")return n;let e,t="";for(let r=0;r<n.length;r++)n[r]&&(e=WA(n[r]))&&(t&&(t+=" "),t+=e);return t};function Y5(n,...e){let t,r,s,o=l;function l(h){const p=e.reduce((g,_)=>_(g),n());return t=q5(p),r=t.cache.get,s=t.cache.set,o=u,u(h)}function u(h){const p=r(h);if(p)return p;const g=K5(h,t);return s(h,g),g}return function(){return o(Q5.apply(null,arguments))}}const qt=n=>{const e=t=>t[n]||[];return e.isThemeGetter=!0,e},HA=/^\[(?:(\w[\w-]*):)?(.+)\]$/i,qA=/^\((?:(\w[\w-]*):)?(.+)\)$/i,X5=/^\d+\/\d+$/,J5=/^(\d+(\.\d+)?)?(xs|sm|md|lg|xl)$/,Z5=/\d+(%|px|r?em|[sdl]?v([hwib]|min|max)|pt|pc|in|cm|mm|cap|ch|ex|r?lh|cq(w|h|i|b|min|max))|\b(calc|min|max|clamp)\(.+\)|^0$/,e9=/^(rgba?|hsla?|hwb|(ok)?(lab|lch)|color-mix)\(.+\)$/,t9=/^(inset_)?-?((\d+)?\.?(\d+)[a-z]+|0)_-?((\d+)?\.?(\d+)[a-z]+|0)/,n9=/^(url|image|image-set|cross-fade|element|(repeating-)?(linear|radial|conic)-gradient)\(.+\)$/,gl=n=>X5.test(n),We=n=>!!n&&!Number.isNaN(Number(n)),Bi=n=>!!n&&Number.isInteger(Number(n)),gy=n=>n.endsWith("%")&&We(n.slice(0,-1)),Bs=n=>J5.test(n),r9=()=>!0,s9=n=>Z5.test(n)&&!e9.test(n),GA=()=>!1,i9=n=>t9.test(n),o9=n=>n9.test(n),a9=n=>!we(n)&&!Ee(n),l9=n=>uc(n,YA,GA),we=n=>HA.test(n),Jo=n=>uc(n,XA,s9),yy=n=>uc(n,f9,We),eS=n=>uc(n,KA,GA),c9=n=>uc(n,QA,o9),Jh=n=>uc(n,JA,i9),Ee=n=>qA.test(n),fu=n=>dc(n,XA),u9=n=>dc(n,p9),tS=n=>dc(n,KA),d9=n=>dc(n,YA),h9=n=>dc(n,QA),Zh=n=>dc(n,JA,!0),uc=(n,e,t)=>{const r=HA.exec(n);return r?r[1]?e(r[1]):t(r[2]):!1},dc=(n,e,t=!1)=>{const r=qA.exec(n);return r?r[1]?e(r[1]):t:!1},KA=n=>n==="position"||n==="percentage",QA=n=>n==="image"||n==="url",YA=n=>n==="length"||n==="size"||n==="bg-size",XA=n=>n==="length",f9=n=>n==="number",p9=n=>n==="family-name",JA=n=>n==="shadow",m9=()=>{const n=qt("color"),e=qt("font"),t=qt("text"),r=qt("font-weight"),s=qt("tracking"),o=qt("leading"),l=qt("breakpoint"),u=qt("container"),h=qt("spacing"),p=qt("radius"),g=qt("shadow"),_=qt("inset-shadow"),v=qt("text-shadow"),T=qt("drop-shadow"),A=qt("blur"),I=qt("perspective"),b=qt("aspect"),j=qt("ease"),U=qt("animate"),$=()=>["auto","avoid","all","avoid-page","page","left","right","column"],G=()=>["center","top","bottom","left","right","top-left","left-top","top-right","right-top","bottom-right","right-bottom","bottom-left","left-bottom"],X=()=>[...G(),Ee,we],ne=()=>["auto","hidden","clip","visible","scroll"],P=()=>["auto","contain","none"],R=()=>[Ee,we,h],N=()=>[gl,"full","auto",...R()],L=()=>[Bi,"none","subgrid",Ee,we],O=()=>["auto",{span:["full",Bi,Ee,we]},Bi,Ee,we],F=()=>[Bi,"auto",Ee,we],D=()=>["auto","min","max","fr",Ee,we],Ce=()=>["start","end","center","between","around","evenly","stretch","baseline","center-safe","end-safe"],je=()=>["start","end","center","stretch","center-safe","end-safe"],Se=()=>["auto",...R()],Ie=()=>[gl,"auto","full","dvw","dvh","lvw","lvh","svw","svh","min","max","fit",...R()],W=()=>[n,Ee,we],J=()=>[...G(),tS,eS,{position:[Ee,we]}],oe=()=>["no-repeat",{repeat:["","x","y","space","round"]}],B=()=>["auto","cover","contain",d9,l9,{size:[Ee,we]}],Z=()=>[gy,fu,Jo],me=()=>["","none","full",p,Ee,we],_e=()=>["",We,fu,Jo],Ne=()=>["solid","dashed","dotted","double"],Pe=()=>["normal","multiply","screen","overlay","darken","lighten","color-dodge","color-burn","hard-light","soft-light","difference","exclusion","hue","saturation","color","luminosity"],he=()=>[We,gy,tS,eS],Fe=()=>["","none",A,Ee,we],Ye=()=>["none",We,Ee,we],xt=()=>["none",We,Ee,we],An=()=>[We,Ee,we],kn=()=>[gl,"full",...R()];return{cacheSize:500,theme:{animate:["spin","ping","pulse","bounce"],aspect:["video"],blur:[Bs],breakpoint:[Bs],color:[r9],container:[Bs],"drop-shadow":[Bs],ease:["in","out","in-out"],font:[a9],"font-weight":["thin","extralight","light","normal","medium","semibold","bold","extrabold","black"],"inset-shadow":[Bs],leading:["none","tight","snug","normal","relaxed","loose"],perspective:["dramatic","near","normal","midrange","distant","none"],radius:[Bs],shadow:[Bs],spacing:["px",We],text:[Bs],"text-shadow":[Bs],tracking:["tighter","tight","normal","wide","wider","widest"]},classGroups:{aspect:[{aspect:["auto","square",gl,we,Ee,b]}],container:["container"],columns:[{columns:[We,we,Ee,u]}],"break-after":[{"break-after":$()}],"break-before":[{"break-before":$()}],"break-inside":[{"break-inside":["auto","avoid","avoid-page","avoid-column"]}],"box-decoration":[{"box-decoration":["slice","clone"]}],box:[{box:["border","content"]}],display:["block","inline-block","inline","flex","inline-flex","table","inline-table","table-caption","table-cell","table-column","table-column-group","table-footer-group","table-header-group","table-row-group","table-row","flow-root","grid","inline-grid","contents","list-item","hidden"],sr:["sr-only","not-sr-only"],float:[{float:["right","left","none","start","end"]}],clear:[{clear:["left","right","both","none","start","end"]}],isolation:["isolate","isolation-auto"],"object-fit":[{object:["contain","cover","fill","none","scale-down"]}],"object-position":[{object:X()}],overflow:[{overflow:ne()}],"overflow-x":[{"overflow-x":ne()}],"overflow-y":[{"overflow-y":ne()}],overscroll:[{overscroll:P()}],"overscroll-x":[{"overscroll-x":P()}],"overscroll-y":[{"overscroll-y":P()}],position:["static","fixed","absolute","relative","sticky"],inset:[{inset:N()}],"inset-x":[{"inset-x":N()}],"inset-y":[{"inset-y":N()}],start:[{start:N()}],end:[{end:N()}],top:[{top:N()}],right:[{right:N()}],bottom:[{bottom:N()}],left:[{left:N()}],visibility:["visible","invisible","collapse"],z:[{z:[Bi,"auto",Ee,we]}],basis:[{basis:[gl,"full","auto",u,...R()]}],"flex-direction":[{flex:["row","row-reverse","col","col-reverse"]}],"flex-wrap":[{flex:["nowrap","wrap","wrap-reverse"]}],flex:[{flex:[We,gl,"auto","initial","none",we]}],grow:[{grow:["",We,Ee,we]}],shrink:[{shrink:["",We,Ee,we]}],order:[{order:[Bi,"first","last","none",Ee,we]}],"grid-cols":[{"grid-cols":L()}],"col-start-end":[{col:O()}],"col-start":[{"col-start":F()}],"col-end":[{"col-end":F()}],"grid-rows":[{"grid-rows":L()}],"row-start-end":[{row:O()}],"row-start":[{"row-start":F()}],"row-end":[{"row-end":F()}],"grid-flow":[{"grid-flow":["row","col","dense","row-dense","col-dense"]}],"auto-cols":[{"auto-cols":D()}],"auto-rows":[{"auto-rows":D()}],gap:[{gap:R()}],"gap-x":[{"gap-x":R()}],"gap-y":[{"gap-y":R()}],"justify-content":[{justify:[...Ce(),"normal"]}],"justify-items":[{"justify-items":[...je(),"normal"]}],"justify-self":[{"justify-self":["auto",...je()]}],"align-content":[{content:["normal",...Ce()]}],"align-items":[{items:[...je(),{baseline:["","last"]}]}],"align-self":[{self:["auto",...je(),{baseline:["","last"]}]}],"place-content":[{"place-content":Ce()}],"place-items":[{"place-items":[...je(),"baseline"]}],"place-self":[{"place-self":["auto",...je()]}],p:[{p:R()}],px:[{px:R()}],py:[{py:R()}],ps:[{ps:R()}],pe:[{pe:R()}],pt:[{pt:R()}],pr:[{pr:R()}],pb:[{pb:R()}],pl:[{pl:R()}],m:[{m:Se()}],mx:[{mx:Se()}],my:[{my:Se()}],ms:[{ms:Se()}],me:[{me:Se()}],mt:[{mt:Se()}],mr:[{mr:Se()}],mb:[{mb:Se()}],ml:[{ml:Se()}],"space-x":[{"space-x":R()}],"space-x-reverse":["space-x-reverse"],"space-y":[{"space-y":R()}],"space-y-reverse":["space-y-reverse"],size:[{size:Ie()}],w:[{w:[u,"screen",...Ie()]}],"min-w":[{"min-w":[u,"screen","none",...Ie()]}],"max-w":[{"max-w":[u,"screen","none","prose",{screen:[l]},...Ie()]}],h:[{h:["screen","lh",...Ie()]}],"min-h":[{"min-h":["screen","lh","none",...Ie()]}],"max-h":[{"max-h":["screen","lh",...Ie()]}],"font-size":[{text:["base",t,fu,Jo]}],"font-smoothing":["antialiased","subpixel-antialiased"],"font-style":["italic","not-italic"],"font-weight":[{font:[r,Ee,yy]}],"font-stretch":[{"font-stretch":["ultra-condensed","extra-condensed","condensed","semi-condensed","normal","semi-expanded","expanded","extra-expanded","ultra-expanded",gy,we]}],"font-family":[{font:[u9,we,e]}],"fvn-normal":["normal-nums"],"fvn-ordinal":["ordinal"],"fvn-slashed-zero":["slashed-zero"],"fvn-figure":["lining-nums","oldstyle-nums"],"fvn-spacing":["proportional-nums","tabular-nums"],"fvn-fraction":["diagonal-fractions","stacked-fractions"],tracking:[{tracking:[s,Ee,we]}],"line-clamp":[{"line-clamp":[We,"none",Ee,yy]}],leading:[{leading:[o,...R()]}],"list-image":[{"list-image":["none",Ee,we]}],"list-style-position":[{list:["inside","outside"]}],"list-style-type":[{list:["disc","decimal","none",Ee,we]}],"text-alignment":[{text:["left","center","right","justify","start","end"]}],"placeholder-color":[{placeholder:W()}],"text-color":[{text:W()}],"text-decoration":["underline","overline","line-through","no-underline"],"text-decoration-style":[{decoration:[...Ne(),"wavy"]}],"text-decoration-thickness":[{decoration:[We,"from-font","auto",Ee,Jo]}],"text-decoration-color":[{decoration:W()}],"underline-offset":[{"underline-offset":[We,"auto",Ee,we]}],"text-transform":["uppercase","lowercase","capitalize","normal-case"],"text-overflow":["truncate","text-ellipsis","text-clip"],"text-wrap":[{text:["wrap","nowrap","balance","pretty"]}],indent:[{indent:R()}],"vertical-align":[{align:["baseline","top","middle","bottom","text-top","text-bottom","sub","super",Ee,we]}],whitespace:[{whitespace:["normal","nowrap","pre","pre-line","pre-wrap","break-spaces"]}],break:[{break:["normal","words","all","keep"]}],wrap:[{wrap:["break-word","anywhere","normal"]}],hyphens:[{hyphens:["none","manual","auto"]}],content:[{content:["none",Ee,we]}],"bg-attachment":[{bg:["fixed","local","scroll"]}],"bg-clip":[{"bg-clip":["border","padding","content","text"]}],"bg-origin":[{"bg-origin":["border","padding","content"]}],"bg-position":[{bg:J()}],"bg-repeat":[{bg:oe()}],"bg-size":[{bg:B()}],"bg-image":[{bg:["none",{linear:[{to:["t","tr","r","br","b","bl","l","tl"]},Bi,Ee,we],radial:["",Ee,we],conic:[Bi,Ee,we]},h9,c9]}],"bg-color":[{bg:W()}],"gradient-from-pos":[{from:Z()}],"gradient-via-pos":[{via:Z()}],"gradient-to-pos":[{to:Z()}],"gradient-from":[{from:W()}],"gradient-via":[{via:W()}],"gradient-to":[{to:W()}],rounded:[{rounded:me()}],"rounded-s":[{"rounded-s":me()}],"rounded-e":[{"rounded-e":me()}],"rounded-t":[{"rounded-t":me()}],"rounded-r":[{"rounded-r":me()}],"rounded-b":[{"rounded-b":me()}],"rounded-l":[{"rounded-l":me()}],"rounded-ss":[{"rounded-ss":me()}],"rounded-se":[{"rounded-se":me()}],"rounded-ee":[{"rounded-ee":me()}],"rounded-es":[{"rounded-es":me()}],"rounded-tl":[{"rounded-tl":me()}],"rounded-tr":[{"rounded-tr":me()}],"rounded-br":[{"rounded-br":me()}],"rounded-bl":[{"rounded-bl":me()}],"border-w":[{border:_e()}],"border-w-x":[{"border-x":_e()}],"border-w-y":[{"border-y":_e()}],"border-w-s":[{"border-s":_e()}],"border-w-e":[{"border-e":_e()}],"border-w-t":[{"border-t":_e()}],"border-w-r":[{"border-r":_e()}],"border-w-b":[{"border-b":_e()}],"border-w-l":[{"border-l":_e()}],"divide-x":[{"divide-x":_e()}],"divide-x-reverse":["divide-x-reverse"],"divide-y":[{"divide-y":_e()}],"divide-y-reverse":["divide-y-reverse"],"border-style":[{border:[...Ne(),"hidden","none"]}],"divide-style":[{divide:[...Ne(),"hidden","none"]}],"border-color":[{border:W()}],"border-color-x":[{"border-x":W()}],"border-color-y":[{"border-y":W()}],"border-color-s":[{"border-s":W()}],"border-color-e":[{"border-e":W()}],"border-color-t":[{"border-t":W()}],"border-color-r":[{"border-r":W()}],"border-color-b":[{"border-b":W()}],"border-color-l":[{"border-l":W()}],"divide-color":[{divide:W()}],"outline-style":[{outline:[...Ne(),"none","hidden"]}],"outline-offset":[{"outline-offset":[We,Ee,we]}],"outline-w":[{outline:["",We,fu,Jo]}],"outline-color":[{outline:W()}],shadow:[{shadow:["","none",g,Zh,Jh]}],"shadow-color":[{shadow:W()}],"inset-shadow":[{"inset-shadow":["none",_,Zh,Jh]}],"inset-shadow-color":[{"inset-shadow":W()}],"ring-w":[{ring:_e()}],"ring-w-inset":["ring-inset"],"ring-color":[{ring:W()}],"ring-offset-w":[{"ring-offset":[We,Jo]}],"ring-offset-color":[{"ring-offset":W()}],"inset-ring-w":[{"inset-ring":_e()}],"inset-ring-color":[{"inset-ring":W()}],"text-shadow":[{"text-shadow":["none",v,Zh,Jh]}],"text-shadow-color":[{"text-shadow":W()}],opacity:[{opacity:[We,Ee,we]}],"mix-blend":[{"mix-blend":[...Pe(),"plus-darker","plus-lighter"]}],"bg-blend":[{"bg-blend":Pe()}],"mask-clip":[{"mask-clip":["border","padding","content","fill","stroke","view"]},"mask-no-clip"],"mask-composite":[{mask:["add","subtract","intersect","exclude"]}],"mask-image-linear-pos":[{"mask-linear":[We]}],"mask-image-linear-from-pos":[{"mask-linear-from":he()}],"mask-image-linear-to-pos":[{"mask-linear-to":he()}],"mask-image-linear-from-color":[{"mask-linear-from":W()}],"mask-image-linear-to-color":[{"mask-linear-to":W()}],"mask-image-t-from-pos":[{"mask-t-from":he()}],"mask-image-t-to-pos":[{"mask-t-to":he()}],"mask-image-t-from-color":[{"mask-t-from":W()}],"mask-image-t-to-color":[{"mask-t-to":W()}],"mask-image-r-from-pos":[{"mask-r-from":he()}],"mask-image-r-to-pos":[{"mask-r-to":he()}],"mask-image-r-from-color":[{"mask-r-from":W()}],"mask-image-r-to-color":[{"mask-r-to":W()}],"mask-image-b-from-pos":[{"mask-b-from":he()}],"mask-image-b-to-pos":[{"mask-b-to":he()}],"mask-image-b-from-color":[{"mask-b-from":W()}],"mask-image-b-to-color":[{"mask-b-to":W()}],"mask-image-l-from-pos":[{"mask-l-from":he()}],"mask-image-l-to-pos":[{"mask-l-to":he()}],"mask-image-l-from-color":[{"mask-l-from":W()}],"mask-image-l-to-color":[{"mask-l-to":W()}],"mask-image-x-from-pos":[{"mask-x-from":he()}],"mask-image-x-to-pos":[{"mask-x-to":he()}],"mask-image-x-from-color":[{"mask-x-from":W()}],"mask-image-x-to-color":[{"mask-x-to":W()}],"mask-image-y-from-pos":[{"mask-y-from":he()}],"mask-image-y-to-pos":[{"mask-y-to":he()}],"mask-image-y-from-color":[{"mask-y-from":W()}],"mask-image-y-to-color":[{"mask-y-to":W()}],"mask-image-radial":[{"mask-radial":[Ee,we]}],"mask-image-radial-from-pos":[{"mask-radial-from":he()}],"mask-image-radial-to-pos":[{"mask-radial-to":he()}],"mask-image-radial-from-color":[{"mask-radial-from":W()}],"mask-image-radial-to-color":[{"mask-radial-to":W()}],"mask-image-radial-shape":[{"mask-radial":["circle","ellipse"]}],"mask-image-radial-size":[{"mask-radial":[{closest:["side","corner"],farthest:["side","corner"]}]}],"mask-image-radial-pos":[{"mask-radial-at":G()}],"mask-image-conic-pos":[{"mask-conic":[We]}],"mask-image-conic-from-pos":[{"mask-conic-from":he()}],"mask-image-conic-to-pos":[{"mask-conic-to":he()}],"mask-image-conic-from-color":[{"mask-conic-from":W()}],"mask-image-conic-to-color":[{"mask-conic-to":W()}],"mask-mode":[{mask:["alpha","luminance","match"]}],"mask-origin":[{"mask-origin":["border","padding","content","fill","stroke","view"]}],"mask-position":[{mask:J()}],"mask-repeat":[{mask:oe()}],"mask-size":[{mask:B()}],"mask-type":[{"mask-type":["alpha","luminance"]}],"mask-image":[{mask:["none",Ee,we]}],filter:[{filter:["","none",Ee,we]}],blur:[{blur:Fe()}],brightness:[{brightness:[We,Ee,we]}],contrast:[{contrast:[We,Ee,we]}],"drop-shadow":[{"drop-shadow":["","none",T,Zh,Jh]}],"drop-shadow-color":[{"drop-shadow":W()}],grayscale:[{grayscale:["",We,Ee,we]}],"hue-rotate":[{"hue-rotate":[We,Ee,we]}],invert:[{invert:["",We,Ee,we]}],saturate:[{saturate:[We,Ee,we]}],sepia:[{sepia:["",We,Ee,we]}],"backdrop-filter":[{"backdrop-filter":["","none",Ee,we]}],"backdrop-blur":[{"backdrop-blur":Fe()}],"backdrop-brightness":[{"backdrop-brightness":[We,Ee,we]}],"backdrop-contrast":[{"backdrop-contrast":[We,Ee,we]}],"backdrop-grayscale":[{"backdrop-grayscale":["",We,Ee,we]}],"backdrop-hue-rotate":[{"backdrop-hue-rotate":[We,Ee,we]}],"backdrop-invert":[{"backdrop-invert":["",We,Ee,we]}],"backdrop-opacity":[{"backdrop-opacity":[We,Ee,we]}],"backdrop-saturate":[{"backdrop-saturate":[We,Ee,we]}],"backdrop-sepia":[{"backdrop-sepia":["",We,Ee,we]}],"border-collapse":[{border:["collapse","separate"]}],"border-spacing":[{"border-spacing":R()}],"border-spacing-x":[{"border-spacing-x":R()}],"border-spacing-y":[{"border-spacing-y":R()}],"table-layout":[{table:["auto","fixed"]}],caption:[{caption:["top","bottom"]}],transition:[{transition:["","all","colors","opacity","shadow","transform","none",Ee,we]}],"transition-behavior":[{transition:["normal","discrete"]}],duration:[{duration:[We,"initial",Ee,we]}],ease:[{ease:["linear","initial",j,Ee,we]}],delay:[{delay:[We,Ee,we]}],animate:[{animate:["none",U,Ee,we]}],backface:[{backface:["hidden","visible"]}],perspective:[{perspective:[I,Ee,we]}],"perspective-origin":[{"perspective-origin":X()}],rotate:[{rotate:Ye()}],"rotate-x":[{"rotate-x":Ye()}],"rotate-y":[{"rotate-y":Ye()}],"rotate-z":[{"rotate-z":Ye()}],scale:[{scale:xt()}],"scale-x":[{"scale-x":xt()}],"scale-y":[{"scale-y":xt()}],"scale-z":[{"scale-z":xt()}],"scale-3d":["scale-3d"],skew:[{skew:An()}],"skew-x":[{"skew-x":An()}],"skew-y":[{"skew-y":An()}],transform:[{transform:[Ee,we,"","none","gpu","cpu"]}],"transform-origin":[{origin:X()}],"transform-style":[{transform:["3d","flat"]}],translate:[{translate:kn()}],"translate-x":[{"translate-x":kn()}],"translate-y":[{"translate-y":kn()}],"translate-z":[{"translate-z":kn()}],"translate-none":["translate-none"],accent:[{accent:W()}],appearance:[{appearance:["none","auto"]}],"caret-color":[{caret:W()}],"color-scheme":[{scheme:["normal","dark","light","light-dark","only-dark","only-light"]}],cursor:[{cursor:["auto","default","pointer","wait","text","move","help","not-allowed","none","context-menu","progress","cell","crosshair","vertical-text","alias","copy","no-drop","grab","grabbing","all-scroll","col-resize","row-resize","n-resize","e-resize","s-resize","w-resize","ne-resize","nw-resize","se-resize","sw-resize","ew-resize","ns-resize","nesw-resize","nwse-resize","zoom-in","zoom-out",Ee,we]}],"field-sizing":[{"field-sizing":["fixed","content"]}],"pointer-events":[{"pointer-events":["auto","none"]}],resize:[{resize:["none","","y","x"]}],"scroll-behavior":[{scroll:["auto","smooth"]}],"scroll-m":[{"scroll-m":R()}],"scroll-mx":[{"scroll-mx":R()}],"scroll-my":[{"scroll-my":R()}],"scroll-ms":[{"scroll-ms":R()}],"scroll-me":[{"scroll-me":R()}],"scroll-mt":[{"scroll-mt":R()}],"scroll-mr":[{"scroll-mr":R()}],"scroll-mb":[{"scroll-mb":R()}],"scroll-ml":[{"scroll-ml":R()}],"scroll-p":[{"scroll-p":R()}],"scroll-px":[{"scroll-px":R()}],"scroll-py":[{"scroll-py":R()}],"scroll-ps":[{"scroll-ps":R()}],"scroll-pe":[{"scroll-pe":R()}],"scroll-pt":[{"scroll-pt":R()}],"scroll-pr":[{"scroll-pr":R()}],"scroll-pb":[{"scroll-pb":R()}],"scroll-pl":[{"scroll-pl":R()}],"snap-align":[{snap:["start","end","center","align-none"]}],"snap-stop":[{snap:["normal","always"]}],"snap-type":[{snap:["none","x","y","both"]}],"snap-strictness":[{snap:["mandatory","proximity"]}],touch:[{touch:["auto","none","manipulation"]}],"touch-x":[{"touch-pan":["x","left","right"]}],"touch-y":[{"touch-pan":["y","up","down"]}],"touch-pz":["touch-pinch-zoom"],select:[{select:["none","text","all","auto"]}],"will-change":[{"will-change":["auto","scroll","contents","transform",Ee,we]}],fill:[{fill:["none",...W()]}],"stroke-w":[{stroke:[We,fu,Jo,yy]}],stroke:[{stroke:["none",...W()]}],"forced-color-adjust":[{"forced-color-adjust":["auto","none"]}]},conflictingClassGroups:{overflow:["overflow-x","overflow-y"],overscroll:["overscroll-x","overscroll-y"],inset:["inset-x","inset-y","start","end","top","right","bottom","left"],"inset-x":["right","left"],"inset-y":["top","bottom"],flex:["basis","grow","shrink"],gap:["gap-x","gap-y"],p:["px","py","ps","pe","pt","pr","pb","pl"],px:["pr","pl"],py:["pt","pb"],m:["mx","my","ms","me","mt","mr","mb","ml"],mx:["mr","ml"],my:["mt","mb"],size:["w","h"],"font-size":["leading"],"fvn-normal":["fvn-ordinal","fvn-slashed-zero","fvn-figure","fvn-spacing","fvn-fraction"],"fvn-ordinal":["fvn-normal"],"fvn-slashed-zero":["fvn-normal"],"fvn-figure":["fvn-normal"],"fvn-spacing":["fvn-normal"],"fvn-fraction":["fvn-normal"],"line-clamp":["display","overflow"],rounded:["rounded-s","rounded-e","rounded-t","rounded-r","rounded-b","rounded-l","rounded-ss","rounded-se","rounded-ee","rounded-es","rounded-tl","rounded-tr","rounded-br","rounded-bl"],"rounded-s":["rounded-ss","rounded-es"],"rounded-e":["rounded-se","rounded-ee"],"rounded-t":["rounded-tl","rounded-tr"],"rounded-r":["rounded-tr","rounded-br"],"rounded-b":["rounded-br","rounded-bl"],"rounded-l":["rounded-tl","rounded-bl"],"border-spacing":["border-spacing-x","border-spacing-y"],"border-w":["border-w-x","border-w-y","border-w-s","border-w-e","border-w-t","border-w-r","border-w-b","border-w-l"],"border-w-x":["border-w-r","border-w-l"],"border-w-y":["border-w-t","border-w-b"],"border-color":["border-color-x","border-color-y","border-color-s","border-color-e","border-color-t","border-color-r","border-color-b","border-color-l"],"border-color-x":["border-color-r","border-color-l"],"border-color-y":["border-color-t","border-color-b"],translate:["translate-x","translate-y","translate-none"],"translate-none":["translate","translate-x","translate-y","translate-z"],"scroll-m":["scroll-mx","scroll-my","scroll-ms","scroll-me","scroll-mt","scroll-mr","scroll-mb","scroll-ml"],"scroll-mx":["scroll-mr","scroll-ml"],"scroll-my":["scroll-mt","scroll-mb"],"scroll-p":["scroll-px","scroll-py","scroll-ps","scroll-pe","scroll-pt","scroll-pr","scroll-pb","scroll-pl"],"scroll-px":["scroll-pr","scroll-pl"],"scroll-py":["scroll-pt","scroll-pb"],touch:["touch-x","touch-y","touch-pz"],"touch-x":["touch"],"touch-y":["touch"],"touch-pz":["touch"]},conflictingClassGroupModifiers:{"font-size":["leading"]},orderSensitiveModifiers:["*","**","after","backdrop","before","details-content","file","first-letter","first-line","marker","placeholder","selection"]}},g9=Y5(m9);function Lt(...n){return g9(zA(n))}const y9=BA("inline-flex items-center justify-center gap-2 whitespace-nowrap rounded-md text-sm font-medium transition-all disabled:pointer-events-none disabled:opacity-50 [&_svg]:pointer-events-none [&_svg:not([class*='size-'])]:size-4 shrink-0 [&_svg]:shrink-0 outline-none focus-visible:border-ring focus-visible:ring-ring/50 focus-visible:ring-[3px] aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive",{variants:{variant:{default:"bg-primary text-primary-foreground hover:bg-primary/90",destructive:"bg-destructive text-white hover:bg-destructive/90 focus-visible:ring-destructive/20 dark:focus-visible:ring-destructive/40 dark:bg-destructive/60",outline:"border bg-background text-foreground hover:bg-accent hover:text-accent-foreground dark:bg-input/30 dark:border-input dark:hover:bg-input/50",secondary:"bg-secondary text-secondary-foreground hover:bg-secondary/80",ghost:"hover:bg-accent hover:text-accent-foreground dark:hover:bg-accent/50",link:"text-primary underline-offset-4 hover:underline"},size:{default:"h-9 px-4 py-2 has-[>svg]:px-3",sm:"h-8 rounded-md gap-1.5 px-3 has-[>svg]:px-2.5",lg:"h-10 rounded-md px-6 has-[>svg]:px-4",icon:"size-9 rounded-md"}},defaultVariants:{variant:"default",size:"default"}});function ue({className:n,variant:e,size:t,asChild:r=!1,...s}){const o=r?FA:"button";return m.jsx(o,{"data-slot":"button",className:Lt(y9({variant:e,size:t,className:n})),...s})}const _9=BA("inline-flex items-center justify-center rounded-md border px-2 py-0.5 text-xs font-medium w-fit whitespace-nowrap shrink-0 [&>svg]:size-3 gap-1 [&>svg]:pointer-events-none focus-visible:border-ring focus-visible:ring-ring/50 focus-visible:ring-[3px] aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive transition-[color,box-shadow] overflow-hidden",{variants:{variant:{default:"border-transparent bg-primary text-primary-foreground [a&]:hover:bg-primary/90",secondary:"border-transparent bg-secondary text-secondary-foreground [a&]:hover:bg-secondary/90",destructive:"border-transparent bg-destructive text-white [a&]:hover:bg-destructive/90 focus-visible:ring-destructive/20 dark:focus-visible:ring-destructive/40 dark:bg-destructive/60",outline:"text-foreground [a&]:hover:bg-accent [a&]:hover:text-accent-foreground"}},defaultVariants:{variant:"default"}});function Rw({className:n,variant:e,asChild:t=!1,...r}){const s=t?FA:"span";return m.jsx(s,{"data-slot":"badge",className:Lt(_9({variant:e}),n),...r})}function v9({currentView:n,onViewChange:e,unreadCount:t=0}){return m.jsx("nav",{className:"fixed top-0 left-0 right-0 z-50 bg-black/90 backdrop-blur-sm border-b border-gray-800",dir:"rtl",children:m.jsxs("div",{className:"max-w-4xl mx-auto px-4 py-3 flex items-center justify-between",children:[m.jsxs("div",{className:"flex items-center gap-2",children:[m.jsx("h1",{className:"text-white font-bold text-lg",children:"Dark*Chat"}),m.jsx("span",{className:"text-green-400 text-sm",children:"•"})]}),m.jsxs("div",{className:"flex items-center gap-1",children:[m.jsxs(ue,{variant:"ghost",size:"sm",onClick:()=>e("feed"),className:`p-2 ${n==="feed"?"text-green-400":"text-gray-400 hover:text-white"}`,children:[m.jsx(VA,{className:"w-5 h-5"}),m.jsx("span",{className:"hidden sm:inline mr-2",children:"الرئيسية"})]}),m.jsxs(ue,{variant:"ghost",size:"sm",onClick:()=>e("messages"),className:`p-2 relative ${n==="messages"?"text-green-400":"text-gray-400 hover:text-white"}`,children:[m.jsx(ed,{className:"w-5 h-5"}),m.jsx("span",{className:"hidden sm:inline mr-2",children:"الرسائل"}),t>0&&m.jsx(Rw,{variant:"destructive",className:"absolute -top-1 -right-1 h-5 w-5 text-xs p-0 flex items-center justify-center rounded-full bg-red-500 text-white",children:t>99?"99+":t})]}),m.jsxs(ue,{variant:"ghost",size:"sm",onClick:()=>e("likes"),className:`p-2 ${n==="likes"?"text-green-400":"text-gray-400 hover:text-white"}`,children:[m.jsx(Ql,{className:"w-5 h-5"}),m.jsx("span",{className:"hidden sm:inline mr-2",children:"الإعجابات"})]}),m.jsxs(ue,{variant:"ghost",size:"sm",onClick:()=>e("profile"),className:`p-2 ${n==="profile"?"text-green-400":"text-gray-400 hover:text-white"}`,children:[m.jsx(b5,{className:"w-5 h-5"}),m.jsx("span",{className:"hidden sm:inline mr-2",children:"الملف الشخصي"})]})]})]})})}function w9(n,e){const t=C.createContext(e),r=o=>{const{children:l,...u}=o,h=C.useMemo(()=>u,Object.values(u));return m.jsx(t.Provider,{value:h,children:l})};r.displayName=n+"Provider";function s(o){const l=C.useContext(t);if(l)return l;if(e!==void 0)return e;throw new Error(`\`${o}\` must be used within \`${n}\``)}return[r,s]}function ci(n,e=[]){let t=[];function r(o,l){const u=C.createContext(l),h=t.length;t=[...t,l];const p=_=>{const{scope:v,children:T,...A}=_,I=v?.[n]?.[h]||u,b=C.useMemo(()=>A,Object.values(A));return m.jsx(I.Provider,{value:b,children:T})};p.displayName=o+"Provider";function g(_,v){const T=v?.[n]?.[h]||u,A=C.useContext(T);if(A)return A;if(l!==void 0)return l;throw new Error(`\`${_}\` must be used within \`${o}\``)}return[p,g]}const s=()=>{const o=t.map(l=>C.createContext(l));return function(u){const h=u?.[n]||o;return C.useMemo(()=>({[`__scope${n}`]:{...u,[n]:h}}),[u,h])}};return s.scopeName=n,[r,E9(s,...e)]}function E9(...n){const e=n[0];if(n.length===1)return e;const t=()=>{const r=n.map(s=>({useScope:s(),scopeName:s.scopeName}));return function(o){const l=r.reduce((u,{useScope:h,scopeName:p})=>{const _=h(o)[`__scope${p}`];return{...u,..._}},{});return C.useMemo(()=>({[`__scope${e.scopeName}`]:l}),[l])}};return t.scopeName=e.scopeName,t}function un(n){const e=C.useRef(n);return C.useEffect(()=>{e.current=n}),C.useMemo(()=>(...t)=>e.current?.(...t),[])}var _r=globalThis?.document?C.useLayoutEffect:()=>{},Aw=PS();const x9=NS(Aw);var T9=["a","button","div","form","h2","h3","img","input","label","li","nav","ol","p","select","span","svg","ul"],st=T9.reduce((n,e)=>{const t=Yl(`Primitive.${e}`),r=C.forwardRef((s,o)=>{const{asChild:l,...u}=s,h=l?t:e;return typeof window<"u"&&(window[Symbol.for("radix-ui")]=!0),m.jsx(h,{...u,ref:o})});return r.displayName=`Primitive.${e}`,{...n,[e]:r}},{});function ZA(n,e){n&&Aw.flushSync(()=>n.dispatchEvent(e))}var _y={exports:{}},vy={};/**
 * @license React
 * use-sync-external-store-shim.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var nS;function C9(){if(nS)return vy;nS=1;var n=gp();function e(_,v){return _===v&&(_!==0||1/_===1/v)||_!==_&&v!==v}var t=typeof Object.is=="function"?Object.is:e,r=n.useState,s=n.useEffect,o=n.useLayoutEffect,l=n.useDebugValue;function u(_,v){var T=v(),A=r({inst:{value:T,getSnapshot:v}}),I=A[0].inst,b=A[1];return o(function(){I.value=T,I.getSnapshot=v,h(I)&&b({inst:I})},[_,T,v]),s(function(){return h(I)&&b({inst:I}),_(function(){h(I)&&b({inst:I})})},[_]),l(T),T}function h(_){var v=_.getSnapshot;_=_.value;try{var T=v();return!t(_,T)}catch{return!0}}function p(_,v){return v()}var g=typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"?p:u;return vy.useSyncExternalStore=n.useSyncExternalStore!==void 0?n.useSyncExternalStore:g,vy}var rS;function S9(){return rS||(rS=1,_y.exports=C9()),_y.exports}var I9=S9();function b9(){return I9.useSyncExternalStore(R9,()=>!0,()=>!1)}function R9(){return()=>{}}var kw="Avatar",[A9]=ci(kw),[k9,ek]=A9(kw),tk=C.forwardRef((n,e)=>{const{__scopeAvatar:t,...r}=n,[s,o]=C.useState("idle");return m.jsx(k9,{scope:t,imageLoadingStatus:s,onImageLoadingStatusChange:o,children:m.jsx(st.span,{...r,ref:e})})});tk.displayName=kw;var nk="AvatarImage",rk=C.forwardRef((n,e)=>{const{__scopeAvatar:t,src:r,onLoadingStatusChange:s=()=>{},...o}=n,l=ek(nk,t),u=N9(r,o),h=un(p=>{s(p),l.onImageLoadingStatusChange(p)});return _r(()=>{u!=="idle"&&h(u)},[u,h]),u==="loaded"?m.jsx(st.img,{...o,ref:e,src:r}):null});rk.displayName=nk;var sk="AvatarFallback",ik=C.forwardRef((n,e)=>{const{__scopeAvatar:t,delayMs:r,...s}=n,o=ek(sk,t),[l,u]=C.useState(r===void 0);return C.useEffect(()=>{if(r!==void 0){const h=window.setTimeout(()=>u(!0),r);return()=>window.clearTimeout(h)}},[r]),l&&o.imageLoadingStatus!=="loaded"?m.jsx(st.span,{...s,ref:e}):null});ik.displayName=sk;function sS(n,e){return n?e?(n.src!==e&&(n.src=e),n.complete&&n.naturalWidth>0?"loaded":"loading"):"error":"idle"}function N9(n,{referrerPolicy:e,crossOrigin:t}){const r=b9(),s=C.useRef(null),o=r?(s.current||(s.current=new window.Image),s.current):null,[l,u]=C.useState(()=>sS(o,n));return _r(()=>{u(sS(o,n))},[o,n]),_r(()=>{const h=_=>()=>{u(_)};if(!o)return;const p=h("loaded"),g=h("error");return o.addEventListener("load",p),o.addEventListener("error",g),e&&(o.referrerPolicy=e),typeof t=="string"&&(o.crossOrigin=t),()=>{o.removeEventListener("load",p),o.removeEventListener("error",g)}},[o,t,e]),l}var P9=tk,D9=rk,O9=ik;function nr({className:n,...e}){return m.jsx(P9,{"data-slot":"avatar",className:Lt("relative flex size-10 shrink-0 overflow-hidden rounded-full",n),...e})}function rr({className:n,...e}){return m.jsx(D9,{"data-slot":"avatar-image",className:Lt("aspect-square size-full",n),...e})}function sr({className:n,...e}){return m.jsx(O9,{"data-slot":"avatar-fallback",className:Lt("bg-muted flex size-full items-center justify-center rounded-full",n),...e})}function M9({currentUser:n,onStoryClick:e,onAddStory:t}){const[r,s]=C.useState([]);C.useEffect(()=>{(async()=>{try{const u=await E_(),h=await Promise.all(u.map(async p=>{const g=await _f(p.userId);return{...p,username:g?.username||"Unknown",displayName:g?.displayName||"Unknown User",avatar:g?.avatar||"/api/placeholder/64/64"}}));s(h)}catch(u){console.error("Failed to fetch stories:",u)}})()},[]);const o=l=>l.isViewed||l.isViewed?"ring-gray-500":"ring-gradient-to-r from-green-500 to-black";return m.jsxs("div",{className:"flex gap-4 p-4 overflow-x-auto scrollbar-hide bg-gray-900/50",children:[m.jsxs("div",{className:"flex flex-col items-center gap-2 min-w-[70px]",children:[m.jsxs("div",{className:"relative",children:[m.jsxs(nr,{className:"w-16 h-16 ring-2 ring-green-500",children:[m.jsx(rr,{src:n?.avatar}),m.jsx(sr,{className:"bg-gray-700 text-white",children:n?.displayName?.charAt(0)||"Y"})]}),m.jsx("div",{className:"absolute -bottom-1 -right-1 w-6 h-6 bg-green-500 rounded-full flex items-center justify-center border-2 border-gray-900 cursor-pointer hover:bg-green-600 transition-colors",onClick:t,children:m.jsx(ip,{className:"w-3 h-3 text-white"})})]}),m.jsx("span",{className:"text-xs text-gray-300 text-center",children:"Your Story"})]}),r.map(l=>m.jsxs("div",{className:"flex flex-col items-center gap-2 min-w-[70px] cursor-pointer",onClick:()=>e(l),children:[m.jsx("div",{className:"relative",children:m.jsxs(nr,{className:`w-16 h-16 ring-2 ${o(l)}`,children:[m.jsx(rr,{src:l.avatar}),m.jsx(sr,{className:"bg-gray-700 text-white",children:l.displayName.charAt(0)})]})}),m.jsx("span",{className:"text-xs text-gray-300 text-center truncate w-full",children:l.displayName})]},l.userId))]})}function Pr({className:n,...e}){return m.jsx("div",{"data-slot":"card",className:Lt("bg-card text-card-foreground flex flex-col gap-6 rounded-xl border",n),...e})}function L9({posts:n,stories:e,currentUser:t,onLike:r,onReply:s,onShare:o,onStoryClick:l,onUserClick:u,onAddStory:h,onCreatePost:p,currentUserId:g}){const _=v=>{if(!v)return"الآن";if(typeof v=="object"&&v.seconds){const T=new Date(v.seconds*1e3),I=Math.floor((new Date().getTime()-T.getTime())/(1e3*60));return I<1?"الآن":I<60?`${I}د`:I<1440?`${Math.floor(I/60)}س`:`${Math.floor(I/1440)}ي`}return v};return m.jsxs("div",{className:"min-h-screen bg-gradient-to-b from-gray-900 to-black",dir:"rtl",children:[m.jsx("div",{className:"bg-gray-900/80 backdrop-blur-sm sticky top-16 z-40",children:m.jsx(M9,{currentUser:t,onStoryClick:l,onAddStory:h})}),m.jsx("div",{className:"fixed bottom-6 left-6 z-50",children:m.jsx(ue,{onClick:p,className:"w-14 h-14 rounded-full bg-green-600 hover:bg-green-700 text-white shadow-lg hover:shadow-xl transition-all duration-200 flex items-center justify-center",children:m.jsx(ip,{className:"w-6 h-6"})})}),m.jsx("div",{className:"max-w-2xl mx-auto px-4 pb-20 pt-4",children:n.length===0?m.jsxs("div",{className:"text-center py-12",children:[m.jsx("div",{className:"w-16 h-16 bg-gray-700 rounded-full flex items-center justify-center mx-auto mb-4",children:m.jsx(ed,{className:"w-8 h-8 text-gray-400"})}),m.jsx("p",{className:"text-gray-400 text-lg mb-2",children:"لا توجد منشورات بعد"}),m.jsx("p",{className:"text-gray-500 text-sm mb-4",children:"كن أول من يشارك شيئاً!"}),m.jsxs(ue,{onClick:p,className:"bg-green-600 hover:bg-green-700 text-white",children:[m.jsx(ip,{className:"w-4 h-4 ml-2"}),"إنشاء منشور"]})]}):n.map(v=>m.jsx(Pr,{className:"mb-4 bg-gray-800/50 border-gray-700 backdrop-blur-sm",children:m.jsxs("div",{className:"p-4",children:[m.jsxs("div",{className:"flex items-center justify-between mb-3",children:[m.jsxs("div",{className:"flex items-center gap-3",children:[m.jsxs("div",{className:"relative",children:[m.jsxs(nr,{className:"w-10 h-10 cursor-pointer",onClick:()=>u(v.userId),children:[m.jsx(rr,{src:v.avatar}),m.jsx(sr,{className:"bg-gray-700 text-white",children:v.displayName.charAt(0)})]}),m.jsx("div",{className:`absolute -bottom-1 -left-1 w-3 h-3 rounded-full border-2 border-gray-800 ${v.isOnline?"bg-green-500":"bg-gray-500"}`})]}),m.jsxs("div",{children:[m.jsx("p",{className:"text-white font-medium cursor-pointer hover:text-green-400 transition-colors",onClick:()=>u(v.userId),children:v.displayName}),m.jsxs("p",{className:"text-gray-400 text-sm cursor-pointer hover:text-green-400 transition-colors",onClick:()=>u(v.userId),children:["@",v.username]})]})]}),m.jsxs("div",{className:"flex items-center gap-2",children:[m.jsx("span",{className:"text-gray-500 text-sm",children:_(v.timestamp)}),m.jsx(ue,{variant:"ghost",size:"sm",className:"text-gray-400 hover:text-white",children:m.jsx(Cw,{className:"w-4 h-4"})})]})]}),m.jsx("p",{className:"text-gray-100 mb-4 leading-relaxed",children:v.content}),m.jsxs("div",{className:"flex items-center justify-between pt-2 border-t border-gray-700",children:[m.jsxs(ue,{variant:"ghost",size:"sm",onClick:()=>r(v.id),className:`flex items-center gap-2 ${v.likedBy&&g&&v.likedBy[g]||v.isLiked?"text-red-500 hover:text-red-400":"text-gray-400 hover:text-red-500"}`,children:[m.jsx(Ql,{className:`w-4 h-4 ${v.likedBy&&g&&v.likedBy[g]||v.isLiked?"fill-current":""}`}),m.jsx("span",{children:v.likes||0})]}),m.jsxs(ue,{variant:"ghost",size:"sm",onClick:()=>s(v.id),className:"flex items-center gap-2 text-gray-400 hover:text-blue-400",children:[m.jsx(ed,{className:"w-4 h-4"}),m.jsx("span",{children:v.replies||0})]}),m.jsxs(ue,{variant:"ghost",size:"sm",onClick:()=>o(v.id),className:"flex items-center gap-2 text-gray-400 hover:text-green-400",children:[m.jsx(Sw,{className:"w-4 h-4"}),m.jsx("span",{children:"مشاركة"})]})]})]})},v.id))})]})}function ln({className:n,type:e,...t}){return m.jsx("input",{type:e,"data-slot":"input",className:Lt("file:text-foreground placeholder:text-muted-foreground selection:bg-primary selection:text-primary-foreground dark:bg-input/30 border-input flex h-9 w-full min-w-0 rounded-md border px-3 py-1 text-base bg-input-background transition-[color,box-shadow] outline-none file:inline-flex file:h-7 file:border-0 file:bg-transparent file:text-sm file:font-medium disabled:pointer-events-none disabled:cursor-not-allowed disabled:opacity-50 md:text-sm","focus-visible:border-ring focus-visible:ring-ring/50 focus-visible:ring-[3px]","aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive",n),...t})}function j9({conversations:n,onStartChat:e,onDeleteChat:t,onConversationClick:r,onSearchUsers:s}){const[o,l]=C.useState(""),u=n.filter(h=>h.displayName.toLowerCase().includes(o.toLowerCase())||h.username.toLowerCase().includes(o.toLowerCase())||h.lastMessage.toLowerCase().includes(o.toLowerCase()));return m.jsx("div",{className:"min-h-screen bg-gradient-to-b from-gray-900 to-black pt-16",children:m.jsxs("div",{className:"max-w-md mx-auto",children:[m.jsxs("div",{className:"px-4 py-4 border-b border-gray-800",children:[m.jsxs("div",{className:"flex items-center justify-between mb-4",children:[m.jsx("h2",{className:"text-xl text-white font-bold",children:"Messages"}),m.jsxs("div",{className:"flex items-center gap-2",children:[m.jsx(ue,{variant:"ghost",size:"sm",onClick:()=>s&&s(),className:"text-gray-400 hover:text-green-400",children:m.jsx(op,{className:"w-5 h-5"})}),m.jsx(ue,{variant:"ghost",size:"sm",className:"text-green-400 hover:text-green-300",children:m.jsx(jA,{className:"w-5 h-5"})})]})]}),m.jsxs("div",{className:"relative",children:[m.jsx(op,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 w-4 h-4 text-gray-400"}),m.jsx(ln,{value:o,onChange:h=>l(h.target.value),placeholder:"Search messages...",className:"pl-10 bg-gray-800 border-gray-700 text-white placeholder-gray-400"})]})]}),m.jsx("div",{className:"px-4 py-2",children:u.length===0&&o?m.jsxs("div",{className:"text-center py-8",children:[m.jsx("p",{className:"text-gray-400",children:"لا توجد نتائج"}),m.jsxs("p",{className:"text-gray-500 text-sm mt-1",children:['No results found for "',o,'"']})]}):u.map(h=>m.jsx(Pr,{className:"mb-2 bg-gray-800/30 border-gray-700 hover:bg-gray-800/50 transition-colors cursor-pointer",onClick:()=>r(h),children:m.jsx("div",{className:"p-4",children:m.jsxs("div",{className:"flex items-center gap-3",children:[m.jsxs("div",{className:"relative",children:[m.jsxs(nr,{className:"w-12 h-12",children:[m.jsx(rr,{src:h.avatar}),m.jsx(sr,{className:"bg-gray-700 text-white",children:h.displayName.charAt(0)})]}),m.jsx("div",{className:`absolute -bottom-1 -right-1 w-4 h-4 rounded-full border-2 border-gray-800 ${h.isOnline?"bg-green-500":"bg-gray-500"}`})]}),m.jsxs("div",{className:"flex-1 min-w-0",children:[m.jsxs("div",{className:"flex items-center justify-between mb-1",children:[m.jsx("p",{className:"text-white font-medium truncate",children:h.displayName}),m.jsxs("div",{className:"flex items-center gap-2",children:[m.jsx("span",{className:"text-gray-400 text-sm",children:h.timestamp}),h.unreadCount>0&&m.jsx("div",{className:"w-5 h-5 bg-green-500 rounded-full flex items-center justify-center",children:m.jsx("span",{className:"text-xs text-white font-medium",children:h.unreadCount})})]})]}),m.jsxs("div",{className:"flex items-center justify-between",children:[m.jsx("p",{className:"text-gray-400 text-sm truncate flex-1",children:h.lastMessage}),m.jsxs("div",{className:"flex items-center gap-1 ml-2",children:[m.jsx(ue,{variant:"ghost",size:"sm",onClick:p=>{p.stopPropagation(),e&&e(h.id)},className:"text-gray-400 hover:text-green-400 p-1",children:m.jsx(OA,{className:"w-4 h-4"})}),m.jsx(ue,{variant:"ghost",size:"sm",onClick:p=>{p.stopPropagation(),t&&t(h.id)},className:"text-gray-400 hover:text-red-400 p-1",children:m.jsx(Y6,{className:"w-4 h-4"})})]})]}),!h.isOnline&&h.lastSeen&&m.jsx("p",{className:"text-gray-500 text-xs mt-1",children:h.lastSeen})]})]})})},h.id))})]})})}function V9({profile:n,isOwnProfile:e=!0,onEditProfile:t,onShareProfile:r,onFollow:s}){const[o,l]=C.useState(!1);return C.useEffect(()=>{if(!n.id)return;const u=y_(w_,"/status/"+n.id),h=NA(u,p=>{const g=p.val();l(g?.state==="online")});return()=>h()},[n.id]),m.jsx("div",{className:"min-h-screen bg-gradient-to-b from-gray-900 to-black pt-16",children:m.jsxs("div",{className:"max-w-md mx-auto px-4 py-6",children:[m.jsx(Pr,{className:"bg-gray-800/50 border-gray-700 backdrop-blur-sm mb-6",children:m.jsxs("div",{className:"p-6",children:[m.jsxs("div",{className:"flex items-start justify-between mb-4",children:[m.jsxs("div",{className:"relative",children:[m.jsxs(nr,{className:"w-20 h-20 ring-2 ring-green-500",children:[m.jsx(rr,{src:n.avatar}),m.jsx(sr,{className:"bg-gray-700 text-white text-xl",children:n.displayName.charAt(0)})]}),m.jsx("div",{className:`absolute -bottom-2 -right-2 w-5 h-5 rounded-full border-2 border-gray-800 ${o?"bg-green-500":"bg-gray-500"}`})]}),m.jsx("div",{className:"flex gap-2",children:e?m.jsxs(m.Fragment,{children:[m.jsxs(ue,{variant:"outline",size:"sm",onClick:t,className:"border-gray-600 text-gray-300 hover:bg-gray-700",children:[m.jsx(jA,{className:"w-4 h-4 mr-1"}),"Edit"]}),m.jsx(ue,{variant:"outline",size:"sm",onClick:r,className:"border-gray-600 text-gray-300 hover:bg-gray-700",children:m.jsx(Sw,{className:"w-4 h-4"})})]}):m.jsxs(ue,{onClick:s,className:"bg-green-500 hover:bg-green-600 text-white",children:[m.jsx(Iw,{className:"w-4 h-4 mr-1"}),"Follow"]})})]}),m.jsxs("div",{className:"space-y-2",children:[m.jsxs("div",{children:[m.jsx("h1",{className:"text-xl text-white font-bold",children:n.displayName}),m.jsxs("p",{className:"text-gray-400",children:["@",n.username]})]}),n.bio&&m.jsx("p",{className:"text-gray-300 leading-relaxed",children:n.bio}),m.jsxs("div",{className:"flex items-center gap-2",children:[m.jsx(Rw,{variant:"secondary",className:"bg-gray-700 text-gray-300",children:o?"✅ Online":"⚫ Offline"}),m.jsxs("span",{className:"text-gray-500 text-sm",children:["Joined ",n.joinDate]})]})]})]})}),m.jsx(Pr,{className:"bg-gray-800/50 border-gray-700 backdrop-blur-sm mb-6",children:m.jsx("div",{className:"p-4",children:m.jsxs("div",{className:"grid grid-cols-3 gap-4 text-center",children:[m.jsxs("div",{className:"space-y-1",children:[m.jsx("p",{className:"text-xl text-white font-bold",children:n.postsCount}),m.jsx("p",{className:"text-gray-400 text-sm",children:"Posts"})]}),m.jsxs("div",{className:"space-y-1",children:[m.jsx("p",{className:"text-xl text-white font-bold",children:n.followersCount}),m.jsx("p",{className:"text-gray-400 text-sm",children:"Followers"})]}),m.jsxs("div",{className:"space-y-1",children:[m.jsx("p",{className:"text-xl text-white font-bold",children:n.followingCount}),m.jsx("p",{className:"text-gray-400 text-sm",children:"Following"})]})]})})}),e&&m.jsx(Pr,{className:"bg-gray-800/50 border-gray-700 backdrop-blur-sm",children:m.jsxs("div",{className:"p-4 space-y-3",children:[m.jsxs(ue,{variant:"ghost",className:"w-full justify-start text-gray-300 hover:bg-gray-700",children:[m.jsx(y5,{className:"w-4 h-4 mr-3"}),"Account Settings"]}),m.jsxs(ue,{variant:"ghost",className:"w-full justify-start text-gray-300 hover:bg-gray-700",children:[m.jsx(VA,{className:"w-4 h-4 mr-3"}),"Manage Followers"]}),m.jsxs(ue,{variant:"ghost",className:"w-full justify-start text-gray-300 hover:bg-gray-700",children:[m.jsx(Z6,{className:"w-4 h-4 mr-3"}),"Privacy Policy"]})]})})]})})}function F9({likedPosts:n,onUnlike:e,onReply:t,onShare:r}){return m.jsx("div",{className:"min-h-screen bg-gradient-to-b from-gray-900 to-black pt-16",children:m.jsxs("div",{className:"max-w-md mx-auto px-4 py-6",children:[m.jsxs("div",{className:"mb-6",children:[m.jsx("h2",{className:"text-2xl text-white font-bold mb-2",children:"Liked Posts"}),m.jsx("p",{className:"text-gray-400",children:"Posts you've liked recently"})]}),n.length===0?m.jsx(Pr,{className:"bg-gray-800/50 border-gray-700 backdrop-blur-sm",children:m.jsxs("div",{className:"p-8 text-center",children:[m.jsx(Ql,{className:"w-12 h-12 text-gray-500 mx-auto mb-4"}),m.jsx("h3",{className:"text-lg text-gray-300 mb-2",children:"No liked posts yet"}),m.jsx("p",{className:"text-gray-500",children:"Start exploring and like posts that interest you!"})]})}):m.jsx("div",{className:"space-y-4",children:n.map(s=>m.jsx(Pr,{className:"bg-gray-800/50 border-gray-700 backdrop-blur-sm",children:m.jsxs("div",{className:"p-4",children:[m.jsxs("div",{className:"flex items-center justify-between mb-3",children:[m.jsxs("div",{className:"flex items-center gap-3",children:[m.jsxs("div",{className:"relative",children:[m.jsxs(nr,{className:"w-10 h-10",children:[m.jsx(rr,{src:s.avatar}),m.jsx(sr,{className:"bg-gray-700 text-white",children:s.displayName.charAt(0)})]}),m.jsx("div",{className:`absolute -bottom-1 -right-1 w-3 h-3 rounded-full border-2 border-gray-800 ${s.isOnline?"bg-green-500":"bg-gray-500"}`})]}),m.jsxs("div",{children:[m.jsx("p",{className:"text-white font-medium",children:s.displayName}),m.jsxs("p",{className:"text-gray-400 text-sm",children:["@",s.username]})]})]}),m.jsxs("div",{className:"text-right",children:[m.jsx("p",{className:"text-gray-500 text-sm",children:s.timestamp}),m.jsxs("div",{className:"flex items-center gap-1 text-xs text-gray-500 mt-1",children:[m.jsx(q6,{className:"w-3 h-3"}),m.jsxs("span",{children:["Liked ",s.likedAt]})]})]})]}),m.jsx("p",{className:"text-gray-100 mb-4 leading-relaxed",children:s.content}),m.jsxs("div",{className:"flex items-center justify-between pt-2 border-t border-gray-700",children:[m.jsxs(ue,{variant:"ghost",size:"sm",onClick:()=>e(s.id),className:"flex items-center gap-2 text-red-500 hover:text-red-400",children:[m.jsx(Ql,{className:"w-4 h-4 fill-current"}),m.jsx("span",{children:s.likes})]}),m.jsxs(ue,{variant:"ghost",size:"sm",onClick:()=>t(s.id),className:"flex items-center gap-2 text-gray-400 hover:text-blue-400",children:[m.jsx(ed,{className:"w-4 h-4"}),m.jsx("span",{children:s.replies})]}),m.jsxs(ue,{variant:"ghost",size:"sm",onClick:()=>r(s.id),className:"flex items-center gap-2 text-gray-400 hover:text-green-400",children:[m.jsx(Sw,{className:"w-4 h-4"}),m.jsx("span",{children:"Share"})]})]})]})},s.id))})]})})}function Le(n,e,{checkForDefaultPrevented:t=!0}={}){return function(s){if(n?.(s),t===!1||!s.defaultPrevented)return e?.(s)}}var U9=DS[" useId ".trim().toString()]||(()=>{}),z9=0;function Dl(n){const[e,t]=C.useState(U9());return _r(()=>{t(r=>r??String(z9++))},[n]),n||(e?`radix-${e}`:"")}var B9=DS[" useInsertionEffect ".trim().toString()]||_r;function lm({prop:n,defaultProp:e,onChange:t=()=>{},caller:r}){const[s,o,l]=$9({defaultProp:e,onChange:t}),u=n!==void 0,h=u?n:s;{const g=C.useRef(n!==void 0);C.useEffect(()=>{const _=g.current;_!==u&&console.warn(`${r} is changing from ${_?"controlled":"uncontrolled"} to ${u?"controlled":"uncontrolled"}. Components should not switch from controlled to uncontrolled (or vice versa). Decide between using a controlled or uncontrolled value for the lifetime of the component.`),g.current=u},[u,r])}const p=C.useCallback(g=>{if(u){const _=W9(g)?g(n):g;_!==n&&l.current?.(_)}else o(g)},[u,n,o,l]);return[h,p]}function $9({defaultProp:n,onChange:e}){const[t,r]=C.useState(n),s=C.useRef(t),o=C.useRef(e);return B9(()=>{o.current=e},[e]),C.useEffect(()=>{s.current!==t&&(o.current?.(t),s.current=t)},[t,s]),[t,r,o]}function W9(n){return typeof n=="function"}function H9(n,e=globalThis?.document){const t=un(n);C.useEffect(()=>{const r=s=>{s.key==="Escape"&&t(s)};return e.addEventListener("keydown",r,{capture:!0}),()=>e.removeEventListener("keydown",r,{capture:!0})},[t,e])}var q9="DismissableLayer",I_="dismissableLayer.update",G9="dismissableLayer.pointerDownOutside",K9="dismissableLayer.focusOutside",iS,ok=C.createContext({layers:new Set,layersWithOutsidePointerEventsDisabled:new Set,branches:new Set}),Nw=C.forwardRef((n,e)=>{const{disableOutsidePointerEvents:t=!1,onEscapeKeyDown:r,onPointerDownOutside:s,onFocusOutside:o,onInteractOutside:l,onDismiss:u,...h}=n,p=C.useContext(ok),[g,_]=C.useState(null),v=g?.ownerDocument??globalThis?.document,[,T]=C.useState({}),A=Et(e,P=>_(P)),I=Array.from(p.layers),[b]=[...p.layersWithOutsidePointerEventsDisabled].slice(-1),j=I.indexOf(b),U=g?I.indexOf(g):-1,$=p.layersWithOutsidePointerEventsDisabled.size>0,G=U>=j,X=X9(P=>{const R=P.target,N=[...p.branches].some(L=>L.contains(R));!G||N||(s?.(P),l?.(P),P.defaultPrevented||u?.())},v),ne=J9(P=>{const R=P.target;[...p.branches].some(L=>L.contains(R))||(o?.(P),l?.(P),P.defaultPrevented||u?.())},v);return H9(P=>{U===p.layers.size-1&&(r?.(P),!P.defaultPrevented&&u&&(P.preventDefault(),u()))},v),C.useEffect(()=>{if(g)return t&&(p.layersWithOutsidePointerEventsDisabled.size===0&&(iS=v.body.style.pointerEvents,v.body.style.pointerEvents="none"),p.layersWithOutsidePointerEventsDisabled.add(g)),p.layers.add(g),oS(),()=>{t&&p.layersWithOutsidePointerEventsDisabled.size===1&&(v.body.style.pointerEvents=iS)}},[g,v,t,p]),C.useEffect(()=>()=>{g&&(p.layers.delete(g),p.layersWithOutsidePointerEventsDisabled.delete(g),oS())},[g,p]),C.useEffect(()=>{const P=()=>T({});return document.addEventListener(I_,P),()=>document.removeEventListener(I_,P)},[]),m.jsx(st.div,{...h,ref:A,style:{pointerEvents:$?G?"auto":"none":void 0,...n.style},onFocusCapture:Le(n.onFocusCapture,ne.onFocusCapture),onBlurCapture:Le(n.onBlurCapture,ne.onBlurCapture),onPointerDownCapture:Le(n.onPointerDownCapture,X.onPointerDownCapture)})});Nw.displayName=q9;var Q9="DismissableLayerBranch",Y9=C.forwardRef((n,e)=>{const t=C.useContext(ok),r=C.useRef(null),s=Et(e,r);return C.useEffect(()=>{const o=r.current;if(o)return t.branches.add(o),()=>{t.branches.delete(o)}},[t.branches]),m.jsx(st.div,{...n,ref:s})});Y9.displayName=Q9;function X9(n,e=globalThis?.document){const t=un(n),r=C.useRef(!1),s=C.useRef(()=>{});return C.useEffect(()=>{const o=u=>{if(u.target&&!r.current){let h=function(){ak(G9,t,p,{discrete:!0})};const p={originalEvent:u};u.pointerType==="touch"?(e.removeEventListener("click",s.current),s.current=h,e.addEventListener("click",s.current,{once:!0})):h()}else e.removeEventListener("click",s.current);r.current=!1},l=window.setTimeout(()=>{e.addEventListener("pointerdown",o)},0);return()=>{window.clearTimeout(l),e.removeEventListener("pointerdown",o),e.removeEventListener("click",s.current)}},[e,t]),{onPointerDownCapture:()=>r.current=!0}}function J9(n,e=globalThis?.document){const t=un(n),r=C.useRef(!1);return C.useEffect(()=>{const s=o=>{o.target&&!r.current&&ak(K9,t,{originalEvent:o},{discrete:!1})};return e.addEventListener("focusin",s),()=>e.removeEventListener("focusin",s)},[e,t]),{onFocusCapture:()=>r.current=!0,onBlurCapture:()=>r.current=!1}}function oS(){const n=new CustomEvent(I_);document.dispatchEvent(n)}function ak(n,e,t,{discrete:r}){const s=t.originalEvent.target,o=new CustomEvent(n,{bubbles:!1,cancelable:!0,detail:t});e&&s.addEventListener(n,e,{once:!0}),r?ZA(s,o):s.dispatchEvent(o)}var wy="focusScope.autoFocusOnMount",Ey="focusScope.autoFocusOnUnmount",aS={bubbles:!1,cancelable:!0},Z9="FocusScope",Pw=C.forwardRef((n,e)=>{const{loop:t=!1,trapped:r=!1,onMountAutoFocus:s,onUnmountAutoFocus:o,...l}=n,[u,h]=C.useState(null),p=un(s),g=un(o),_=C.useRef(null),v=Et(e,I=>h(I)),T=C.useRef({paused:!1,pause(){this.paused=!0},resume(){this.paused=!1}}).current;C.useEffect(()=>{if(r){let I=function($){if(T.paused||!u)return;const G=$.target;u.contains(G)?_.current=G:Wi(_.current,{select:!0})},b=function($){if(T.paused||!u)return;const G=$.relatedTarget;G!==null&&(u.contains(G)||Wi(_.current,{select:!0}))},j=function($){if(document.activeElement===document.body)for(const X of $)X.removedNodes.length>0&&Wi(u)};document.addEventListener("focusin",I),document.addEventListener("focusout",b);const U=new MutationObserver(j);return u&&U.observe(u,{childList:!0,subtree:!0}),()=>{document.removeEventListener("focusin",I),document.removeEventListener("focusout",b),U.disconnect()}}},[r,u,T.paused]),C.useEffect(()=>{if(u){cS.add(T);const I=document.activeElement;if(!u.contains(I)){const j=new CustomEvent(wy,aS);u.addEventListener(wy,p),u.dispatchEvent(j),j.defaultPrevented||(ez(iz(lk(u)),{select:!0}),document.activeElement===I&&Wi(u))}return()=>{u.removeEventListener(wy,p),setTimeout(()=>{const j=new CustomEvent(Ey,aS);u.addEventListener(Ey,g),u.dispatchEvent(j),j.defaultPrevented||Wi(I??document.body,{select:!0}),u.removeEventListener(Ey,g),cS.remove(T)},0)}}},[u,p,g,T]);const A=C.useCallback(I=>{if(!t&&!r||T.paused)return;const b=I.key==="Tab"&&!I.altKey&&!I.ctrlKey&&!I.metaKey,j=document.activeElement;if(b&&j){const U=I.currentTarget,[$,G]=tz(U);$&&G?!I.shiftKey&&j===G?(I.preventDefault(),t&&Wi($,{select:!0})):I.shiftKey&&j===$&&(I.preventDefault(),t&&Wi(G,{select:!0})):j===U&&I.preventDefault()}},[t,r,T.paused]);return m.jsx(st.div,{tabIndex:-1,...l,ref:v,onKeyDown:A})});Pw.displayName=Z9;function ez(n,{select:e=!1}={}){const t=document.activeElement;for(const r of n)if(Wi(r,{select:e}),document.activeElement!==t)return}function tz(n){const e=lk(n),t=lS(e,n),r=lS(e.reverse(),n);return[t,r]}function lk(n){const e=[],t=document.createTreeWalker(n,NodeFilter.SHOW_ELEMENT,{acceptNode:r=>{const s=r.tagName==="INPUT"&&r.type==="hidden";return r.disabled||r.hidden||s?NodeFilter.FILTER_SKIP:r.tabIndex>=0?NodeFilter.FILTER_ACCEPT:NodeFilter.FILTER_SKIP}});for(;t.nextNode();)e.push(t.currentNode);return e}function lS(n,e){for(const t of n)if(!nz(t,{upTo:e}))return t}function nz(n,{upTo:e}){if(getComputedStyle(n).visibility==="hidden")return!0;for(;n;){if(e!==void 0&&n===e)return!1;if(getComputedStyle(n).display==="none")return!0;n=n.parentElement}return!1}function rz(n){return n instanceof HTMLInputElement&&"select"in n}function Wi(n,{select:e=!1}={}){if(n&&n.focus){const t=document.activeElement;n.focus({preventScroll:!0}),n!==t&&rz(n)&&e&&n.select()}}var cS=sz();function sz(){let n=[];return{add(e){const t=n[0];e!==t&&t?.pause(),n=uS(n,e),n.unshift(e)},remove(e){n=uS(n,e),n[0]?.resume()}}}function uS(n,e){const t=[...n],r=t.indexOf(e);return r!==-1&&t.splice(r,1),t}function iz(n){return n.filter(e=>e.tagName!=="A")}var oz="Portal",Dw=C.forwardRef((n,e)=>{const{container:t,...r}=n,[s,o]=C.useState(!1);_r(()=>o(!0),[]);const l=t||s&&globalThis?.document?.body;return l?x9.createPortal(m.jsx(st.div,{...r,ref:e}),l):null});Dw.displayName=oz;function az(n,e){return C.useReducer((t,r)=>e[t][r]??t,n)}var ir=n=>{const{present:e,children:t}=n,r=lz(e),s=typeof t=="function"?t({present:r.isPresent}):C.Children.only(t),o=Et(r.ref,cz(s));return typeof t=="function"||r.isPresent?C.cloneElement(s,{ref:o}):null};ir.displayName="Presence";function lz(n){const[e,t]=C.useState(),r=C.useRef(null),s=C.useRef(n),o=C.useRef("none"),l=n?"mounted":"unmounted",[u,h]=az(l,{mounted:{UNMOUNT:"unmounted",ANIMATION_OUT:"unmountSuspended"},unmountSuspended:{MOUNT:"mounted",ANIMATION_END:"unmounted"},unmounted:{MOUNT:"mounted"}});return C.useEffect(()=>{const p=ef(r.current);o.current=u==="mounted"?p:"none"},[u]),_r(()=>{const p=r.current,g=s.current;if(g!==n){const v=o.current,T=ef(p);n?h("MOUNT"):T==="none"||p?.display==="none"?h("UNMOUNT"):h(g&&v!==T?"ANIMATION_OUT":"UNMOUNT"),s.current=n}},[n,h]),_r(()=>{if(e){let p;const g=e.ownerDocument.defaultView??window,_=T=>{const I=ef(r.current).includes(CSS.escape(T.animationName));if(T.target===e&&I&&(h("ANIMATION_END"),!s.current)){const b=e.style.animationFillMode;e.style.animationFillMode="forwards",p=g.setTimeout(()=>{e.style.animationFillMode==="forwards"&&(e.style.animationFillMode=b)})}},v=T=>{T.target===e&&(o.current=ef(r.current))};return e.addEventListener("animationstart",v),e.addEventListener("animationcancel",_),e.addEventListener("animationend",_),()=>{g.clearTimeout(p),e.removeEventListener("animationstart",v),e.removeEventListener("animationcancel",_),e.removeEventListener("animationend",_)}}else h("ANIMATION_END")},[e,h]),{isPresent:["mounted","unmountSuspended"].includes(u),ref:C.useCallback(p=>{r.current=p?getComputedStyle(p):null,t(p)},[])}}function ef(n){return n?.animationName||"none"}function cz(n){let e=Object.getOwnPropertyDescriptor(n.props,"ref")?.get,t=e&&"isReactWarning"in e&&e.isReactWarning;return t?n.ref:(e=Object.getOwnPropertyDescriptor(n,"ref")?.get,t=e&&"isReactWarning"in e&&e.isReactWarning,t?n.props.ref:n.props.ref||n.ref)}var xy=0;function ck(){C.useEffect(()=>{const n=document.querySelectorAll("[data-radix-focus-guard]");return document.body.insertAdjacentElement("afterbegin",n[0]??dS()),document.body.insertAdjacentElement("beforeend",n[1]??dS()),xy++,()=>{xy===1&&document.querySelectorAll("[data-radix-focus-guard]").forEach(e=>e.remove()),xy--}},[])}function dS(){const n=document.createElement("span");return n.setAttribute("data-radix-focus-guard",""),n.tabIndex=0,n.style.outline="none",n.style.opacity="0",n.style.position="fixed",n.style.pointerEvents="none",n}var is=function(){return is=Object.assign||function(e){for(var t,r=1,s=arguments.length;r<s;r++){t=arguments[r];for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o])}return e},is.apply(this,arguments)};function uk(n,e){var t={};for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&e.indexOf(r)<0&&(t[r]=n[r]);if(n!=null&&typeof Object.getOwnPropertySymbols=="function")for(var s=0,r=Object.getOwnPropertySymbols(n);s<r.length;s++)e.indexOf(r[s])<0&&Object.prototype.propertyIsEnumerable.call(n,r[s])&&(t[r[s]]=n[r[s]]);return t}function uz(n,e,t){if(t||arguments.length===2)for(var r=0,s=e.length,o;r<s;r++)(o||!(r in e))&&(o||(o=Array.prototype.slice.call(e,0,r)),o[r]=e[r]);return n.concat(o||Array.prototype.slice.call(e))}var vf="right-scroll-bar-position",wf="width-before-scroll-bar",dz="with-scroll-bars-hidden",hz="--removed-body-scroll-bar-size";function Ty(n,e){return typeof n=="function"?n(e):n&&(n.current=e),n}function fz(n,e){var t=C.useState(function(){return{value:n,callback:e,facade:{get current(){return t.value},set current(r){var s=t.value;s!==r&&(t.value=r,t.callback(r,s))}}}})[0];return t.callback=e,t.facade}var pz=typeof window<"u"?C.useLayoutEffect:C.useEffect,hS=new WeakMap;function mz(n,e){var t=fz(null,function(r){return n.forEach(function(s){return Ty(s,r)})});return pz(function(){var r=hS.get(t);if(r){var s=new Set(r),o=new Set(n),l=t.current;s.forEach(function(u){o.has(u)||Ty(u,null)}),o.forEach(function(u){s.has(u)||Ty(u,l)})}hS.set(t,n)},[n]),t}function gz(n){return n}function yz(n,e){e===void 0&&(e=gz);var t=[],r=!1,s={read:function(){if(r)throw new Error("Sidecar: could not `read` from an `assigned` medium. `read` could be used only with `useMedium`.");return t.length?t[t.length-1]:n},useMedium:function(o){var l=e(o,r);return t.push(l),function(){t=t.filter(function(u){return u!==l})}},assignSyncMedium:function(o){for(r=!0;t.length;){var l=t;t=[],l.forEach(o)}t={push:function(u){return o(u)},filter:function(){return t}}},assignMedium:function(o){r=!0;var l=[];if(t.length){var u=t;t=[],u.forEach(o),l=t}var h=function(){var g=l;l=[],g.forEach(o)},p=function(){return Promise.resolve().then(h)};p(),t={push:function(g){l.push(g),p()},filter:function(g){return l=l.filter(g),t}}}};return s}function _z(n){n===void 0&&(n={});var e=yz(null);return e.options=is({async:!0,ssr:!1},n),e}var dk=function(n){var e=n.sideCar,t=uk(n,["sideCar"]);if(!e)throw new Error("Sidecar: please provide `sideCar` property to import the right car");var r=e.read();if(!r)throw new Error("Sidecar medium not found");return C.createElement(r,is({},t))};dk.isSideCarExport=!0;function vz(n,e){return n.useMedium(e),dk}var hk=_z(),Cy=function(){},cm=C.forwardRef(function(n,e){var t=C.useRef(null),r=C.useState({onScrollCapture:Cy,onWheelCapture:Cy,onTouchMoveCapture:Cy}),s=r[0],o=r[1],l=n.forwardProps,u=n.children,h=n.className,p=n.removeScrollBar,g=n.enabled,_=n.shards,v=n.sideCar,T=n.noRelative,A=n.noIsolation,I=n.inert,b=n.allowPinchZoom,j=n.as,U=j===void 0?"div":j,$=n.gapMode,G=uk(n,["forwardProps","children","className","removeScrollBar","enabled","shards","sideCar","noRelative","noIsolation","inert","allowPinchZoom","as","gapMode"]),X=v,ne=mz([t,e]),P=is(is({},G),s);return C.createElement(C.Fragment,null,g&&C.createElement(X,{sideCar:hk,removeScrollBar:p,shards:_,noRelative:T,noIsolation:A,inert:I,setCallbacks:o,allowPinchZoom:!!b,lockRef:t,gapMode:$}),l?C.cloneElement(C.Children.only(u),is(is({},P),{ref:ne})):C.createElement(U,is({},P,{className:h,ref:ne}),u))});cm.defaultProps={enabled:!0,removeScrollBar:!0,inert:!1};cm.classNames={fullWidth:wf,zeroRight:vf};var wz=function(){if(typeof __webpack_nonce__<"u")return __webpack_nonce__};function Ez(){if(!document)return null;var n=document.createElement("style");n.type="text/css";var e=wz();return e&&n.setAttribute("nonce",e),n}function xz(n,e){n.styleSheet?n.styleSheet.cssText=e:n.appendChild(document.createTextNode(e))}function Tz(n){var e=document.head||document.getElementsByTagName("head")[0];e.appendChild(n)}var Cz=function(){var n=0,e=null;return{add:function(t){n==0&&(e=Ez())&&(xz(e,t),Tz(e)),n++},remove:function(){n--,!n&&e&&(e.parentNode&&e.parentNode.removeChild(e),e=null)}}},Sz=function(){var n=Cz();return function(e,t){C.useEffect(function(){return n.add(e),function(){n.remove()}},[e&&t])}},fk=function(){var n=Sz(),e=function(t){var r=t.styles,s=t.dynamic;return n(r,s),null};return e},Iz={left:0,top:0,right:0,gap:0},Sy=function(n){return parseInt(n||"",10)||0},bz=function(n){var e=window.getComputedStyle(document.body),t=e[n==="padding"?"paddingLeft":"marginLeft"],r=e[n==="padding"?"paddingTop":"marginTop"],s=e[n==="padding"?"paddingRight":"marginRight"];return[Sy(t),Sy(r),Sy(s)]},Rz=function(n){if(n===void 0&&(n="margin"),typeof window>"u")return Iz;var e=bz(n),t=document.documentElement.clientWidth,r=window.innerWidth;return{left:e[0],top:e[1],right:e[2],gap:Math.max(0,r-t+e[2]-e[0])}},Az=fk(),Ol="data-scroll-locked",kz=function(n,e,t,r){var s=n.left,o=n.top,l=n.right,u=n.gap;return t===void 0&&(t="margin"),`
  .`.concat(dz,` {
   overflow: hidden `).concat(r,`;
   padding-right: `).concat(u,"px ").concat(r,`;
  }
  body[`).concat(Ol,`] {
    overflow: hidden `).concat(r,`;
    overscroll-behavior: contain;
    `).concat([e&&"position: relative ".concat(r,";"),t==="margin"&&`
    padding-left: `.concat(s,`px;
    padding-top: `).concat(o,`px;
    padding-right: `).concat(l,`px;
    margin-left:0;
    margin-top:0;
    margin-right: `).concat(u,"px ").concat(r,`;
    `),t==="padding"&&"padding-right: ".concat(u,"px ").concat(r,";")].filter(Boolean).join(""),`
  }
  
  .`).concat(vf,` {
    right: `).concat(u,"px ").concat(r,`;
  }
  
  .`).concat(wf,` {
    margin-right: `).concat(u,"px ").concat(r,`;
  }
  
  .`).concat(vf," .").concat(vf,` {
    right: 0 `).concat(r,`;
  }
  
  .`).concat(wf," .").concat(wf,` {
    margin-right: 0 `).concat(r,`;
  }
  
  body[`).concat(Ol,`] {
    `).concat(hz,": ").concat(u,`px;
  }
`)},fS=function(){var n=parseInt(document.body.getAttribute(Ol)||"0",10);return isFinite(n)?n:0},Nz=function(){C.useEffect(function(){return document.body.setAttribute(Ol,(fS()+1).toString()),function(){var n=fS()-1;n<=0?document.body.removeAttribute(Ol):document.body.setAttribute(Ol,n.toString())}},[])},Pz=function(n){var e=n.noRelative,t=n.noImportant,r=n.gapMode,s=r===void 0?"margin":r;Nz();var o=C.useMemo(function(){return Rz(s)},[s]);return C.createElement(Az,{styles:kz(o,!e,s,t?"":"!important")})},b_=!1;if(typeof window<"u")try{var tf=Object.defineProperty({},"passive",{get:function(){return b_=!0,!0}});window.addEventListener("test",tf,tf),window.removeEventListener("test",tf,tf)}catch{b_=!1}var yl=b_?{passive:!1}:!1,Dz=function(n){return n.tagName==="TEXTAREA"},pk=function(n,e){if(!(n instanceof Element))return!1;var t=window.getComputedStyle(n);return t[e]!=="hidden"&&!(t.overflowY===t.overflowX&&!Dz(n)&&t[e]==="visible")},Oz=function(n){return pk(n,"overflowY")},Mz=function(n){return pk(n,"overflowX")},pS=function(n,e){var t=e.ownerDocument,r=e;do{typeof ShadowRoot<"u"&&r instanceof ShadowRoot&&(r=r.host);var s=mk(n,r);if(s){var o=gk(n,r),l=o[1],u=o[2];if(l>u)return!0}r=r.parentNode}while(r&&r!==t.body);return!1},Lz=function(n){var e=n.scrollTop,t=n.scrollHeight,r=n.clientHeight;return[e,t,r]},jz=function(n){var e=n.scrollLeft,t=n.scrollWidth,r=n.clientWidth;return[e,t,r]},mk=function(n,e){return n==="v"?Oz(e):Mz(e)},gk=function(n,e){return n==="v"?Lz(e):jz(e)},Vz=function(n,e){return n==="h"&&e==="rtl"?-1:1},Fz=function(n,e,t,r,s){var o=Vz(n,window.getComputedStyle(e).direction),l=o*r,u=t.target,h=e.contains(u),p=!1,g=l>0,_=0,v=0;do{if(!u)break;var T=gk(n,u),A=T[0],I=T[1],b=T[2],j=I-b-o*A;(A||j)&&mk(n,u)&&(_+=j,v+=A);var U=u.parentNode;u=U&&U.nodeType===Node.DOCUMENT_FRAGMENT_NODE?U.host:U}while(!h&&u!==document.body||h&&(e.contains(u)||e===u));return(g&&Math.abs(_)<1||!g&&Math.abs(v)<1)&&(p=!0),p},nf=function(n){return"changedTouches"in n?[n.changedTouches[0].clientX,n.changedTouches[0].clientY]:[0,0]},mS=function(n){return[n.deltaX,n.deltaY]},gS=function(n){return n&&"current"in n?n.current:n},Uz=function(n,e){return n[0]===e[0]&&n[1]===e[1]},zz=function(n){return`
  .block-interactivity-`.concat(n,` {pointer-events: none;}
  .allow-interactivity-`).concat(n,` {pointer-events: all;}
`)},Bz=0,_l=[];function $z(n){var e=C.useRef([]),t=C.useRef([0,0]),r=C.useRef(),s=C.useState(Bz++)[0],o=C.useState(fk)[0],l=C.useRef(n);C.useEffect(function(){l.current=n},[n]),C.useEffect(function(){if(n.inert){document.body.classList.add("block-interactivity-".concat(s));var I=uz([n.lockRef.current],(n.shards||[]).map(gS),!0).filter(Boolean);return I.forEach(function(b){return b.classList.add("allow-interactivity-".concat(s))}),function(){document.body.classList.remove("block-interactivity-".concat(s)),I.forEach(function(b){return b.classList.remove("allow-interactivity-".concat(s))})}}},[n.inert,n.lockRef.current,n.shards]);var u=C.useCallback(function(I,b){if("touches"in I&&I.touches.length===2||I.type==="wheel"&&I.ctrlKey)return!l.current.allowPinchZoom;var j=nf(I),U=t.current,$="deltaX"in I?I.deltaX:U[0]-j[0],G="deltaY"in I?I.deltaY:U[1]-j[1],X,ne=I.target,P=Math.abs($)>Math.abs(G)?"h":"v";if("touches"in I&&P==="h"&&ne.type==="range")return!1;var R=pS(P,ne);if(!R)return!0;if(R?X=P:(X=P==="v"?"h":"v",R=pS(P,ne)),!R)return!1;if(!r.current&&"changedTouches"in I&&($||G)&&(r.current=X),!X)return!0;var N=r.current||X;return Fz(N,b,I,N==="h"?$:G)},[]),h=C.useCallback(function(I){var b=I;if(!(!_l.length||_l[_l.length-1]!==o)){var j="deltaY"in b?mS(b):nf(b),U=e.current.filter(function(X){return X.name===b.type&&(X.target===b.target||b.target===X.shadowParent)&&Uz(X.delta,j)})[0];if(U&&U.should){b.cancelable&&b.preventDefault();return}if(!U){var $=(l.current.shards||[]).map(gS).filter(Boolean).filter(function(X){return X.contains(b.target)}),G=$.length>0?u(b,$[0]):!l.current.noIsolation;G&&b.cancelable&&b.preventDefault()}}},[]),p=C.useCallback(function(I,b,j,U){var $={name:I,delta:b,target:j,should:U,shadowParent:Wz(j)};e.current.push($),setTimeout(function(){e.current=e.current.filter(function(G){return G!==$})},1)},[]),g=C.useCallback(function(I){t.current=nf(I),r.current=void 0},[]),_=C.useCallback(function(I){p(I.type,mS(I),I.target,u(I,n.lockRef.current))},[]),v=C.useCallback(function(I){p(I.type,nf(I),I.target,u(I,n.lockRef.current))},[]);C.useEffect(function(){return _l.push(o),n.setCallbacks({onScrollCapture:_,onWheelCapture:_,onTouchMoveCapture:v}),document.addEventListener("wheel",h,yl),document.addEventListener("touchmove",h,yl),document.addEventListener("touchstart",g,yl),function(){_l=_l.filter(function(I){return I!==o}),document.removeEventListener("wheel",h,yl),document.removeEventListener("touchmove",h,yl),document.removeEventListener("touchstart",g,yl)}},[]);var T=n.removeScrollBar,A=n.inert;return C.createElement(C.Fragment,null,A?C.createElement(o,{styles:zz(s)}):null,T?C.createElement(Pz,{noRelative:n.noRelative,gapMode:n.gapMode}):null)}function Wz(n){for(var e=null;n!==null;)n instanceof ShadowRoot&&(e=n.host,n=n.host),n=n.parentNode;return e}const Hz=vz(hk,$z);var Ow=C.forwardRef(function(n,e){return C.createElement(cm,is({},n,{ref:e,sideCar:Hz}))});Ow.classNames=cm.classNames;var qz=function(n){if(typeof document>"u")return null;var e=Array.isArray(n)?n[0]:n;return e.ownerDocument.body},vl=new WeakMap,rf=new WeakMap,sf={},Iy=0,yk=function(n){return n&&(n.host||yk(n.parentNode))},Gz=function(n,e){return e.map(function(t){if(n.contains(t))return t;var r=yk(t);return r&&n.contains(r)?r:(console.error("aria-hidden",t,"in not contained inside",n,". Doing nothing"),null)}).filter(function(t){return!!t})},Kz=function(n,e,t,r){var s=Gz(e,Array.isArray(n)?n:[n]);sf[t]||(sf[t]=new WeakMap);var o=sf[t],l=[],u=new Set,h=new Set(s),p=function(_){!_||u.has(_)||(u.add(_),p(_.parentNode))};s.forEach(p);var g=function(_){!_||h.has(_)||Array.prototype.forEach.call(_.children,function(v){if(u.has(v))g(v);else try{var T=v.getAttribute(r),A=T!==null&&T!=="false",I=(vl.get(v)||0)+1,b=(o.get(v)||0)+1;vl.set(v,I),o.set(v,b),l.push(v),I===1&&A&&rf.set(v,!0),b===1&&v.setAttribute(t,"true"),A||v.setAttribute(r,"true")}catch(j){console.error("aria-hidden: cannot operate on ",v,j)}})};return g(e),u.clear(),Iy++,function(){l.forEach(function(_){var v=vl.get(_)-1,T=o.get(_)-1;vl.set(_,v),o.set(_,T),v||(rf.has(_)||_.removeAttribute(r),rf.delete(_)),T||_.removeAttribute(t)}),Iy--,Iy||(vl=new WeakMap,vl=new WeakMap,rf=new WeakMap,sf={})}},_k=function(n,e,t){t===void 0&&(t="data-aria-hidden");var r=Array.from(Array.isArray(n)?n:[n]),s=qz(n);return s?(r.push.apply(r,Array.from(s.querySelectorAll("[aria-live], script"))),Kz(r,s,t,"aria-hidden")):function(){return null}},um="Dialog",[vk]=ci(um),[Qz,Fr]=vk(um),wk=n=>{const{__scopeDialog:e,children:t,open:r,defaultOpen:s,onOpenChange:o,modal:l=!0}=n,u=C.useRef(null),h=C.useRef(null),[p,g]=lm({prop:r,defaultProp:s??!1,onChange:o,caller:um});return m.jsx(Qz,{scope:e,triggerRef:u,contentRef:h,contentId:Dl(),titleId:Dl(),descriptionId:Dl(),open:p,onOpenChange:g,onOpenToggle:C.useCallback(()=>g(_=>!_),[g]),modal:l,children:t})};wk.displayName=um;var Ek="DialogTrigger",Yz=C.forwardRef((n,e)=>{const{__scopeDialog:t,...r}=n,s=Fr(Ek,t),o=Et(e,s.triggerRef);return m.jsx(st.button,{type:"button","aria-haspopup":"dialog","aria-expanded":s.open,"aria-controls":s.contentId,"data-state":jw(s.open),...r,ref:o,onClick:Le(n.onClick,s.onOpenToggle)})});Yz.displayName=Ek;var Mw="DialogPortal",[Xz,xk]=vk(Mw,{forceMount:void 0}),Tk=n=>{const{__scopeDialog:e,forceMount:t,children:r,container:s}=n,o=Fr(Mw,e);return m.jsx(Xz,{scope:e,forceMount:t,children:C.Children.map(r,l=>m.jsx(ir,{present:t||o.open,children:m.jsx(Dw,{asChild:!0,container:s,children:l})}))})};Tk.displayName=Mw;var ap="DialogOverlay",Ck=C.forwardRef((n,e)=>{const t=xk(ap,n.__scopeDialog),{forceMount:r=t.forceMount,...s}=n,o=Fr(ap,n.__scopeDialog);return o.modal?m.jsx(ir,{present:r||o.open,children:m.jsx(Zz,{...s,ref:e})}):null});Ck.displayName=ap;var Jz=Yl("DialogOverlay.RemoveScroll"),Zz=C.forwardRef((n,e)=>{const{__scopeDialog:t,...r}=n,s=Fr(ap,t);return m.jsx(Ow,{as:Jz,allowPinchZoom:!0,shards:[s.contentRef],children:m.jsx(st.div,{"data-state":jw(s.open),...r,ref:e,style:{pointerEvents:"auto",...r.style}})})}),ga="DialogContent",Sk=C.forwardRef((n,e)=>{const t=xk(ga,n.__scopeDialog),{forceMount:r=t.forceMount,...s}=n,o=Fr(ga,n.__scopeDialog);return m.jsx(ir,{present:r||o.open,children:o.modal?m.jsx(eB,{...s,ref:e}):m.jsx(tB,{...s,ref:e})})});Sk.displayName=ga;var eB=C.forwardRef((n,e)=>{const t=Fr(ga,n.__scopeDialog),r=C.useRef(null),s=Et(e,t.contentRef,r);return C.useEffect(()=>{const o=r.current;if(o)return _k(o)},[]),m.jsx(Ik,{...n,ref:s,trapFocus:t.open,disableOutsidePointerEvents:!0,onCloseAutoFocus:Le(n.onCloseAutoFocus,o=>{o.preventDefault(),t.triggerRef.current?.focus()}),onPointerDownOutside:Le(n.onPointerDownOutside,o=>{const l=o.detail.originalEvent,u=l.button===0&&l.ctrlKey===!0;(l.button===2||u)&&o.preventDefault()}),onFocusOutside:Le(n.onFocusOutside,o=>o.preventDefault())})}),tB=C.forwardRef((n,e)=>{const t=Fr(ga,n.__scopeDialog),r=C.useRef(!1),s=C.useRef(!1);return m.jsx(Ik,{...n,ref:e,trapFocus:!1,disableOutsidePointerEvents:!1,onCloseAutoFocus:o=>{n.onCloseAutoFocus?.(o),o.defaultPrevented||(r.current||t.triggerRef.current?.focus(),o.preventDefault()),r.current=!1,s.current=!1},onInteractOutside:o=>{n.onInteractOutside?.(o),o.defaultPrevented||(r.current=!0,o.detail.originalEvent.type==="pointerdown"&&(s.current=!0));const l=o.target;t.triggerRef.current?.contains(l)&&o.preventDefault(),o.detail.originalEvent.type==="focusin"&&s.current&&o.preventDefault()}})}),Ik=C.forwardRef((n,e)=>{const{__scopeDialog:t,trapFocus:r,onOpenAutoFocus:s,onCloseAutoFocus:o,...l}=n,u=Fr(ga,t),h=C.useRef(null),p=Et(e,h);return ck(),m.jsxs(m.Fragment,{children:[m.jsx(Pw,{asChild:!0,loop:!0,trapped:r,onMountAutoFocus:s,onUnmountAutoFocus:o,children:m.jsx(Nw,{role:"dialog",id:u.contentId,"aria-describedby":u.descriptionId,"aria-labelledby":u.titleId,"data-state":jw(u.open),...l,ref:p,onDismiss:()=>u.onOpenChange(!1)})}),m.jsxs(m.Fragment,{children:[m.jsx(nB,{titleId:u.titleId}),m.jsx(sB,{contentRef:h,descriptionId:u.descriptionId})]})]})}),Lw="DialogTitle",bk=C.forwardRef((n,e)=>{const{__scopeDialog:t,...r}=n,s=Fr(Lw,t);return m.jsx(st.h2,{id:s.titleId,...r,ref:e})});bk.displayName=Lw;var Rk="DialogDescription",Ak=C.forwardRef((n,e)=>{const{__scopeDialog:t,...r}=n,s=Fr(Rk,t);return m.jsx(st.p,{id:s.descriptionId,...r,ref:e})});Ak.displayName=Rk;var kk="DialogClose",Nk=C.forwardRef((n,e)=>{const{__scopeDialog:t,...r}=n,s=Fr(kk,t);return m.jsx(st.button,{type:"button",...r,ref:e,onClick:Le(n.onClick,()=>s.onOpenChange(!1))})});Nk.displayName=kk;function jw(n){return n?"open":"closed"}var Pk="DialogTitleWarning",[dW,Dk]=w9(Pk,{contentName:ga,titleName:Lw,docsSlug:"dialog"}),nB=({titleId:n})=>{const e=Dk(Pk),t=`\`${e.contentName}\` requires a \`${e.titleName}\` for the component to be accessible for screen reader users.

If you want to hide the \`${e.titleName}\`, you can wrap it with our VisuallyHidden component.

For more information, see https://radix-ui.com/primitives/docs/components/${e.docsSlug}`;return C.useEffect(()=>{n&&(document.getElementById(n)||console.error(t))},[t,n]),null},rB="DialogDescriptionWarning",sB=({contentRef:n,descriptionId:e})=>{const r=`Warning: Missing \`Description\` or \`aria-describedby={undefined}\` for {${Dk(rB).contentName}}.`;return C.useEffect(()=>{const s=n.current?.getAttribute("aria-describedby");e&&s&&(document.getElementById(e)||console.warn(r))},[r,n,e]),null},iB=wk,oB=Tk,Ok=Ck,aB=Sk,lB=bk,cB=Ak,uB=Nk;function Ta({...n}){return m.jsx(iB,{"data-slot":"dialog",...n})}function dB({...n}){return m.jsx(oB,{"data-slot":"dialog-portal",...n})}const Mk=C.forwardRef(({className:n,...e},t)=>m.jsx(Ok,{ref:t,"data-slot":"dialog-overlay",className:Lt("data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 fixed inset-0 z-50 bg-black/50",n),...e}));Mk.displayName=Ok.displayName;function Ca({className:n,children:e,...t}){return m.jsxs(dB,{"data-slot":"dialog-portal",children:[m.jsx(Mk,{}),m.jsxs(aB,{"data-slot":"dialog-content",className:Lt("bg-background data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 fixed top-[50%] left-[50%] z-50 grid w-full max-w-[calc(100%-2rem)] translate-x-[-50%] translate-y-[-50%] gap-4 rounded-lg border p-6 shadow-lg duration-200 sm:max-w-lg",n),...t,children:[e,m.jsxs(uB,{className:"ring-offset-background focus:ring-ring data-[state=open]:bg-accent data-[state=open]:text-muted-foreground absolute top-4 right-4 rounded-xs opacity-70 transition-opacity hover:opacity-100 focus:ring-2 focus:ring-offset-2 focus:outline-hidden disabled:pointer-events-none [&_svg]:pointer-events-none [&_svg]:shrink-0 [&_svg:not([class*='size-'])]:size-4",children:[m.jsx(xa,{}),m.jsx("span",{className:"sr-only",children:"Close"})]})]})]})}function Sa({className:n,...e}){return m.jsx("div",{"data-slot":"dialog-header",className:Lt("flex flex-col gap-2 text-center sm:text-left",n),...e})}function hB({className:n,...e}){return m.jsx("div",{"data-slot":"dialog-footer",className:Lt("flex flex-col-reverse gap-2 sm:flex-row sm:justify-end",n),...e})}function Ia({className:n,...e}){return m.jsx(lB,{"data-slot":"dialog-title",className:Lt("text-lg leading-none font-semibold",n),...e})}function hc({className:n,...e}){return m.jsx(cB,{"data-slot":"dialog-description",className:Lt("text-muted-foreground text-sm",n),...e})}var fB=C.createContext(void 0);function Vw(n){const e=C.useContext(fB);return n||e||"ltr"}function pB(n,[e,t]){return Math.min(t,Math.max(e,n))}function mB(n,e){return C.useReducer((t,r)=>e[t][r]??t,n)}var Fw="ScrollArea",[Lk]=ci(Fw),[gB,vr]=Lk(Fw),jk=C.forwardRef((n,e)=>{const{__scopeScrollArea:t,type:r="hover",dir:s,scrollHideDelay:o=600,...l}=n,[u,h]=C.useState(null),[p,g]=C.useState(null),[_,v]=C.useState(null),[T,A]=C.useState(null),[I,b]=C.useState(null),[j,U]=C.useState(0),[$,G]=C.useState(0),[X,ne]=C.useState(!1),[P,R]=C.useState(!1),N=Et(e,O=>h(O)),L=Vw(s);return m.jsx(gB,{scope:t,type:r,dir:L,scrollHideDelay:o,scrollArea:u,viewport:p,onViewportChange:g,content:_,onContentChange:v,scrollbarX:T,onScrollbarXChange:A,scrollbarXEnabled:X,onScrollbarXEnabledChange:ne,scrollbarY:I,onScrollbarYChange:b,scrollbarYEnabled:P,onScrollbarYEnabledChange:R,onCornerWidthChange:U,onCornerHeightChange:G,children:m.jsx(st.div,{dir:L,...l,ref:N,style:{position:"relative","--radix-scroll-area-corner-width":j+"px","--radix-scroll-area-corner-height":$+"px",...n.style}})})});jk.displayName=Fw;var Vk="ScrollAreaViewport",Fk=C.forwardRef((n,e)=>{const{__scopeScrollArea:t,children:r,nonce:s,...o}=n,l=vr(Vk,t),u=C.useRef(null),h=Et(e,u,l.onViewportChange);return m.jsxs(m.Fragment,{children:[m.jsx("style",{dangerouslySetInnerHTML:{__html:"[data-radix-scroll-area-viewport]{scrollbar-width:none;-ms-overflow-style:none;-webkit-overflow-scrolling:touch;}[data-radix-scroll-area-viewport]::-webkit-scrollbar{display:none}"},nonce:s}),m.jsx(st.div,{"data-radix-scroll-area-viewport":"",...o,ref:h,style:{overflowX:l.scrollbarXEnabled?"scroll":"hidden",overflowY:l.scrollbarYEnabled?"scroll":"hidden",...n.style},children:m.jsx("div",{ref:l.onContentChange,style:{minWidth:"100%",display:"table"},children:r})})]})});Fk.displayName=Vk;var xs="ScrollAreaScrollbar",Uk=C.forwardRef((n,e)=>{const{forceMount:t,...r}=n,s=vr(xs,n.__scopeScrollArea),{onScrollbarXEnabledChange:o,onScrollbarYEnabledChange:l}=s,u=n.orientation==="horizontal";return C.useEffect(()=>(u?o(!0):l(!0),()=>{u?o(!1):l(!1)}),[u,o,l]),s.type==="hover"?m.jsx(yB,{...r,ref:e,forceMount:t}):s.type==="scroll"?m.jsx(_B,{...r,ref:e,forceMount:t}):s.type==="auto"?m.jsx(zk,{...r,ref:e,forceMount:t}):s.type==="always"?m.jsx(Uw,{...r,ref:e}):null});Uk.displayName=xs;var yB=C.forwardRef((n,e)=>{const{forceMount:t,...r}=n,s=vr(xs,n.__scopeScrollArea),[o,l]=C.useState(!1);return C.useEffect(()=>{const u=s.scrollArea;let h=0;if(u){const p=()=>{window.clearTimeout(h),l(!0)},g=()=>{h=window.setTimeout(()=>l(!1),s.scrollHideDelay)};return u.addEventListener("pointerenter",p),u.addEventListener("pointerleave",g),()=>{window.clearTimeout(h),u.removeEventListener("pointerenter",p),u.removeEventListener("pointerleave",g)}}},[s.scrollArea,s.scrollHideDelay]),m.jsx(ir,{present:t||o,children:m.jsx(zk,{"data-state":o?"visible":"hidden",...r,ref:e})})}),_B=C.forwardRef((n,e)=>{const{forceMount:t,...r}=n,s=vr(xs,n.__scopeScrollArea),o=n.orientation==="horizontal",l=hm(()=>h("SCROLL_END"),100),[u,h]=mB("hidden",{hidden:{SCROLL:"scrolling"},scrolling:{SCROLL_END:"idle",POINTER_ENTER:"interacting"},interacting:{SCROLL:"interacting",POINTER_LEAVE:"idle"},idle:{HIDE:"hidden",SCROLL:"scrolling",POINTER_ENTER:"interacting"}});return C.useEffect(()=>{if(u==="idle"){const p=window.setTimeout(()=>h("HIDE"),s.scrollHideDelay);return()=>window.clearTimeout(p)}},[u,s.scrollHideDelay,h]),C.useEffect(()=>{const p=s.viewport,g=o?"scrollLeft":"scrollTop";if(p){let _=p[g];const v=()=>{const T=p[g];_!==T&&(h("SCROLL"),l()),_=T};return p.addEventListener("scroll",v),()=>p.removeEventListener("scroll",v)}},[s.viewport,o,h,l]),m.jsx(ir,{present:t||u!=="hidden",children:m.jsx(Uw,{"data-state":u==="hidden"?"hidden":"visible",...r,ref:e,onPointerEnter:Le(n.onPointerEnter,()=>h("POINTER_ENTER")),onPointerLeave:Le(n.onPointerLeave,()=>h("POINTER_LEAVE"))})})}),zk=C.forwardRef((n,e)=>{const t=vr(xs,n.__scopeScrollArea),{forceMount:r,...s}=n,[o,l]=C.useState(!1),u=n.orientation==="horizontal",h=hm(()=>{if(t.viewport){const p=t.viewport.offsetWidth<t.viewport.scrollWidth,g=t.viewport.offsetHeight<t.viewport.scrollHeight;l(u?p:g)}},10);return Xl(t.viewport,h),Xl(t.content,h),m.jsx(ir,{present:r||o,children:m.jsx(Uw,{"data-state":o?"visible":"hidden",...s,ref:e})})}),Uw=C.forwardRef((n,e)=>{const{orientation:t="vertical",...r}=n,s=vr(xs,n.__scopeScrollArea),o=C.useRef(null),l=C.useRef(0),[u,h]=C.useState({content:0,viewport:0,scrollbar:{size:0,paddingStart:0,paddingEnd:0}}),p=qk(u.viewport,u.content),g={...r,sizes:u,onSizesChange:h,hasThumb:p>0&&p<1,onThumbChange:v=>o.current=v,onThumbPointerUp:()=>l.current=0,onThumbPointerDown:v=>l.current=v};function _(v,T){return CB(v,l.current,u,T)}return t==="horizontal"?m.jsx(vB,{...g,ref:e,onThumbPositionChange:()=>{if(s.viewport&&o.current){const v=s.viewport.scrollLeft,T=yS(v,u,s.dir);o.current.style.transform=`translate3d(${T}px, 0, 0)`}},onWheelScroll:v=>{s.viewport&&(s.viewport.scrollLeft=v)},onDragScroll:v=>{s.viewport&&(s.viewport.scrollLeft=_(v,s.dir))}}):t==="vertical"?m.jsx(wB,{...g,ref:e,onThumbPositionChange:()=>{if(s.viewport&&o.current){const v=s.viewport.scrollTop,T=yS(v,u);o.current.style.transform=`translate3d(0, ${T}px, 0)`}},onWheelScroll:v=>{s.viewport&&(s.viewport.scrollTop=v)},onDragScroll:v=>{s.viewport&&(s.viewport.scrollTop=_(v))}}):null}),vB=C.forwardRef((n,e)=>{const{sizes:t,onSizesChange:r,...s}=n,o=vr(xs,n.__scopeScrollArea),[l,u]=C.useState(),h=C.useRef(null),p=Et(e,h,o.onScrollbarXChange);return C.useEffect(()=>{h.current&&u(getComputedStyle(h.current))},[h]),m.jsx($k,{"data-orientation":"horizontal",...s,ref:p,sizes:t,style:{bottom:0,left:o.dir==="rtl"?"var(--radix-scroll-area-corner-width)":0,right:o.dir==="ltr"?"var(--radix-scroll-area-corner-width)":0,"--radix-scroll-area-thumb-width":dm(t)+"px",...n.style},onThumbPointerDown:g=>n.onThumbPointerDown(g.x),onDragScroll:g=>n.onDragScroll(g.x),onWheelScroll:(g,_)=>{if(o.viewport){const v=o.viewport.scrollLeft+g.deltaX;n.onWheelScroll(v),Kk(v,_)&&g.preventDefault()}},onResize:()=>{h.current&&o.viewport&&l&&r({content:o.viewport.scrollWidth,viewport:o.viewport.offsetWidth,scrollbar:{size:h.current.clientWidth,paddingStart:cp(l.paddingLeft),paddingEnd:cp(l.paddingRight)}})}})}),wB=C.forwardRef((n,e)=>{const{sizes:t,onSizesChange:r,...s}=n,o=vr(xs,n.__scopeScrollArea),[l,u]=C.useState(),h=C.useRef(null),p=Et(e,h,o.onScrollbarYChange);return C.useEffect(()=>{h.current&&u(getComputedStyle(h.current))},[h]),m.jsx($k,{"data-orientation":"vertical",...s,ref:p,sizes:t,style:{top:0,right:o.dir==="ltr"?0:void 0,left:o.dir==="rtl"?0:void 0,bottom:"var(--radix-scroll-area-corner-height)","--radix-scroll-area-thumb-height":dm(t)+"px",...n.style},onThumbPointerDown:g=>n.onThumbPointerDown(g.y),onDragScroll:g=>n.onDragScroll(g.y),onWheelScroll:(g,_)=>{if(o.viewport){const v=o.viewport.scrollTop+g.deltaY;n.onWheelScroll(v),Kk(v,_)&&g.preventDefault()}},onResize:()=>{h.current&&o.viewport&&l&&r({content:o.viewport.scrollHeight,viewport:o.viewport.offsetHeight,scrollbar:{size:h.current.clientHeight,paddingStart:cp(l.paddingTop),paddingEnd:cp(l.paddingBottom)}})}})}),[EB,Bk]=Lk(xs),$k=C.forwardRef((n,e)=>{const{__scopeScrollArea:t,sizes:r,hasThumb:s,onThumbChange:o,onThumbPointerUp:l,onThumbPointerDown:u,onThumbPositionChange:h,onDragScroll:p,onWheelScroll:g,onResize:_,...v}=n,T=vr(xs,t),[A,I]=C.useState(null),b=Et(e,N=>I(N)),j=C.useRef(null),U=C.useRef(""),$=T.viewport,G=r.content-r.viewport,X=un(g),ne=un(h),P=hm(_,10);function R(N){if(j.current){const L=N.clientX-j.current.left,O=N.clientY-j.current.top;p({x:L,y:O})}}return C.useEffect(()=>{const N=L=>{const O=L.target;A?.contains(O)&&X(L,G)};return document.addEventListener("wheel",N,{passive:!1}),()=>document.removeEventListener("wheel",N,{passive:!1})},[$,A,G,X]),C.useEffect(ne,[r,ne]),Xl(A,P),Xl(T.content,P),m.jsx(EB,{scope:t,scrollbar:A,hasThumb:s,onThumbChange:un(o),onThumbPointerUp:un(l),onThumbPositionChange:ne,onThumbPointerDown:un(u),children:m.jsx(st.div,{...v,ref:b,style:{position:"absolute",...v.style},onPointerDown:Le(n.onPointerDown,N=>{N.button===0&&(N.target.setPointerCapture(N.pointerId),j.current=A.getBoundingClientRect(),U.current=document.body.style.webkitUserSelect,document.body.style.webkitUserSelect="none",T.viewport&&(T.viewport.style.scrollBehavior="auto"),R(N))}),onPointerMove:Le(n.onPointerMove,R),onPointerUp:Le(n.onPointerUp,N=>{const L=N.target;L.hasPointerCapture(N.pointerId)&&L.releasePointerCapture(N.pointerId),document.body.style.webkitUserSelect=U.current,T.viewport&&(T.viewport.style.scrollBehavior=""),j.current=null})})})}),lp="ScrollAreaThumb",Wk=C.forwardRef((n,e)=>{const{forceMount:t,...r}=n,s=Bk(lp,n.__scopeScrollArea);return m.jsx(ir,{present:t||s.hasThumb,children:m.jsx(xB,{ref:e,...r})})}),xB=C.forwardRef((n,e)=>{const{__scopeScrollArea:t,style:r,...s}=n,o=vr(lp,t),l=Bk(lp,t),{onThumbPositionChange:u}=l,h=Et(e,_=>l.onThumbChange(_)),p=C.useRef(void 0),g=hm(()=>{p.current&&(p.current(),p.current=void 0)},100);return C.useEffect(()=>{const _=o.viewport;if(_){const v=()=>{if(g(),!p.current){const T=SB(_,u);p.current=T,u()}};return u(),_.addEventListener("scroll",v),()=>_.removeEventListener("scroll",v)}},[o.viewport,g,u]),m.jsx(st.div,{"data-state":l.hasThumb?"visible":"hidden",...s,ref:h,style:{width:"var(--radix-scroll-area-thumb-width)",height:"var(--radix-scroll-area-thumb-height)",...r},onPointerDownCapture:Le(n.onPointerDownCapture,_=>{const T=_.target.getBoundingClientRect(),A=_.clientX-T.left,I=_.clientY-T.top;l.onThumbPointerDown({x:A,y:I})}),onPointerUp:Le(n.onPointerUp,l.onThumbPointerUp)})});Wk.displayName=lp;var zw="ScrollAreaCorner",Hk=C.forwardRef((n,e)=>{const t=vr(zw,n.__scopeScrollArea),r=!!(t.scrollbarX&&t.scrollbarY);return t.type!=="scroll"&&r?m.jsx(TB,{...n,ref:e}):null});Hk.displayName=zw;var TB=C.forwardRef((n,e)=>{const{__scopeScrollArea:t,...r}=n,s=vr(zw,t),[o,l]=C.useState(0),[u,h]=C.useState(0),p=!!(o&&u);return Xl(s.scrollbarX,()=>{const g=s.scrollbarX?.offsetHeight||0;s.onCornerHeightChange(g),h(g)}),Xl(s.scrollbarY,()=>{const g=s.scrollbarY?.offsetWidth||0;s.onCornerWidthChange(g),l(g)}),p?m.jsx(st.div,{...r,ref:e,style:{width:o,height:u,position:"absolute",right:s.dir==="ltr"?0:void 0,left:s.dir==="rtl"?0:void 0,bottom:0,...n.style}}):null});function cp(n){return n?parseInt(n,10):0}function qk(n,e){const t=n/e;return isNaN(t)?0:t}function dm(n){const e=qk(n.viewport,n.content),t=n.scrollbar.paddingStart+n.scrollbar.paddingEnd,r=(n.scrollbar.size-t)*e;return Math.max(r,18)}function CB(n,e,t,r="ltr"){const s=dm(t),o=s/2,l=e||o,u=s-l,h=t.scrollbar.paddingStart+l,p=t.scrollbar.size-t.scrollbar.paddingEnd-u,g=t.content-t.viewport,_=r==="ltr"?[0,g]:[g*-1,0];return Gk([h,p],_)(n)}function yS(n,e,t="ltr"){const r=dm(e),s=e.scrollbar.paddingStart+e.scrollbar.paddingEnd,o=e.scrollbar.size-s,l=e.content-e.viewport,u=o-r,h=t==="ltr"?[0,l]:[l*-1,0],p=pB(n,h);return Gk([0,l],[0,u])(p)}function Gk(n,e){return t=>{if(n[0]===n[1]||e[0]===e[1])return e[0];const r=(e[1]-e[0])/(n[1]-n[0]);return e[0]+r*(t-n[0])}}function Kk(n,e){return n>0&&n<e}var SB=(n,e=()=>{})=>{let t={left:n.scrollLeft,top:n.scrollTop},r=0;return(function s(){const o={left:n.scrollLeft,top:n.scrollTop},l=t.left!==o.left,u=t.top!==o.top;(l||u)&&e(),t=o,r=window.requestAnimationFrame(s)})(),()=>window.cancelAnimationFrame(r)};function hm(n,e){const t=un(n),r=C.useRef(0);return C.useEffect(()=>()=>window.clearTimeout(r.current),[]),C.useCallback(()=>{window.clearTimeout(r.current),r.current=window.setTimeout(t,e)},[t,e])}function Xl(n,e){const t=un(e);_r(()=>{let r=0;if(n){const s=new ResizeObserver(()=>{cancelAnimationFrame(r),r=window.requestAnimationFrame(t)});return s.observe(n),()=>{window.cancelAnimationFrame(r),s.unobserve(n)}}},[n,t])}var IB=jk,bB=Fk,RB=Hk;function Bw({className:n,children:e,...t}){return m.jsxs(IB,{"data-slot":"scroll-area",className:Lt("relative",n),...t,children:[m.jsx(bB,{"data-slot":"scroll-area-viewport",className:"focus-visible:ring-ring/50 size-full rounded-[inherit] transition-[color,box-shadow] outline-none focus-visible:ring-[3px] focus-visible:outline-1",children:e}),m.jsx(AB,{}),m.jsx(RB,{})]})}function AB({className:n,orientation:e="vertical",...t}){return m.jsx(Uk,{"data-slot":"scroll-area-scrollbar",orientation:e,className:Lt("flex touch-none p-px transition-colors select-none",e==="vertical"&&"h-full w-2.5 border-l border-l-transparent",e==="horizontal"&&"h-2.5 flex-col border-t border-t-transparent",n),...t,children:m.jsx(Wk,{"data-slot":"scroll-area-thumb",className:"bg-border relative flex-1 rounded-full"})})}const Qk="efxIXZk8hBcXsDtZomqJGDi2MQJHyOWW",Yk="https://api.giphy.com/v1",kB=async(n,e=20,t=0)=>{try{const r=await fetch(`${Yk}/gifs/search?api_key=${Qk}&q=${encodeURIComponent(n)}&limit=${e}&offset=${t}`);if(!r.ok)throw new Error("Failed to fetch GIFs");return await r.json()}catch(r){throw console.error("Error searching GIFs:",r),r}},NB=async(n=20,e=0)=>{try{const t=await fetch(`${Yk}/gifs/trending?api_key=${Qk}&limit=${n}&offset=${e}`);if(!t.ok)throw new Error("Failed to fetch trending GIFs");return await t.json()}catch(t){throw console.error("Error fetching trending GIFs:",t),t}},PB=["happy","love","funny","cute","excited","sad","angry","surprised","dance","party","food","cat","dog","reaction","hello","goodbye","yes","no","think","confused"],DB=["سعيد","حب","مضحك","لطيف","متحمس","حزين","غاضب","مندهش","رقص","حفلة","طعام","قطة","كلب","ردة فعل","مرحبا","وداعا","نعم","لا","تفكير","محتار"];function OB({isOpen:n,onClose:e,onSelectGif:t}){const[r,s]=C.useState([]),[o,l]=C.useState(""),[u,h]=C.useState(!1),[p,g]=C.useState("");C.useEffect(()=>{n&&r.length===0&&_()},[n]);const _=async()=>{h(!0),g("");try{const I=await NB(20);s(I.data)}catch(I){g("فشل في تحميل الصور المتحركة"),console.error("Error loading trending GIFs:",I)}finally{h(!1)}},v=async I=>{if(!I.trim()){_();return}h(!0),g("");try{const b=await kB(I,20);s(b.data)}catch(b){g("فشل في البحث عن الصور المتحركة"),console.error("Error searching GIFs:",b)}finally{h(!1)}},T=I=>{I.preventDefault(),v(o)},A=I=>{l(I),v(I)};return m.jsx(Ta,{open:n,onOpenChange:e,children:m.jsxs(Ca,{className:"bg-gray-900 border-gray-700 text-white max-w-md max-h-[80vh]",dir:"rtl",children:[m.jsx(Sa,{children:m.jsxs(Ia,{className:"flex items-center justify-between",children:[m.jsx("span",{children:"اختر صورة متحركة"}),m.jsx(ue,{variant:"ghost",size:"sm",onClick:e,children:m.jsx(xa,{className:"w-4 h-4"})})]})}),m.jsxs("form",{onSubmit:T,className:"flex gap-2",children:[m.jsx(ln,{value:o,onChange:I=>l(I.target.value),placeholder:"ابحث عن صورة متحركة...",className:"bg-gray-800 border-gray-600 text-white",dir:"rtl"}),m.jsx(ue,{type:"submit",size:"sm",className:"bg-green-600 hover:bg-green-700",children:m.jsx(op,{className:"w-4 h-4"})})]}),m.jsxs("div",{className:"flex flex-wrap gap-2",children:[m.jsxs(ue,{variant:"outline",size:"sm",onClick:_,className:"border-gray-600 text-gray-300 hover:bg-gray-700",children:[m.jsx(KC,{className:"w-3 h-3 ml-1"}),"الرائج"]}),DB.slice(0,4).map((I,b)=>m.jsx(ue,{variant:"outline",size:"sm",onClick:()=>A(PB[b]),className:"border-gray-600 text-gray-300 hover:bg-gray-700",children:I},I))]}),p&&m.jsx("div",{className:"text-red-400 text-sm text-center py-2",children:p}),m.jsx(Bw,{className:"h-[400px]",children:u?m.jsx("div",{className:"flex items-center justify-center h-40",children:m.jsx("div",{className:"w-8 h-8 border-2 border-green-500 border-t-transparent rounded-full animate-spin"})}):r.length===0?m.jsxs("div",{className:"flex flex-col items-center justify-center h-40 text-gray-400",children:[m.jsx(KC,{className:"w-12 h-12 mb-2"}),m.jsx("p",{children:"لم يتم العثور على صور متحركة"})]}):m.jsx("div",{className:"grid grid-cols-2 gap-2 p-2",children:r.map(I=>m.jsxs("div",{className:"relative cursor-pointer rounded-lg overflow-hidden hover:scale-105 transition-transform",onClick:()=>t(I),children:[m.jsx("img",{src:I.images.fixed_height.url,alt:I.title,className:"w-full h-auto object-cover",loading:"lazy"}),m.jsx("div",{className:"absolute inset-0 bg-black bg-opacity-0 hover:bg-opacity-20 transition-all duration-200"})]},I.id))})}),m.jsx("div",{className:"text-center text-xs text-gray-500",children:"مدعوم بواسطة GIPHY"})]})})}const MB=n=>(typeof n=="number"?new Date(n):new Date(n)).toLocaleTimeString("ar",{hour:"2-digit",minute:"2-digit"});function LB({user:n,onBack:e,currentUserId:t}){const[r,s]=C.useState(""),[o,l]=C.useState([]),[u,h]=C.useState(null),[p,g]=C.useState(!1),_=C.useRef(null),v=()=>{_.current?.scrollIntoView({behavior:"smooth"})};C.useEffect(()=>{(async()=>{if(t&&n.id){const $=await T6(t,n.id);h($)}})()},[t,n.id]),C.useEffect(()=>{if(!u)return;const U=I6(u,$=>{l($)});return()=>U()},[u]),C.useEffect(()=>{v()},[o]);const T=async()=>{if(r.trim()&&u){const U={content:r.trim(),senderId:t,isRead:!1};await $C(u,U),s("")}},A=U=>{U.key==="Enter"&&T()},I=async U=>{if(u){const $={content:`[GIF] ${U.images.fixed_height.url}`,senderId:t,isRead:!1};await $C(u,$),g(!1)}},b=()=>{console.log("Open photo/video picker")},j=U=>{if(U.content.startsWith("[GIF] ")){const $=U.content.replace("[GIF] ","");return m.jsx("div",{className:"rounded-lg overflow-hidden max-w-[200px]",children:m.jsx("img",{src:$,alt:"GIF",className:"w-full h-auto"})})}return m.jsx("p",{className:"leading-relaxed",children:U.content})};return m.jsxs("div",{className:"fixed inset-0 z-[60] min-h-screen bg-gradient-to-b from-gray-900 to-black flex flex-col",dir:"rtl",children:[m.jsxs("div",{className:"bg-gray-900/90 backdrop-blur-sm border-b border-gray-800 p-4 flex items-center gap-3",children:[m.jsx(ue,{variant:"ghost",size:"sm",onClick:e,className:"text-white hover:bg-gray-700",children:m.jsx(x_,{className:"w-5 h-5"})}),m.jsxs("div",{className:"relative",children:[m.jsxs(nr,{className:"w-10 h-10",children:[m.jsx(rr,{src:n.avatar}),m.jsx(sr,{className:"bg-gray-700 text-white",children:n.displayName.charAt(0)})]}),m.jsx("div",{className:`absolute -bottom-1 -left-1 w-3 h-3 rounded-full border-2 border-gray-900 ${n.isOnline?"bg-green-500":"bg-gray-500"}`})]}),m.jsxs("div",{className:"flex-1",children:[m.jsx("h3",{className:"text-white font-medium",children:n.displayName}),m.jsx("p",{className:"text-gray-400 text-sm",children:n.isOnline?"متصل":n.lastSeen||"آخر ظهور مؤخراً"})]}),m.jsxs("div",{className:"flex items-center gap-2",children:[m.jsx(ue,{variant:"ghost",size:"sm",className:"text-gray-400 hover:text-white",children:m.jsx(u5,{className:"w-5 h-5"})}),m.jsx(ue,{variant:"ghost",size:"sm",className:"text-gray-400 hover:text-white",children:m.jsx(k5,{className:"w-5 h-5"})}),m.jsx(ue,{variant:"ghost",size:"sm",className:"text-gray-400 hover:text-white",children:m.jsx(Cw,{className:"w-5 h-5"})})]})]}),m.jsxs("div",{className:"flex-1 overflow-y-auto p-4 space-y-4",children:[o.length===0?m.jsxs("div",{className:"flex flex-col items-center justify-center h-full text-center py-20",children:[m.jsx("div",{className:"w-16 h-16 bg-gray-700 rounded-full flex items-center justify-center mb-4",children:m.jsx(ma,{className:"w-8 h-8 text-gray-400"})}),m.jsx("p",{className:"text-gray-400 text-lg mb-2",children:"بداية المحادثة"}),m.jsxs("p",{className:"text-gray-500 text-sm",children:["أرسل رسالة لبدء المحادثة مع ",n.displayName]})]}):o.map(U=>{const $=U.senderId===t;return m.jsx("div",{className:`flex ${$?"justify-end":"justify-start"}`,children:m.jsxs("div",{className:`max-w-[70%] rounded-2xl px-4 py-2 ${$?"bg-green-600 text-white":"bg-gray-700 text-white"}`,children:[j(U),m.jsxs("div",{className:`flex items-center gap-1 mt-1 ${$?"justify-end":"justify-start"}`,children:[m.jsx("span",{className:"text-xs opacity-70",children:MB(U.timestamp)}),$&&m.jsx("div",{className:`w-2 h-2 rounded-full ${U.isRead?"bg-blue-400":"bg-gray-400"}`})]})]})},U.id)}),m.jsx("div",{ref:_})]}),m.jsx("div",{className:"bg-gray-800/50 backdrop-blur-sm border-t border-gray-700 p-4",children:m.jsxs("div",{className:"flex items-center gap-2",children:[m.jsx(ue,{variant:"ghost",size:"sm",onClick:b,className:"text-gray-400 hover:text-white",children:m.jsx(ip,{className:"w-5 h-5"})}),m.jsxs("div",{className:"flex-1 bg-gray-700 rounded-full flex items-center px-4 py-2",children:[m.jsx(ln,{value:r,onChange:U=>s(U.target.value),onKeyPress:A,placeholder:"اكتب رسالة...",className:"flex-1 bg-transparent border-none text-white placeholder-gray-400 focus:ring-0",dir:"rtl"}),m.jsx(ue,{variant:"ghost",size:"sm",onClick:()=>g(!0),className:"text-gray-400 hover:text-white ml-2",children:m.jsx(LA,{className:"w-5 h-5"})})]}),m.jsx(ue,{onClick:T,disabled:!r.trim(),className:"bg-green-600 hover:bg-green-700 text-white rounded-full p-2",children:m.jsx(ma,{className:"w-4 h-4"})})]})}),m.jsx(OB,{isOpen:p,onClose:()=>g(!1),onSelectGif:I})]})}function jB({stories:n,currentStoryIndex:e,currentContentIndex:t,onClose:r,onNext:s,onPrevious:o,onReply:l}){const[u,h]=C.useState(0),[p,g]=C.useState(""),[_,v]=C.useState(!1),T=n[e],A=T?.stories[t];C.useEffect(()=>{h(0);const b=setInterval(()=>{h(j=>j>=100?(s(),0):j+2)},100);return()=>clearInterval(b)},[e,t,s]);const I=()=>{p.trim()&&(l(T.id,p),g(""),v(!1))};return!T||!A?null:m.jsxs("div",{className:"fixed inset-0 z-[100] bg-black flex items-center justify-center",children:[m.jsx("div",{className:"absolute top-4 left-4 right-4 flex gap-1 z-10",children:T.stories.map((b,j)=>m.jsx("div",{className:"flex-1 h-1 bg-gray-600 rounded-full overflow-hidden",children:m.jsx("div",{className:"h-full bg-white transition-all duration-100",style:{width:j<t?"100%":j===t?`${u}%`:"0%"}})},j))}),m.jsxs("div",{className:"absolute top-8 left-4 right-4 flex items-center justify-between z-10 mt-6",children:[m.jsxs("div",{className:"flex items-center gap-3",children:[m.jsxs(nr,{className:"w-10 h-10 ring-2 ring-white",children:[m.jsx(rr,{src:T.avatar}),m.jsx(sr,{className:"bg-gray-700 text-white",children:T.displayName.charAt(0)})]}),m.jsxs("div",{children:[m.jsx("p",{className:"text-white font-medium",children:T.displayName}),m.jsx("p",{className:"text-gray-300 text-sm",children:A.timestamp})]})]}),m.jsx(ue,{variant:"ghost",size:"sm",onClick:r,className:"text-white hover:bg-white/20",children:m.jsx(xa,{className:"w-6 h-6"})})]}),m.jsxs("div",{className:"w-full h-full flex items-center justify-center relative",children:[A.type==="image"?m.jsx("img",{src:A.content,alt:"Story",className:"max-w-full max-h-full object-contain"}):m.jsx("div",{className:"w-full h-full flex items-center justify-center p-8",style:{backgroundColor:A.backgroundColor||"#1f2937"},children:m.jsx("p",{className:"text-white text-center text-xl leading-relaxed max-w-md",children:A.content})}),m.jsx("div",{className:"absolute left-0 top-0 w-1/3 h-full cursor-pointer z-20",onClick:o}),m.jsx("div",{className:"absolute right-0 top-0 w-1/3 h-full cursor-pointer z-20",onClick:s})]}),m.jsx("div",{className:"absolute bottom-4 left-4 right-4 z-10",children:_?m.jsxs("div",{className:"flex items-center gap-2 bg-black/50 rounded-full p-2",children:[m.jsx(ln,{value:p,onChange:b=>g(b.target.value),placeholder:`Reply to ${T.displayName}...`,className:"flex-1 bg-transparent border-none text-white placeholder-gray-300 focus:ring-0",onKeyPress:b=>b.key==="Enter"&&I()}),m.jsx(ue,{onClick:I,disabled:!p.trim(),className:"bg-green-600 hover:bg-green-700 text-white rounded-full p-2",children:m.jsx(ma,{className:"w-4 h-4"})})]}):m.jsxs("div",{className:"flex items-center justify-between",children:[m.jsx(ue,{variant:"ghost",size:"sm",className:"text-white hover:bg-white/20",children:m.jsx(Ql,{className:"w-5 h-5"})}),m.jsx(ue,{variant:"ghost",size:"sm",onClick:()=>v(!0),className:"text-white hover:bg-white/20",children:m.jsx(ma,{className:"w-5 h-5"})})]})}),e>0&&m.jsx(ue,{variant:"ghost",size:"sm",onClick:o,className:"absolute left-4 top-1/2 -translate-y-1/2 text-white hover:bg-white/20 z-30",children:m.jsx(B6,{className:"w-6 h-6"})}),e<n.length-1&&m.jsx(ue,{variant:"ghost",size:"sm",onClick:s,className:"absolute right-4 top-1/2 -translate-y-1/2 text-white hover:bg-white/20 z-30",children:m.jsx(W6,{className:"w-6 h-6"})})]})}function VB({isOpen:n,onClose:e,postId:t,comments:r,onAddComment:s,onLikeComment:o,onReplyToComment:l}){const[u,h]=C.useState(""),[p,g]=C.useState(null),[_,v]=C.useState(""),T=()=>{u.trim()&&(s(t,u),h(""))},A=b=>{_.trim()&&l&&(l(b,_),v(""),g(null))},I=({comment:b,isReply:j=!1})=>m.jsxs("div",{className:`flex gap-3 ${j?"ml-8 mt-2":"mb-4"}`,children:[m.jsxs(nr,{className:"w-8 h-8",children:[m.jsx(rr,{src:b.avatar}),m.jsx(sr,{className:"bg-gray-700 text-white text-sm",children:b.displayName.charAt(0)})]}),m.jsxs("div",{className:"flex-1",children:[m.jsxs("div",{className:"bg-gray-800/50 rounded-2xl px-3 py-2",children:[m.jsx("p",{className:"text-white font-medium text-sm",children:b.displayName}),m.jsx("p",{className:"text-gray-100 text-sm leading-relaxed mt-1",children:b.content})]}),m.jsxs("div",{className:"flex items-center gap-4 mt-2 text-xs text-gray-400",children:[m.jsx("span",{children:b.timestamp}),m.jsxs(ue,{variant:"ghost",size:"sm",onClick:()=>o&&o(b.id),className:`p-0 h-auto text-xs ${b.isLiked?"text-red-400":"text-gray-400 hover:text-red-400"}`,children:[m.jsx(Ql,{className:`w-3 h-3 mr-1 ${b.isLiked?"fill-current":""}`}),b.likes>0&&b.likes]}),!j&&m.jsxs(ue,{variant:"ghost",size:"sm",onClick:()=>g(b.id),className:"p-0 h-auto text-xs text-gray-400 hover:text-white",children:[m.jsx(f5,{className:"w-3 h-3 mr-1"}),"Reply"]})]}),p===b.id&&m.jsxs("div",{className:"flex items-center gap-2 mt-3",children:[m.jsx(ln,{value:_,onChange:U=>v(U.target.value),placeholder:`Reply to ${b.displayName}...`,className:"flex-1 bg-gray-700 border-gray-600 text-white placeholder-gray-400 text-sm",onKeyPress:U=>U.key==="Enter"&&A(b.id)}),m.jsx(ue,{onClick:()=>A(b.id),disabled:!_.trim(),className:"bg-green-600 hover:bg-green-700 text-white px-3 py-1 text-sm",children:m.jsx(ma,{className:"w-3 h-3"})})]}),b.replies&&b.replies.map(U=>m.jsx(I,{comment:U,isReply:!0},U.id))]})]});return m.jsx(Ta,{open:n,onOpenChange:e,children:m.jsxs(Ca,{className:"bg-gray-900 border-gray-700 text-white max-w-md max-h-[80vh] p-0",children:[m.jsxs(Sa,{className:"p-4 border-b border-gray-700",children:[m.jsx(Ia,{className:"text-center",children:"Comments"}),m.jsx(hc,{className:"text-center text-gray-400",children:"Join the conversation and share your thoughts"}),m.jsx(ue,{variant:"ghost",size:"sm",onClick:e,className:"absolute right-4 top-4 text-gray-400 hover:text-white",children:m.jsx(xa,{className:"w-5 h-5"})})]}),m.jsx(Bw,{className:"flex-1 p-4 max-h-[400px]",children:r.length===0?m.jsxs("div",{className:"text-center py-8",children:[m.jsx("p",{className:"text-gray-400",children:"No comments yet"}),m.jsx("p",{className:"text-gray-500 text-sm mt-1",children:"Be the first to comment!"})]}):r.map(b=>m.jsx(I,{comment:b},b.id))}),m.jsx("div",{className:"p-4 border-t border-gray-700",children:m.jsxs("div",{className:"flex items-center gap-3",children:[m.jsxs(nr,{className:"w-8 h-8",children:[m.jsx(rr,{src:"https://images.unsplash.com/photo-1535713875002-d1d0cf377fde?w=150&h=150&fit=crop&crop=face"}),m.jsx(sr,{className:"bg-gray-700 text-white",children:"You"})]}),m.jsx(ln,{value:u,onChange:b=>h(b.target.value),placeholder:"Add a comment...",className:"flex-1 bg-gray-800 border-gray-600 text-white placeholder-gray-400",onKeyPress:b=>b.key==="Enter"&&T()}),m.jsx(ue,{onClick:T,disabled:!u.trim(),className:"bg-green-600 hover:bg-green-700 text-white",children:m.jsx(ma,{className:"w-4 h-4"})})]})})]})})}function FB(n){const e=C.useRef({value:n,previous:n});return C.useMemo(()=>(e.current.value!==n&&(e.current.previous=e.current.value,e.current.value=n),e.current.previous),[n])}function Xk(n){const[e,t]=C.useState(void 0);return _r(()=>{if(n){t({width:n.offsetWidth,height:n.offsetHeight});const r=new ResizeObserver(s=>{if(!Array.isArray(s)||!s.length)return;const o=s[0];let l,u;if("borderBoxSize"in o){const h=o.borderBoxSize,p=Array.isArray(h)?h[0]:h;l=p.inlineSize,u=p.blockSize}else l=n.offsetWidth,u=n.offsetHeight;t({width:l,height:u})});return r.observe(n,{box:"border-box"}),()=>r.unobserve(n)}else t(void 0)},[n]),e}var fm="Checkbox",[UB]=ci(fm),[zB,$w]=UB(fm);function BB(n){const{__scopeCheckbox:e,checked:t,children:r,defaultChecked:s,disabled:o,form:l,name:u,onCheckedChange:h,required:p,value:g="on",internal_do_not_use_render:_}=n,[v,T]=lm({prop:t,defaultProp:s??!1,onChange:h,caller:fm}),[A,I]=C.useState(null),[b,j]=C.useState(null),U=C.useRef(!1),$=A?!!l||!!A.closest("form"):!0,G={checked:v,disabled:o,setChecked:T,control:A,setControl:I,name:u,form:l,value:g,hasConsumerStoppedPropagationRef:U,required:p,defaultChecked:so(s)?!1:s,isFormControl:$,bubbleInput:b,setBubbleInput:j};return m.jsx(zB,{scope:e,...G,children:$B(_)?_(G):r})}var Jk="CheckboxTrigger",Zk=C.forwardRef(({__scopeCheckbox:n,onKeyDown:e,onClick:t,...r},s)=>{const{control:o,value:l,disabled:u,checked:h,required:p,setControl:g,setChecked:_,hasConsumerStoppedPropagationRef:v,isFormControl:T,bubbleInput:A}=$w(Jk,n),I=Et(s,g),b=C.useRef(h);return C.useEffect(()=>{const j=o?.form;if(j){const U=()=>_(b.current);return j.addEventListener("reset",U),()=>j.removeEventListener("reset",U)}},[o,_]),m.jsx(st.button,{type:"button",role:"checkbox","aria-checked":so(h)?"mixed":h,"aria-required":p,"data-state":iN(h),"data-disabled":u?"":void 0,disabled:u,value:l,...r,ref:I,onKeyDown:Le(e,j=>{j.key==="Enter"&&j.preventDefault()}),onClick:Le(t,j=>{_(U=>so(U)?!0:!U),A&&T&&(v.current=j.isPropagationStopped(),v.current||j.stopPropagation())})})});Zk.displayName=Jk;var eN=C.forwardRef((n,e)=>{const{__scopeCheckbox:t,name:r,checked:s,defaultChecked:o,required:l,disabled:u,value:h,onCheckedChange:p,form:g,..._}=n;return m.jsx(BB,{__scopeCheckbox:t,checked:s,defaultChecked:o,disabled:u,required:l,onCheckedChange:p,name:r,form:g,value:h,internal_do_not_use_render:({isFormControl:v})=>m.jsxs(m.Fragment,{children:[m.jsx(Zk,{..._,ref:e,__scopeCheckbox:t}),v&&m.jsx(sN,{__scopeCheckbox:t})]})})});eN.displayName=fm;var tN="CheckboxIndicator",nN=C.forwardRef((n,e)=>{const{__scopeCheckbox:t,forceMount:r,...s}=n,o=$w(tN,t);return m.jsx(ir,{present:r||so(o.checked)||o.checked===!0,children:m.jsx(st.span,{"data-state":iN(o.checked),"data-disabled":o.disabled?"":void 0,...s,ref:e,style:{pointerEvents:"none",...n.style}})})});nN.displayName=tN;var rN="CheckboxBubbleInput",sN=C.forwardRef(({__scopeCheckbox:n,...e},t)=>{const{control:r,hasConsumerStoppedPropagationRef:s,checked:o,defaultChecked:l,required:u,disabled:h,name:p,value:g,form:_,bubbleInput:v,setBubbleInput:T}=$w(rN,n),A=Et(t,T),I=FB(o),b=Xk(r);C.useEffect(()=>{const U=v;if(!U)return;const $=window.HTMLInputElement.prototype,X=Object.getOwnPropertyDescriptor($,"checked").set,ne=!s.current;if(I!==o&&X){const P=new Event("click",{bubbles:ne});U.indeterminate=so(o),X.call(U,so(o)?!1:o),U.dispatchEvent(P)}},[v,I,o,s]);const j=C.useRef(so(o)?!1:o);return m.jsx(st.input,{type:"checkbox","aria-hidden":!0,defaultChecked:l??j.current,required:u,disabled:h,name:p,value:g,form:_,...e,tabIndex:-1,ref:A,style:{...e.style,...b,position:"absolute",pointerEvents:"none",opacity:0,margin:0,transform:"translateX(-100%)"}})});sN.displayName=rN;function $B(n){return typeof n=="function"}function so(n){return n==="indeterminate"}function iN(n){return so(n)?"indeterminate":n?"checked":"unchecked"}function WB({className:n,...e}){return m.jsx(eN,{"data-slot":"checkbox",className:Lt("peer border bg-input-background dark:bg-input/30 data-[state=checked]:bg-primary data-[state=checked]:text-primary-foreground dark:data-[state=checked]:bg-primary data-[state=checked]:border-primary focus-visible:border-ring focus-visible:ring-ring/50 aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive size-4 shrink-0 rounded-[4px] border shadow-xs transition-shadow outline-none focus-visible:ring-[3px] disabled:cursor-not-allowed disabled:opacity-50",n),...e,children:m.jsx(nN,{"data-slot":"checkbox-indicator",className:"flex items-center justify-center text-current transition-none",children:m.jsx(U6,{className:"size-3.5"})})})}function HB({isOpen:n,onClose:e,postId:t,users:r,onShare:s}){const[o,l]=C.useState([]),[u,h]=C.useState(""),[p,g]=C.useState(""),_=r.filter(I=>I.displayName.toLowerCase().includes(u.toLowerCase())||I.username.toLowerCase().includes(u.toLowerCase())),v=I=>{l(b=>b.includes(I)?b.filter(j=>j!==I):[...b,I])},T=()=>{o.length>0&&(s(t,o,p||void 0),l([]),g(""),h(""),e())},A=()=>{l([]),g(""),h(""),e()};return m.jsx(Ta,{open:n,onOpenChange:A,children:m.jsxs(Ca,{className:"bg-gray-900 border-gray-700 text-white max-w-md max-h-[80vh] p-0",children:[m.jsxs(Sa,{className:"p-4 border-b border-gray-700",children:[m.jsx(Ia,{className:"text-center",children:"Share Post"}),m.jsx(hc,{className:"text-center text-gray-400",children:"Share this post with your friends and connections"}),m.jsx(ue,{variant:"ghost",size:"sm",onClick:A,className:"absolute right-4 top-4 text-gray-400 hover:text-white",children:m.jsx(xa,{className:"w-5 h-5"})})]}),m.jsx("div",{className:"p-4 border-b border-gray-700",children:m.jsxs("div",{className:"relative",children:[m.jsx(op,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 w-4 h-4 text-gray-400"}),m.jsx(ln,{value:u,onChange:I=>h(I.target.value),placeholder:"Search users...",className:"pl-10 bg-gray-800 border-gray-600 text-white placeholder-gray-400"})]})}),m.jsx(Bw,{className:"flex-1 max-h-[300px]",children:m.jsxs("div",{className:"p-4 space-y-3",children:[_.map(I=>m.jsxs("div",{className:"flex items-center gap-3 p-2 rounded-lg hover:bg-gray-800/50",children:[m.jsx(WB,{checked:o.includes(I.id),onCheckedChange:()=>v(I.id),className:"border-gray-600"}),m.jsxs("div",{className:"relative",children:[m.jsxs(nr,{className:"w-10 h-10",children:[m.jsx(rr,{src:I.avatar}),m.jsx(sr,{className:"bg-gray-700 text-white",children:I.displayName.charAt(0)})]}),m.jsx("div",{className:`absolute -bottom-1 -right-1 w-3 h-3 rounded-full border-2 border-gray-900 ${I.isOnline?"bg-green-500":"bg-gray-500"}`})]}),m.jsxs("div",{className:"flex-1",children:[m.jsx("p",{className:"text-white font-medium",children:I.displayName}),m.jsxs("p",{className:"text-gray-400 text-sm",children:["@",I.username]})]})]},I.id)),_.length===0&&m.jsx("div",{className:"text-center py-8",children:m.jsx("p",{className:"text-gray-400",children:"No users found"})})]})}),o.length>0&&m.jsx("div",{className:"px-4 py-2 bg-gray-800/50",children:m.jsxs("p",{className:"text-sm text-gray-300",children:[o.length," user",o.length!==1?"s":""," selected"]})}),m.jsxs("div",{className:"p-4 border-t border-gray-700",children:[m.jsx(ln,{value:p,onChange:I=>g(I.target.value),placeholder:"Add a message (optional)...",className:"mb-3 bg-gray-800 border-gray-600 text-white placeholder-gray-400"}),m.jsxs("div",{className:"flex gap-2",children:[m.jsx(ue,{variant:"outline",onClick:A,className:"flex-1 border-gray-600 text-gray-300 hover:bg-gray-700",children:"Cancel"}),m.jsxs(ue,{onClick:T,disabled:o.length===0,className:"flex-1 bg-green-600 hover:bg-green-700 text-white",children:[m.jsx(ma,{className:"w-4 h-4 mr-2"}),"Share"]})]})]})]})})}function oN(n){const e=n+"CollectionProvider",[t,r]=ci(e),[s,o]=t(e,{collectionRef:{current:null},itemMap:new Map}),l=I=>{const{scope:b,children:j}=I,U=$i.useRef(null),$=$i.useRef(new Map).current;return m.jsx(s,{scope:b,itemMap:$,collectionRef:U,children:j})};l.displayName=e;const u=n+"CollectionSlot",h=Yl(u),p=$i.forwardRef((I,b)=>{const{scope:j,children:U}=I,$=o(u,j),G=Et(b,$.collectionRef);return m.jsx(h,{ref:G,children:U})});p.displayName=u;const g=n+"CollectionItemSlot",_="data-radix-collection-item",v=Yl(g),T=$i.forwardRef((I,b)=>{const{scope:j,children:U,...$}=I,G=$i.useRef(null),X=Et(b,G),ne=o(g,j);return $i.useEffect(()=>(ne.itemMap.set(G,{ref:G,...$}),()=>void ne.itemMap.delete(G))),m.jsx(v,{[_]:"",ref:X,children:U})});T.displayName=g;function A(I){const b=o(n+"CollectionConsumer",I);return $i.useCallback(()=>{const U=b.collectionRef.current;if(!U)return[];const $=Array.from(U.querySelectorAll(`[${_}]`));return Array.from(b.itemMap.values()).sort((ne,P)=>$.indexOf(ne.ref.current)-$.indexOf(P.ref.current))},[b.collectionRef,b.itemMap])}return[{Provider:l,Slot:p,ItemSlot:T},A,r]}const qB=["top","right","bottom","left"],yo=Math.min,Xn=Math.max,up=Math.round,of=Math.floor,ms=n=>({x:n,y:n}),GB={left:"right",right:"left",bottom:"top",top:"bottom"},KB={start:"end",end:"start"};function R_(n,e,t){return Xn(n,yo(e,t))}function ii(n,e){return typeof n=="function"?n(e):n}function oi(n){return n.split("-")[0]}function fc(n){return n.split("-")[1]}function Ww(n){return n==="x"?"y":"x"}function Hw(n){return n==="y"?"height":"width"}const QB=new Set(["top","bottom"]);function as(n){return QB.has(oi(n))?"y":"x"}function qw(n){return Ww(as(n))}function YB(n,e,t){t===void 0&&(t=!1);const r=fc(n),s=qw(n),o=Hw(s);let l=s==="x"?r===(t?"end":"start")?"right":"left":r==="start"?"bottom":"top";return e.reference[o]>e.floating[o]&&(l=dp(l)),[l,dp(l)]}function XB(n){const e=dp(n);return[A_(n),e,A_(e)]}function A_(n){return n.replace(/start|end/g,e=>KB[e])}const _S=["left","right"],vS=["right","left"],JB=["top","bottom"],ZB=["bottom","top"];function e$(n,e,t){switch(n){case"top":case"bottom":return t?e?vS:_S:e?_S:vS;case"left":case"right":return e?JB:ZB;default:return[]}}function t$(n,e,t,r){const s=fc(n);let o=e$(oi(n),t==="start",r);return s&&(o=o.map(l=>l+"-"+s),e&&(o=o.concat(o.map(A_)))),o}function dp(n){return n.replace(/left|right|bottom|top/g,e=>GB[e])}function n$(n){return{top:0,right:0,bottom:0,left:0,...n}}function aN(n){return typeof n!="number"?n$(n):{top:n,right:n,bottom:n,left:n}}function hp(n){const{x:e,y:t,width:r,height:s}=n;return{width:r,height:s,top:t,left:e,right:e+r,bottom:t+s,x:e,y:t}}function wS(n,e,t){let{reference:r,floating:s}=n;const o=as(e),l=qw(e),u=Hw(l),h=oi(e),p=o==="y",g=r.x+r.width/2-s.width/2,_=r.y+r.height/2-s.height/2,v=r[u]/2-s[u]/2;let T;switch(h){case"top":T={x:g,y:r.y-s.height};break;case"bottom":T={x:g,y:r.y+r.height};break;case"right":T={x:r.x+r.width,y:_};break;case"left":T={x:r.x-s.width,y:_};break;default:T={x:r.x,y:r.y}}switch(fc(e)){case"start":T[l]-=v*(t&&p?-1:1);break;case"end":T[l]+=v*(t&&p?-1:1);break}return T}const r$=async(n,e,t)=>{const{placement:r="bottom",strategy:s="absolute",middleware:o=[],platform:l}=t,u=o.filter(Boolean),h=await(l.isRTL==null?void 0:l.isRTL(e));let p=await l.getElementRects({reference:n,floating:e,strategy:s}),{x:g,y:_}=wS(p,r,h),v=r,T={},A=0;for(let I=0;I<u.length;I++){const{name:b,fn:j}=u[I],{x:U,y:$,data:G,reset:X}=await j({x:g,y:_,initialPlacement:r,placement:v,strategy:s,middlewareData:T,rects:p,platform:l,elements:{reference:n,floating:e}});g=U??g,_=$??_,T={...T,[b]:{...T[b],...G}},X&&A<=50&&(A++,typeof X=="object"&&(X.placement&&(v=X.placement),X.rects&&(p=X.rects===!0?await l.getElementRects({reference:n,floating:e,strategy:s}):X.rects),{x:g,y:_}=wS(p,v,h)),I=-1)}return{x:g,y:_,placement:v,strategy:s,middlewareData:T}};async function td(n,e){var t;e===void 0&&(e={});const{x:r,y:s,platform:o,rects:l,elements:u,strategy:h}=n,{boundary:p="clippingAncestors",rootBoundary:g="viewport",elementContext:_="floating",altBoundary:v=!1,padding:T=0}=ii(e,n),A=aN(T),b=u[v?_==="floating"?"reference":"floating":_],j=hp(await o.getClippingRect({element:(t=await(o.isElement==null?void 0:o.isElement(b)))==null||t?b:b.contextElement||await(o.getDocumentElement==null?void 0:o.getDocumentElement(u.floating)),boundary:p,rootBoundary:g,strategy:h})),U=_==="floating"?{x:r,y:s,width:l.floating.width,height:l.floating.height}:l.reference,$=await(o.getOffsetParent==null?void 0:o.getOffsetParent(u.floating)),G=await(o.isElement==null?void 0:o.isElement($))?await(o.getScale==null?void 0:o.getScale($))||{x:1,y:1}:{x:1,y:1},X=hp(o.convertOffsetParentRelativeRectToViewportRelativeRect?await o.convertOffsetParentRelativeRectToViewportRelativeRect({elements:u,rect:U,offsetParent:$,strategy:h}):U);return{top:(j.top-X.top+A.top)/G.y,bottom:(X.bottom-j.bottom+A.bottom)/G.y,left:(j.left-X.left+A.left)/G.x,right:(X.right-j.right+A.right)/G.x}}const s$=n=>({name:"arrow",options:n,async fn(e){const{x:t,y:r,placement:s,rects:o,platform:l,elements:u,middlewareData:h}=e,{element:p,padding:g=0}=ii(n,e)||{};if(p==null)return{};const _=aN(g),v={x:t,y:r},T=qw(s),A=Hw(T),I=await l.getDimensions(p),b=T==="y",j=b?"top":"left",U=b?"bottom":"right",$=b?"clientHeight":"clientWidth",G=o.reference[A]+o.reference[T]-v[T]-o.floating[A],X=v[T]-o.reference[T],ne=await(l.getOffsetParent==null?void 0:l.getOffsetParent(p));let P=ne?ne[$]:0;(!P||!await(l.isElement==null?void 0:l.isElement(ne)))&&(P=u.floating[$]||o.floating[A]);const R=G/2-X/2,N=P/2-I[A]/2-1,L=yo(_[j],N),O=yo(_[U],N),F=L,D=P-I[A]-O,Ce=P/2-I[A]/2+R,je=R_(F,Ce,D),Se=!h.arrow&&fc(s)!=null&&Ce!==je&&o.reference[A]/2-(Ce<F?L:O)-I[A]/2<0,Ie=Se?Ce<F?Ce-F:Ce-D:0;return{[T]:v[T]+Ie,data:{[T]:je,centerOffset:Ce-je-Ie,...Se&&{alignmentOffset:Ie}},reset:Se}}}),i$=function(n){return n===void 0&&(n={}),{name:"flip",options:n,async fn(e){var t,r;const{placement:s,middlewareData:o,rects:l,initialPlacement:u,platform:h,elements:p}=e,{mainAxis:g=!0,crossAxis:_=!0,fallbackPlacements:v,fallbackStrategy:T="bestFit",fallbackAxisSideDirection:A="none",flipAlignment:I=!0,...b}=ii(n,e);if((t=o.arrow)!=null&&t.alignmentOffset)return{};const j=oi(s),U=as(u),$=oi(u)===u,G=await(h.isRTL==null?void 0:h.isRTL(p.floating)),X=v||($||!I?[dp(u)]:XB(u)),ne=A!=="none";!v&&ne&&X.push(...t$(u,I,A,G));const P=[u,...X],R=await td(e,b),N=[];let L=((r=o.flip)==null?void 0:r.overflows)||[];if(g&&N.push(R[j]),_){const Ce=YB(s,l,G);N.push(R[Ce[0]],R[Ce[1]])}if(L=[...L,{placement:s,overflows:N}],!N.every(Ce=>Ce<=0)){var O,F;const Ce=(((O=o.flip)==null?void 0:O.index)||0)+1,je=P[Ce];if(je&&(!(_==="alignment"?U!==as(je):!1)||L.every(W=>as(W.placement)===U?W.overflows[0]>0:!0)))return{data:{index:Ce,overflows:L},reset:{placement:je}};let Se=(F=L.filter(Ie=>Ie.overflows[0]<=0).sort((Ie,W)=>Ie.overflows[1]-W.overflows[1])[0])==null?void 0:F.placement;if(!Se)switch(T){case"bestFit":{var D;const Ie=(D=L.filter(W=>{if(ne){const J=as(W.placement);return J===U||J==="y"}return!0}).map(W=>[W.placement,W.overflows.filter(J=>J>0).reduce((J,oe)=>J+oe,0)]).sort((W,J)=>W[1]-J[1])[0])==null?void 0:D[0];Ie&&(Se=Ie);break}case"initialPlacement":Se=u;break}if(s!==Se)return{reset:{placement:Se}}}return{}}}};function ES(n,e){return{top:n.top-e.height,right:n.right-e.width,bottom:n.bottom-e.height,left:n.left-e.width}}function xS(n){return qB.some(e=>n[e]>=0)}const o$=function(n){return n===void 0&&(n={}),{name:"hide",options:n,async fn(e){const{rects:t}=e,{strategy:r="referenceHidden",...s}=ii(n,e);switch(r){case"referenceHidden":{const o=await td(e,{...s,elementContext:"reference"}),l=ES(o,t.reference);return{data:{referenceHiddenOffsets:l,referenceHidden:xS(l)}}}case"escaped":{const o=await td(e,{...s,altBoundary:!0}),l=ES(o,t.floating);return{data:{escapedOffsets:l,escaped:xS(l)}}}default:return{}}}}},lN=new Set(["left","top"]);async function a$(n,e){const{placement:t,platform:r,elements:s}=n,o=await(r.isRTL==null?void 0:r.isRTL(s.floating)),l=oi(t),u=fc(t),h=as(t)==="y",p=lN.has(l)?-1:1,g=o&&h?-1:1,_=ii(e,n);let{mainAxis:v,crossAxis:T,alignmentAxis:A}=typeof _=="number"?{mainAxis:_,crossAxis:0,alignmentAxis:null}:{mainAxis:_.mainAxis||0,crossAxis:_.crossAxis||0,alignmentAxis:_.alignmentAxis};return u&&typeof A=="number"&&(T=u==="end"?A*-1:A),h?{x:T*g,y:v*p}:{x:v*p,y:T*g}}const l$=function(n){return n===void 0&&(n=0),{name:"offset",options:n,async fn(e){var t,r;const{x:s,y:o,placement:l,middlewareData:u}=e,h=await a$(e,n);return l===((t=u.offset)==null?void 0:t.placement)&&(r=u.arrow)!=null&&r.alignmentOffset?{}:{x:s+h.x,y:o+h.y,data:{...h,placement:l}}}}},c$=function(n){return n===void 0&&(n={}),{name:"shift",options:n,async fn(e){const{x:t,y:r,placement:s}=e,{mainAxis:o=!0,crossAxis:l=!1,limiter:u={fn:b=>{let{x:j,y:U}=b;return{x:j,y:U}}},...h}=ii(n,e),p={x:t,y:r},g=await td(e,h),_=as(oi(s)),v=Ww(_);let T=p[v],A=p[_];if(o){const b=v==="y"?"top":"left",j=v==="y"?"bottom":"right",U=T+g[b],$=T-g[j];T=R_(U,T,$)}if(l){const b=_==="y"?"top":"left",j=_==="y"?"bottom":"right",U=A+g[b],$=A-g[j];A=R_(U,A,$)}const I=u.fn({...e,[v]:T,[_]:A});return{...I,data:{x:I.x-t,y:I.y-r,enabled:{[v]:o,[_]:l}}}}}},u$=function(n){return n===void 0&&(n={}),{options:n,fn(e){const{x:t,y:r,placement:s,rects:o,middlewareData:l}=e,{offset:u=0,mainAxis:h=!0,crossAxis:p=!0}=ii(n,e),g={x:t,y:r},_=as(s),v=Ww(_);let T=g[v],A=g[_];const I=ii(u,e),b=typeof I=="number"?{mainAxis:I,crossAxis:0}:{mainAxis:0,crossAxis:0,...I};if(h){const $=v==="y"?"height":"width",G=o.reference[v]-o.floating[$]+b.mainAxis,X=o.reference[v]+o.reference[$]-b.mainAxis;T<G?T=G:T>X&&(T=X)}if(p){var j,U;const $=v==="y"?"width":"height",G=lN.has(oi(s)),X=o.reference[_]-o.floating[$]+(G&&((j=l.offset)==null?void 0:j[_])||0)+(G?0:b.crossAxis),ne=o.reference[_]+o.reference[$]+(G?0:((U=l.offset)==null?void 0:U[_])||0)-(G?b.crossAxis:0);A<X?A=X:A>ne&&(A=ne)}return{[v]:T,[_]:A}}}},d$=function(n){return n===void 0&&(n={}),{name:"size",options:n,async fn(e){var t,r;const{placement:s,rects:o,platform:l,elements:u}=e,{apply:h=()=>{},...p}=ii(n,e),g=await td(e,p),_=oi(s),v=fc(s),T=as(s)==="y",{width:A,height:I}=o.floating;let b,j;_==="top"||_==="bottom"?(b=_,j=v===(await(l.isRTL==null?void 0:l.isRTL(u.floating))?"start":"end")?"left":"right"):(j=_,b=v==="end"?"top":"bottom");const U=I-g.top-g.bottom,$=A-g.left-g.right,G=yo(I-g[b],U),X=yo(A-g[j],$),ne=!e.middlewareData.shift;let P=G,R=X;if((t=e.middlewareData.shift)!=null&&t.enabled.x&&(R=$),(r=e.middlewareData.shift)!=null&&r.enabled.y&&(P=U),ne&&!v){const L=Xn(g.left,0),O=Xn(g.right,0),F=Xn(g.top,0),D=Xn(g.bottom,0);T?R=A-2*(L!==0||O!==0?L+O:Xn(g.left,g.right)):P=I-2*(F!==0||D!==0?F+D:Xn(g.top,g.bottom))}await h({...e,availableWidth:R,availableHeight:P});const N=await l.getDimensions(u.floating);return A!==N.width||I!==N.height?{reset:{rects:!0}}:{}}}};function pm(){return typeof window<"u"}function pc(n){return cN(n)?(n.nodeName||"").toLowerCase():"#document"}function tr(n){var e;return(n==null||(e=n.ownerDocument)==null?void 0:e.defaultView)||window}function Ts(n){var e;return(e=(cN(n)?n.ownerDocument:n.document)||window.document)==null?void 0:e.documentElement}function cN(n){return pm()?n instanceof Node||n instanceof tr(n).Node:!1}function jr(n){return pm()?n instanceof Element||n instanceof tr(n).Element:!1}function _s(n){return pm()?n instanceof HTMLElement||n instanceof tr(n).HTMLElement:!1}function TS(n){return!pm()||typeof ShadowRoot>"u"?!1:n instanceof ShadowRoot||n instanceof tr(n).ShadowRoot}const h$=new Set(["inline","contents"]);function Td(n){const{overflow:e,overflowX:t,overflowY:r,display:s}=Vr(n);return/auto|scroll|overlay|hidden|clip/.test(e+r+t)&&!h$.has(s)}const f$=new Set(["table","td","th"]);function p$(n){return f$.has(pc(n))}const m$=[":popover-open",":modal"];function mm(n){return m$.some(e=>{try{return n.matches(e)}catch{return!1}})}const g$=["transform","translate","scale","rotate","perspective"],y$=["transform","translate","scale","rotate","perspective","filter"],_$=["paint","layout","strict","content"];function Gw(n){const e=Kw(),t=jr(n)?Vr(n):n;return g$.some(r=>t[r]?t[r]!=="none":!1)||(t.containerType?t.containerType!=="normal":!1)||!e&&(t.backdropFilter?t.backdropFilter!=="none":!1)||!e&&(t.filter?t.filter!=="none":!1)||y$.some(r=>(t.willChange||"").includes(r))||_$.some(r=>(t.contain||"").includes(r))}function v$(n){let e=_o(n);for(;_s(e)&&!Jl(e);){if(Gw(e))return e;if(mm(e))return null;e=_o(e)}return null}function Kw(){return typeof CSS>"u"||!CSS.supports?!1:CSS.supports("-webkit-backdrop-filter","none")}const w$=new Set(["html","body","#document"]);function Jl(n){return w$.has(pc(n))}function Vr(n){return tr(n).getComputedStyle(n)}function gm(n){return jr(n)?{scrollLeft:n.scrollLeft,scrollTop:n.scrollTop}:{scrollLeft:n.scrollX,scrollTop:n.scrollY}}function _o(n){if(pc(n)==="html")return n;const e=n.assignedSlot||n.parentNode||TS(n)&&n.host||Ts(n);return TS(e)?e.host:e}function uN(n){const e=_o(n);return Jl(e)?n.ownerDocument?n.ownerDocument.body:n.body:_s(e)&&Td(e)?e:uN(e)}function nd(n,e,t){var r;e===void 0&&(e=[]),t===void 0&&(t=!0);const s=uN(n),o=s===((r=n.ownerDocument)==null?void 0:r.body),l=tr(s);if(o){const u=k_(l);return e.concat(l,l.visualViewport||[],Td(s)?s:[],u&&t?nd(u):[])}return e.concat(s,nd(s,[],t))}function k_(n){return n.parent&&Object.getPrototypeOf(n.parent)?n.frameElement:null}function dN(n){const e=Vr(n);let t=parseFloat(e.width)||0,r=parseFloat(e.height)||0;const s=_s(n),o=s?n.offsetWidth:t,l=s?n.offsetHeight:r,u=up(t)!==o||up(r)!==l;return u&&(t=o,r=l),{width:t,height:r,$:u}}function Qw(n){return jr(n)?n:n.contextElement}function Ml(n){const e=Qw(n);if(!_s(e))return ms(1);const t=e.getBoundingClientRect(),{width:r,height:s,$:o}=dN(e);let l=(o?up(t.width):t.width)/r,u=(o?up(t.height):t.height)/s;return(!l||!Number.isFinite(l))&&(l=1),(!u||!Number.isFinite(u))&&(u=1),{x:l,y:u}}const E$=ms(0);function hN(n){const e=tr(n);return!Kw()||!e.visualViewport?E$:{x:e.visualViewport.offsetLeft,y:e.visualViewport.offsetTop}}function x$(n,e,t){return e===void 0&&(e=!1),!t||e&&t!==tr(n)?!1:e}function ya(n,e,t,r){e===void 0&&(e=!1),t===void 0&&(t=!1);const s=n.getBoundingClientRect(),o=Qw(n);let l=ms(1);e&&(r?jr(r)&&(l=Ml(r)):l=Ml(n));const u=x$(o,t,r)?hN(o):ms(0);let h=(s.left+u.x)/l.x,p=(s.top+u.y)/l.y,g=s.width/l.x,_=s.height/l.y;if(o){const v=tr(o),T=r&&jr(r)?tr(r):r;let A=v,I=k_(A);for(;I&&r&&T!==A;){const b=Ml(I),j=I.getBoundingClientRect(),U=Vr(I),$=j.left+(I.clientLeft+parseFloat(U.paddingLeft))*b.x,G=j.top+(I.clientTop+parseFloat(U.paddingTop))*b.y;h*=b.x,p*=b.y,g*=b.x,_*=b.y,h+=$,p+=G,A=tr(I),I=k_(A)}}return hp({width:g,height:_,x:h,y:p})}function ym(n,e){const t=gm(n).scrollLeft;return e?e.left+t:ya(Ts(n)).left+t}function fN(n,e){const t=n.getBoundingClientRect(),r=t.left+e.scrollLeft-ym(n,t),s=t.top+e.scrollTop;return{x:r,y:s}}function T$(n){let{elements:e,rect:t,offsetParent:r,strategy:s}=n;const o=s==="fixed",l=Ts(r),u=e?mm(e.floating):!1;if(r===l||u&&o)return t;let h={scrollLeft:0,scrollTop:0},p=ms(1);const g=ms(0),_=_s(r);if((_||!_&&!o)&&((pc(r)!=="body"||Td(l))&&(h=gm(r)),_s(r))){const T=ya(r);p=Ml(r),g.x=T.x+r.clientLeft,g.y=T.y+r.clientTop}const v=l&&!_&&!o?fN(l,h):ms(0);return{width:t.width*p.x,height:t.height*p.y,x:t.x*p.x-h.scrollLeft*p.x+g.x+v.x,y:t.y*p.y-h.scrollTop*p.y+g.y+v.y}}function C$(n){return Array.from(n.getClientRects())}function S$(n){const e=Ts(n),t=gm(n),r=n.ownerDocument.body,s=Xn(e.scrollWidth,e.clientWidth,r.scrollWidth,r.clientWidth),o=Xn(e.scrollHeight,e.clientHeight,r.scrollHeight,r.clientHeight);let l=-t.scrollLeft+ym(n);const u=-t.scrollTop;return Vr(r).direction==="rtl"&&(l+=Xn(e.clientWidth,r.clientWidth)-s),{width:s,height:o,x:l,y:u}}const CS=25;function I$(n,e){const t=tr(n),r=Ts(n),s=t.visualViewport;let o=r.clientWidth,l=r.clientHeight,u=0,h=0;if(s){o=s.width,l=s.height;const g=Kw();(!g||g&&e==="fixed")&&(u=s.offsetLeft,h=s.offsetTop)}const p=ym(r);if(p<=0){const g=r.ownerDocument,_=g.body,v=getComputedStyle(_),T=g.compatMode==="CSS1Compat"&&parseFloat(v.marginLeft)+parseFloat(v.marginRight)||0,A=Math.abs(r.clientWidth-_.clientWidth-T);A<=CS&&(o-=A)}else p<=CS&&(o+=p);return{width:o,height:l,x:u,y:h}}const b$=new Set(["absolute","fixed"]);function R$(n,e){const t=ya(n,!0,e==="fixed"),r=t.top+n.clientTop,s=t.left+n.clientLeft,o=_s(n)?Ml(n):ms(1),l=n.clientWidth*o.x,u=n.clientHeight*o.y,h=s*o.x,p=r*o.y;return{width:l,height:u,x:h,y:p}}function SS(n,e,t){let r;if(e==="viewport")r=I$(n,t);else if(e==="document")r=S$(Ts(n));else if(jr(e))r=R$(e,t);else{const s=hN(n);r={x:e.x-s.x,y:e.y-s.y,width:e.width,height:e.height}}return hp(r)}function pN(n,e){const t=_o(n);return t===e||!jr(t)||Jl(t)?!1:Vr(t).position==="fixed"||pN(t,e)}function A$(n,e){const t=e.get(n);if(t)return t;let r=nd(n,[],!1).filter(u=>jr(u)&&pc(u)!=="body"),s=null;const o=Vr(n).position==="fixed";let l=o?_o(n):n;for(;jr(l)&&!Jl(l);){const u=Vr(l),h=Gw(l);!h&&u.position==="fixed"&&(s=null),(o?!h&&!s:!h&&u.position==="static"&&!!s&&b$.has(s.position)||Td(l)&&!h&&pN(n,l))?r=r.filter(g=>g!==l):s=u,l=_o(l)}return e.set(n,r),r}function k$(n){let{element:e,boundary:t,rootBoundary:r,strategy:s}=n;const l=[...t==="clippingAncestors"?mm(e)?[]:A$(e,this._c):[].concat(t),r],u=l[0],h=l.reduce((p,g)=>{const _=SS(e,g,s);return p.top=Xn(_.top,p.top),p.right=yo(_.right,p.right),p.bottom=yo(_.bottom,p.bottom),p.left=Xn(_.left,p.left),p},SS(e,u,s));return{width:h.right-h.left,height:h.bottom-h.top,x:h.left,y:h.top}}function N$(n){const{width:e,height:t}=dN(n);return{width:e,height:t}}function P$(n,e,t){const r=_s(e),s=Ts(e),o=t==="fixed",l=ya(n,!0,o,e);let u={scrollLeft:0,scrollTop:0};const h=ms(0);function p(){h.x=ym(s)}if(r||!r&&!o)if((pc(e)!=="body"||Td(s))&&(u=gm(e)),r){const T=ya(e,!0,o,e);h.x=T.x+e.clientLeft,h.y=T.y+e.clientTop}else s&&p();o&&!r&&s&&p();const g=s&&!r&&!o?fN(s,u):ms(0),_=l.left+u.scrollLeft-h.x-g.x,v=l.top+u.scrollTop-h.y-g.y;return{x:_,y:v,width:l.width,height:l.height}}function by(n){return Vr(n).position==="static"}function IS(n,e){if(!_s(n)||Vr(n).position==="fixed")return null;if(e)return e(n);let t=n.offsetParent;return Ts(n)===t&&(t=t.ownerDocument.body),t}function mN(n,e){const t=tr(n);if(mm(n))return t;if(!_s(n)){let s=_o(n);for(;s&&!Jl(s);){if(jr(s)&&!by(s))return s;s=_o(s)}return t}let r=IS(n,e);for(;r&&p$(r)&&by(r);)r=IS(r,e);return r&&Jl(r)&&by(r)&&!Gw(r)?t:r||v$(n)||t}const D$=async function(n){const e=this.getOffsetParent||mN,t=this.getDimensions,r=await t(n.floating);return{reference:P$(n.reference,await e(n.floating),n.strategy),floating:{x:0,y:0,width:r.width,height:r.height}}};function O$(n){return Vr(n).direction==="rtl"}const M$={convertOffsetParentRelativeRectToViewportRelativeRect:T$,getDocumentElement:Ts,getClippingRect:k$,getOffsetParent:mN,getElementRects:D$,getClientRects:C$,getDimensions:N$,getScale:Ml,isElement:jr,isRTL:O$};function gN(n,e){return n.x===e.x&&n.y===e.y&&n.width===e.width&&n.height===e.height}function L$(n,e){let t=null,r;const s=Ts(n);function o(){var u;clearTimeout(r),(u=t)==null||u.disconnect(),t=null}function l(u,h){u===void 0&&(u=!1),h===void 0&&(h=1),o();const p=n.getBoundingClientRect(),{left:g,top:_,width:v,height:T}=p;if(u||e(),!v||!T)return;const A=of(_),I=of(s.clientWidth-(g+v)),b=of(s.clientHeight-(_+T)),j=of(g),$={rootMargin:-A+"px "+-I+"px "+-b+"px "+-j+"px",threshold:Xn(0,yo(1,h))||1};let G=!0;function X(ne){const P=ne[0].intersectionRatio;if(P!==h){if(!G)return l();P?l(!1,P):r=setTimeout(()=>{l(!1,1e-7)},1e3)}P===1&&!gN(p,n.getBoundingClientRect())&&l(),G=!1}try{t=new IntersectionObserver(X,{...$,root:s.ownerDocument})}catch{t=new IntersectionObserver(X,$)}t.observe(n)}return l(!0),o}function j$(n,e,t,r){r===void 0&&(r={});const{ancestorScroll:s=!0,ancestorResize:o=!0,elementResize:l=typeof ResizeObserver=="function",layoutShift:u=typeof IntersectionObserver=="function",animationFrame:h=!1}=r,p=Qw(n),g=s||o?[...p?nd(p):[],...nd(e)]:[];g.forEach(j=>{s&&j.addEventListener("scroll",t,{passive:!0}),o&&j.addEventListener("resize",t)});const _=p&&u?L$(p,t):null;let v=-1,T=null;l&&(T=new ResizeObserver(j=>{let[U]=j;U&&U.target===p&&T&&(T.unobserve(e),cancelAnimationFrame(v),v=requestAnimationFrame(()=>{var $;($=T)==null||$.observe(e)})),t()}),p&&!h&&T.observe(p),T.observe(e));let A,I=h?ya(n):null;h&&b();function b(){const j=ya(n);I&&!gN(I,j)&&t(),I=j,A=requestAnimationFrame(b)}return t(),()=>{var j;g.forEach(U=>{s&&U.removeEventListener("scroll",t),o&&U.removeEventListener("resize",t)}),_?.(),(j=T)==null||j.disconnect(),T=null,h&&cancelAnimationFrame(A)}}const V$=l$,F$=c$,U$=i$,z$=d$,B$=o$,bS=s$,$$=u$,W$=(n,e,t)=>{const r=new Map,s={platform:M$,...t},o={...s.platform,_c:r};return r$(n,e,{...s,platform:o})};var H$=typeof document<"u",q$=function(){},Ef=H$?C.useLayoutEffect:q$;function fp(n,e){if(n===e)return!0;if(typeof n!=typeof e)return!1;if(typeof n=="function"&&n.toString()===e.toString())return!0;let t,r,s;if(n&&e&&typeof n=="object"){if(Array.isArray(n)){if(t=n.length,t!==e.length)return!1;for(r=t;r--!==0;)if(!fp(n[r],e[r]))return!1;return!0}if(s=Object.keys(n),t=s.length,t!==Object.keys(e).length)return!1;for(r=t;r--!==0;)if(!{}.hasOwnProperty.call(e,s[r]))return!1;for(r=t;r--!==0;){const o=s[r];if(!(o==="_owner"&&n.$$typeof)&&!fp(n[o],e[o]))return!1}return!0}return n!==n&&e!==e}function yN(n){return typeof window>"u"?1:(n.ownerDocument.defaultView||window).devicePixelRatio||1}function RS(n,e){const t=yN(n);return Math.round(e*t)/t}function Ry(n){const e=C.useRef(n);return Ef(()=>{e.current=n}),e}function G$(n){n===void 0&&(n={});const{placement:e="bottom",strategy:t="absolute",middleware:r=[],platform:s,elements:{reference:o,floating:l}={},transform:u=!0,whileElementsMounted:h,open:p}=n,[g,_]=C.useState({x:0,y:0,strategy:t,placement:e,middlewareData:{},isPositioned:!1}),[v,T]=C.useState(r);fp(v,r)||T(r);const[A,I]=C.useState(null),[b,j]=C.useState(null),U=C.useCallback(W=>{W!==ne.current&&(ne.current=W,I(W))},[]),$=C.useCallback(W=>{W!==P.current&&(P.current=W,j(W))},[]),G=o||A,X=l||b,ne=C.useRef(null),P=C.useRef(null),R=C.useRef(g),N=h!=null,L=Ry(h),O=Ry(s),F=Ry(p),D=C.useCallback(()=>{if(!ne.current||!P.current)return;const W={placement:e,strategy:t,middleware:v};O.current&&(W.platform=O.current),W$(ne.current,P.current,W).then(J=>{const oe={...J,isPositioned:F.current!==!1};Ce.current&&!fp(R.current,oe)&&(R.current=oe,Aw.flushSync(()=>{_(oe)}))})},[v,e,t,O,F]);Ef(()=>{p===!1&&R.current.isPositioned&&(R.current.isPositioned=!1,_(W=>({...W,isPositioned:!1})))},[p]);const Ce=C.useRef(!1);Ef(()=>(Ce.current=!0,()=>{Ce.current=!1}),[]),Ef(()=>{if(G&&(ne.current=G),X&&(P.current=X),G&&X){if(L.current)return L.current(G,X,D);D()}},[G,X,D,L,N]);const je=C.useMemo(()=>({reference:ne,floating:P,setReference:U,setFloating:$}),[U,$]),Se=C.useMemo(()=>({reference:G,floating:X}),[G,X]),Ie=C.useMemo(()=>{const W={position:t,left:0,top:0};if(!Se.floating)return W;const J=RS(Se.floating,g.x),oe=RS(Se.floating,g.y);return u?{...W,transform:"translate("+J+"px, "+oe+"px)",...yN(Se.floating)>=1.5&&{willChange:"transform"}}:{position:t,left:J,top:oe}},[t,u,Se.floating,g.x,g.y]);return C.useMemo(()=>({...g,update:D,refs:je,elements:Se,floatingStyles:Ie}),[g,D,je,Se,Ie])}const K$=n=>{function e(t){return{}.hasOwnProperty.call(t,"current")}return{name:"arrow",options:n,fn(t){const{element:r,padding:s}=typeof n=="function"?n(t):n;return r&&e(r)?r.current!=null?bS({element:r.current,padding:s}).fn(t):{}:r?bS({element:r,padding:s}).fn(t):{}}}},Q$=(n,e)=>({...V$(n),options:[n,e]}),Y$=(n,e)=>({...F$(n),options:[n,e]}),X$=(n,e)=>({...$$(n),options:[n,e]}),J$=(n,e)=>({...U$(n),options:[n,e]}),Z$=(n,e)=>({...z$(n),options:[n,e]}),e8=(n,e)=>({...B$(n),options:[n,e]}),t8=(n,e)=>({...K$(n),options:[n,e]});var n8="Arrow",_N=C.forwardRef((n,e)=>{const{children:t,width:r=10,height:s=5,...o}=n;return m.jsx(st.svg,{...o,ref:e,width:r,height:s,viewBox:"0 0 30 10",preserveAspectRatio:"none",children:n.asChild?t:m.jsx("polygon",{points:"0,0 30,0 15,10"})})});_N.displayName=n8;var r8=_N,Yw="Popper",[vN,wN]=ci(Yw),[s8,EN]=vN(Yw),xN=n=>{const{__scopePopper:e,children:t}=n,[r,s]=C.useState(null);return m.jsx(s8,{scope:e,anchor:r,onAnchorChange:s,children:t})};xN.displayName=Yw;var TN="PopperAnchor",CN=C.forwardRef((n,e)=>{const{__scopePopper:t,virtualRef:r,...s}=n,o=EN(TN,t),l=C.useRef(null),u=Et(e,l),h=C.useRef(null);return C.useEffect(()=>{const p=h.current;h.current=r?.current||l.current,p!==h.current&&o.onAnchorChange(h.current)}),r?null:m.jsx(st.div,{...s,ref:u})});CN.displayName=TN;var Xw="PopperContent",[i8,o8]=vN(Xw),SN=C.forwardRef((n,e)=>{const{__scopePopper:t,side:r="bottom",sideOffset:s=0,align:o="center",alignOffset:l=0,arrowPadding:u=0,avoidCollisions:h=!0,collisionBoundary:p=[],collisionPadding:g=0,sticky:_="partial",hideWhenDetached:v=!1,updatePositionStrategy:T="optimized",onPlaced:A,...I}=n,b=EN(Xw,t),[j,U]=C.useState(null),$=Et(e,he=>U(he)),[G,X]=C.useState(null),ne=Xk(G),P=ne?.width??0,R=ne?.height??0,N=r+(o!=="center"?"-"+o:""),L=typeof g=="number"?g:{top:0,right:0,bottom:0,left:0,...g},O=Array.isArray(p)?p:[p],F=O.length>0,D={padding:L,boundary:O.filter(l8),altBoundary:F},{refs:Ce,floatingStyles:je,placement:Se,isPositioned:Ie,middlewareData:W}=G$({strategy:"fixed",placement:N,whileElementsMounted:(...he)=>j$(...he,{animationFrame:T==="always"}),elements:{reference:b.anchor},middleware:[Q$({mainAxis:s+R,alignmentAxis:l}),h&&Y$({mainAxis:!0,crossAxis:!1,limiter:_==="partial"?X$():void 0,...D}),h&&J$({...D}),Z$({...D,apply:({elements:he,rects:Fe,availableWidth:Ye,availableHeight:xt})=>{const{width:An,height:kn}=Fe.reference,Tn=he.floating.style;Tn.setProperty("--radix-popper-available-width",`${Ye}px`),Tn.setProperty("--radix-popper-available-height",`${xt}px`),Tn.setProperty("--radix-popper-anchor-width",`${An}px`),Tn.setProperty("--radix-popper-anchor-height",`${kn}px`)}}),G&&t8({element:G,padding:u}),c8({arrowWidth:P,arrowHeight:R}),v&&e8({strategy:"referenceHidden",...D})]}),[J,oe]=RN(Se),B=un(A);_r(()=>{Ie&&B?.()},[Ie,B]);const Z=W.arrow?.x,me=W.arrow?.y,_e=W.arrow?.centerOffset!==0,[Ne,Pe]=C.useState();return _r(()=>{j&&Pe(window.getComputedStyle(j).zIndex)},[j]),m.jsx("div",{ref:Ce.setFloating,"data-radix-popper-content-wrapper":"",style:{...je,transform:Ie?je.transform:"translate(0, -200%)",minWidth:"max-content",zIndex:Ne,"--radix-popper-transform-origin":[W.transformOrigin?.x,W.transformOrigin?.y].join(" "),...W.hide?.referenceHidden&&{visibility:"hidden",pointerEvents:"none"}},dir:n.dir,children:m.jsx(i8,{scope:t,placedSide:J,onArrowChange:X,arrowX:Z,arrowY:me,shouldHideArrow:_e,children:m.jsx(st.div,{"data-side":J,"data-align":oe,...I,ref:$,style:{...I.style,animation:Ie?void 0:"none"}})})})});SN.displayName=Xw;var IN="PopperArrow",a8={top:"bottom",right:"left",bottom:"top",left:"right"},bN=C.forwardRef(function(e,t){const{__scopePopper:r,...s}=e,o=o8(IN,r),l=a8[o.placedSide];return m.jsx("span",{ref:o.onArrowChange,style:{position:"absolute",left:o.arrowX,top:o.arrowY,[l]:0,transformOrigin:{top:"",right:"0 0",bottom:"center 0",left:"100% 0"}[o.placedSide],transform:{top:"translateY(100%)",right:"translateY(50%) rotate(90deg) translateX(-50%)",bottom:"rotate(180deg)",left:"translateY(50%) rotate(-90deg) translateX(50%)"}[o.placedSide],visibility:o.shouldHideArrow?"hidden":void 0},children:m.jsx(r8,{...s,ref:t,style:{...s.style,display:"block"}})})});bN.displayName=IN;function l8(n){return n!==null}var c8=n=>({name:"transformOrigin",options:n,fn(e){const{placement:t,rects:r,middlewareData:s}=e,l=s.arrow?.centerOffset!==0,u=l?0:n.arrowWidth,h=l?0:n.arrowHeight,[p,g]=RN(t),_={start:"0%",center:"50%",end:"100%"}[g],v=(s.arrow?.x??0)+u/2,T=(s.arrow?.y??0)+h/2;let A="",I="";return p==="bottom"?(A=l?_:`${v}px`,I=`${-h}px`):p==="top"?(A=l?_:`${v}px`,I=`${r.floating.height+h}px`):p==="right"?(A=`${-h}px`,I=l?_:`${T}px`):p==="left"&&(A=`${r.floating.width+h}px`,I=l?_:`${T}px`),{data:{x:A,y:I}}}});function RN(n){const[e,t="center"]=n.split("-");return[e,t]}var u8=xN,d8=CN,h8=SN,f8=bN,Ay="rovingFocusGroup.onEntryFocus",p8={bubbles:!1,cancelable:!0},Cd="RovingFocusGroup",[N_,AN,m8]=oN(Cd),[g8,kN]=ci(Cd,[m8]),[y8,_8]=g8(Cd),NN=C.forwardRef((n,e)=>m.jsx(N_.Provider,{scope:n.__scopeRovingFocusGroup,children:m.jsx(N_.Slot,{scope:n.__scopeRovingFocusGroup,children:m.jsx(v8,{...n,ref:e})})}));NN.displayName=Cd;var v8=C.forwardRef((n,e)=>{const{__scopeRovingFocusGroup:t,orientation:r,loop:s=!1,dir:o,currentTabStopId:l,defaultCurrentTabStopId:u,onCurrentTabStopIdChange:h,onEntryFocus:p,preventScrollOnEntryFocus:g=!1,..._}=n,v=C.useRef(null),T=Et(e,v),A=Vw(o),[I,b]=lm({prop:l,defaultProp:u??null,onChange:h,caller:Cd}),[j,U]=C.useState(!1),$=un(p),G=AN(t),X=C.useRef(!1),[ne,P]=C.useState(0);return C.useEffect(()=>{const R=v.current;if(R)return R.addEventListener(Ay,$),()=>R.removeEventListener(Ay,$)},[$]),m.jsx(y8,{scope:t,orientation:r,dir:A,loop:s,currentTabStopId:I,onItemFocus:C.useCallback(R=>b(R),[b]),onItemShiftTab:C.useCallback(()=>U(!0),[]),onFocusableItemAdd:C.useCallback(()=>P(R=>R+1),[]),onFocusableItemRemove:C.useCallback(()=>P(R=>R-1),[]),children:m.jsx(st.div,{tabIndex:j||ne===0?-1:0,"data-orientation":r,..._,ref:T,style:{outline:"none",...n.style},onMouseDown:Le(n.onMouseDown,()=>{X.current=!0}),onFocus:Le(n.onFocus,R=>{const N=!X.current;if(R.target===R.currentTarget&&N&&!j){const L=new CustomEvent(Ay,p8);if(R.currentTarget.dispatchEvent(L),!L.defaultPrevented){const O=G().filter(Se=>Se.focusable),F=O.find(Se=>Se.active),D=O.find(Se=>Se.id===I),je=[F,D,...O].filter(Boolean).map(Se=>Se.ref.current);ON(je,g)}}X.current=!1}),onBlur:Le(n.onBlur,()=>U(!1))})})}),PN="RovingFocusGroupItem",DN=C.forwardRef((n,e)=>{const{__scopeRovingFocusGroup:t,focusable:r=!0,active:s=!1,tabStopId:o,children:l,...u}=n,h=Dl(),p=o||h,g=_8(PN,t),_=g.currentTabStopId===p,v=AN(t),{onFocusableItemAdd:T,onFocusableItemRemove:A,currentTabStopId:I}=g;return C.useEffect(()=>{if(r)return T(),()=>A()},[r,T,A]),m.jsx(N_.ItemSlot,{scope:t,id:p,focusable:r,active:s,children:m.jsx(st.span,{tabIndex:_?0:-1,"data-orientation":g.orientation,...u,ref:e,onMouseDown:Le(n.onMouseDown,b=>{r?g.onItemFocus(p):b.preventDefault()}),onFocus:Le(n.onFocus,()=>g.onItemFocus(p)),onKeyDown:Le(n.onKeyDown,b=>{if(b.key==="Tab"&&b.shiftKey){g.onItemShiftTab();return}if(b.target!==b.currentTarget)return;const j=x8(b,g.orientation,g.dir);if(j!==void 0){if(b.metaKey||b.ctrlKey||b.altKey||b.shiftKey)return;b.preventDefault();let $=v().filter(G=>G.focusable).map(G=>G.ref.current);if(j==="last")$.reverse();else if(j==="prev"||j==="next"){j==="prev"&&$.reverse();const G=$.indexOf(b.currentTarget);$=g.loop?T8($,G+1):$.slice(G+1)}setTimeout(()=>ON($))}}),children:typeof l=="function"?l({isCurrentTabStop:_,hasTabStop:I!=null}):l})})});DN.displayName=PN;var w8={ArrowLeft:"prev",ArrowUp:"prev",ArrowRight:"next",ArrowDown:"next",PageUp:"first",Home:"first",PageDown:"last",End:"last"};function E8(n,e){return e!=="rtl"?n:n==="ArrowLeft"?"ArrowRight":n==="ArrowRight"?"ArrowLeft":n}function x8(n,e,t){const r=E8(n.key,t);if(!(e==="vertical"&&["ArrowLeft","ArrowRight"].includes(r))&&!(e==="horizontal"&&["ArrowUp","ArrowDown"].includes(r)))return w8[r]}function ON(n,e=!1){const t=document.activeElement;for(const r of n)if(r===t||(r.focus({preventScroll:e}),document.activeElement!==t))return}function T8(n,e){return n.map((t,r)=>n[(e+r)%n.length])}var C8=NN,S8=DN,P_=["Enter"," "],I8=["ArrowDown","PageUp","Home"],MN=["ArrowUp","PageDown","End"],b8=[...I8,...MN],R8={ltr:[...P_,"ArrowRight"],rtl:[...P_,"ArrowLeft"]},A8={ltr:["ArrowLeft"],rtl:["ArrowRight"]},Sd="Menu",[rd,k8,N8]=oN(Sd),[ba,LN]=ci(Sd,[N8,wN,kN]),_m=wN(),jN=kN(),[P8,Ra]=ba(Sd),[D8,Id]=ba(Sd),VN=n=>{const{__scopeMenu:e,open:t=!1,children:r,dir:s,onOpenChange:o,modal:l=!0}=n,u=_m(e),[h,p]=C.useState(null),g=C.useRef(!1),_=un(o),v=Vw(s);return C.useEffect(()=>{const T=()=>{g.current=!0,document.addEventListener("pointerdown",A,{capture:!0,once:!0}),document.addEventListener("pointermove",A,{capture:!0,once:!0})},A=()=>g.current=!1;return document.addEventListener("keydown",T,{capture:!0}),()=>{document.removeEventListener("keydown",T,{capture:!0}),document.removeEventListener("pointerdown",A,{capture:!0}),document.removeEventListener("pointermove",A,{capture:!0})}},[]),m.jsx(u8,{...u,children:m.jsx(P8,{scope:e,open:t,onOpenChange:_,content:h,onContentChange:p,children:m.jsx(D8,{scope:e,onClose:C.useCallback(()=>_(!1),[_]),isUsingKeyboardRef:g,dir:v,modal:l,children:r})})})};VN.displayName=Sd;var O8="MenuAnchor",Jw=C.forwardRef((n,e)=>{const{__scopeMenu:t,...r}=n,s=_m(t);return m.jsx(d8,{...s,...r,ref:e})});Jw.displayName=O8;var Zw="MenuPortal",[M8,FN]=ba(Zw,{forceMount:void 0}),UN=n=>{const{__scopeMenu:e,forceMount:t,children:r,container:s}=n,o=Ra(Zw,e);return m.jsx(M8,{scope:e,forceMount:t,children:m.jsx(ir,{present:t||o.open,children:m.jsx(Dw,{asChild:!0,container:s,children:r})})})};UN.displayName=Zw;var yr="MenuContent",[L8,e0]=ba(yr),zN=C.forwardRef((n,e)=>{const t=FN(yr,n.__scopeMenu),{forceMount:r=t.forceMount,...s}=n,o=Ra(yr,n.__scopeMenu),l=Id(yr,n.__scopeMenu);return m.jsx(rd.Provider,{scope:n.__scopeMenu,children:m.jsx(ir,{present:r||o.open,children:m.jsx(rd.Slot,{scope:n.__scopeMenu,children:l.modal?m.jsx(j8,{...s,ref:e}):m.jsx(V8,{...s,ref:e})})})})}),j8=C.forwardRef((n,e)=>{const t=Ra(yr,n.__scopeMenu),r=C.useRef(null),s=Et(e,r);return C.useEffect(()=>{const o=r.current;if(o)return _k(o)},[]),m.jsx(t0,{...n,ref:s,trapFocus:t.open,disableOutsidePointerEvents:t.open,disableOutsideScroll:!0,onFocusOutside:Le(n.onFocusOutside,o=>o.preventDefault(),{checkForDefaultPrevented:!1}),onDismiss:()=>t.onOpenChange(!1)})}),V8=C.forwardRef((n,e)=>{const t=Ra(yr,n.__scopeMenu);return m.jsx(t0,{...n,ref:e,trapFocus:!1,disableOutsidePointerEvents:!1,disableOutsideScroll:!1,onDismiss:()=>t.onOpenChange(!1)})}),F8=Yl("MenuContent.ScrollLock"),t0=C.forwardRef((n,e)=>{const{__scopeMenu:t,loop:r=!1,trapFocus:s,onOpenAutoFocus:o,onCloseAutoFocus:l,disableOutsidePointerEvents:u,onEntryFocus:h,onEscapeKeyDown:p,onPointerDownOutside:g,onFocusOutside:_,onInteractOutside:v,onDismiss:T,disableOutsideScroll:A,...I}=n,b=Ra(yr,t),j=Id(yr,t),U=_m(t),$=jN(t),G=k8(t),[X,ne]=C.useState(null),P=C.useRef(null),R=Et(e,P,b.onContentChange),N=C.useRef(0),L=C.useRef(""),O=C.useRef(0),F=C.useRef(null),D=C.useRef("right"),Ce=C.useRef(0),je=A?Ow:C.Fragment,Se=A?{as:F8,allowPinchZoom:!0}:void 0,Ie=J=>{const oe=L.current+J,B=G().filter(he=>!he.disabled),Z=document.activeElement,me=B.find(he=>he.ref.current===Z)?.textValue,_e=B.map(he=>he.textValue),Ne=X8(_e,oe,me),Pe=B.find(he=>he.textValue===Ne)?.ref.current;(function he(Fe){L.current=Fe,window.clearTimeout(N.current),Fe!==""&&(N.current=window.setTimeout(()=>he(""),1e3))})(oe),Pe&&setTimeout(()=>Pe.focus())};C.useEffect(()=>()=>window.clearTimeout(N.current),[]),ck();const W=C.useCallback(J=>D.current===F.current?.side&&Z8(J,F.current?.area),[]);return m.jsx(L8,{scope:t,searchRef:L,onItemEnter:C.useCallback(J=>{W(J)&&J.preventDefault()},[W]),onItemLeave:C.useCallback(J=>{W(J)||(P.current?.focus(),ne(null))},[W]),onTriggerLeave:C.useCallback(J=>{W(J)&&J.preventDefault()},[W]),pointerGraceTimerRef:O,onPointerGraceIntentChange:C.useCallback(J=>{F.current=J},[]),children:m.jsx(je,{...Se,children:m.jsx(Pw,{asChild:!0,trapped:s,onMountAutoFocus:Le(o,J=>{J.preventDefault(),P.current?.focus({preventScroll:!0})}),onUnmountAutoFocus:l,children:m.jsx(Nw,{asChild:!0,disableOutsidePointerEvents:u,onEscapeKeyDown:p,onPointerDownOutside:g,onFocusOutside:_,onInteractOutside:v,onDismiss:T,children:m.jsx(C8,{asChild:!0,...$,dir:j.dir,orientation:"vertical",loop:r,currentTabStopId:X,onCurrentTabStopIdChange:ne,onEntryFocus:Le(h,J=>{j.isUsingKeyboardRef.current||J.preventDefault()}),preventScrollOnEntryFocus:!0,children:m.jsx(h8,{role:"menu","aria-orientation":"vertical","data-state":r1(b.open),"data-radix-menu-content":"",dir:j.dir,...U,...I,ref:R,style:{outline:"none",...I.style},onKeyDown:Le(I.onKeyDown,J=>{const B=J.target.closest("[data-radix-menu-content]")===J.currentTarget,Z=J.ctrlKey||J.altKey||J.metaKey,me=J.key.length===1;B&&(J.key==="Tab"&&J.preventDefault(),!Z&&me&&Ie(J.key));const _e=P.current;if(J.target!==_e||!b8.includes(J.key))return;J.preventDefault();const Pe=G().filter(he=>!he.disabled).map(he=>he.ref.current);MN.includes(J.key)&&Pe.reverse(),Q8(Pe)}),onBlur:Le(n.onBlur,J=>{J.currentTarget.contains(J.target)||(window.clearTimeout(N.current),L.current="")}),onPointerMove:Le(n.onPointerMove,sd(J=>{const oe=J.target,B=Ce.current!==J.clientX;if(J.currentTarget.contains(oe)&&B){const Z=J.clientX>Ce.current?"right":"left";D.current=Z,Ce.current=J.clientX}}))})})})})})})});zN.displayName=yr;var U8="MenuGroup",n0=C.forwardRef((n,e)=>{const{__scopeMenu:t,...r}=n;return m.jsx(st.div,{role:"group",...r,ref:e})});n0.displayName=U8;var z8="MenuLabel",BN=C.forwardRef((n,e)=>{const{__scopeMenu:t,...r}=n;return m.jsx(st.div,{...r,ref:e})});BN.displayName=z8;var pp="MenuItem",AS="menu.itemSelect",vm=C.forwardRef((n,e)=>{const{disabled:t=!1,onSelect:r,...s}=n,o=C.useRef(null),l=Id(pp,n.__scopeMenu),u=e0(pp,n.__scopeMenu),h=Et(e,o),p=C.useRef(!1),g=()=>{const _=o.current;if(!t&&_){const v=new CustomEvent(AS,{bubbles:!0,cancelable:!0});_.addEventListener(AS,T=>r?.(T),{once:!0}),ZA(_,v),v.defaultPrevented?p.current=!1:l.onClose()}};return m.jsx($N,{...s,ref:h,disabled:t,onClick:Le(n.onClick,g),onPointerDown:_=>{n.onPointerDown?.(_),p.current=!0},onPointerUp:Le(n.onPointerUp,_=>{p.current||_.currentTarget?.click()}),onKeyDown:Le(n.onKeyDown,_=>{const v=u.searchRef.current!=="";t||v&&_.key===" "||P_.includes(_.key)&&(_.currentTarget.click(),_.preventDefault())})})});vm.displayName=pp;var $N=C.forwardRef((n,e)=>{const{__scopeMenu:t,disabled:r=!1,textValue:s,...o}=n,l=e0(pp,t),u=jN(t),h=C.useRef(null),p=Et(e,h),[g,_]=C.useState(!1),[v,T]=C.useState("");return C.useEffect(()=>{const A=h.current;A&&T((A.textContent??"").trim())},[o.children]),m.jsx(rd.ItemSlot,{scope:t,disabled:r,textValue:s??v,children:m.jsx(S8,{asChild:!0,...u,focusable:!r,children:m.jsx(st.div,{role:"menuitem","data-highlighted":g?"":void 0,"aria-disabled":r||void 0,"data-disabled":r?"":void 0,...o,ref:p,onPointerMove:Le(n.onPointerMove,sd(A=>{r?l.onItemLeave(A):(l.onItemEnter(A),A.defaultPrevented||A.currentTarget.focus({preventScroll:!0}))})),onPointerLeave:Le(n.onPointerLeave,sd(A=>l.onItemLeave(A))),onFocus:Le(n.onFocus,()=>_(!0)),onBlur:Le(n.onBlur,()=>_(!1))})})})}),B8="MenuCheckboxItem",WN=C.forwardRef((n,e)=>{const{checked:t=!1,onCheckedChange:r,...s}=n;return m.jsx(QN,{scope:n.__scopeMenu,checked:t,children:m.jsx(vm,{role:"menuitemcheckbox","aria-checked":mp(t)?"mixed":t,...s,ref:e,"data-state":s0(t),onSelect:Le(s.onSelect,()=>r?.(mp(t)?!0:!t),{checkForDefaultPrevented:!1})})})});WN.displayName=B8;var HN="MenuRadioGroup",[$8,W8]=ba(HN,{value:void 0,onValueChange:()=>{}}),qN=C.forwardRef((n,e)=>{const{value:t,onValueChange:r,...s}=n,o=un(r);return m.jsx($8,{scope:n.__scopeMenu,value:t,onValueChange:o,children:m.jsx(n0,{...s,ref:e})})});qN.displayName=HN;var GN="MenuRadioItem",KN=C.forwardRef((n,e)=>{const{value:t,...r}=n,s=W8(GN,n.__scopeMenu),o=t===s.value;return m.jsx(QN,{scope:n.__scopeMenu,checked:o,children:m.jsx(vm,{role:"menuitemradio","aria-checked":o,...r,ref:e,"data-state":s0(o),onSelect:Le(r.onSelect,()=>s.onValueChange?.(t),{checkForDefaultPrevented:!1})})})});KN.displayName=GN;var r0="MenuItemIndicator",[QN,H8]=ba(r0,{checked:!1}),YN=C.forwardRef((n,e)=>{const{__scopeMenu:t,forceMount:r,...s}=n,o=H8(r0,t);return m.jsx(ir,{present:r||mp(o.checked)||o.checked===!0,children:m.jsx(st.span,{...s,ref:e,"data-state":s0(o.checked)})})});YN.displayName=r0;var q8="MenuSeparator",XN=C.forwardRef((n,e)=>{const{__scopeMenu:t,...r}=n;return m.jsx(st.div,{role:"separator","aria-orientation":"horizontal",...r,ref:e})});XN.displayName=q8;var G8="MenuArrow",JN=C.forwardRef((n,e)=>{const{__scopeMenu:t,...r}=n,s=_m(t);return m.jsx(f8,{...s,...r,ref:e})});JN.displayName=G8;var K8="MenuSub",[hW,ZN]=ba(K8),Eu="MenuSubTrigger",e1=C.forwardRef((n,e)=>{const t=Ra(Eu,n.__scopeMenu),r=Id(Eu,n.__scopeMenu),s=ZN(Eu,n.__scopeMenu),o=e0(Eu,n.__scopeMenu),l=C.useRef(null),{pointerGraceTimerRef:u,onPointerGraceIntentChange:h}=o,p={__scopeMenu:n.__scopeMenu},g=C.useCallback(()=>{l.current&&window.clearTimeout(l.current),l.current=null},[]);return C.useEffect(()=>g,[g]),C.useEffect(()=>{const _=u.current;return()=>{window.clearTimeout(_),h(null)}},[u,h]),m.jsx(Jw,{asChild:!0,...p,children:m.jsx($N,{id:s.triggerId,"aria-haspopup":"menu","aria-expanded":t.open,"aria-controls":s.contentId,"data-state":r1(t.open),...n,ref:am(e,s.onTriggerChange),onClick:_=>{n.onClick?.(_),!(n.disabled||_.defaultPrevented)&&(_.currentTarget.focus(),t.open||t.onOpenChange(!0))},onPointerMove:Le(n.onPointerMove,sd(_=>{o.onItemEnter(_),!_.defaultPrevented&&!n.disabled&&!t.open&&!l.current&&(o.onPointerGraceIntentChange(null),l.current=window.setTimeout(()=>{t.onOpenChange(!0),g()},100))})),onPointerLeave:Le(n.onPointerLeave,sd(_=>{g();const v=t.content?.getBoundingClientRect();if(v){const T=t.content?.dataset.side,A=T==="right",I=A?-5:5,b=v[A?"left":"right"],j=v[A?"right":"left"];o.onPointerGraceIntentChange({area:[{x:_.clientX+I,y:_.clientY},{x:b,y:v.top},{x:j,y:v.top},{x:j,y:v.bottom},{x:b,y:v.bottom}],side:T}),window.clearTimeout(u.current),u.current=window.setTimeout(()=>o.onPointerGraceIntentChange(null),300)}else{if(o.onTriggerLeave(_),_.defaultPrevented)return;o.onPointerGraceIntentChange(null)}})),onKeyDown:Le(n.onKeyDown,_=>{const v=o.searchRef.current!=="";n.disabled||v&&_.key===" "||R8[r.dir].includes(_.key)&&(t.onOpenChange(!0),t.content?.focus(),_.preventDefault())})})})});e1.displayName=Eu;var t1="MenuSubContent",n1=C.forwardRef((n,e)=>{const t=FN(yr,n.__scopeMenu),{forceMount:r=t.forceMount,...s}=n,o=Ra(yr,n.__scopeMenu),l=Id(yr,n.__scopeMenu),u=ZN(t1,n.__scopeMenu),h=C.useRef(null),p=Et(e,h);return m.jsx(rd.Provider,{scope:n.__scopeMenu,children:m.jsx(ir,{present:r||o.open,children:m.jsx(rd.Slot,{scope:n.__scopeMenu,children:m.jsx(t0,{id:u.contentId,"aria-labelledby":u.triggerId,...s,ref:p,align:"start",side:l.dir==="rtl"?"left":"right",disableOutsidePointerEvents:!1,disableOutsideScroll:!1,trapFocus:!1,onOpenAutoFocus:g=>{l.isUsingKeyboardRef.current&&h.current?.focus(),g.preventDefault()},onCloseAutoFocus:g=>g.preventDefault(),onFocusOutside:Le(n.onFocusOutside,g=>{g.target!==u.trigger&&o.onOpenChange(!1)}),onEscapeKeyDown:Le(n.onEscapeKeyDown,g=>{l.onClose(),g.preventDefault()}),onKeyDown:Le(n.onKeyDown,g=>{const _=g.currentTarget.contains(g.target),v=A8[l.dir].includes(g.key);_&&v&&(o.onOpenChange(!1),u.trigger?.focus(),g.preventDefault())})})})})})});n1.displayName=t1;function r1(n){return n?"open":"closed"}function mp(n){return n==="indeterminate"}function s0(n){return mp(n)?"indeterminate":n?"checked":"unchecked"}function Q8(n){const e=document.activeElement;for(const t of n)if(t===e||(t.focus(),document.activeElement!==e))return}function Y8(n,e){return n.map((t,r)=>n[(e+r)%n.length])}function X8(n,e,t){const s=e.length>1&&Array.from(e).every(p=>p===e[0])?e[0]:e,o=t?n.indexOf(t):-1;let l=Y8(n,Math.max(o,0));s.length===1&&(l=l.filter(p=>p!==t));const h=l.find(p=>p.toLowerCase().startsWith(s.toLowerCase()));return h!==t?h:void 0}function J8(n,e){const{x:t,y:r}=n;let s=!1;for(let o=0,l=e.length-1;o<e.length;l=o++){const u=e[o],h=e[l],p=u.x,g=u.y,_=h.x,v=h.y;g>r!=v>r&&t<(_-p)*(r-g)/(v-g)+p&&(s=!s)}return s}function Z8(n,e){if(!e)return!1;const t={x:n.clientX,y:n.clientY};return J8(t,e)}function sd(n){return e=>e.pointerType==="mouse"?n(e):void 0}var e7=VN,t7=Jw,n7=UN,r7=zN,s7=n0,i7=BN,o7=vm,a7=WN,l7=qN,c7=KN,u7=YN,d7=XN,h7=JN,f7=e1,p7=n1,wm="DropdownMenu",[m7]=ci(wm,[LN]),Rn=LN(),[g7,s1]=m7(wm),i1=n=>{const{__scopeDropdownMenu:e,children:t,dir:r,open:s,defaultOpen:o,onOpenChange:l,modal:u=!0}=n,h=Rn(e),p=C.useRef(null),[g,_]=lm({prop:s,defaultProp:o??!1,onChange:l,caller:wm});return m.jsx(g7,{scope:e,triggerId:Dl(),triggerRef:p,contentId:Dl(),open:g,onOpenChange:_,onOpenToggle:C.useCallback(()=>_(v=>!v),[_]),modal:u,children:m.jsx(e7,{...h,open:g,onOpenChange:_,dir:r,modal:u,children:t})})};i1.displayName=wm;var o1="DropdownMenuTrigger",a1=C.forwardRef((n,e)=>{const{__scopeDropdownMenu:t,disabled:r=!1,...s}=n,o=s1(o1,t),l=Rn(t);return m.jsx(t7,{asChild:!0,...l,children:m.jsx(st.button,{type:"button",id:o.triggerId,"aria-haspopup":"menu","aria-expanded":o.open,"aria-controls":o.open?o.contentId:void 0,"data-state":o.open?"open":"closed","data-disabled":r?"":void 0,disabled:r,...s,ref:am(e,o.triggerRef),onPointerDown:Le(n.onPointerDown,u=>{!r&&u.button===0&&u.ctrlKey===!1&&(o.onOpenToggle(),o.open||u.preventDefault())}),onKeyDown:Le(n.onKeyDown,u=>{r||(["Enter"," "].includes(u.key)&&o.onOpenToggle(),u.key==="ArrowDown"&&o.onOpenChange(!0),["Enter"," ","ArrowDown"].includes(u.key)&&u.preventDefault())})})})});a1.displayName=o1;var y7="DropdownMenuPortal",l1=n=>{const{__scopeDropdownMenu:e,...t}=n,r=Rn(e);return m.jsx(n7,{...r,...t})};l1.displayName=y7;var c1="DropdownMenuContent",u1=C.forwardRef((n,e)=>{const{__scopeDropdownMenu:t,...r}=n,s=s1(c1,t),o=Rn(t),l=C.useRef(!1);return m.jsx(r7,{id:s.contentId,"aria-labelledby":s.triggerId,...o,...r,ref:e,onCloseAutoFocus:Le(n.onCloseAutoFocus,u=>{l.current||s.triggerRef.current?.focus(),l.current=!1,u.preventDefault()}),onInteractOutside:Le(n.onInteractOutside,u=>{const h=u.detail.originalEvent,p=h.button===0&&h.ctrlKey===!0,g=h.button===2||p;(!s.modal||g)&&(l.current=!0)}),style:{...n.style,"--radix-dropdown-menu-content-transform-origin":"var(--radix-popper-transform-origin)","--radix-dropdown-menu-content-available-width":"var(--radix-popper-available-width)","--radix-dropdown-menu-content-available-height":"var(--radix-popper-available-height)","--radix-dropdown-menu-trigger-width":"var(--radix-popper-anchor-width)","--radix-dropdown-menu-trigger-height":"var(--radix-popper-anchor-height)"}})});u1.displayName=c1;var _7="DropdownMenuGroup",v7=C.forwardRef((n,e)=>{const{__scopeDropdownMenu:t,...r}=n,s=Rn(t);return m.jsx(s7,{...s,...r,ref:e})});v7.displayName=_7;var w7="DropdownMenuLabel",E7=C.forwardRef((n,e)=>{const{__scopeDropdownMenu:t,...r}=n,s=Rn(t);return m.jsx(i7,{...s,...r,ref:e})});E7.displayName=w7;var x7="DropdownMenuItem",d1=C.forwardRef((n,e)=>{const{__scopeDropdownMenu:t,...r}=n,s=Rn(t);return m.jsx(o7,{...s,...r,ref:e})});d1.displayName=x7;var T7="DropdownMenuCheckboxItem",C7=C.forwardRef((n,e)=>{const{__scopeDropdownMenu:t,...r}=n,s=Rn(t);return m.jsx(a7,{...s,...r,ref:e})});C7.displayName=T7;var S7="DropdownMenuRadioGroup",I7=C.forwardRef((n,e)=>{const{__scopeDropdownMenu:t,...r}=n,s=Rn(t);return m.jsx(l7,{...s,...r,ref:e})});I7.displayName=S7;var b7="DropdownMenuRadioItem",R7=C.forwardRef((n,e)=>{const{__scopeDropdownMenu:t,...r}=n,s=Rn(t);return m.jsx(c7,{...s,...r,ref:e})});R7.displayName=b7;var A7="DropdownMenuItemIndicator",k7=C.forwardRef((n,e)=>{const{__scopeDropdownMenu:t,...r}=n,s=Rn(t);return m.jsx(u7,{...s,...r,ref:e})});k7.displayName=A7;var N7="DropdownMenuSeparator",P7=C.forwardRef((n,e)=>{const{__scopeDropdownMenu:t,...r}=n,s=Rn(t);return m.jsx(d7,{...s,...r,ref:e})});P7.displayName=N7;var D7="DropdownMenuArrow",O7=C.forwardRef((n,e)=>{const{__scopeDropdownMenu:t,...r}=n,s=Rn(t);return m.jsx(h7,{...s,...r,ref:e})});O7.displayName=D7;var M7="DropdownMenuSubTrigger",L7=C.forwardRef((n,e)=>{const{__scopeDropdownMenu:t,...r}=n,s=Rn(t);return m.jsx(f7,{...s,...r,ref:e})});L7.displayName=M7;var j7="DropdownMenuSubContent",V7=C.forwardRef((n,e)=>{const{__scopeDropdownMenu:t,...r}=n,s=Rn(t);return m.jsx(p7,{...s,...r,ref:e,style:{...n.style,"--radix-dropdown-menu-content-transform-origin":"var(--radix-popper-transform-origin)","--radix-dropdown-menu-content-available-width":"var(--radix-popper-available-width)","--radix-dropdown-menu-content-available-height":"var(--radix-popper-available-height)","--radix-dropdown-menu-trigger-width":"var(--radix-popper-anchor-width)","--radix-dropdown-menu-trigger-height":"var(--radix-popper-anchor-height)"}})});V7.displayName=j7;var F7=i1,U7=a1,z7=l1,B7=u1,$7=d1;function W7({...n}){return m.jsx(F7,{"data-slot":"dropdown-menu",...n})}function H7({...n}){return m.jsx(U7,{"data-slot":"dropdown-menu-trigger",...n})}function q7({className:n,sideOffset:e=4,...t}){return m.jsx(z7,{children:m.jsx(B7,{"data-slot":"dropdown-menu-content",sideOffset:e,className:Lt("bg-popover text-popover-foreground data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2 z-50 max-h-(--radix-dropdown-menu-content-available-height) min-w-[8rem] origin-(--radix-dropdown-menu-content-transform-origin) overflow-x-hidden overflow-y-auto rounded-md border p-1 shadow-md",n),...t})})}function G7({className:n,inset:e,variant:t="default",...r}){return m.jsx($7,{"data-slot":"dropdown-menu-item","data-inset":e,"data-variant":t,className:Lt("focus:bg-accent focus:text-accent-foreground data-[variant=destructive]:text-destructive data-[variant=destructive]:focus:bg-destructive/10 dark:data-[variant=destructive]:focus:bg-destructive/20 data-[variant=destructive]:focus:text-destructive data-[variant=destructive]:*:[svg]:!text-destructive [&_svg:not([class*='text-'])]:text-muted-foreground relative flex cursor-default items-center gap-2 rounded-sm px-2 py-1.5 text-sm outline-hidden select-none data-[disabled]:pointer-events-none data-[disabled]:opacity-50 data-[inset]:pl-8 [&_svg]:pointer-events-none [&_svg]:shrink-0 [&_svg:not([class*='size-'])]:size-4",n),...r})}function K7({profile:n,onBack:e,onFollow:t,onMessage:r,onBlock:s}){const[o,l]=C.useState(n.isFollowing||!1),[u,h]=C.useState(n.isBlocked||!1),p=()=>{l(!o),t&&t()},g=()=>{h(!0),s&&s()};return u?m.jsx("div",{className:"min-h-screen bg-gradient-to-b from-gray-900 to-black pt-16",children:m.jsxs("div",{className:"max-w-md mx-auto px-4 py-6",children:[m.jsxs("div",{className:"flex items-center gap-3 mb-6",children:[m.jsx(ue,{variant:"ghost",size:"sm",onClick:e,className:"text-white hover:bg-gray-700",children:m.jsx(qC,{className:"w-5 h-5"})}),m.jsx("h2",{className:"text-xl text-white font-bold",children:"User Profile"})]}),m.jsx(Pr,{className:"bg-gray-800/50 border-gray-700 backdrop-blur-sm",children:m.jsxs("div",{className:"p-8 text-center",children:[m.jsx(GC,{className:"w-12 h-12 text-gray-500 mx-auto mb-4"}),m.jsx("h3",{className:"text-lg text-gray-300 mb-2",children:"User Blocked"}),m.jsx("p",{className:"text-gray-500",children:"You have blocked this user. You won't see their posts or messages."})]})})]})}):m.jsx("div",{className:"min-h-screen bg-gradient-to-b from-gray-900 to-black pt-16",children:m.jsxs("div",{className:"max-w-md mx-auto px-4 py-6",children:[m.jsxs("div",{className:"flex items-center justify-between mb-6",children:[m.jsxs("div",{className:"flex items-center gap-3",children:[m.jsx(ue,{variant:"ghost",size:"sm",onClick:e,className:"text-white hover:bg-gray-700",children:m.jsx(qC,{className:"w-5 h-5"})}),m.jsxs("h2",{className:"text-xl text-white font-bold",children:["@",n.username]})]}),m.jsxs(W7,{children:[m.jsx(H7,{asChild:!0,children:m.jsx(ue,{variant:"ghost",size:"sm",className:"text-gray-400 hover:text-white",children:m.jsx(Cw,{className:"w-5 h-5"})})}),m.jsx(q7,{align:"end",className:"bg-gray-800 border-gray-700",children:m.jsxs(G7,{onClick:g,className:"text-red-400 hover:text-red-300 hover:bg-gray-700",children:[m.jsx(GC,{className:"w-4 h-4 mr-2"}),"Block User"]})})]})]}),m.jsx(Pr,{className:"bg-gray-800/50 border-gray-700 backdrop-blur-sm mb-6",children:m.jsxs("div",{className:"p-6",children:[m.jsxs("div",{className:"flex items-start justify-between mb-4",children:[m.jsxs("div",{className:"relative",children:[m.jsxs(nr,{className:"w-20 h-20 ring-2 ring-green-500",children:[m.jsx(rr,{src:n.avatar}),m.jsx(sr,{className:"bg-gray-700 text-white text-xl",children:n.displayName.charAt(0)})]}),m.jsx("div",{className:`absolute -bottom-2 -right-2 w-5 h-5 rounded-full border-2 border-gray-800 ${n.isOnline?"bg-green-500":"bg-gray-500"}`})]}),m.jsxs("div",{className:"flex gap-2",children:[m.jsxs(ue,{onClick:p,className:`${o?"bg-gray-600 hover:bg-gray-700 text-white":"bg-green-500 hover:bg-green-600 text-white"}`,children:[m.jsx(Iw,{className:"w-4 h-4 mr-1"}),o?"Following":"Follow"]}),m.jsxs(ue,{onClick:r,variant:"outline",className:"border-gray-600 text-gray-300 hover:bg-gray-700",children:[m.jsx(ed,{className:"w-4 h-4 mr-1"}),"Message"]})]})]}),m.jsxs("div",{className:"space-y-2",children:[m.jsxs("div",{children:[m.jsx("h1",{className:"text-xl text-white font-bold",children:n.displayName}),m.jsxs("p",{className:"text-gray-400",children:["@",n.username]})]}),n.bio&&m.jsx("p",{className:"text-gray-300 leading-relaxed",children:n.bio}),m.jsxs("div",{className:"flex items-center gap-2",children:[m.jsx(Rw,{variant:"secondary",className:"bg-gray-700 text-gray-300",children:n.isOnline?"✅ Online":"⚫ Offline"}),m.jsxs("span",{className:"text-gray-500 text-sm",children:["Joined ",n.joinDate]})]})]})]})}),m.jsx(Pr,{className:"bg-gray-800/50 border-gray-700 backdrop-blur-sm mb-6",children:m.jsx("div",{className:"p-4",children:m.jsxs("div",{className:"grid grid-cols-3 gap-4 text-center",children:[m.jsxs("div",{className:"space-y-1",children:[m.jsx("p",{className:"text-xl text-white font-bold",children:n.postsCount}),m.jsx("p",{className:"text-gray-400 text-sm",children:"Posts"})]}),m.jsxs("div",{className:"space-y-1",children:[m.jsx("p",{className:"text-xl text-white font-bold",children:n.followersCount}),m.jsx("p",{className:"text-gray-400 text-sm",children:"Followers"})]}),m.jsxs("div",{className:"space-y-1",children:[m.jsx("p",{className:"text-xl text-white font-bold",children:n.followingCount}),m.jsx("p",{className:"text-gray-400 text-sm",children:"Following"})]})]})})}),m.jsx(Pr,{className:"bg-gray-800/50 border-gray-700 backdrop-blur-sm",children:m.jsxs("div",{className:"p-4",children:[m.jsx("h3",{className:"text-white font-medium mb-4",children:"Recent Posts"}),m.jsx("div",{className:"text-center py-8",children:m.jsx("p",{className:"text-gray-400",children:"No recent posts to show"})})]})})]})})}function i0({className:n,...e}){return m.jsx("textarea",{"data-slot":"textarea",className:Lt("resize-none border-input placeholder:text-muted-foreground focus-visible:border-ring focus-visible:ring-ring/50 aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive dark:bg-input/30 flex field-sizing-content min-h-16 w-full rounded-md border bg-input-background px-3 py-2 text-base transition-[color,box-shadow] outline-none focus-visible:ring-[3px] disabled:cursor-not-allowed disabled:opacity-50 md:text-sm",n),...e})}function Q7({isOpen:n,onClose:e,onSubmit:t}){const[r,s]=C.useState("image"),[o,l]=C.useState(""),[u,h]=C.useState("#1f2937"),[p,g]=C.useState(""),[_,v]=C.useState(!1),T=C.useRef(null),A=["#1f2937","#7c3aed","#dc2626","#059669","#ea580c","#0891b2","#be185d","#4338ca"],I=()=>{l(""),g(""),s("image"),h("#1f2937"),v(!1)},b=()=>{I(),e()},j=()=>{r==="text"&&o.trim()?t({content:o,type:"text",backgroundColor:u}):r==="image"&&p.trim()&&t({content:p,type:"image"}),b()},U=async $=>{const G=$.target.files?.[0];if(G&&sp.currentUser){v(!0);try{const X=await k6(G,sp.currentUser.uid);g(X)}catch(X){console.error("Error uploading story image:",X)}finally{v(!1)}}};return m.jsx(Ta,{open:n,onOpenChange:b,children:m.jsxs(Ca,{className:"bg-gray-900 border-gray-700 text-white max-w-md",children:[m.jsxs(Sa,{children:[m.jsx(Ia,{className:"text-center",children:"Add New Story"}),m.jsx(hc,{className:"text-center text-gray-400",children:"Share a moment with your story that lasts 24 hours"}),m.jsx(ue,{variant:"ghost",size:"sm",onClick:b,className:"absolute right-4 top-4 text-gray-400 hover:text-white",children:m.jsx(xa,{className:"w-5 h-5"})})]}),m.jsxs("div",{className:"flex gap-2 p-4",children:[m.jsxs(ue,{variant:r==="image"?"default":"outline",onClick:()=>s("image"),className:"flex-1 flex items-center gap-2",disabled:_,children:[m.jsx(MA,{className:"w-4 h-4"}),"صورة"]}),m.jsxs(ue,{variant:r==="text"?"default":"outline",onClick:()=>s("text"),className:"flex-1 flex items-center gap-2",disabled:_,children:[m.jsx(C5,{className:"w-4 h-4"}),"نص"]})]}),m.jsx("div",{className:"p-4 space-y-4",children:r==="image"?m.jsxs("div",{className:"space-y-4",children:[m.jsxs("div",{children:[m.jsx("label",{className:"block text-sm font-medium mb-2",children:"رابط الصورة"}),m.jsx(ln,{value:p,onChange:$=>g($.target.value),placeholder:"أدخل رابط الصورة...",className:"bg-gray-800 border-gray-600 text-white",disabled:_})]}),m.jsx("input",{type:"file",ref:T,onChange:U,style:{display:"none"},accept:"image/*"}),m.jsxs(ue,{onClick:()=>T.current?.click(),className:"w-full flex items-center gap-2 bg-green-600 hover:bg-green-700",disabled:_,children:[_?m.jsx(i5,{className:"w-4 h-4 animate-spin"}):m.jsx(OA,{className:"w-4 h-4"}),_?"جاري الرفع...":"أو اختر من الجهاز"]}),p&&m.jsx("div",{className:"relative w-full h-48 bg-gray-800 rounded-lg overflow-hidden",children:m.jsx("img",{src:p,alt:"Preview",className:"w-full h-full object-cover"})})]}):m.jsxs("div",{className:"space-y-4",children:[m.jsxs("div",{children:[m.jsx("label",{className:"block text-sm font-medium mb-2",children:"محتوى النص"}),m.jsx(i0,{value:o,onChange:$=>l($.target.value),placeholder:"اكتب نصك هنا...",className:"bg-gray-800 border-gray-600 text-white min-h-[100px]",maxLength:200}),m.jsxs("p",{className:"text-xs text-gray-400 mt-1",children:[o.length,"/200"]})]}),m.jsxs("div",{children:[m.jsx("label",{className:"block text-sm font-medium mb-2",children:"لون الخلفية"}),m.jsx("div",{className:"flex gap-2 flex-wrap",children:A.map($=>m.jsx("button",{onClick:()=>h($),className:`w-8 h-8 rounded-full border-2 ${u===$?"border-white":"border-gray-600"}`,style:{backgroundColor:$}},$))})]}),o&&m.jsx("div",{className:"w-full h-48 rounded-lg flex items-center justify-center p-4",style:{backgroundColor:u},children:m.jsx("p",{className:"text-white text-center text-lg leading-relaxed",children:o})})]})}),m.jsxs("div",{className:"flex gap-2 p-4",children:[m.jsx(ue,{variant:"outline",onClick:b,className:"flex-1 border-gray-600 text-gray-300 hover:bg-gray-700",disabled:_,children:"إلغاء"}),m.jsx(ue,{onClick:j,disabled:_||r==="text"&&!o.trim()||r==="image"&&!p.trim(),className:"flex-1 bg-green-600 hover:bg-green-700 text-white",children:_?"...":"نشر الستوري"})]})]})})}var Y7="Label",h1=C.forwardRef((n,e)=>m.jsx(st.label,{...n,ref:e,onMouseDown:t=>{t.target.closest("button, input, select, textarea")||(n.onMouseDown?.(t),!t.defaultPrevented&&t.detail>1&&t.preventDefault())}}));h1.displayName=Y7;var X7=h1;function Ws({className:n,...e}){return m.jsx(X7,{"data-slot":"label",className:Lt("flex items-center gap-2 text-sm leading-none font-medium select-none group-data-[disabled=true]:pointer-events-none group-data-[disabled=true]:opacity-50 peer-disabled:cursor-not-allowed peer-disabled:opacity-50",n),...e})}var J7="Separator",kS="horizontal",Z7=["horizontal","vertical"],f1=C.forwardRef((n,e)=>{const{decorative:t,orientation:r=kS,...s}=n,o=eW(r)?r:kS,u=t?{role:"none"}:{"aria-orientation":o==="vertical"?o:void 0,role:"separator"};return m.jsx(st.div,{"data-orientation":o,...u,...s,ref:e})});f1.displayName=J7;function eW(n){return Z7.includes(n)}var tW=f1;function nW({className:n,orientation:e="horizontal",decorative:t=!0,...r}){return m.jsx(tW,{"data-slot":"separator-root",decorative:t,orientation:e,className:Lt("bg-border shrink-0 data-[orientation=horizontal]:h-px data-[orientation=horizontal]:w-full data-[orientation=vertical]:h-full data-[orientation=vertical]:w-px",n),...r})}function rW({isOpen:n,onClose:e,onDevModeToggle:t}){const[r,s]=C.useState("options"),[o,l]=C.useState(!1),[u,h]=C.useState(""),[p,g]=C.useState(""),[_,v]=C.useState(""),[T,A]=C.useState(""),[I,b]=C.useState(""),[j,U]=C.useState(""),[$,G]=C.useState(""),X=()=>{g(""),v(""),A(""),b(""),U(""),G(""),h(""),s("options")},ne=O=>{const F=/^[a-zA-Z][a-zA-Z0-9_]*$/;return O.length>=2&&F.test(O)},P=O=>{const F=/[a-zA-Z]/.test(O),D=/[0-9]/.test(O);return O.length>=8&&F&&D},R=async O=>{if(O.preventDefault(),!p.trim()||!_.trim()){h("يرجى ملء جميع الحقول");return}l(!0),h("");try{await g6(p,_)}catch(F){console.error("Login Error:",F),h("اسم المستخدم او كلمة المرور غير صحيحة")}finally{l(!1)}},N=async O=>{if(O.preventDefault(),!T.trim()||!I.trim()||!j.trim()||!$.trim()){h("يرجى ملء جميع الحقول");return}if(!ne(T)){h("اسم المستخدم يجب أن يبدأ بحرف ويحتوي على حروف وأرقام انجليزية و _ فقط (حد أدنى حرفين)");return}if(!P(I)){h("كلمة المرور يجب أن تكون 8 خانات على الأقل وتحتوي على حرف ورقم انجليزي");return}if(I!==j){h("كلمة المرور وتأكيد كلمة المرور غير متطابقتين");return}l(!0),h("");try{await m6(T,$,I)}catch(F){console.error("Registration Error:",F),h("فشل في إنشاء الحساب. قد يكون اسم المستخدم مستخدماً بالفعل.")}finally{l(!1)}},L=async()=>{l(!0),h("");try{await y6()}catch(O){console.error("Guest Login Error:",O),h("فشل في تسجيل الدخول كضيف. يرجى المحاولة مرة أخرى.")}finally{l(!1)}};return m.jsx(Ta,{open:n,onOpenChange:O=>{O||(X(),e())},children:m.jsxs(Ca,{className:"bg-gray-900 border-gray-700 text-white max-w-md relative",dir:"rtl",children:[m.jsx("button",{onClick:t,className:"absolute top-2 left-2 z-10 bg-gray-800/50 text-white p-2 rounded-full border border-gray-600 hover:bg-gray-700 transition-colors","aria-label":"Developer Mode",children:m.jsx(K6,{className:"h-5 w-5"})}),m.jsxs(Sa,{children:[m.jsx(Ia,{className:"text-center text-xl text-green-400",children:"مرحباً بك في Dark*Chat"}),m.jsxs(hc,{className:"text-center text-gray-400",children:[r==="options"&&"اختر كيف تريد الانضمام للمحادثة",r==="login"&&"سجل دخولك إلى حسابك",r==="register"&&"أنشئ حسابك الجديد"]})]}),r==="options"&&m.jsxs("div",{className:"space-y-4",children:[m.jsxs(ue,{onClick:()=>s("login"),className:"w-full bg-green-600 hover:bg-green-700 text-white",children:[m.jsx(a5,{className:"ml-2 h-4 w-4"}),"تسجيل الدخول"]}),m.jsxs(ue,{onClick:()=>s("register"),className:"w-full bg-blue-600 hover:bg-blue-700 text-white",children:[m.jsx(Iw,{className:"ml-2 h-4 w-4"}),"إنشاء حساب جديد"]}),m.jsxs("div",{className:"relative",children:[m.jsx(nW,{className:"bg-gray-600"}),m.jsx("div",{className:"absolute inset-0 flex items-center justify-center",children:m.jsx("span",{className:"bg-gray-900 px-2 text-gray-400 text-sm",children:"أو"})})]}),m.jsxs(ue,{onClick:L,disabled:o,className:"w-full bg-gray-700 hover:bg-gray-600 text-white border-gray-600 border",children:[m.jsx(t5,{className:"ml-2 h-4 w-4"}),o?"جاري الدخول...":"الدخول كضيف"]})]}),r==="login"&&m.jsxs("form",{onSubmit:R,className:"space-y-4",children:[u&&m.jsx("div",{className:"text-red-400 text-sm text-center bg-red-900/20 p-2 rounded",children:u}),m.jsxs("div",{children:[m.jsx(Ws,{htmlFor:"loginUsername",className:"text-gray-300",children:"اسم المستخدم"}),m.jsx(ln,{id:"loginUsername",value:p,onChange:O=>g(O.target.value),placeholder:"اسم المستخدم",className:"bg-gray-800 border-gray-600 text-white placeholder-gray-400",disabled:o,dir:"ltr"})]}),m.jsxs("div",{children:[m.jsx(Ws,{htmlFor:"loginPassword",className:"text-gray-300",children:"كلمة المرور"}),m.jsx(ln,{id:"loginPassword",type:"password",value:_,onChange:O=>v(O.target.value),placeholder:"كلمة المرور",className:"bg-gray-800 border-gray-600 text-white placeholder-gray-400",disabled:o,dir:"ltr"})]}),m.jsxs("div",{className:"flex gap-2",children:[m.jsxs(ue,{type:"button",onClick:()=>s("options"),variant:"outline",className:"flex-1 border-gray-600 text-gray-300 hover:bg-gray-700",disabled:o,children:[m.jsx(x_,{className:"ml-2 h-4 w-4"}),"رجوع"]}),m.jsx(ue,{type:"submit",disabled:o||!p.trim()||!_.trim(),className:"flex-1 bg-green-600 hover:bg-green-700 text-white",children:o?"جاري تسجيل الدخول...":"دخول"})]})]}),r==="register"&&m.jsxs("form",{onSubmit:N,className:"space-y-4",children:[m.jsxs("div",{children:[m.jsx(Ws,{htmlFor:"displayName",className:"text-gray-300",children:"الاسم الكامل"}),m.jsx(ln,{id:"displayName",value:$,onChange:O=>G(O.target.value),placeholder:"اسمك الكامل",className:"bg-gray-800 border-gray-600 text-white placeholder-gray-400",disabled:o,dir:"rtl"})]}),m.jsxs("div",{children:[m.jsx(Ws,{htmlFor:"registerUsername",className:"text-gray-300",children:"اسم المستخدم"}),m.jsx(ln,{id:"registerUsername",value:T,onChange:O=>A(O.target.value.toLowerCase()),placeholder:"username",className:"bg-gray-800 border-gray-600 text-white placeholder-gray-400",disabled:o,dir:"ltr"}),m.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"يجب أن يبدأ بحرف، حروف وأرقام انجليزية و _ فقط"})]}),m.jsxs("div",{children:[m.jsx(Ws,{htmlFor:"registerPassword",className:"text-gray-300",children:"كلمة المرور"}),m.jsx(ln,{id:"registerPassword",type:"password",value:I,onChange:O=>b(O.target.value),placeholder:"كلمة المرور",className:"bg-gray-800 border-gray-600 text-white placeholder-gray-400",disabled:o,dir:"ltr"}),m.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"8 خانات على الأقل، حرف ورقم انجليزي"})]}),m.jsxs("div",{children:[m.jsx(Ws,{htmlFor:"confirmPassword",className:"text-gray-300",children:"تأكيد كلمة المرور"}),m.jsx(ln,{id:"confirmPassword",type:"password",value:j,onChange:O=>U(O.target.value),placeholder:"تأكيد كلمة المرور",className:"bg-gray-800 border-gray-600 text-white placeholder-gray-400",disabled:o,dir:"ltr"})]}),u&&m.jsx("div",{className:"text-red-400 text-sm text-center bg-red-900/20 p-2 rounded",children:u}),m.jsxs("div",{className:"flex gap-2",children:[m.jsxs(ue,{type:"button",onClick:()=>s("options"),variant:"outline",className:"flex-1 border-gray-600 text-gray-300 hover:bg-gray-700",disabled:o,children:[m.jsx(x_,{className:"ml-2 h-4 w-4"}),"رجوع"]}),m.jsx(ue,{type:"submit",disabled:o||!T.trim()||!I.trim()||!j.trim()||!$.trim(),className:"flex-1 bg-blue-600 hover:bg-blue-700 text-white",children:o?"جاري الإنشاء...":"إنشاء الحساب"})]})]})]})})}function sW({isOpen:n,onClose:e,onSubmit:t}){const[r,s]=C.useState(""),[o,l]=C.useState(!1),[u,h]=C.useState(null),p=C.useRef(null),g=async T=>{if(T.preventDefault(),!!r.trim()){l(!0);try{await t(r.trim(),u||void 0),s(""),h(null),e()}catch(A){console.error("Error creating post:",A)}finally{l(!1)}}},_=()=>{s(""),h(null),e()},v=T=>{T.target.files&&h(T.target.files[0])};return m.jsx(Ta,{open:n,onOpenChange:_,children:m.jsxs(Ca,{className:"bg-gray-900 border-gray-700 text-white max-w-md",dir:"rtl",children:[m.jsxs(Sa,{children:[m.jsx(Ia,{className:"text-center text-green-400",children:"إنشاء منشور جديد"}),m.jsx(hc,{className:"text-center text-gray-400",children:"شارك ما يجري في بالك مع المجتمع"}),m.jsx(ue,{variant:"ghost",size:"sm",onClick:_,className:"absolute left-4 top-4 text-gray-400 hover:text-white",children:m.jsx(xa,{className:"w-5 h-5"})})]}),m.jsxs("form",{onSubmit:g,className:"space-y-4",children:[m.jsxs("div",{children:[m.jsx(i0,{value:r,onChange:T=>s(T.target.value),placeholder:"ماذا يحدث؟",className:"bg-gray-800 border-gray-600 text-white placeholder-gray-400 min-h-[120px] resize-none",disabled:o,maxLength:500,dir:"rtl"}),m.jsxs("div",{className:"flex justify-between items-center mt-2",children:[m.jsxs("div",{className:"flex items-center gap-2",children:[m.jsx("input",{type:"file",ref:p,onChange:v,className:"hidden",accept:"image/*"}),m.jsx(ue,{type:"button",variant:"ghost",size:"sm",className:"text-gray-400 hover:text-white",disabled:o,onClick:()=>p.current?.click(),children:m.jsx(MA,{className:"w-4 h-4"})}),m.jsx(ue,{type:"button",variant:"ghost",size:"sm",className:"text-gray-400 hover:text-white",disabled:o,children:m.jsx(LA,{className:"w-4 h-4"})})]}),m.jsxs("span",{className:"text-xs text-gray-500",children:[r.length,"/500"]})]})]}),m.jsxs("div",{className:"flex gap-2",children:[m.jsx(ue,{type:"button",variant:"outline",onClick:_,className:"flex-1 border-gray-600 text-gray-300 hover:bg-gray-700",disabled:o,children:"إلغاء"}),m.jsx(ue,{type:"submit",disabled:o||!r.trim(),className:"flex-1 bg-green-600 hover:bg-green-700 text-white",children:o?"جاري النشر...":"نشر"})]})]})]})})}function iW({isOpen:n,onClose:e,onSubmit:t,currentUser:r}){const[s,o]=C.useState(""),[l,u]=C.useState(""),[h,p]=C.useState(null),[g,_]=C.useState(null),[v,T]=C.useState(!1);C.useEffect(()=>{r&&(o(r.displayName||""),u(r.bio||""),_(r.avatar||null))},[r]);const A=b=>{if(b.target.files&&b.target.files[0]){const j=b.target.files[0];p(j),_(URL.createObjectURL(j))}},I=async b=>{b.preventDefault(),T(!0);const j={};s!==r.displayName&&(j.displayName=s),l!==r.bio&&(j.bio=l),h&&(j.avatar=h),await t(j),T(!1),e()};return m.jsx(Ta,{open:n,onOpenChange:e,children:m.jsxs(Ca,{className:"bg-gray-900 border-gray-700 text-white",dir:"rtl",children:[m.jsxs(Sa,{children:[m.jsx(Ia,{className:"text-green-400",children:"تعديل الملف الشخصي"}),m.jsx(hc,{children:"قم بتحديث معلومات ملفك الشخصي هنا."})]}),m.jsxs("form",{onSubmit:I,className:"space-y-4",children:[m.jsxs("div",{className:"flex flex-col items-center space-y-2",children:[m.jsxs(nr,{className:"w-24 h-24 ring-2 ring-green-500",children:[m.jsx(rr,{src:g||""}),m.jsx(sr,{children:s.charAt(0)})]}),m.jsx(ln,{id:"avatar-upload",type:"file",accept:"image/*",onChange:A,className:"hidden"}),m.jsx(Ws,{htmlFor:"avatar-upload",className:"cursor-pointer text-green-400 hover:underline",children:"تغيير الصورة"})]}),m.jsxs("div",{children:[m.jsx(Ws,{htmlFor:"displayName",className:"text-gray-300",children:"الاسم الظاهر"}),m.jsx(ln,{id:"displayName",value:s,onChange:b=>o(b.target.value),className:"bg-gray-800 border-gray-600"})]}),m.jsxs("div",{children:[m.jsx(Ws,{htmlFor:"bio",className:"text-gray-300",children:"النبذة التعريفية"}),m.jsx(i0,{id:"bio",value:l,onChange:b=>u(b.target.value),className:"bg-gray-800 border-gray-600",rows:3})]}),m.jsxs(hB,{children:[m.jsx(ue,{type:"button",variant:"outline",onClick:e,className:"border-gray-600 text-gray-300 hover:bg-gray-700",children:"إلغاء"}),m.jsx(ue,{type:"submit",disabled:v,className:"bg-green-600 hover:bg-green-700",children:v?"جاري الحفظ...":"حفظ التغييرات"})]})]})]})})}function oW(){const[n,e]=C.useState("feed"),[t,r]=C.useState(null),[s,o]=C.useState(null),[l,u]=C.useState(!0),[h,p]=C.useState([]),[g,_]=C.useState([]),[v,T]=C.useState([]),[A,I]=C.useState([]),[b,j]=C.useState([]),[U,$]=C.useState(null),[G,X]=C.useState(null),[ne,P]=C.useState(!1),[R,N]=C.useState(0),[L,O]=C.useState(0),[F,D]=C.useState(!1),[Ce,je]=C.useState(!1),[Se,Ie]=C.useState(!1),[W,J]=C.useState(null),[oe,B]=C.useState(!1),[Z,me]=C.useState(null),[_e,Ne]=C.useState(!1),Pe=()=>{const ge=prompt("أدخل رمز المطور:");if(ge==="9760"){console.log("Developer mode activated");const Re={uid:"dev_user_01"},$e={uid:"dev_user_01",username:"developer",displayName:"المطور",avatar:"https://firebasestorage.googleapis.com/v0/b/darklight-chat.appspot.com/o/profile-pictures%2Fdefault_avatar.png?alt=media&token=0default-avatar-token",bio:"أنا أستخدم وضع المطور لتجربة التطبيق.",postsCount:42,followersCount:1337,followingCount:42,isGuest:!1};r(Re),o($e),u(!1)}else ge&&alert("الرمز غير صحيح!")};C.useEffect(()=>{const ge=_6(async Re=>{if(Re){N6(Re.uid);try{const $e=await _f(Re.uid);$e?(r(Re),o($e)):(console.warn("No user profile found for authenticated user. Signing out to resolve inconsistency."),await zC(),r(null),o(null))}catch($e){console.error("Error fetching user profile, signing out:",$e),await zC(),r(null),o(null)}}else r(null),o(null);u(!1)});return()=>ge()},[]),C.useEffect(()=>{if(t&&s){const ge=b6(p),Re=C6(t.uid,T);return(async()=>{const nt=await E_();_(nt)})(),()=>{ge(),Re()}}else p([]),_([]),T([]),I([]),j([])},[t,s]);const he=async(ge,Re)=>{if(!s)return;let $e;Re&&($e=await A6(s.uid,Re));const nt={content:ge,imageUrl:$e,userId:s.uid,username:s.username,displayName:s.displayName,avatar:s.avatar,likes:0,replies:0,likedBy:[]};await E6(nt),je(!1)},Fe=async ge=>{if(!t)return;const Re=h.find(tn=>tn.id===ge);if(!Re)return;const nt=Re.likedBy.includes(t.uid)?Re.likedBy.filter(tn=>tn!==t.uid):[...Re.likedBy,t.uid];await BC(ge,{likedBy:nt,likes:nt.length})},Ye=async(ge,Re)=>{if(!s)return;const $e={postId:ge,content:Re,userId:s.uid,username:s.username,displayName:s.displayName,avatar:s.avatar};await S6($e);const nt=h.find(tn=>tn.id===ge);nt&&await BC(ge,{replies:(nt.replies||0)+1})},xt=async ge=>{if(!t)return;const Re={type:ge.type,content:ge.content,backgroundColor:ge.backgroundColor};await x6(t.uid,Re),D(!1);const $e=await E_();_($e)},An=async ge=>{if(!s)return;const Re={};if(ge.displayName&&(Re.displayName=ge.displayName),ge.bio&&(Re.bio=ge.bio),ge.avatar){const nt=await R6(s.uid,ge.avatar);Re.avatar=nt}Object.keys(Re).length>0&&await w6(s.uid,Re);const $e=await _f(s.uid);$e&&o($e),Ne(!1)},kn=ge=>{const Re=g.findIndex($e=>$e.userId===ge.userId);Re!==-1&&(N(Re),O(0),P(!0))},Tn=()=>{const ge=g[R]?.stories;L<ge.length-1?O(Re=>Re+1):R<g.length-1?(N(Re=>Re+1),O(0)):P(!1)},ui=()=>{if(L>0)O(ge=>ge-1);else if(R>0){const ge=R-1,Re=g[ge].stories;N(ge),O(Re.length-1)}},Aa=async ge=>{const Re=await _f(ge);X(Re)},di=ge=>{ge.otherUser?$(ge.otherUser):console.error("Conversation is missing otherUser property",ge)};return l?m.jsx("div",{className:"min-h-screen bg-black flex items-center justify-center",children:m.jsxs("div",{className:"text-center",children:[m.jsx("div",{className:"w-12 h-12 border-2 border-green-500 border-t-transparent rounded-full animate-spin mx-auto mb-4"}),m.jsx("p",{className:"text-white",children:"تحميل Dark*Chat..."})]})}):t?m.jsxs("div",{className:"min-h-screen bg-black",dir:"rtl",children:[m.jsx(v9,{currentView:n,onViewChange:e,unreadCount:v.reduce((ge,Re)=>ge+(Re.unreadCount||0),0)}),G&&m.jsx(K7,{profile:G,onBack:()=>X(null),onMessage:()=>{$(G),X(null)}}),U&&m.jsx(LB,{user:U,onBack:()=>$(null),currentUserId:t.uid}),ne&&g.length>0&&m.jsx(jB,{stories:g,currentStoryIndex:R,currentContentIndex:L,onClose:()=>P(!1),onNext:Tn,onPrevious:ui,onReply:(ge,Re)=>console.log("Reply to story:",ge,Re)}),m.jsx(Q7,{isOpen:F,onClose:()=>D(!1),onSubmit:xt}),m.jsx(sW,{isOpen:Ce,onClose:()=>je(!1),onSubmit:he}),m.jsx(VB,{isOpen:Se,onClose:()=>{Ie(!1),J(null),j([])},postId:W||"",comments:b,onAddComment:Ye}),m.jsx(HB,{isOpen:oe,onClose:()=>B(!1),postId:Z||"",users:[],onShare:(ge,Re,$e)=>console.log("Share post:",ge,Re,$e)}),s&&m.jsx(iW,{isOpen:_e,onClose:()=>Ne(!1),onSubmit:An,currentUser:s}),m.jsxs("div",{className:U||G?"hidden":"",children:[n==="feed"&&m.jsx(L9,{posts:h,stories:g,onLike:Fe,onReply:async ge=>{const Re=await WC(ge);j(Re),J(ge),Ie(!0)},onShare:ge=>{me(ge),B(!0)},onStoryClick:kn,onUserClick:Aa,onAddStory:()=>D(!0),onCreatePost:()=>je(!0),currentUserId:t?.uid,currentUser:s}),n==="messages"&&m.jsx(j9,{conversations:v,onConversationClick:di}),n==="likes"&&m.jsx(F9,{likedPosts:h.filter(ge=>ge.likedBy.includes(t.uid)),onUnlike:Fe,onReply:async ge=>{const Re=await WC(ge);j(Re),J(ge),Ie(!0)},onShare:ge=>{me(ge),B(!0)}}),n==="profile"&&s&&m.jsx(V9,{profile:s,isOwnProfile:!0,onEditProfile:()=>Ne(!0),onShareProfile:()=>console.log("Share profile clicked"),onFollow:()=>console.log("Follow clicked")})]})]}):m.jsx("div",{className:"min-h-screen bg-black",children:m.jsx(rW,{isOpen:!0,onClose:()=>{},onDevModeToggle:Pe})})}RP.createRoot(document.getElementById("root")).render(m.jsx(oW,{}));
